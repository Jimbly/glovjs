(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";module.exports=create;function create(){var out=new Float32Array(9);out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=1;out[5]=0;out[6]=0;out[7]=0;out[8]=1;return out}},{}],2:[function(require,module,exports){"use strict";module.exports=fromMat4;function fromMat4(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[4];out[4]=a[5];out[5]=a[6];out[6]=a[8];out[7]=a[9];out[8]=a[10];return out}},{}],3:[function(require,module,exports){"use strict";module.exports=copy;function copy(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return out}},{}],4:[function(require,module,exports){"use strict";module.exports=create;function create(){var out=new Float32Array(16);out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return out}},{}],5:[function(require,module,exports){"use strict";module.exports=invert;function invert(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;out[0]=(a11*b11-a12*b10+a13*b09)*det;out[1]=(a02*b10-a01*b11-a03*b09)*det;out[2]=(a31*b05-a32*b04+a33*b03)*det;out[3]=(a22*b04-a21*b05-a23*b03)*det;out[4]=(a12*b08-a10*b11-a13*b07)*det;out[5]=(a00*b11-a02*b08+a03*b07)*det;out[6]=(a32*b02-a30*b05-a33*b01)*det;out[7]=(a20*b05-a22*b02+a23*b01)*det;out[8]=(a10*b10-a11*b08+a13*b06)*det;out[9]=(a01*b08-a00*b10-a03*b06)*det;out[10]=(a30*b04-a31*b02+a33*b00)*det;out[11]=(a21*b02-a20*b04-a23*b00)*det;out[12]=(a11*b07-a10*b09-a12*b06)*det;out[13]=(a00*b09-a01*b07+a02*b06)*det;out[14]=(a31*b01-a30*b03-a32*b00)*det;out[15]=(a20*b03-a21*b01+a22*b00)*det;return out}},{}],6:[function(require,module,exports){"use strict";module.exports=multiply;function multiply(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];var b0=b[0],b1=b[1],b2=b[2],b3=b[3];out[0]=b0*a00+b1*a10+b2*a20+b3*a30;out[1]=b0*a01+b1*a11+b2*a21+b3*a31;out[2]=b0*a02+b1*a12+b2*a22+b3*a32;out[3]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[4];b1=b[5];b2=b[6];b3=b[7];out[4]=b0*a00+b1*a10+b2*a20+b3*a30;out[5]=b0*a01+b1*a11+b2*a21+b3*a31;out[6]=b0*a02+b1*a12+b2*a22+b3*a32;out[7]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[8];b1=b[9];b2=b[10];b3=b[11];out[8]=b0*a00+b1*a10+b2*a20+b3*a30;out[9]=b0*a01+b1*a11+b2*a21+b3*a31;out[10]=b0*a02+b1*a12+b2*a22+b3*a32;out[11]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[12];b1=b[13];b2=b[14];b3=b[15];out[12]=b0*a00+b1*a10+b2*a20+b3*a30;out[13]=b0*a01+b1*a11+b2*a21+b3*a31;out[14]=b0*a02+b1*a12+b2*a22+b3*a32;out[15]=b0*a03+b1*a13+b2*a23+b3*a33;return out}},{}],7:[function(require,module,exports){"use strict";module.exports=perspective;function perspective(out,fovy,aspect,near,far){var f=1/Math.tan(fovy/2),nf=1/(near-far);out[0]=f/aspect;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=f;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=2*far*near*nf;out[15]=0;return out}},{}],8:[function(require,module,exports){"use strict";module.exports=transpose;function transpose(out,a){if(out===a){var a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a01;out[6]=a[9];out[7]=a[13];out[8]=a02;out[9]=a12;out[11]=a[14];out[12]=a03;out[13]=a13;out[14]=a23}else{out[0]=a[0];out[1]=a[4];out[2]=a[8];out[3]=a[12];out[4]=a[1];out[5]=a[5];out[6]=a[9];out[7]=a[13];out[8]=a[2];out[9]=a[6];out[10]=a[10];out[11]=a[14];out[12]=a[3];out[13]=a[7];out[14]=a[11];out[15]=a[15]}return out}},{}],9:[function(require,module,exports){"use strict";exports.virtualToCanvas=virtualToCanvas;exports.set=set;exports.setAspectFixed=setAspectFixed;exports.setAspectFixed2=setAspectFixed2;exports.zoom=zoom;exports.setNormalized=setNormalized;exports.x0=x0;exports.y0=y0;exports.x1=x1;exports.y1=y1;exports.w=w;exports.h=h;exports.xScale=xScale;exports.yScale=yScale;exports.htmlPos=htmlPos;exports.htmlSize=htmlSize;exports.physicalToVirtual=physicalToVirtual;exports.physicalDeltaToVirtual=physicalDeltaToVirtual;exports.virtualToPhysical=virtualToPhysical;exports.tick=tick;exports.startup=startup;var engine=require("./engine.js");var round=Math.round;var data=exports.data=new Float32Array(9);var screen_width=void 0;var screen_height=void 0;var render_width=void 0;var render_height=void 0;var render_viewport_w=exports.render_viewport_w=void 0;var render_viewport_h=exports.render_viewport_h=void 0;var render_offset_x=exports.render_offset_x=void 0;var render_offset_y=exports.render_offset_y=void 0;function reapply(){if(render_width){data[4]=render_width/(data[2]-data[0]);data[5]=render_height/(data[3]-data[1]);data[7]=(data[2]-data[0])/render_viewport_w;data[8]=(data[3]-data[1])/render_viewport_h}else{data[4]=screen_width/(data[2]-data[0]);data[5]=screen_height/(data[3]-data[1])}}function virtualToCanvas(dst,src){dst[0]=(src[0]-data[0])*data[4];dst[1]=(src[1]-data[1])*data[5]}function set(x0,y0,x1,y1){data[0]=x0;data[1]=y0;data[2]=x1;data[3]=y1;reapply()}function setAspectFixed(w,h){var pa=engine.render_width?1:engine.pixel_aspect;var inv_aspect=h/pa/w;var inv_desired_aspect=void 0;if(render_width){inv_desired_aspect=render_height/render_width}else{inv_desired_aspect=screen_height/screen_width}if(inv_aspect>inv_desired_aspect){var margin=(h/pa/inv_desired_aspect-w)/2;set(-margin,0,w+margin,h)}else{var _margin=(w*pa*inv_desired_aspect-h)/2;set(0,-_margin,w,h+_margin)}}function setAspectFixed2(w,h){var pa=engine.render_width?1:engine.pixel_aspect;var inv_aspect=h/pa/w;var inv_desired_aspect=void 0;if(render_width){inv_desired_aspect=render_height/render_width}else{inv_desired_aspect=screen_height/screen_width}if(inv_aspect>inv_desired_aspect){var margin=h/pa/inv_desired_aspect-w;set(0,0,w+margin,h)}else{var _margin2=w*pa*inv_desired_aspect-h;set(0,0,w,h+_margin2)}}function zoom(x,y,factor){var inv_factor=1/factor;set(x-(x-data[0])*inv_factor,y-(y-data[1])*inv_factor,x+(data[2]-x)*inv_factor,y+(data[3]-y)*inv_factor)}function setNormalized(){set(0,0,1,1)}function x0(){return data[0]}function y0(){return data[1]}function x1(){return data[2]}function y1(){return data[3]}function w(){return data[2]-data[0]}function h(){return data[3]-data[1]}function xScale(){return data[4]}function yScale(){return data[5]}function htmlPos(x,y){if(render_width){return[100*(((x-data[0])/data[7]+render_offset_x)/screen_width),100*(((y-data[1])/data[8]+render_offset_y)/screen_height)]}else{return[100*(x-data[0])/(data[2]-data[0]),100*(y-data[1])/(data[3]-data[1])]}}function htmlSize(w,h){if(render_width){return[100*w/data[7]/screen_width,100*h/data[8]/screen_height]}else{return[100*w/(data[2]-data[0]),100*h/(data[3]-data[1])]}}function physicalToVirtual(dst,src){if(render_width){dst[0]=(src[0]*data[6]-render_offset_x)*data[7]+data[0];dst[1]=(src[1]*data[6]-render_offset_y)*data[8]+data[1]}else{dst[0]=src[0]*data[6]/data[4]+data[0];dst[1]=src[1]*data[6]/data[5]+data[1]}}function physicalDeltaToVirtual(dst,src){if(render_width){dst[0]=src[0]*data[6]*data[7];dst[1]=src[1]*data[6]*data[8]}else{dst[0]=src[0]*data[6]/data[4];dst[1]=src[1]*data[6]/data[5]}}function virtualToPhysical(dst,src){if(render_width){dst[0]=(render_offset_x+(src[0]-data[0])/data[7])/data[6];dst[1]=(render_offset_y+(src[1]-data[1])/data[8])/data[6]}else{dst[0]=(src[0]-data[0])*data[4]/data[6];dst[1]=(src[1]-data[1])*data[5]/data[6]}}function tick(){data[6]=window.devicePixelRatio||1;screen_width=engine.width;screen_height=engine.height;var viewport=[0,0,screen_width,screen_height];if(engine.render_width){render_width=engine.render_width;render_height=engine.render_height;var pa=engine.pixel_aspect;var inv_aspect=render_height/pa/render_width;var inv_desired_aspect=screen_height/screen_width;if(inv_aspect>inv_desired_aspect){var margin=(render_height/inv_desired_aspect-render_width*pa)/2*screen_height/render_height;exports.render_offset_x=render_offset_x=round(margin);exports.render_offset_y=render_offset_y=0;exports.render_viewport_w=render_viewport_w=round(screen_width-margin*2);exports.render_viewport_h=render_viewport_h=screen_height}else{var _margin3=(render_width*inv_desired_aspect-render_height/pa)/2*screen_width/render_width;exports.render_offset_x=render_offset_x=0;exports.render_offset_y=render_offset_y=round(_margin3);exports.render_viewport_w=render_viewport_w=screen_width;exports.render_viewport_h=render_viewport_h=round(screen_height-_margin3*2)}viewport[2]=render_width;viewport[3]=render_height}else{render_width=render_height=0;exports.render_offset_x=render_offset_x=0;exports.render_offset_y=render_offset_y=0}reapply();engine.setViewport(viewport)}function startup(){set(0,0,engine.width,engine.height);tick()}},{"./engine.js":12}],10:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports.create=create;var glov_input=require("./input.js");var glov_ui=require("./ui.js");var camera2d=require("./camera2d.js");var _require=require("./ui.js"),focuslog=_require.focuslog;var GlovUIEditBox=function(){function GlovUIEditBox(params){this.x=0;this.y=0;this.z=Z.UI;this.w=glov_ui.button_width;this.type="text";this.text="";this.placeholder="";this.initial_focus=false;this.applyParams(params);this.got_focus_in=false;this.got_focus_out=false;this.elem=null;this.input=null;this.submitted=false}_createClass(GlovUIEditBox,[{key:"applyParams",value:function applyParams(params){if(!params){return}for(var f in params){this[f]=params[f]}}},{key:"getText",value:function getText(){return this.text}},{key:"setText",value:function setText(new_text){if(this.input){this.input.value=new_text}this.text=new_text}},{key:"focus",value:function focus(){glov_ui.focusSteal(this)}},{key:"updateFocus",value:function updateFocus(){if(this.got_focus_out){if(glov_ui.isFocusedPeek(this)){glov_input.keyDownEdge(glov_input.KEYS.TAB);if(glov_input.keyDown(glov_input.KEYS.SHIFT)){glov_ui.focusPrev(this)}else{glov_ui.focusNext(this)}}this.got_focus_out=false}if(this.got_focus_in){glov_input.keyDownEdge(glov_input.KEYS.TAB);glov_ui.focusSteal(this);this.got_focus_in=false}var focused=glov_ui.focusCheck(this);if(focused&&this.input&&document.activeElement!==this.input){this.input.focus()}if(!focused&&this.input&&document.activeElement===this.input){this.input.blur()}if(focused&&glov_input.keyDownEdge(glov_input.KEYS.ESC)){if(this.text){this.setText("")}else{glov_ui.focusCanvas()}}return focused}},{key:"run",value:function run(params){var _this=this;this.applyParams(params);var focused=this.updateFocus();glov_ui.this_frame_edit_boxes.push(this);var elem=glov_ui.getElem();if(elem!==this.elem){if(elem){elem.textContent="";var form=document.createElement("form");var input=document.createElement("input");input.setAttribute("type",this.type);input.setAttribute("placeholder",this.placeholder);input.setAttribute("tabindex",2);input.addEventListener("focusin",function(ev){focuslog("EditBox:focusin",_this);_this.got_focus_in=true;ev.preventDefault()},true);input.addEventListener("focusout",function(ev){focuslog("EditBox:focusout",_this);_this.got_focus_out=true;ev.preventDefault()},true);form.addEventListener("submit",function(ev){ev.preventDefault();_this.submitted=true},true);form.appendChild(input);var span=document.createElement("span");span.setAttribute("tabindex",3);form.appendChild(span);elem.appendChild(form);input.value=this.text;this.input=input;if(this.initial_focus){input.focus()}}else{this.input=null}this.submitted=false;this.elem=elem}else{if(this.input){this.text=this.input.value}}if(elem){var pos=camera2d.htmlPos(this.x,this.y);elem.style.left=pos[0]+"%";elem.style.top=pos[1]+"%";var size=camera2d.htmlSize(this.w,this.h);elem.style.width=size[0]+"%"}if(focused){glov_input.eatAllKeyboardInput()}if(this.submitted){this.submitted=false;return this.SUBMIT}return null}},{key:"unrun",value:function unrun(){this.elem=null;this.input=null}}]);return GlovUIEditBox}();GlovUIEditBox.prototype.SUBMIT="submit";function create(params){return new GlovUIEditBox(params)}},{"./camera2d.js":9,"./input.js":15,"./ui.js":25}],11:[function(require,module,exports){"use strict";exports.grayScaleMatrix=grayScaleMatrix;exports.sepiaMatrix=sepiaMatrix;exports.negativeMatrix=negativeMatrix;exports.saturationMatrix=saturationMatrix;exports.hueMatrix=hueMatrix;exports.brightnessAddMatrix=brightnessAddMatrix;exports.brightnessScaleMatrix=brightnessScaleMatrix;exports.additiveMatrix=additiveMatrix;exports.contrastMatrix=contrastMatrix;exports.applyCopy=applyCopy;exports.applyPixelyExpand=applyPixelyExpand;exports.applyGaussianBlur=applyGaussianBlur;exports.applyColorMatrix=applyColorMatrix;var engine=require("./engine.js");var geom=require("./geom.js");var shaders=require("./shaders.js");var textures=require("./textures.js");var _require=require("./vmath.js"),vec2=_require.vec2,vec4=_require.vec4,v4set=_require.v4set;var shader_data={vp_copy:{vp:"#pragma WebGL\nprecision highp float;\n\nvarying vec2 interp_texcoord;\nattribute vec2 POSITION;\n\nuniform vec2 copy_uv_scale;\nuniform vec4 clip_space;\n\nvoid main()\n{\n  interp_texcoord = POSITION * copy_uv_scale;\n  gl_Position = vec4(POSITION * clip_space.xy + clip_space.zw, 0, 1);\n}"},copy:{fp:"#pragma WebGL\n\nprecision highp float;\nprecision highp int;\n\nvarying vec2 interp_texcoord;\n\nuniform sampler2D inputTexture0;\nvoid main()\n{\n  gl_FragColor = texture2D(inputTexture0, interp_texcoord);\n}\n"},pixely_expand:{fp:"// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n#pragma WebGL\n\nprecision mediump float;\nprecision mediump int;\n\nvarying highp vec2 interp_texcoord;\nuniform sampler2D inputTexture0; // source\nuniform sampler2D inputTexture1; // hblur\nuniform sampler2D inputTexture2; // hblur+vblur\nuniform vec4 orig_pixel_size;\n\n// 1D Gaussian.\nfloat Gaus(float pos, float scale) {\n  return exp2(scale*pos*pos);\n}\n\nconst float SHADE = 0.75;\nconst float EASING = 1.25;\n\n#define DO_WARP\n#ifdef DO_WARP\n// Display warp.\n// 0.0 = none\n// 1.0/8.0 = extreme\nconst vec2 WARP=vec2(1.0/32.0,1.0/24.0);\n\n// Distortion of scanlines, and end of screen alpha.\nvec2 Warp(vec2 pos){\n  pos=pos*2.0-1.0;\n  pos*=vec2(1.0+(pos.y*pos.y)*WARP.x,1.0+(pos.x*pos.x)*WARP.y);\n  return pos*0.5+0.5;\n}\n#else\n#define Warp(v) v\n#endif\n\nfloat easeInOut(float v) {\n  float va = pow(v, EASING);\n  return va / (va + pow((1.0 - v), EASING));\n}\n\nfloat easeIn(float v) {\n  return 2.0 * easeInOut(0.5 * v);\n}\n\nfloat easeOut(float v) {\n  return 2.0 * easeInOut(0.5 + 0.5 * v) - 1.0;\n}\n\nvoid main()\n{\n  vec2 texcoords = Warp(interp_texcoord);\n  vec2 intcoords = (floor(texcoords.xy * orig_pixel_size.xy) + 0.5) * orig_pixel_size.zw;\n  vec2 deltacoords = (texcoords.xy - intcoords) * orig_pixel_size.xy; // -0.5 ... 0.5\n  // for horizontal sampling, map [-0.5 .. -A .. A .. 0.5] -> [-0.5 .. 0 .. 0 .. 0.5];\n  float A = 0.25;\n  float Ainv = (0.5 - A) * 2.0;\n  float uoffs = clamp((abs(deltacoords.x) - A) / Ainv, 0.0, 1.0) * orig_pixel_size.z;\n  uoffs *= sign(deltacoords.x);\n  vec2 sample_coords = vec2(intcoords.x + uoffs, intcoords.y);\n  // sample_coords = intcoords;\n  vec3 color = texture2D(inputTexture1, sample_coords).rgb;\n  vec3 color_scanline = texture2D(inputTexture2, texcoords.xy + vec2(0.0, 0.5 * orig_pixel_size.w)).rgb * SHADE;\n  // color_scanline = vec3(0);\n\n  // float mask = Gaus(deltacoords.y, -12.0);\n  float mask = easeOut(2.0*(0.5 - abs(deltacoords.y)));\n  // float mask = abs(deltacoords.y) > 0.25 ? 0.0 : 1.0;\n  color = mix(color_scanline, color, mask);\n  // color = vec3(mask);\n\n#ifdef DO_WARP\n  // vignette\n  float dist = min(1.0, 100.0 * min(0.5 - abs(texcoords.x - 0.5), 0.5 - abs(texcoords.y - 0.5)));\n  color *= dist;\n#endif\n\n  gl_FragColor = vec4(color, 1.0);\n  // gl_FragColor = vec4(color_scanline, 1.0);\n  // gl_FragColor = vec4(sample_coords, 0.0, 1.0);\n}\n"},gaussian_blur:{fp:"#pragma WebGL\n\nprecision highp float;\nprecision highp int;\n\nvarying vec2 interp_texcoord;\n\nvec4 _ret_0;\nvec4 _TMP2;\nvec4 _TMP1;\nvec2 _c0022;\nvec2 _c0024;\nuniform vec2 sampleRadius;\nuniform sampler2D inputTexture0;\nuniform float Gauss[9];\n\nvoid main()\n{\n  vec2 uv = interp_texcoord;\n  vec2 step = sampleRadius;\n  gl_FragColor =\n    ((texture2D(inputTexture0, uv - step * 3.0) + texture2D(inputTexture0, uv + step * 3.0)) * 0.085625 +\n    (texture2D(inputTexture0, uv - step * 2.0) + texture2D(inputTexture0, uv + step * 2.0)) * 0.12375 +\n    (texture2D(inputTexture0, uv - step * 1.0) + texture2D(inputTexture0, uv + step * 1.0)) * 0.234375 +\n    texture2D(inputTexture0, uv) * 0.3125) * 0.83333333333333333333333333333333;\n}\n"},color_matrix:{fp:"#pragma WebGL\n\nprecision highp float;\n\nvarying vec2 interp_texcoord;\n\nuniform vec4 colorMatrix[3];\nuniform sampler2D tex0;\n\nvoid main()\n{\n  vec4 _color;\n  vec4 _mutc;\n  _color = texture2D(tex0, interp_texcoord);\n  _mutc = _color;\n  _mutc.w = 1.0;\n  vec3 _r0019;\n  _r0019.x = dot(colorMatrix[0], _mutc);\n  _r0019.y = dot(colorMatrix[1], _mutc);\n  _r0019.z = dot(colorMatrix[2], _mutc);\n  _mutc.xyz = _r0019;\n  _mutc.w = _color.w;\n  gl_FragColor = _mutc;\n}"}};function getShader(key){var elem=shader_data[key];if(!elem.shader){if(elem.fp){elem.shader=shaders.create(gl.FRAGMENT_SHADER,elem.fp)}else{elem.shader=shaders.create(gl.VERTEX_SHADER,elem.vp)}}return elem.shader}var inited=false;var clip_space=vec4(2,2,-1,-1);var copy_uv_scale=vec2(1,1);var shader_params_default={clip_space:clip_space,copy_uv_scale:copy_uv_scale};var shader_params_color_matrix=void 0;var shader_params_gaussian_blur=void 0;var shader_params_pixely_expand=void 0;var quad_geom=void 0;function startup(){inited=true;quad_geom=geom.create([[shaders.semantic.POSITION,gl.FLOAT,2,false]],new Float32Array([0,0,1,0,1,1,0,1]),null,geom.QUADS);shader_params_color_matrix={clip_space:clip_space,copy_uv_scale:copy_uv_scale,colorMatrix:new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0])};shader_params_gaussian_blur={clip_space:clip_space,copy_uv_scale:copy_uv_scale,sampleRadius:vec2(1,1),Gauss:new Float32Array([.93,.8,.7,.6,.5,.4,.3,.2,.1])};shader_params_pixely_expand={clip_space:clip_space,copy_uv_scale:copy_uv_scale,orig_pixel_size:vec4()}}function grayScaleMatrix(dst){dst[0]=.2126;dst[1]=.2126;dst[2]=.2126;dst[3]=.7152;dst[4]=.7152;dst[5]=.7152;dst[6]=.0722;dst[7]=.0722;dst[8]=.0722;dst[9]=dst[10]=dst[11]=0}function sepiaMatrix(dst){dst[0]=.393;dst[1]=.349;dst[2]=.272;dst[3]=.769;dst[4]=.686;dst[5]=.534;dst[6]=.189;dst[7]=.168;dst[8]=.131;dst[9]=dst[10]=dst[11]=0}function negativeMatrix(dst){dst[0]=dst[4]=dst[8]=-1;dst[1]=dst[2]=dst[3]=dst[5]=dst[6]=dst[7]=0;dst[9]=dst[10]=dst[11]=1}function saturationMatrix(dst,saturationScale){var is=1-saturationScale;dst[0]=is*.2126+saturationScale;dst[1]=is*.2126;dst[2]=is*.2126;dst[3]=is*.7152;dst[4]=is*.7152+saturationScale;dst[5]=is*.7152;dst[6]=is*.0722;dst[7]=is*.0722;dst[8]=is*.0722+saturationScale;dst[9]=dst[10]=dst[11]=0}function hueMatrix(dst,angle){var c=Math.cos(angle);var s=Math.sin(angle);dst[0]=.7874*c+-.3712362230889293*s+.2126;dst[1]=-.2126*c+.20611404610069642*s+.2126;dst[2]=-.2126*c+-.9485864922785551*s+.2126;dst[3]=-.7152*c+-.4962902913954023*s+.7152;dst[4]=.2848*c+.08105997779422341*s+.7152;dst[5]=-.7152*c+.6584102469838492*s+.7152;dst[6]=-.0722*c+.8675265144843316*s+.0722;dst[7]=-.0722*c+-.28717402389491986*s+.0722;dst[8]=.9278*c+.290176245294706*s+.0722;dst[9]=dst[10]=dst[11]=0}function brightnessAddMatrix(dst,brightnessOffset){dst[0]=dst[4]=dst[8]=1;dst[1]=dst[2]=dst[3]=dst[5]=dst[6]=dst[7]=0;dst[9]=dst[10]=dst[11]=brightnessOffset}function brightnessScaleMatrix(dst,scale){dst[0]=dst[4]=dst[8]=scale;dst[1]=dst[2]=dst[3]=dst[5]=dst[6]=dst[7]=0;dst[9]=dst[10]=dst[11]=0}function additiveMatrix(dst,additiveRGB){dst[0]=dst[4]=dst[8]=1;dst[1]=dst[2]=dst[3]=dst[5]=dst[6]=dst[7]=0;dst[9]=additiveRGB[0];dst[10]=additiveRGB[1];dst[11]=additiveRGB[2]}function contrastMatrix(dst,contrastScale){dst[0]=dst[4]=dst[8]=contrastScale;dst[1]=dst[2]=dst[3]=dst[5]=dst[6]=dst[7]=0;dst[9]=dst[10]=dst[11]=.5*(1-contrastScale)}function applyEffect(effect,view_w,view_h){var viewport=engine.viewport;var target_w=viewport[2];var target_h=viewport[3];view_w=view_w||target_w;view_h=view_h||target_h;clip_space[0]=2*view_w/target_w;clip_space[1]=2*view_h/target_h;shaders.bind(getShader("vp_copy"),getShader(effect.shader),effect.params);textures.bindArray(effect.texs);quad_geom.draw()}function applyCopy(params){if(!inited){startup()}applyEffect({shader:"copy",params:shader_params_default,texs:[params.source]})}function applyPixelyExpand(params){if(!inited){startup()}var source=params.source;source.setSamplerState({filter_min:gl.LINEAR,filter_mag:gl.LINEAR,wrap_s:gl.CLAMP_TO_EDGE,wrap_t:gl.CLAMP_TO_EDGE});var resx=source.width;var resy=source.height;var sampleRadius=(params.hblur||.25)/resx;shader_params_gaussian_blur.sampleRadius[0]=sampleRadius;shader_params_gaussian_blur.sampleRadius[1]=0;applyEffect({shader:"gaussian_blur",params:shader_params_gaussian_blur,texs:[source]},resx,resy);var hblur=engine.captureFramebuffer(null,resx,resy,true,false);sampleRadius=(params.vblur||.75)/resy;shader_params_gaussian_blur.sampleRadius[0]=0;shader_params_gaussian_blur.sampleRadius[1]=sampleRadius;applyEffect({shader:"gaussian_blur",params:shader_params_gaussian_blur,texs:[hblur]},resx,resy);var vblur=engine.captureFramebuffer(null,resx,resy,true,false);v4set(shader_params_pixely_expand.orig_pixel_size,source.width,source.height,1/source.width,1/source.height);engine.setViewport(params.final_viewport);if(params.clear_color){gl.clearColor(params.clear_color[0],params.clear_color[1],params.clear_color[2],params.clear_color[3]);gl.clear(gl.COLOR_BUFFER_BIT)}applyEffect({shader:"pixely_expand",params:shader_params_pixely_expand,texs:[source,hblur,vblur]})}function applyGaussianBlur(params){if(!inited){startup()}var source=params.source;source.setSamplerState({filter_min:gl.LINEAR,filter_mag:gl.LINEAR,wrap_s:gl.CLAMP_TO_EDGE,wrap_t:gl.CLAMP_TO_EDGE});var max_size=params.max_size||512;var min_size=params.min_size||128;var inputTexture0=source;var viewport=engine.viewport;var res=max_size;while(res>viewport[2]||res>viewport[3]){res/=2}while(res>min_size){applyEffect({shader:"copy",params:shader_params_default,texs:[inputTexture0]},res,res);inputTexture0=engine.captureFramebuffer(null,res,res,true,false);res/=2}var sampleRadius=(params.blur||1)/res;shader_params_gaussian_blur.sampleRadius[0]=sampleRadius;shader_params_gaussian_blur.sampleRadius[1]=0;applyEffect({shader:"gaussian_blur",params:shader_params_gaussian_blur,texs:[inputTexture0]},res,res);var blur=engine.captureFramebuffer(null,res,res,true,false);shader_params_gaussian_blur.sampleRadius[0]=0;shader_params_gaussian_blur.sampleRadius[1]=sampleRadius;applyEffect({shader:"gaussian_blur",params:shader_params_gaussian_blur,texs:[blur]});return true}function applyColorMatrix(params){if(!inited){startup()}var source=params.source;source.setSamplerState({filter_min:gl.LINEAR,filter_mag:gl.LINEAR,wrap_s:gl.CLAMP_TO_EDGE,wrap_t:gl.CLAMP_TO_EDGE});var matrix=params.colorMatrix;var mout=shader_params_color_matrix.colorMatrix;mout[0]=matrix[0];mout[1]=matrix[3];mout[2]=matrix[6];mout[3]=matrix[9];mout[4]=matrix[1];mout[5]=matrix[4];mout[6]=matrix[7];mout[7]=matrix[10];mout[8]=matrix[2];mout[9]=matrix[5];mout[10]=matrix[8];mout[11]=matrix[11];applyEffect({shader:"color_matrix",params:shader_params_color_matrix,texs:[source]});return true}},{"./engine.js":12,"./geom.js":14,"./shaders.js":19,"./textures.js":23,"./vmath.js":26}],12:[function(require,module,exports){"use strict";exports.setGlobalMatrices=setGlobalMatrices;exports.updateMatrices=updateMatrices;exports.postprocessingAllow=postprocessingAllow;exports.getFrameTimestamp=getFrameTimestamp;exports.getFrameIndex=getFrameIndex;exports.getFrameDt=getFrameDt;exports.getFrameDtActual=getFrameDtActual;exports.setState=setState;exports.addTickFunc=addTickFunc;exports.setViewport=setViewport;exports.getTemporaryTexture=getTemporaryTexture;exports.captureFramebuffer=captureFramebuffer;exports.startup=startup;var assert=require("assert");var camera2d=require("./camera2d.js");var effects=require("./effects.js");var glov_font=require("./font.js");var font_info_palanquin32=require("../img/font/palanquin32.json");var geom=require("./geom.js");var input=require("./input.js");var local_storage=require("./local_storage.js");var mat3FromMat4=require("gl-mat3/fromMat4");var mat4Copy=require("gl-mat4/copy");var mat4Invert=require("gl-mat4/invert");var mat4Mul=require("gl-mat4/multiply");var mat4Transpose=require("gl-mat4/transpose");var mat4Perspective=require("gl-mat4/perspective");var asin=Math.asin,cos=Math.cos,min=Math.min,max=Math.max,PI=Math.PI,sin=Math.sin,sqrt=Math.sqrt;var shaders=require("./shaders.js");var sprites=require("./sprites.js");var textures=require("./textures.js");var glov_transition=require("./transition.js");var glov_ui=require("./ui.js");var _require=require("./vmath.js"),mat3=_require.mat3,mat4=_require.mat4,vec3=_require.vec3,vec4=_require.vec4,v3mulMat4=_require.v3mulMat4,v3normalize=_require.v3normalize,v4copy=_require.v4copy;var canvas=void 0;var glov_particles=exports.glov_particles=void 0;var sound_manager=exports.sound_manager=void 0;var width=exports.width=void 0;var height=exports.height=void 0;var pixel_aspect=exports.pixel_aspect=1;var clear_bits=void 0;var game_width=exports.game_width=void 0;var game_height=exports.game_height=void 0;var render_width=exports.render_width=void 0;var render_height=exports.render_height=void 0;var defines=exports.defines={};var ZFAR=exports.ZFAR=1e4;var fov_y=exports.fov_y=45*PI/180;var fov_x=exports.fov_x=1;var mat_projection=exports.mat_projection=mat4();var mat_view=exports.mat_view=mat4();var mat_m=mat4();var mat_vp=mat4();var mat_mv=mat4();var mat_mvp=mat4();var mat_mv_inv_transform=mat3();var light_diffuse=exports.light_diffuse=vec3(.75,.75,.75);var light_dir_vs=vec3(0,0,0);var light_ambient=vec3(.25,.25,.25);var light_dir_ws=exports.light_dir_ws=vec3(-1,-2,-3);var font=exports.font=void 0;var app_state=exports.app_state=null;var pico8_colors=exports.pico8_colors=[vec4(0,0,0,1),vec4(.114,.169,.326,1),vec4(.494,.145,.326,1),vec4(0,.529,.328,1),vec4(.671,.322,.212,1),vec4(.373,.341,.31,1),vec4(.761,.765,.78,1),vec4(1,.945,.91,1),vec4(1,0,.302,1),vec4(1,.639,0,1),vec4(1,.925,.153,1),vec4(0,.894,.212,1),vec4(.161,.678,1,1),vec4(.514,.463,.612,1),vec4(1,.467,.659,1),vec4(1,.8,.667,1)];var fps_style=exports.fps_style=glov_font.style({outline_width:2,outline_color:128,color:4294967295});function setGlobalMatrices(_mat_view){mat4Copy(mat_view,_mat_view);mat4Mul(mat_vp,mat_projection,mat_view);v3normalize(light_dir_ws,light_dir_ws);v3mulMat4(light_dir_vs,light_dir_ws,mat_view)}var mat_temp=mat4();function updateMatrices(mat_model){mat4Copy(mat_m,mat_model);mat4Mul(mat_mv,mat_view,mat_model);mat4Mul(mat_mvp,mat_projection,mat_mv);mat4Invert(mat_temp,mat_mv);mat4Transpose(mat_temp,mat_temp);mat3FromMat4(mat_mv_inv_transform,mat_temp)}var postprocessing_reset_version="2";var postprocessing=exports.postprocessing=local_storage.get("glov_no_postprocessing")!==postprocessing_reset_version;function postprocessingAllow(allow){local_storage.set("glov_no_postprocessing",allow?undefined:postprocessing_reset_version);exports.postprocessing=postprocessing=allow}var global_timer=0;function getFrameTimestamp(){return global_timer}var global_frame_index=0;function getFrameIndex(){return global_frame_index}var this_frame_time=0;function getFrameDt(){return this_frame_time}var this_frame_time_actual=0;function getFrameDtActual(){return this_frame_time_actual}var after_loading_state=null;var is_loading=exports.is_loading=true;function setState(new_state){if(is_loading){after_loading_state=new_state}else{exports.app_state=app_state=new_state}}var mspf=1e3;var mspf_update_time=Date.now();var mspf_frame_count=0;var show_fps=true;var do_borders=true;var do_viewport_postprocess=false;var need_repos=0;var app_tick_functions=[];function addTickFunc(cb){app_tick_functions.push(cb)}var temporary_textures={};function resetEffects(){for(var key in temporary_textures){var temp=temporary_textures[key];while(temp.list.length>temp.idx){temp.list.pop().destroy()}if(!temp.idx){delete temporary_textures[key]}else{temp.idx=0}}}var viewport=exports.viewport=vec4(0,0,1,1);function setViewport(xywh){v4copy(viewport,xywh);gl.viewport(xywh[0],xywh[1],xywh[2],xywh[3])}function getTemporaryTexture(w,h){var key=w?w+"_"+h:"screen";var temp=temporary_textures[key];if(!temp){temp=temporary_textures[key]={list:[],idx:0}}if(temp.idx>=temp.list.length){var _tex=textures.createForCapture();temp.list.push(_tex)}var tex=temp.list[temp.idx++];tex.override_sampler=null;return tex}function captureFramebuffer(tex,w,h,do_filter_linear,do_wrap){if(!w&&render_width){w=render_width;h=render_height}if(!tex){tex=getTemporaryTexture(w,h)}if(w){tex.copyTexImage(viewport[0],viewport[1],w,h)}else{tex.copyTexImage(0,0,width,height)}tex.setSamplerState({filter_min:do_filter_linear?gl.LINEAR:gl.NEAREST,filter_mag:do_filter_linear?gl.LINEAR:gl.NEAREST,wrap_s:do_wrap?gl.REPEAT:gl.CLAMP_TO_EDGE,wrap_t:do_wrap?gl.REPEAT:gl.CLAMP_TO_EDGE});return tex}var last_tick=Date.now();function tick(){var now=Date.now();requestAnimationFrame(tick);this_frame_time_actual=now-last_tick;var dt=min(max(this_frame_time_actual,1),250);this_frame_time=dt;last_tick=now;global_timer+=dt;++global_frame_index;++mspf_frame_count;if(now-mspf_update_time>1e3){mspf=(now-mspf_update_time)/mspf_frame_count;mspf_frame_count=0;mspf_update_time=now}if(document.hidden||document.webkitHidden){resetEffects();return}exports.width=width=canvas.width;exports.height=height=canvas.height;var rise=width/height*sin(fov_y/2)/cos(fov_y/2);exports.fov_x=fov_x=2*asin(rise/sqrt(rise*rise+1));mat4Perspective(mat_projection,fov_y,width/height,.7,ZFAR);gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA);gl.enable(gl.BLEND);gl.enable(gl.DEPTH_TEST);textures.bind(0,textures.textures.error);camera2d.tick();camera2d.setAspectFixed(game_width,game_height);sound_manager.tick(dt);input.tick();glov_ui.tick(dt);if(need_repos){--need_repos;var ul=[];camera2d.virtualToPhysical(ul,[0,0]);var lr=[];camera2d.virtualToPhysical(lr,[game_width-1,game_height-1]);var viewport2=[ul[0],ul[1],lr[0],lr[1]];var view_height=viewport2[3]-viewport2[1];var font_size=Math.min(256,Math.max(2,Math.floor(view_height/800*16)));document.getElementById("fullscreen").style["font-size"]=font_size+"px"}if(do_borders){glov_ui.drawRect(camera2d.x0(),camera2d.y0(),camera2d.x1(),0,Z.BORDERS,pico8_colors[0]);glov_ui.drawRect(camera2d.x0(),game_height,camera2d.x1(),camera2d.y1(),Z.BORDERS,pico8_colors[0]);glov_ui.drawRect(camera2d.x0(),0,0,game_height,Z.BORDERS,pico8_colors[0]);glov_ui.drawRect(game_width,0,camera2d.x1(),game_height,Z.BORDERS,pico8_colors[0])}for(var ii=0;ii<app_tick_functions.length;++ii){app_tick_functions[ii](dt)}if(app_state){app_state(dt)}if(show_fps){camera2d.setAspectFixed(game_width,game_height);font.drawSizedAligned(fps_style,camera2d.x0(),camera2d.y0(),Z.FPSMETER,glov_ui.font_height,glov_font.ALIGN.HRIGHT,camera2d.w(),0,"FPS: "+(1e3/mspf).toFixed(1)+" ("+mspf.toFixed(0)+"ms/f)")}glov_particles.tick(dt);glov_transition.render(dt);gl.viewport(viewport[0],viewport[1],viewport[2],viewport[3]);gl.clear(clear_bits);sprites.draw();glov_ui.endFrame();if(render_width){var source=captureFramebuffer();var clear_color=[0,0,0,1];var final_viewport=[camera2d.render_offset_x,camera2d.render_offset_y,camera2d.render_viewport_w,camera2d.render_viewport_h];if(do_viewport_postprocess){effects.applyPixelyExpand({source:source,final_viewport:final_viewport,clear_color:clear_color})}else{if(clear_color){gl.clearColor(clear_color[0],clear_color[1],clear_color[2],clear_color[3]);gl.clear(gl.COLOR_BUFFER_BIT)}setViewport(final_viewport);effects.applyCopy({source:source})}}input.endFrame();resetEffects()}function startup(params){window.TurbulenzEngine=null;window.assert=assert;canvas=params.canvas;assert(gl);canvas.focus();exports.game_width=game_width=params.game_width||1280;exports.game_height=game_height=params.game_height||960;if(params.pixely==="strict"){exports.render_width=render_width=game_width;exports.render_height=render_height=game_height;if(params.viewport_postprocess){do_viewport_postprocess=true}}else{exports.render_width=render_width=undefined;exports.render_height=render_height=undefined}exports.pixel_aspect=pixel_aspect=params.pixel_aspect||1;gl.depthFunc(gl.LEQUAL);gl.enable(gl.CULL_FACE);gl.cullFace(gl.BACK);gl.clearColor(0,.1,.2,1);var m=document.location.search.match(/D=(?:[\0-%'-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+/g);if(m){m.forEach(function(v){defines[v.slice(2)]=true})}textures.startup();geom.startup();shaders.startup({light_diffuse:light_diffuse,light_dir_vs:light_dir_vs,ambient:light_ambient,mat_m:mat_m,mat_vp:mat_vp,mvp:mat_mvp,mv_inv_trans:mat_mv_inv_transform,view:mat_view,projection:mat_projection});camera2d.startup();sprites.startup();input.startup(canvas);clear_bits=gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT;exports.glov_particles=glov_particles=require("./particles.js").create();if(params.pixely&&params.pixely!=="off"){textures.defaultFilters(gl.NEAREST,gl.NEAREST)}else{textures.defaultFilters(gl.LINEAR,gl.LINEAR)}exports.sound_manager=sound_manager=require("./sound_manager.js").create();var font_info_04b03x2=require("../img/font/04b03_8x2.json");var font_info_04b03x1=require("../img/font/04b03_8x1.json");if(params.font){exports.font=font=glov_font.create(params.font.info,params.font.texture)}else if(params.pixely==="strict"){exports.font=font=glov_font.create(font_info_04b03x1,"font/04b03_8x1")}else if(params.pixely){exports.font=font=glov_font.create(font_info_04b03x2,"font/04b03_8x2")}else{exports.font=font=glov_font.create(font_info_palanquin32,"font/palanquin32")}glov_ui.startup(font,params.ui_sprites);glov_ui.bindSounds(sound_manager,{button_click:"button_click",rollover:"rollover"});camera2d.setAspectFixed(game_width,game_height);function onResize(){need_repos=10}window.addEventListener("resize",onResize,false);onResize();if(params.state){setState(params.state)}if(params.do_borders!==undefined){do_borders=params.do_borders}if(params.show_fps!==undefined){show_fps=params.show_fps}requestAnimationFrame(tick)}function loading(){var load_count=textures.load_count+sound_manager.loading();document.getElementById("loading_text").innerText="Loading ("+load_count+")...";if(!load_count){var elem=document.getElementById("loading");elem.style.visibility="hidden";exports.is_loading=is_loading=false;exports.app_state=app_state=after_loading_state}}exports.app_state=app_state=loading;window.glov_engine=exports},{"../img/font/04b03_8x1.json":27,"../img/font/04b03_8x2.json":28,"../img/font/palanquin32.json":29,"./camera2d.js":9,"./effects.js":11,"./font.js":13,"./geom.js":14,"./input.js":15,"./local_storage.js":16,"./particles.js":18,"./shaders.js":19,"./sound_manager.js":20,"./sprites.js":21,"./textures.js":23,"./transition.js":24,"./ui.js":25,"./vmath.js":26,assert:32,"gl-mat3/fromMat4":2,"gl-mat4/copy":3,"gl-mat4/invert":5,"gl-mat4/multiply":6,"gl-mat4/perspective":7,"gl-mat4/transpose":8}],13:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports.intColorFromVec4Color=intColorFromVec4Color;exports.vec4ColorFromIntColor=vec4ColorFromIntColor;exports.style=style;exports.styleColored=styleColored;exports.styleAlpha=styleAlpha;exports.create=create;function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var assert=require("assert");var camera2d=require("./camera2d.js");var floor=Math.floor,max=Math.max,round=Math.round;var shaders=require("./shaders.js");var sprites=require("./sprites.js");var textures=require("./textures.js");var _require=require("./vmath.js"),clamp=_require.clamp,vec4=_require.vec4,v4clone=_require.v4clone,v4scale=_require.v4scale;var COLOR_MODE=exports.COLOR_MODE={SINGLE:0,GRADIENT:1};var ALIGN=exports.ALIGN={HLEFT:0,HCENTER:1,HRIGHT:2,HMASK:3,VTOP:0<<2,VCENTER:1<<2,VBOTTOM:2<<2,VMASK:3<<2,HFIT:1<<4,HWRAP:1<<5,HCENTERFIT:1|1<<4,HVCENTER:1|1<<2,HVCENTERFIT:1|1<<2|1<<4};function GlovFontDefaultStyle(){}GlovFontDefaultStyle.prototype.outline_width=0;GlovFontDefaultStyle.prototype.outline_color=0;GlovFontDefaultStyle.prototype.glow_xoffs=0;GlovFontDefaultStyle.prototype.glow_yoffs=0;GlovFontDefaultStyle.prototype.glow_inner=0;GlovFontDefaultStyle.prototype.glow_outer=0;GlovFontDefaultStyle.prototype.glow_color=0;GlovFontDefaultStyle.prototype.color=4294967295;GlovFontDefaultStyle.prototype.colorUR=0;GlovFontDefaultStyle.prototype.colorLR=0;GlovFontDefaultStyle.prototype.colorLL=0;GlovFontDefaultStyle.prototype.color_mode=COLOR_MODE.SINGLE;var GlovFontStyle=function(_GlovFontDefaultStyle){_inherits(GlovFontStyle,_GlovFontDefaultStyle);function GlovFontStyle(){return _possibleConstructorReturn(this,(GlovFontStyle.__proto__||Object.getPrototypeOf(GlovFontStyle)).apply(this,arguments))}return GlovFontStyle}(GlovFontDefaultStyle);var font_shaders=exports.font_shaders={};function intColorFromVec4Color(v){return(v[0]*255|0)<<24|(v[1]*255|0)<<16|(v[2]*255|0)<<8|(v[3]*255|0)}function vec4ColorFromIntColor(v,c){v[0]=(c>>24&255)/255;v[1]=(c>>16&255)/255;v[2]=(c>>8&255)/255;v[3]=(c&255)/255}function buildVec4ColorFromIntColor(c){return vec4((c>>24&255)/255,(c>>16&255)/255,(c>>8&255)/255,(c&255)/255)}var glov_font_default_style=exports.glov_font_default_style=new GlovFontStyle;function style(font_style,fields){var ret=new GlovFontStyle;if(font_style){for(var f in font_style){ret[f]=font_style[f]}}for(var _f in fields){ret[_f]=fields[_f]}return ret}function styleColored(font_style,color){return style(font_style,{color:color})}function colorAlpha(color,alpha){alpha=clamp(round((color&255)*alpha),0,255);return color&4294967040|alpha}function styleAlpha(font_style,alpha){return style(font_style,{color:colorAlpha((font_style||glov_font_default_style).color,alpha),outline_color:colorAlpha((font_style||glov_font_default_style).outline_color,alpha),glow_color:colorAlpha((font_style||glov_font_default_style).glow_color,alpha)})}var tech_params=null;var tech_params_dirty=false;var temp_color=null;function createTechniqueParameters(){if(tech_params){return}tech_params={param0:vec4(),outlineColor:vec4(),glowColor:vec4(),glowParams:vec4(),tex0:null};if(!temp_color){temp_color=vec4()}}function techParamsSet(param,value){var tpv=tech_params[param];if(!tech_params_dirty){if(tpv[0]!==value[0]||tpv[1]!==value[1]||tpv[2]!==value[2]||tpv[3]!==value[3]){tech_params={param0:v4clone(tech_params.param0),outlineColor:v4clone(tech_params.outlineColor),glowColor:v4clone(tech_params.glowColor),glowParams:v4clone(tech_params.glowParams)};tech_params_dirty=true;tpv=tech_params[param]}else{return}}if(tech_params_dirty){tpv[0]=value[0];tpv[1]=value[1];tpv[2]=value[2];tpv[3]=value[3]}}function techParamsGet(){tech_params_dirty=false;return tech_params}var GlovFont=function(){function GlovFont(font_info,texture_name){assert(font_info.font_size!==0);this.texture=textures.load({url:"img/"+texture_name+".png",filter_min:font_info.noFilter?gl.NEAREST:gl.LINEAR,filter_mag:font_info.noFilter?gl.NEAREST:gl.LINEAR});this.textures=[this.texture];this.font_info=font_info;this.shader=font_shaders.font_aa;for(var ii=0;ii<font_info.char_infos.length;++ii){var char_info=font_info.char_infos[ii];char_info.scale=1/(char_info.sc||1)}this.char_infos=[];for(var _ii=0;_ii<font_info.char_infos.length;++_ii){var _char_info=font_info.char_infos[_ii];this.char_infos[font_info.char_infos[_ii].c]=_char_info;_char_info.xpad=_char_info.xpad||0;_char_info.yoffs=_char_info.yoffs||0}this.replacement_character=this.infoFromChar(65533);if(!this.replacement_character){this.replacement_character=this.infoFromChar(63)}this.default_style=new GlovFontStyle;this.applied_style=new GlovFontStyle;createTechniqueParameters()}_createClass(GlovFont,[{key:"drawSizedColor",value:function drawSizedColor(style,x,y,z,size,color,text){return this.drawSized(styleColored(style,color),x,y,z,size,text)}},{key:"drawSized",value:function drawSized(style,x,y,z,size,text){return this.drawScaled(style,x,y,z,size/this.font_info.font_size,size/this.font_info.font_size,text)}},{key:"drawSizedAligned",value:function drawSizedAligned(style,_x,_y,z,size,align,w,h,text){var x_size=size;var y_size=size;var width=this.getStringWidth(style,x_size,text);if(align&ALIGN.HFIT&&width>w){var scale=w/width;x_size*=scale;width=w;if(scale<.5){if((align&ALIGN.VMASK)!==ALIGN.VCENTER&&(align&ALIGN.VMASK)!==ALIGN.VBOTTOM){_y+=(y_size-y_size*scale*2)/2}y_size*=scale*2}}var height=y_size;var x=void 0;var y=void 0;switch(align&ALIGN.HMASK){case ALIGN.HCENTER:x=_x+(w-width)/2;if(this.font_info.noFilter){x|=0}break;case ALIGN.HRIGHT:x=_x+w-width;break;case ALIGN.HLEFT:x=_x;break;default:x=_x}switch(align&ALIGN.VMASK){case ALIGN.VCENTER:y=_y+(h-height)/2;if(this.font_info.noFilter){y|=0}break;case ALIGN.VBOTTOM:y=_y+h-height;break;case ALIGN.VTOP:y=_y;break;default:y=_y}return this.drawScaled(style,x,y,z,x_size/this.font_info.font_size,y_size/this.font_info.font_size,text)}},{key:"drawSizedColorWrapped",value:function drawSizedColorWrapped(style,x,y,z,w,indent,size,color,text){return this.drawScaledWrapped(styleColored(style,color),x,y,z,w,indent,size/this.font_info.font_size,size/this.font_info.font_size,text)}},{key:"drawSizedWrapped",value:function drawSizedWrapped(style,x,y,z,w,indent,size,text){return this.drawScaledWrapped(style,x,y,z,w,indent,size/this.font_info.font_size,size/this.font_info.font_size,text)}},{key:"wrapLines",value:function wrapLines(w,indent,size,text,word_cb){return this.wrapLinesScaled(w,indent,size/this.font_info.font_size,text,word_cb)}},{key:"infoFromChar",value:function infoFromChar(c){var ret=this.char_infos[c];if(ret){return ret}if(c>127){return this.replacement_character}return null}},{key:"getCharacterWidth",value:function getCharacterWidth(style,x_size,c){assert(typeof c==="number");this.applyStyle(style);var char_info=this.infoFromChar(c);var xsc=x_size/this.font_info.font_size;var x_advance=this.calcXAdvance(xsc);if(char_info){return(char_info.w+char_info.xpad)*xsc*char_info.scale+x_advance}return 0}},{key:"getStringWidth",value:function getStringWidth(style,x_size,text){this.applyStyle(style);var ret=0;var xsc=x_size/this.font_info.font_size;var x_advance=this.calcXAdvance(xsc);for(var ii=0;ii<text.length;++ii){var c=text.charCodeAt(ii);var char_info=this.infoFromChar(c);if(!char_info){char_info=this.infoFromChar(13)}if(char_info){ret+=(char_info.w+char_info.xpad)*xsc*char_info.scale+x_advance}}return ret}},{key:"wrapLinesScaled",value:function wrapLinesScaled(w,indent,xsc,text,word_cb){var len=text.length;var s=0;var word_start=0;var word_x0=0;var x=word_x0;var linenum=0;var space_info=this.infoFromChar(32);var space_size=(space_info?space_info.w+space_info.xpad:this.font_info.font_size)*xsc;var hard_wrap=false;var x_advance=this.calcXAdvance(xsc);do{var c=s<len?text.charCodeAt(s):0;var newx=x;var char_w=void 0;if(c===9){var tabsize=xsc*this.font_info.font_size*4;newx=(floor(x/tabsize)+1)*tabsize;char_w=tabsize}else{var char_info=this.infoFromChar(c);if(!char_info){char_info=this.infoFromChar(10)}if(char_info){char_w=(char_info.w+char_info.xpad)*xsc*char_info.scale+x_advance;newx=x+char_w}}if(newx>=w&&hard_wrap){if(word_cb){word_cb(word_x0,linenum,text.slice(word_start,s))}word_start=s;word_x0=indent;x=word_x0+char_w;linenum++}else{x=newx}if(!(c===32||c===0||c===10)){s++;c=s<len?text.charCodeAt(s):0}if(c===32||c===0||c===10){hard_wrap=false;if(x>w){var word_width=x-word_x0;if(word_width>w){hard_wrap=true;s=word_start;x=word_x0;continue}else{word_x0=indent;x=word_x0+word_width;linenum++}}if(word_cb){word_cb(word_x0,linenum,text.slice(word_start,s))}word_start=s+1;if(c===10){x=indent;linenum++}else{x+=space_size}word_x0=x;if(c===32||c===10){s++}}}while(s<len);++linenum;return linenum}},{key:"drawScaledWrapped",value:function drawScaledWrapped(style,x,y,z,w,indent,xsc,ysc,text){var _this2=this;if(text===null||text===undefined){text="(null)"}this.applyStyle(style);var num_lines=this.wrapLinesScaled(w,indent,xsc,text,function(xoffs,linenum,word){var y2=y+_this2.font_info.font_size*ysc*linenum;var x2=x+xoffs;_this2.drawScaled(style,x2,y2,z,xsc,ysc,word)});return num_lines*this.font_info.font_size*ysc}},{key:"calcXAdvance",value:function calcXAdvance(xsc){var font_texel_scale=this.font_info.font_size/32;var x_advance=xsc*font_texel_scale*max(this.applied_style.outline_width-2,0);x_advance=max(x_advance,xsc*font_texel_scale*max(this.applied_style.glow_outer-this.applied_style.glow_xoffs-3,0));return x_advance}},{key:"drawScaled",value:function drawScaled(style,_x,y,z,xsc,ysc,text){var x=_x;var font_info=this.font_info;y+=(font_info.y_offset||0)*ysc;var tex=this.texture;var texs=this.textures;if(text===null||text===undefined){text="(null)"}var len=text.length;if(xsc===0||ysc===0){return 0}this.applyStyle(style);var avg_scale_font=(xsc+ysc)*.5;var camera_xscale=camera2d.data[4];var camera_yscale=camera2d.data[5];var avg_scale_combined=(xsc*camera_xscale+ysc*camera_yscale)*.5;var x_advance=this.calcXAdvance(xsc);var font_texel_scale=font_info.font_size/32;var tile_state=0;var applied_style=this.applied_style;var delta_per_source_pixel=.5/font_info.spread;var delta_per_dest_pixel=delta_per_source_pixel/avg_scale_combined;var value=vec4(1/delta_per_dest_pixel,-.5/delta_per_dest_pixel+.5,-.5/delta_per_dest_pixel+.5+applied_style.outline_width*font_texel_scale*avg_scale_combined,0);if(value[2]>0){value[2]=0}var padding1=max(1,applied_style.outline_width*font_texel_scale*avg_scale_combined);var padding4=vec4();var outer_scaled=applied_style.glow_outer*font_texel_scale;padding4[0]=max(outer_scaled*xsc-applied_style.glow_xoffs*font_texel_scale*xsc,padding1);padding4[2]=max(outer_scaled*xsc+applied_style.glow_xoffs*font_texel_scale*xsc,padding1);padding4[1]=max(outer_scaled*ysc-applied_style.glow_yoffs*font_texel_scale*ysc,padding1);padding4[3]=max(outer_scaled*ysc+applied_style.glow_yoffs*font_texel_scale*ysc,padding1);techParamsSet("param0",value);var value2=vec4(0,0,1/((applied_style.glow_outer-applied_style.glow_inner)*delta_per_source_pixel*font_texel_scale),-(.5-applied_style.glow_outer*delta_per_source_pixel*font_texel_scale)/((applied_style.glow_outer-applied_style.glow_inner)*delta_per_source_pixel*font_texel_scale));if(value2[3]>0){value2[3]=0}var padding_in_font_space=vec4();v4scale(padding_in_font_space,padding4,1/avg_scale_font);for(var ii=0;ii<4;++ii){if(padding_in_font_space[ii]>font_info.spread){var sc=font_info.spread/padding_in_font_space[ii];padding4[ii]*=sc;padding_in_font_space[ii]*=sc}}var z_advance=applied_style.glow_xoffs<0?-1e-4:1e-4;var rel_x_scale=xsc/avg_scale_font;var rel_y_scale=ysc/avg_scale_font;for(var i=0;i<len;i++){var c=text.charCodeAt(i);if(c===9){var tabsize=xsc*font_info.font_size*4;x=(((x-_x)/tabsize|0)+1)*tabsize+_x}else{var char_info=this.infoFromChar(c);if(!char_info){char_info=this.infoFromChar(13)}if(char_info){var char_scale=char_info.scale;var xsc2=xsc*char_scale;var ysc2=ysc*char_scale;var pad_scale=1/char_scale;var tile_width=tex.width;var tile_height=tex.height;if(char_scale!==tile_state){value2[0]=-applied_style.glow_xoffs*font_texel_scale*pad_scale/tile_width;value2[1]=-applied_style.glow_yoffs*font_texel_scale*pad_scale/tile_height;techParamsSet("glowParams",value2)}var u0=(char_info.x0-padding_in_font_space[0]*pad_scale)/tile_width;var u1=(char_info.x0+char_info.w+padding_in_font_space[2]*pad_scale)/tile_width;var v0=(char_info.y0-padding_in_font_space[1]*pad_scale)/tile_height;var v1=(char_info.y0+char_info.h+padding_in_font_space[3]*pad_scale)/tile_height;var w=char_info.w*xsc2+(padding4[0]+padding4[2])*rel_x_scale;var h=char_info.h*ysc2+(padding4[1]+padding4[3])*rel_y_scale;sprites.queueraw(texs,x-rel_x_scale*padding4[0],y-rel_y_scale*padding4[2]+char_info.yoffs*ysc2,z+z_advance*i,w,h,u0,v0,u1,v1,buildVec4ColorFromIntColor(applied_style.color),this.shader,techParamsGet());x+=(char_info.w+char_info.xpad)*xsc2+x_advance}}}return x-_x}},{key:"determineShader",value:function determineShader(){var outline=this.applied_style.outline_width&&this.applied_style.outline_color&255;var glow=this.applied_style.glow_outer>0&&this.applied_style.glow_color&255;if(outline){if(glow){this.shader=font_shaders.font_aa_outline_glow}else{this.shader=font_shaders.font_aa_outline}}else if(glow){this.shader=font_shaders.font_aa_glow}else{this.shader=font_shaders.font_aa}}},{key:"applyStyle",value:function applyStyle(style){if(!style){style=this.default_style}vec4ColorFromIntColor(temp_color,style.outline_color);techParamsSet("outlineColor",temp_color);vec4ColorFromIntColor(temp_color,style.glow_color);techParamsSet("glowColor",temp_color);this.applied_style.outline_width=style.outline_width;this.applied_style.outline_color=style.outline_color;this.applied_style.glow_xoffs=style.glow_xoffs;this.applied_style.glow_yoffs=style.glow_yoffs;this.applied_style.glow_inner=style.glow_inner;this.applied_style.glow_outer=style.glow_outer;this.applied_style.glow_color=style.glow_color;this.applied_style.color=style.color;this.applied_style.colorUR=style.colorUR;this.applied_style.colorLR=style.colorLR;this.applied_style.colorLL=style.colorLL;this.applied_style.color_mode=style.color_mode;if(this.applied_style.color_mode===COLOR_MODE.SINGLE){this.applied_style.colorUR=this.applied_style.colorLL=this.applied_style.colorLR=this.applied_style.color}this.determineShader()}}]);return GlovFont}();function fontShadersInit(){if(font_shaders.font_aa){return}font_shaders.font_aa=shaders.create(gl.FRAGMENT_SHADER,"precision lowp float;\n\nvarying vec2 interp_texcoord;\nvarying lowp vec4 interp_color;\nvec4 _ret_0;\nuniform sampler2D tex0;\nuniform vec4 param0;\nvoid main()\n{\n  float texture0 = texture2D(tex0,interp_texcoord).r;\n  float res = clamp(texture0 * param0.x + param0.y, 0.0, 1.0);\n  gl_FragColor = vec4(interp_color.rgb, interp_color.a * res);\n}\n");font_shaders.font_aa_glow=shaders.create(gl.FRAGMENT_SHADER,"precision lowp float;\n\nvarying vec2 interp_texcoord;\nvarying lowp vec4 interp_color;\nvec4 _ret_0;\nuniform sampler2D tex0;\nuniform vec4 param0;\nuniform vec4 glowColor;\nuniform vec4 glowParams;\nvoid main()\n{\n  float texture0=texture2D(tex0,interp_texcoord).r;\n  // Glow\n  vec2 glowCoord = interp_texcoord + glowParams.xy;\n  float textureGlow = texture2D(tex0, glowCoord).r;\n  float t = clamp(textureGlow * glowParams.z + glowParams.w, 0.0, 1.0);\n  vec4 outcolor = vec4(glowColor.xyz, t * glowColor.w);\n  // Main body\n  t = clamp(texture0 * param0.x + param0.y, 0.0, 1.0);\n  gl_FragColor = mix(outcolor, interp_color, t);\n}\n");font_shaders.font_aa_outline=shaders.create(gl.FRAGMENT_SHADER,"precision lowp float;\n\nvarying highp vec2 interp_texcoord;\nvarying lowp vec4 interp_color;\nvec4 _ret_0;\nuniform sampler2D tex0;\nuniform vec4 param0;\nuniform vec4 outlineColor;\nvoid main()\n{\n  float texture0=texture2D(tex0,interp_texcoord).r;\n  // Outline\n  vec4 outcolor = vec4(outlineColor.xyz, 0);\n  outcolor.w = clamp(texture0 * param0.x + param0.z, 0.0, 1.0);\n  outcolor.w = outcolor.w * outlineColor.w;\n  // outcolor = mix(outcolor, outlineColor, outcolor.w); // Makes a blackish border\n  // Main body\n  float t = clamp(texture0 * param0.x + param0.y, 0.0, 1.0);\n  gl_FragColor = mix(outcolor, interp_color, t);\n}\n");font_shaders.font_aa_outline_glow=shaders.create(gl.FRAGMENT_SHADER,"precision lowp float;\n\nvarying highp vec2 interp_texcoord;\nvarying lowp vec4 interp_color;\nvec4 _ret_0;\nuniform sampler2D tex0;\nuniform vec4 param0;\nuniform vec4 outlineColor;\nuniform vec4 glowColor;\nuniform vec4 glowParams;\nvoid main()\n{\n  float texture0=texture2D(tex0,interp_texcoord).r;\n  // Glow\n  vec2 glowCoord = interp_texcoord + glowParams.xy;\n  float textureGlow = texture2D(tex0, glowCoord).r;\n  float t = clamp(textureGlow * glowParams.z + glowParams.w, 0.0, 1.0);\n  vec4 outcolor = vec4(glowColor.xyz, t * glowColor.w);\n  // vec4outclor = t * glowColor.xyz;\n  // Outline\n  t = clamp(texture0 * param0.x + param0.z, 0.0, 1.0);\n  t = t * outlineColor.w;\n  outcolor = mix(outcolor, outlineColor, t);\n  // Main body\n  t = clamp(texture0 * param0.x + param0.y, 0.0, 1.0);\n  gl_FragColor = mix(outcolor, interp_color, t);\n}\n")}function create(){fontShadersInit();for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return new(Function.prototype.bind.apply(GlovFont,[null].concat(args)))}},{"./camera2d.js":9,"./shaders.js":19,"./sprites.js":21,"./textures.js":23,"./vmath.js":26,assert:32}],14:[function(require,module,exports){"use strict";exports.create=create;exports.startup=startup;var assert=require("assert");var ceil=Math.ceil,max=Math.max;var QUADS=exports.QUADS=7;var gl_byte_size={5120:1,5121:1,5122:2,5123:2,5126:4};var bound_geom=void 0;var bound_array_buf=null;var bound_index_buf=null;var quad_index_buf=void 0;var quad_index_buf_len=0;function deleteBuffer(handle){if(!handle){return}if(bound_array_buf===handle){gl.bindBuffer(gl.ARRAY_BUFFER,null);bound_array_buf=null}if(bound_index_buf===handle){gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null);bound_index_buf=null}gl.deleteBuffer(handle)}var attrib_enabled=0;function enableVertexAttribArray(bits){if(bits===attrib_enabled){return}var disable_mask=attrib_enabled&~bits;var enable_mask=~attrib_enabled&bits;attrib_enabled=bits;if(disable_mask){var n=0;do{if(disable_mask&1){gl.disableVertexAttribArray(n)}n++;disable_mask>>=1}while(disable_mask)}if(enable_mask){var _n=0;do{if(enable_mask&1){gl.enableVertexAttribArray(_n)}_n++;enable_mask>>=1}while(enable_mask)}}function getQuadIndexBuf(quad_count){assert(quad_count<=16384);if(quad_count*6>quad_index_buf_len){if(!quad_index_buf){quad_index_buf=gl.createBuffer()}quad_index_buf_len=max(ceil(quad_index_buf_len*1.5),quad_count*6);if(bound_index_buf!==quad_index_buf){gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,quad_index_buf);bound_index_buf=quad_index_buf}var arr=new Uint16Array(quad_index_buf_len);var vidx=0;for(var ii=0;ii<quad_index_buf_len;){arr[ii++]=vidx+1;arr[ii++]=vidx+3;arr[ii++]=vidx++;arr[ii++]=vidx++;arr[ii++]=vidx++;arr[ii++]=vidx++}gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,arr,gl.STATIC_DRAW)}return quad_index_buf}function Geom(_format,verts,idxs,mode){this.mode=mode||gl.TRIANGLES;this.format=_format;this.stride=0;this.elem_count=0;this.used_attribs=0;for(var ii=0;ii<_format.length;++ii){var fmt=_format[ii];var sem=fmt[0];var gltype=fmt[1];var count=fmt[2];this.used_attribs|=1<<sem;var byte_size=gl_byte_size[gltype];assert(byte_size);fmt[3]=fmt[3]||false;fmt[4]=byte_size;this.stride+=count*byte_size;this.elem_count+=count}this.vert_count=verts.length/this.elem_count;if(verts.length){this.vbo=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,this.vbo);bound_array_buf=this.vbo;gl.bufferData(gl.ARRAY_BUFFER,verts,gl.STATIC_DRAW)}this.orig_mode=mode;if(idxs){this.ibo=gl.createBuffer();this.ibo_owned=true;this.ibo_size=idxs.length;gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.ibo);bound_index_buf=this.ibo;gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,idxs,gl.STATIC_DRAW)}else if(mode===QUADS){assert(this.vert_count%4===0);var quad_count=this.vert_count/4;this.ibo=getQuadIndexBuf(quad_count);this.ibo_owned=false;this.ibo_size=quad_count*6;this.mode=gl.TRIANGLES}else{this.ibo=null;this.ibo_owned=false}}Geom.prototype.update=function(verts,num_verts){assert(this.orig_mode===QUADS);if(num_verts>this.vert_count){if(bound_geom===this){bound_geom=null}deleteBuffer(this.vbo);this.vert_count=verts.length/this.elem_count;this.vbo=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,this.vbo);bound_array_buf=this.vbo;gl.bufferData(gl.ARRAY_BUFFER,verts,gl.DYNAMIC_DRAW)}else{if(bound_array_buf!==this.vbo){gl.bindBuffer(gl.ARRAY_BUFFER,this.vbo);bound_array_buf=this.vbo}gl.bufferSubData(gl.ARRAY_BUFFER,0,verts.subarray(0,num_verts*this.elem_count))}var quad_count=num_verts/4;this.ibo=getQuadIndexBuf(quad_count);this.ibo_size=quad_count*6};Geom.prototype.dispose=function(){if(this.ibo_owned){deleteBuffer(this.ibo)}this.ibo=null;deleteBuffer(this.vbo);this.vbo=null};var bound_attribs=function(){var r=[];for(var ii=0;ii<16;++ii){r.push({vbo:null,offset:0})}return r}();Geom.prototype.bind=function(){if(bound_geom!==this){bound_geom=this;var vbo=this.vbo;var offset=0;for(var ii=0;ii<this.format.length;++ii){var fmt=this.format[ii];var count=fmt[2];var byte_size=fmt[4];if(bound_attribs[ii].vbo===vbo){}else{if(bound_array_buf!==vbo){gl.bindBuffer(gl.ARRAY_BUFFER,vbo);bound_array_buf=vbo}var sem=fmt[0];var gltype=fmt[1];var normalized=fmt[3];gl.vertexAttribPointer(sem,count,gltype,normalized,this.stride,offset);bound_attribs[ii].vbo=bound_array_buf}offset+=count*byte_size}enableVertexAttribArray(this.used_attribs);if(this.ibo&&bound_index_buf!==this.ibo){gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.ibo);bound_index_buf=this.ibo}}};Geom.prototype.draw=function(){this.bind();assert(this.ibo);gl.drawElements(this.mode,this.ibo_size,gl.UNSIGNED_SHORT,0)};function create(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return new(Function.prototype.bind.apply(Geom,[null].concat(args)))}function startup(){}},{assert:32}],15:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.pointerLocked=pointerLocked;exports.pointerLockEnter=pointerLockEnter;exports.pointerLockExit=pointerLockExit;exports.startup=startup;exports.tick=tick;exports.endFrame=endFrame;exports.eatAllInput=eatAllInput;exports.eatAllKeyboardInput=eatAllKeyboardInput;exports.mousePos=mousePos;exports.mouseWheel=mouseWheel;exports.mouseOver=mouseOver;exports.mouseDown=mouseDown;exports.mousePosIsTouch=mousePosIsTouch;exports.isTouchDown=isTouchDown;exports.numTouches=numTouches;exports.keyDown=keyDown;exports.keyDownEdge=keyDownEdge;exports.keyUpEdge=keyUpEdge;exports.padGetAxes=padGetAxes;exports.padButtonDown=padButtonDown;exports.padButtonDownEdge=padButtonDownEdge;exports.padButtonUpEdge=padButtonUpEdge;exports.mouseUpEdge=mouseUpEdge;exports.mouseDownEdge=mouseDownEdge;exports.drag=drag;var assert=require("assert");var camera2d=require("./camera2d.js");var local_storage=require("./local_storage.js");var glov_engine=require("./engine.js");var abs=Math.abs,min=Math.min,sqrt=Math.sqrt;var _require=require("./vmath.js"),vec2=_require.vec2,v2add=_require.v2add,v2copy=_require.v2copy,v2lengthSq=_require.v2lengthSq,v2set=_require.v2set,v2scale=_require.v2scale,v2sub=_require.v2sub;var UP_EDGE=0;var DOWN_EDGE=1;var DOWN=2;var TOUCH_AS_MOUSE=true;var MAP_ANALOG_TO_DPAD=true;var ANY=exports.ANY=-2;var POINTERLOCK=exports.POINTERLOCK=-1;var KEYS=exports.KEYS={BACKSPACE:8,TAB:9,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INS:45,DEL:46};(function(){for(var ii=1;ii<=12;++ii){KEYS["F"+ii]=111+ii}for(var _ii=48;_ii<=90;++_ii){KEYS[String.fromCharCode(_ii)]=_ii}})();var pad_codes=exports.pad_codes={A:0,SELECT:0,B:1,CANCEL:1,X:2,Y:3,LB:4,LEFT_BUMPER:4,RB:5,RIGHT_BUMPER:5,LT:6,LEFT_TRIGGER:6,RT:7,RIGHT_TRIGGER:7,BACK:8,START:9,LEFT_STICK:10,RIGHT_STICK:11,UP:12,DOWN:13,LEFT:14,RIGHT:15,ANALOG_UP:20,ANALOG_LEFT:21,ANALOG_DOWN:22,ANALOG_RIGHT:23};var canvas=void 0;var key_state={};var pad_states=[];var gamepad_data=[];var mouse_pos=vec2();var last_mouse_pos=vec2();var mouse_pos_is_touch=false;var mouse_over_captured=false;var mouse_down=[];var mouse_wheel=0;var input_eaten_kb=false;var input_eaten_mouse=false;var touches={};var touch_mode=exports.touch_mode=local_storage.getJSON("touch_mode",false);function TouchData(pos,touch,button){this.delta=vec2();this.total=0;this.cur_pos=pos.slice(0);this.start_pos=pos.slice(0);this.release=false;this.touch=touch;this.button=button;this.start_time=Date.now();this.dispatched=false;this.state=DOWN_EDGE}function pointerLocked(){return document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement}var pointerlock_touch_id="m"+POINTERLOCK;function pointerLockEnter(){var touch_data=touches[pointerlock_touch_id];if(touch_data){v2copy(touch_data.start_pos,mouse_pos);touch_data.release=false}else{touch_data=touches[pointerlock_touch_id]=new TouchData(mouse_pos,false,POINTERLOCK);touch_data.state=DOWN}return canvas.requestPointerLock&&canvas.requestPointerLock()}function pointerLockExit(){var touch_data=touches[pointerlock_touch_id];if(touch_data){v2copy(touch_data.cur_pos,mouse_pos);touch_data.state=null;touch_data.release=true}document.exitPointerLock()}function ignored(event){event.preventDefault();event.stopPropagation()}function onKeyUp(event){var code=event.keyCode;if(event.target.tagName!=="INPUT"){event.stopPropagation();event.preventDefault()}if(code===KEYS.ESC&&pointerLocked()){pointerLockExit()}key_state[code]=UP_EDGE}function onKeyDown(event){var code=event.keyCode;if(code!==KEYS.F12&&code!==KEYS.F5&&code!==KEYS.F6&&event.target.tagName!=="INPUT"){event.stopPropagation();event.preventDefault()}key_state[code]=DOWN_EDGE}var temp_delta=vec2();function onMouseMove(event,no_stop){if(touch_mode){local_storage.setJSON("touch_mode",false);exports.touch_mode=touch_mode=false}if(event.target.tagName!=="INPUT"&&!no_stop){event.preventDefault();event.stopPropagation()}if(event.offsetX!==undefined){mouse_pos[0]=event.offsetX;mouse_pos[1]=event.offsetY}else{mouse_pos[0]=event.layerX;mouse_pos[1]=event.layerY}mouse_pos_is_touch=false;var any_movement=false;if(pointerLocked()){if(event.movementX||event.movementY){v2set(temp_delta,event.movementX,event.movementY);any_movement=true}}else{v2sub(temp_delta,mouse_pos,last_mouse_pos);if(temp_delta[0]||temp_delta[1]){any_movement=true}}if(any_movement){for(var button=POINTERLOCK;button<mouse_down.length;++button){if(mouse_down[button]||button===POINTERLOCK&&pointerLocked()){var touch_data=touches["m"+button];if(touch_data){v2add(touch_data.delta,touch_data.delta,temp_delta);touch_data.total+=abs(temp_delta[0])+abs(temp_delta[1]);v2copy(touch_data.cur_pos,mouse_pos)}}}}v2copy(last_mouse_pos,mouse_pos)}function onMouseDown(event){onMouseMove(event);glov_engine.sound_manager.resume();var button=event.button;mouse_down[button]=mouse_pos.slice(0);var touch_id="m"+button;if(touches[touch_id]){v2copy(touches[touch_id].start_pos,mouse_pos);touches[touch_id].release=false}else{touches[touch_id]=new TouchData(mouse_pos,false,button)}}function onMouseUp(event){onMouseMove(event);var no_click=event.target.tagName==="INPUT";var button=event.button;if(mouse_down[button]){var touch_id="m"+button;var touch_data=touches[touch_id];if(touch_data){v2copy(touch_data.cur_pos,mouse_pos);if(!no_click){touch_data.state=UP_EDGE}touch_data.release=true}delete mouse_down[button]}}function onWheel(event){onMouseMove(event,true);if(event.wheelDelta>0){mouse_wheel++}else if(event.wheelDelta<0){mouse_wheel--}}var touch_pos=vec2();function onTouchChange(event){glov_engine.sound_manager.resume();if(!touch_mode){local_storage.set("touch_mode",true);exports.touch_mode=touch_mode=true}if(event.cancelable!==false){event.preventDefault()}var ct=event.touches;var seen={};var new_count=ct.length;var old_count=new_count;for(var ii=0;ii<new_count;++ii){var touch=ct[ii];var last_touch=touches[touch.identifier];v2set(touch_pos,touch.clientX,touch.clientY);if(!last_touch){last_touch=touches[touch.identifier]=new TouchData(touch_pos,true,0);--old_count}else{v2sub(temp_delta,touch_pos,last_touch.cur_pos);v2add(last_touch.delta,last_touch.delta,temp_delta);last_touch.total+=abs(temp_delta[0])+abs(temp_delta[1]);v2copy(last_touch.cur_pos,touch_pos)}seen[touch.identifier]=true;if(TOUCH_AS_MOUSE&&new_count===1){v2copy(mouse_pos,touch_pos);mouse_pos_is_touch=true}}var released_touch=void 0;for(var id in touches){if(!seen[id]){var _touch=touches[id];if(_touch.touch){++old_count;released_touch=_touch;_touch.state=UP_EDGE;_touch.release=true}}}if(TOUCH_AS_MOUSE){if(old_count===1&&new_count===0){delete mouse_down[0];v2copy(mouse_pos,released_touch.cur_pos);mouse_pos_is_touch=true}else if(new_count===1){var _touch2=ct[0];if(!old_count){mouse_down[0]=vec2(_touch2.clientX,_touch2.clientY)}v2set(mouse_pos,_touch2.clientX,_touch2.clientY);mouse_pos_is_touch=true}else if(new_count>1){delete mouse_down[0]}}}function startup(_canvas){canvas=_canvas;var passive_param=false;try{var opts=Object.defineProperty({},"passive",{get:function get(){passive_param={passive:false};return false}});window.addEventListener("test",null,opts);window.removeEventListener("test",null,opts)}catch(e){passive_param=false}canvas.requestPointerLock=canvas.requestPointerLock||canvas.mozRequestPointerLock||canvas.webkitRequestPointerLock;document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||function(){};window.addEventListener("keydown",onKeyDown,false);window.addEventListener("keyup",onKeyUp,false);window.addEventListener("click",ignored,false);window.addEventListener("contextmenu",ignored,false);window.addEventListener("mousemove",onMouseMove,false);window.addEventListener("mousedown",onMouseDown,false);window.addEventListener("mouseup",onMouseUp,false);window.addEventListener("DOMMouseScroll",onWheel,false);window.addEventListener("mousewheel",onWheel,false);canvas.addEventListener("touchstart",onTouchChange,passive_param);canvas.addEventListener("touchmove",onTouchChange,passive_param);canvas.addEventListener("touchend",onTouchChange,passive_param);canvas.addEventListener("touchcancel",onTouchChange,passive_param)}var DEADZONE=.26;var DEADZONE_SQ=DEADZONE*DEADZONE;var NUM_STICKS=2;var PAD_THRESHOLD=.25;function getGamepadData(idx){var gpd=gamepad_data[idx];if(!gpd){gpd=gamepad_data[idx]={timestamp:0,sticks:new Array(NUM_STICKS)};for(var ii=0;ii<NUM_STICKS;++ii){gpd.sticks[ii]=vec2()}pad_states[idx]={}}return gpd}function updatePadState(ps,b,c){if(b&&!ps[c]){ps[c]=DOWN_EDGE}else if(!b&&ps[c]){ps[c]=UP_EDGE}}function gamepadUpdate(){var gamepads=navigator.gamepads||navigator.webkitGamepads||navigator.getGamepads&&navigator.getGamepads()||navigator.webkitGetGamepads&&navigator.webkitGetGamepads();if(gamepads){var numGamePads=gamepads.length;for(var ii=0;ii<numGamePads;ii++){var gamepad=gamepads[ii];if(!gamepad){continue}var gpd=getGamepadData(ii);var ps=pad_states[ii];if(gpd.timestamp<gamepad.timestamp){var buttons=gamepad.buttons;gpd.timestamp=gamepad.timestamp;var numButtons=buttons.length;for(var n=0;n<numButtons;n++){var value=buttons[n];if((typeof value==="undefined"?"undefined":_typeof(value))==="object"){value=value.value}value=value>.5;updatePadState(ps,value,n)}}var axes=gamepad.axes;if(axes.length>=NUM_STICKS*2){for(var _n=0;_n<NUM_STICKS;++_n){var pair=gpd.sticks[_n];v2set(pair,axes[_n*2],-axes[_n*2+1]);var magnitude=v2lengthSq(pair);if(magnitude>DEADZONE_SQ){magnitude=sqrt(magnitude);v2scale(pair,pair,1/magnitude);magnitude=min(magnitude,1);magnitude=(magnitude-DEADZONE)/(1-DEADZONE);v2scale(pair,pair,magnitude)}else{v2set(pair,0,0)}}updatePadState(ps,gpd.sticks[0][0]<-PAD_THRESHOLD,pad_codes.ANALOG_LEFT);updatePadState(ps,gpd.sticks[0][0]>PAD_THRESHOLD,pad_codes.ANALOG_RIGHT);updatePadState(ps,gpd.sticks[0][1]<-PAD_THRESHOLD,pad_codes.ANALOG_DOWN);updatePadState(ps,gpd.sticks[0][1]>PAD_THRESHOLD,pad_codes.ANALOG_UP)}}}}function tick(){mouse_over_captured=false;gamepadUpdate();if(touches[pointerlock_touch_id]&&!pointerLocked()){pointerLockExit()}}function endFrameTickMap(map){Object.keys(map).forEach(function(keycode){switch(map[keycode]){case DOWN_EDGE:map[keycode]=DOWN;break;case UP_EDGE:delete map[keycode];break;default:}})}function endFrame(){endFrameTickMap(key_state);pad_states.forEach(endFrameTickMap);for(var touch_id in touches){var touch_data=touches[touch_id];if(touch_data.release){delete touches[touch_id]}else{touch_data.delta[0]=touch_data.delta[1]=0;touch_data.dispatched=false;if(touch_data.state===DOWN_EDGE){touch_data.state=DOWN}else{assert(touch_data.state!==UP_EDGE)}}}mouse_wheel=0;input_eaten_kb=false;input_eaten_mouse=false}function eatAllInput(){endFrame();mouse_over_captured=true;input_eaten_kb=true;input_eaten_mouse=true}function eatAllKeyboardInput(){var touches_save=touches;var over_save=mouse_over_captured;var eaten_mouse_save=input_eaten_mouse;eatAllInput();touches=touches_save;mouse_over_captured=over_save;input_eaten_mouse=eaten_mouse_save}function mousePos(dst){dst=dst||vec2();camera2d.physicalToVirtual(dst,mouse_pos);return dst}function mouseWheel(){var ret=mouse_wheel;mouse_wheel=0;return ret}function mousePosParam(param){param=param||{};return{x:param.x===undefined?camera2d.x0():param.x,y:param.y===undefined?camera2d.y0():param.y,w:param.w===undefined?camera2d.w():param.w,h:param.h===undefined?camera2d.h():param.h,button:param.button===undefined?ANY:param.button}}var check_pos=vec2();function checkPos(pos,param){camera2d.physicalToVirtual(check_pos,pos);return check_pos[0]>=param.x&&(param.w===Infinity||check_pos[0]<param.x+param.w)&&check_pos[1]>=param.y&&(param.h===Infinity||check_pos[1]<param.y+param.h)}function mouseOver(param){if(mouse_over_captured){return false}var pos_param=mousePosParam(param);for(var id in touches){var touch=touches[id];if(checkPos(touch.cur_pos,pos_param)){if(touch.state===DOWN_EDGE){touch.state=DOWN}else if(touch.state===UP_EDGE){touch.state=null}}}if(checkPos(mouse_pos,pos_param)){mouse_over_captured=true;return true}return false}function mouseDown(button){if(button===ANY){return mouseDown(0)||mouseDown(2)}button=button||0;return!input_eaten_mouse&&mouse_down[button]}function mousePosIsTouch(){return mouse_pos_is_touch}function isTouchDown(param){if(input_eaten_mouse){return false}var pos_param=mousePosParam(param);for(var id in touches){var touch=touches[id];if(checkPos(touch.cur_pos,pos_param)){return check_pos.slice(0)}}return false}function numTouches(){return Object.keys(touches).length}function keyDown(keycode){if(input_eaten_kb){return false}return Boolean(key_state[keycode])}function keyDownEdge(keycode){if(key_state[keycode]===DOWN_EDGE){key_state[keycode]=DOWN;return true}return false}function keyUpEdge(keycode){if(key_state[keycode]===UP_EDGE){delete key_state[keycode];return true}return false}function padGetAxes(out,stickindex,padindex){assert(stickindex>=0&&stickindex<NUM_STICKS);if(padindex===undefined){var sub=vec2();v2set(out,0,0);for(var ii=0;ii<gamepad_data.length;++ii){padGetAxes(sub,stickindex,ii);v2add(out,sub)}return}var sticks=getGamepadData(padindex).sticks;v2copy(out,sticks[stickindex])}function padButtonDownInternal(ps,padcode){return Boolean(ps[padcode])}function padButtonDownEdgeInternal(ps,padcode){if(ps[padcode]===DOWN_EDGE){ps[padcode]=DOWN;return true}return false}function padButtonUpEdgeInternal(ps,padcode){if(ps[padcode]===UP_EDGE){delete ps[padcode];return true}return false}var ANALOG_MAP=function(){if(!MAP_ANALOG_TO_DPAD){return{}}var r={};r[pad_codes.LEFT]=pad_codes.ANALOG_LEFT;r[pad_codes.RIGHT]=pad_codes.ANALOG_RIGHT;r[pad_codes.UP]=pad_codes.ANALOG_UP;r[pad_codes.DOWN]=pad_codes.ANALOG_DOWN;return r}();function padButtonShared(fn,padcode,padindex){assert(padcode!==undefined);if(padindex===undefined){for(var ii=0;ii<pad_states.length;++ii){if(padButtonShared(fn,padcode,ii)){return true}}return false}if(input_eaten_mouse){return false}var ps=pad_states[padindex];if(!ps){return false}if(ANALOG_MAP[padcode]&&fn(ps,ANALOG_MAP[padcode])){return true}return fn(ps,padcode)}function padButtonDown(padcode,padindex){return padButtonShared(padButtonDownInternal,padcode,padindex)}function padButtonDownEdge(padcode,padindex){return padButtonShared(padButtonDownEdgeInternal,padcode,padindex)}function padButtonUpEdge(padcode,padindex){return padButtonShared(padButtonUpEdgeInternal,padcode,padindex)}var start_pos=vec2();var cur_pos=vec2();var delta=vec2();function mouseUpEdge(param){param=param||{};var pos_param=mousePosParam(param);var button=pos_param.button;var max_click_dist=param.max_dist||50;for(var touch_id in touches){var touch_data=touches[touch_id];if(touch_data.state!==UP_EDGE||!(button===ANY||button===touch_data.button)||touch_data.total>max_click_dist){continue}if(checkPos(touch_data.cur_pos,pos_param)){touch_data.state=null;return{button:touch_data.button,pos:check_pos.slice(0),start_time:touch_data.start_time}}}return false}exports.click=mouseUpEdge;function mouseDownEdge(param){param=param||{};var pos_param=mousePosParam(param);var button=pos_param.button;for(var touch_id in touches){var touch_data=touches[touch_id];if(touch_data.state!==DOWN_EDGE||!(button===ANY||button===touch_data.button)){continue}if(checkPos(touch_data.cur_pos,pos_param)){touch_data.state=DOWN;return{button:touch_data.button,pos:check_pos.slice(0),start_time:touch_data.start_time}}}return false}function drag(param){param=param||{};var pos_param=mousePosParam(param);var button=pos_param.button;for(var touch_id in touches){var touch_data=touches[touch_id];if(!(button===ANY||button===touch_data.button)||touch_data.dispatched){continue}if(checkPos(touch_data.start_pos,pos_param)){if(!param.peek){touch_data.dispatched=true}camera2d.physicalToVirtual(start_pos,touch_data.start_pos);camera2d.physicalToVirtual(cur_pos,touch_data.cur_pos);camera2d.physicalDeltaToVirtual(delta,[touch_data.total/2,touch_data.total/2]);var total=delta[0]+delta[1];camera2d.physicalDeltaToVirtual(delta,touch_data.delta);return{cur_pos:cur_pos,start_pos:start_pos,delta:delta,total:total,button:touch_data.button,touch:touch_data.touch,start_time:touch_data.start_time}}}return null}},{"./camera2d.js":9,"./engine.js":12,"./local_storage.js":16,"./vmath.js":26,assert:32}],16:[function(require,module,exports){"use strict";exports.get=get;exports.set=set;exports.setJSON=setJSON;exports.getJSON=getJSON;exports.storage_prefix="demo";var local_storage_sim={};var lsd=function(){try{localStorage.test="test";return localStorage}catch(e){return local_storage_sim}}();function get(key){key=exports.storage_prefix+"_"+key;var ret=lsd[key];if(ret==="undefined"){ret=undefined}return ret}function set(key,value){key=exports.storage_prefix+"_"+key;if(value===undefined||value===null){delete lsd[key]}else{lsd[key]=value}}function setJSON(key,value){set(key,JSON.stringify(value))}function getJSON(key,def){var value=get(key);try{return JSON.parse(value)}catch(e){}return def}},{}],17:[function(require,module,exports){"use strict";exports.mat43=mat43;exports.m43identity=m43identity;exports.m43mul=m43mul;function mat43(){var r=new Float32Array(12);r[0]=r[4]=r[8]=1;return r}function m43identity(out){out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=1;out[5]=0;out[6]=0;out[7]=0;out[8]=1;out[9]=0;out[10]=0;out[11]=0}function m43mul(out,a,b){var a0=a[0];var a1=a[1];var a2=a[2];var a3=a[3];var a4=a[4];var a5=a[5];var a6=a[6];var a7=a[7];var a8=a[8];var a9=a[9];var a10=a[10];var a11=a[11];var b0=b[0];var b1=b[1];var b2=b[2];var b3=b[3];var b4=b[4];var b5=b[5];var b6=b[6];var b7=b[7];var b8=b[8];out[0]=b0*a0+b3*a1+b6*a2;out[1]=b1*a0+b4*a1+b7*a2;out[2]=b2*a0+b5*a1+b8*a2;out[3]=b0*a3+b3*a4+b6*a5;out[4]=b1*a3+b4*a4+b7*a5;out[5]=b2*a3+b5*a4+b8*a5;out[6]=b0*a6+b3*a7+b6*a8;out[7]=b1*a6+b4*a7+b7*a8;out[8]=b2*a6+b5*a7+b8*a8;out[9]=b0*a9+b3*a10+b6*a11+b[9];out[10]=b1*a9+b4*a10+b7*a11+b[10];out[11]=b2*a9+b5*a10+b8*a11+b[11];return out}},{}],18:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports.preloadParticleData=preloadParticleData;exports.create=create;var assert=require("assert");var sprites=require("./sprites.js");var textures=require("./textures.js");var _require=require("./vmath.js"),vec2=_require.vec2,v2copy=_require.v2copy,v2lerp=_require.v2lerp,v2mul=_require.v2mul;var _require2=require("./vmath.js"),vec3=_require2.vec3,vec4=_require2.vec4,v3add=_require2.v3add,v4copy=_require2.v4copy,v4lerp=_require2.v4lerp,v4mul=_require2.v4mul;var blend_map={alpha:sprites.BLEND_ALPHA,additive:sprites.BLEND_ADDITIVE};function preloadParticleData(particle_data){for(var key in particle_data.defs){var def=particle_data.defs[key];for(var part_name in def.particles){var part_def=def.particles[part_name];textures.load({url:"img/"+part_def.texture+".png"})}}}function normalizeValue(v){if(v instanceof Float32Array&&v.length>=2){return v}else if(typeof v==="number"){return vec2(v,0)}else if(Array.isArray(v)||v instanceof Float32Array){return vec2(v[0]||0,v[1]||0)}else{return assert(false)}}function normalizeValueVec(vec,length){assert(length);assert(Array.isArray(vec));var ret=new Array(length);for(var ii=0;ii<length;++ii){ret[ii]=normalizeValue(vec[ii])}return ret}function normalizeParticle(def,particle_manager){if(!def.normalized){var norm=def.normalized={blend:blend_map[def.blend]||sprites.BLEND_ALPHA,texture:textures.load({url:def.texture?"img/"+def.texture+".png":"img/glov/util_circle.png"}),color:normalizeValueVec(def.color||[1,1,1,1],4),color_track:null,size:normalizeValueVec(def.size||[1,1],2),size_track:null,accel:normalizeValueVec(def.accel||[0,0,0],3),rot:normalizeValue(def.rot||0),rot_vel:normalizeValue(def.rot||0),lifespan:normalizeValue(def.lifespan||1e3),kill_time_accel:normalizeValue(def.kill_time_accel||1)};assert(norm.kill_time_accel[0]>=1);if(def.color_track&&def.color_track.length){assert(def.color_track.length>1);norm.color_track=[];for(var ii=0;ii<def.color_track.length;++ii){var e=def.color_track[ii];assert(typeof e.t==="number");var arr=new Float32Array(5);arr[0]=e.v[0];arr[1]=e.v[1];arr[2]=e.v[2];arr[3]=e.v[3];arr[4]=e.t;norm.color_track.push(arr)}}if(def.size_track&&def.size_track.length){assert(def.size_track.length>1);norm.size_track=[];for(var _ii=0;_ii<def.size_track.length;++_ii){var _e=def.size_track[_ii];assert(typeof _e.t==="number");var _arr=new Float32Array(3);_arr[0]=_e.v[0];_arr[1]=_e.v[1];_arr[2]=_e.t;norm.size_track.push(_arr)}}}return def.normalized}function findParticle(particles,name){assert(particles[name]!==undefined);return particles[name]}function normalizeEmitter(def,part_map){if(!def.normalized){def.normalized={part_idx:findParticle(part_map,def.particle),pos:normalizeValueVec(def.pos||[0,0,0],3),vel:normalizeValueVec(def.vel||[0,0,0],3),emit_rate:normalizeValue(def.emit_rate||10),emit_time:normalizeValueVec(def.emit_time||[0,Infinity],2),emit_initial:normalizeValue(def.emit_initial||1)};var min=def.normalized.emit_rate[0];var max=def.normalized.emit_rate[0]+def.normalized.emit_rate[1];def.normalized.emit_rate[0]=1e3/max;def.normalized.emit_rate[1]=1e3/min;assert(def.normalized.emit_rate[0]>1)}return def.normalized}function normalizeDef(def,particle_manager){if(!def.normalized){var norm=def.normalized={system_lifespan:normalizeValue(def.system_lifespan||Infinity),particles:[],emitters:[]};var part_map={};for(var key in def.particles){part_map[key]=norm.particles.length;norm.particles.push(normalizeParticle(def.particles[key],particle_manager))}for(var _key in def.emitters){norm.emitters.push(normalizeEmitter(def.emitters[_key],part_map))}}return def.normalized}function instValue(v){return v[0]+Math.random()*v[1]}function instValueVec(v){var ret=new Float32Array(v.length);for(var ii=0;ii<v.length;++ii){ret[ii]=instValue(v[ii])}return ret}var temp_color=vec4();var temp_color2=vec4();var temp_size=vec2();var temp_size2=vec2();var ParticleSystem=function(){function ParticleSystem(parent,def_in,pos){assert(pos.length===3);this.parent=parent;this.def=normalizeDef(def_in,parent);this.system_lifespan=instValue(this.def.system_lifespan);assert(this.system_lifespan>0);this.age=0;this.kill_hard=false;this.kill_soft=false;this.pos=vec3(pos[0],pos[1],pos[2]);this.part_sets=[];for(var ii=0;ii<this.def.particles.length;++ii){var def=this.def.particles[ii];var part_set={def:def,parts:[]};this.part_sets.push(part_set)}this.emitters=[];for(var _ii2=0;_ii2<this.def.emitters.length;++_ii2){var _def=this.def.emitters[_ii2];var emitter={def:_def,emit_time:instValueVec(_def.emit_time),countdown:0,started:false,stopped:false};this.emitters.push(emitter)}this.tick(0)}_createClass(ParticleSystem,[{key:"tickParticle",value:function tickParticle(part,dt){var def=part.def;part.age+=dt;var age_norm=part.age/part.lifespan;if(age_norm>=1){return true}var dts=dt/1e3;part.pos[0]+=part.vel[0]*dts;part.pos[1]+=part.vel[1]*dts;part.pos[2]+=part.vel[2]*dts;part.vel[0]+=part.accel[0]*dts;part.vel[1]+=part.accel[1]*dts;part.vel[2]+=part.accel[2]*dts;v4copy(temp_color,part.color,temp_color);if(def.color_track){if(age_norm<def.color_track[0][4]){v4mul(temp_color,temp_color,def.color_track[0])}else if(age_norm>=def.color_track[def.color_track.length-1][4]){v4mul(temp_color,temp_color,def.color_track[def.color_track.length-1])}else{for(var ii=0;ii<def.color_track.length-1;++ii){if(age_norm>=def.color_track[ii][4]&&age_norm<def.color_track[ii+1][4]){var weight=(age_norm-def.color_track[ii][4])/(def.color_track[ii+1][4]-def.color_track[ii][4]);v4lerp(temp_color2,weight,def.color_track[ii],def.color_track[ii+1]);v4mul(temp_color,temp_color,temp_color2);break}}}}v2copy(temp_size,part.size);if(def.size_track){if(age_norm<def.size_track[0][4]){v2mul(temp_size,temp_size,def.size_track[0])}else if(age_norm>=def.size_track[def.size_track.length-1][4]){v2mul(temp_size,temp_size,def.size_track[def.size_track.length-1])}else{for(var _ii3=0;_ii3<def.size_track.length-1;++_ii3){if(age_norm>=def.size_track[_ii3][4]&&age_norm<def.size_track[_ii3+1][4]){var _weight=(age_norm-def.size_track[_ii3][4])/(def.size_track[_ii3+1][4]-def.size_track[_ii3][4]);v2lerp(temp_size2,_weight,def.size_track[_ii3],def.size_track[_ii3+1]);v2mul(temp_size,temp_size,temp_size2);break}}}}var w=part.size[0];var h=part.size[1];var x=part.pos[0]-w/2;var y=part.pos[1]-h/2;var z=part.pos[2];sprites.queueraw4([def.texture],x,y,x,y+h,x+w,y+h,x+w,y,z,0,0,1,1,temp_color,null,null,def.blend);return false}},{key:"tickPartSet",value:function tickPartSet(dt_orig,part_set){var parts=part_set.parts;for(var ii=parts.length-1;ii>=0;--ii){var part=parts[ii];var dt=this.kill_soft?dt_orig*part.kill_time_accel:dt_orig;if(this.tickParticle(part,dt)){parts[ii]=parts[parts.length-1];parts.pop()}}}},{key:"emitParticle",value:function emitParticle(init_dt,emitter){var emitter_def=emitter.def;var part_set=this.part_sets[emitter_def.part_idx];var def=part_set.def;var pos=instValueVec(emitter_def.pos,3);v3add(pos,pos,this.pos);var part={def:def,pos:pos,color:instValueVec(def.color,4),size:instValueVec(def.size,4),vel:instValueVec(emitter_def.vel,3),accel:instValueVec(def.accel,3),rot:instValue(def.rot),rot_vel:instValue(def.rot_vel),lifespan:instValue(def.lifespan),kill_time_accel:instValue(def.kill_time_accel),age:0};if(!this.tickParticle(part,init_dt)){part_set.parts.push(part)}}},{key:"tickEmitter",value:function tickEmitter(dt,emitter){var def=emitter.def;if(!emitter.started&&this.age>=emitter.emit_time[0]){emitter.started=true;dt=this.age-emitter.emit_time[0];var num=instValue(def.emit_initial);for(var ii=0;ii<num;++ii){this.emitParticle(dt,emitter)}emitter.countdown=instValue(def.emit_rate)}if(emitter.started&&!emitter.stopped){var remaining_dt=dt;var emit_dt=dt;if(this.age>=emitter.emit_time[1]){emitter.stopped=true;emit_dt-=this.age-emitter.emit_time[1]}while(emit_dt>=emitter.countdown){emit_dt-=emitter.countdown;remaining_dt-=emitter.countdown;emitter.countdown=instValue(def.emit_rate);this.emitParticle(remaining_dt,emitter)}emitter.countdown-=emit_dt}}},{key:"tick",value:function tick(dt){if(this.kill_hard){return true}for(var ii=this.part_sets.length-1;ii>=0;--ii){this.tickPartSet(dt,this.part_sets[ii])}this.age+=dt;for(var _ii4=0;_ii4<this.emitters.length;++_ii4){this.tickEmitter(dt,this.emitters[_ii4])}return this.age>=this.system_lifespan}}]);return ParticleSystem}();var ParticleManager=function(){function ParticleManager(){this.systems=[]}_createClass(ParticleManager,[{key:"createSystem",value:function createSystem(def,pos){var system=new ParticleSystem(this,def,pos);this.systems.push(system);return system}},{key:"tick",value:function tick(dt){for(var ii=this.systems.length-1;ii>=0;--ii){if(this.systems[ii].tick(dt)){this.systems[ii]=this.systems[this.systems.length-1];this.systems.pop()}}}}]);return ParticleManager}();function create(){for(var _len=arguments.length,args=Array(_len),_key2=0;_key2<_len;_key2++){args[_key2]=arguments[_key2]}return new(Function.prototype.bind.apply(ParticleManager,[null].concat(args)))}},{"./sprites.js":21,"./textures.js":23,"./vmath.js":26,assert:32}],19:[function(require,module,exports){"use strict";exports.create=create;exports.bind=bind;exports.startup=startup;var assert=require("assert");var engine=require("./engine.js");var last_id=0;var bound_prog=null;var semantic=exports.semantic={ATTR0:0,POSITION:0,ATTR1:1,COLOR:1,COLOR_0:1,ATTR2:2,TEXCOORD:2,TEXCOORD_0:2,ATTR3:3,NORMAL:3,ATTR4:4,TEXCOORD_1:4};function findAll(str,re){var ret=[];var m=void 0;do{m=re.exec(str);if(m){ret.push(m[1])}}while(m);return ret}var globals=void 0;var defines=void 0;var error_fp=void 0;var error_vp=void 0;var vp_attr_regex=/attribute (?:[\0-\x1F!-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+ ((?:[\0-\x1F!-:<-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+);/g;var uniform_regex=/uniform (?:(?:low|medium|high)p )?((?:vec|mat)[0-9] (?:[\0-\x1F!-:<-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+);/g;var sampler_regex=/uniform sampler2D ((?:[\0-\x1F!-:<-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+);/g;var type_size={vec2:2*1,vec3:3*1,vec4:4*1,mat3:3*3,mat4:4*4};function Shader(type,text){text=""+defines+text;this.shader=gl.createShader(type);if(type===gl.VERTEX_SHADER){this.programs={};this.attributes=findAll(text,vp_attr_regex);this.attributes.forEach(function(v){return assert(semantic[v]!==undefined)})}else{this.id=++last_id;this.samplers=findAll(text,sampler_regex);var found=[];this.samplers.forEach(function(v){var num=Number(v.slice(-1));assert(!isNaN(num));assert(!found[num]);found[num]=true})}this.uniforms=findAll(text,uniform_regex);this.uniforms.forEach(function(v){var type_name=v.split(" ")[0];assert(type_size[type_name])});gl.shaderSource(this.shader,text);gl.compileShader(this.shader);if(!gl.getShaderParameter(this.shader,gl.COMPILE_STATUS)){console.error("Shader compile error: "+gl.getShaderInfoLog(this.shader))}}function create(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return new(Function.prototype.bind.apply(Shader,[null].concat(args)))}function uniformSetValue(unif){switch(unif.width){case 2:gl.uniform2fv(unif.location,unif.value);break;case 3:gl.uniform3fv(unif.location,unif.value);break;case 4:gl.uniform4fv(unif.location,unif.value);break;case 9:gl.uniformMatrix3fv(unif.location,false,unif.value);break;case 16:gl.uniformMatrix4fv(unif.location,false,unif.value);break}}function link(vp,fp){var prog=vp.programs[fp.id]={handle:gl.createProgram(),uniforms:null};gl.attachShader(prog.handle,vp.shader);gl.attachShader(prog.handle,fp.shader);for(var ii=0;ii<vp.attributes.length;++ii){gl.bindAttribLocation(prog.handle,semantic[vp.attributes[ii]],vp.attributes[ii])}gl.linkProgram(prog.handle);prog.valid=gl.getProgramParameter(prog.handle,gl.LINK_STATUS);if(!prog.valid){console.error("Shader link error: "+gl.getProgramInfoLog(prog.handle))}gl.useProgram(prog.handle);bound_prog=prog;var uniforms=vp.uniforms.slice(0);for(var _ii=0;_ii<fp.uniforms.length;++_ii){var name=fp.uniforms[_ii];if(uniforms.indexOf(name)===-1){uniforms.push(name)}}prog.uniforms=uniforms.map(function(v){v=v.split(" ");var type=v[0];var name=v[1];var count=1;var m=name.match(/((?:[\0-Z\\-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)\[([0-9]+)\]/);if(m){name=m[1];count=Number(m[2])}var location=gl.getUniformLocation(prog.handle,name);if(location===null){return null}var width=type_size[type];var size=width*count;var glob=globals[name];var value=new Float32Array(size);var unif={name:name,size:size,width:width,count:count,value:value,location:location,glob:glob};uniformSetValue(unif);return unif}).filter(function(v){return v});for(var _ii2=0;_ii2<fp.samplers.length;++_ii2){var _name=fp.samplers[_ii2];var num=Number(_name.slice(-1));var location=gl.getUniformLocation(prog.handle,_name);if(location!==null){gl.uniform1i(location,num)}}return prog}function bind(vp,fp,params){var prog=vp.programs[fp.id];if(!prog){prog=link(vp,fp)}if(!prog.valid){prog=link(vp,error_fp);if(!prog.valid){prog=link(error_vp,error_fp)}}if(prog!==bound_prog){bound_prog=prog;gl.useProgram(prog.handle)}for(var ii=0;ii<prog.uniforms.length;++ii){var unif=prog.uniforms[ii];var value=params[unif.name]||unif.glob;if(!value){continue}var diff=false;for(var jj=0;jj<unif.size;++jj){if(value[jj]!==unif.value[jj]){diff=true;break}}if(diff){for(var _jj=0;_jj<unif.size;++_jj){unif.value[_jj]=value[_jj]}uniformSetValue(unif)}}}function startup(_globals){defines=Object.keys(engine.defines).map(function(v){return"#define "+v+"\n"}).join("");globals=_globals;error_fp=create(gl.FRAGMENT_SHADER,"#pragma WebGL\n\nvoid main(void) {\n  gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n}\n");error_vp=create(gl.VERTEX_SHADER,"// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n#pragma WebGL\nattribute vec2 POSITION;\nvoid main() {\n  gl_Position = vec4(POSITION.xy * vec2(2.0 / 1024.0, -2.04 / 1024.0) + vec2(-1.0, 1.0), 0.0, 1.0);\n}\n")}},{"./engine.js":12,assert:32}],20:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports.create=create;var DEFAULT_FADE_RATE=.001;var sounds={};var num_loading=0;var SoundManager=function(){function SoundManager(listenerTransform){if(!listenerTransform){listenerTransform=new Float32Array([1,0,-0,0,0,1,0,-1,0,0,0,0])}var soundDeviceParameters={linearDistance:false};this.soundDevice=WebGLSoundDevice.create(soundDeviceParameters);this.soundDevice.listenerTransform=listenerTransform;this.auto_oggs=false;this.auto_mp3s=false;this.sound_on=true;this.music_on=true;this.channels=[];for(var ii=0;ii<16;++ii){this.channels[ii]=this.soundDevice.createSource({position:[0,0,0],relative:false,pitch:1})}this.channel=0;this.last_played={};this.global_timer=0;this.fade_rate=DEFAULT_FADE_RATE;this.current_loop=null;this.music=[];for(var _ii=0;_ii<2;++_ii){this.music.push({source:this.soundDevice.createSource({position:[0,0,0],relative:false,pitch:1,looping:true}),current_volume:0,target_volume:0})}}_createClass(SoundManager,[{key:"loadSound",value:function loadSound(base,cb){var _this=this;if(Array.isArray(base)){for(var ii=0;ii<base.length;++ii){this.loadSound(base[ii],cb)}return}var key=base;var m=base.match(/^((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)\.(mp3|ogg|wav)$/);var preferred_ext=void 0;if(m){base=m[1];preferred_ext=m[2]}var src="sounds/"+base;var tryLoad=function tryLoad(ext){++num_loading;_this.soundDevice.createSound({src:src+ext,onload:function onload(sound){--num_loading;if(sound){sounds[key]=sound;if(cb){return cb()}}else{if(ext===".ogg"||ext===".mp3"){tryLoad(".wav")}}return null}})};if(this.soundDevice.isSupported("FILEFORMAT_OGG")&&(this.auto_oggs||preferred_ext==="ogg")){tryLoad(".ogg")}else if(this.soundDevice.isSupported("FILEFORMAT_MP3")&&(this.auto_mp3s||preferred_ext==="mp3")){tryLoad(".mp3")}else{tryLoad(".wav")}}},{key:"tick",value:function tick(dt){this.global_timer+=dt;var max_fade=dt*this.fade_rate;for(var ii=0;ii<this.music.length;++ii){var target=this.music_on?this.music[ii].target_volume:0;if(this.music[ii].current_volume!==target){var delta=target-this.music[ii].current_volume;var fade_amt=Math.min(Math.abs(delta),max_fade);if(delta<0){this.music[ii].current_volume=Math.max(target,this.music[ii].current_volume-fade_amt)}else{this.music[ii].current_volume=Math.min(target,this.music[ii].current_volume+fade_amt)}this.music[ii].source.gain=this.music[ii].current_volume}}}},{key:"resume",value:function resume(){this.soundDevice.resume()}},{key:"play",value:function play(soundname,volume){volume=volume||1;if(!this.sound_on){return null}if(!sounds[soundname]){return null}var last_played_time=this.last_played[soundname]||-9e9;if(this.global_timer-last_played_time<45){return null}var channel=this.channels[this.channel++];channel.play(sounds[soundname]);channel.gain=volume;this.last_played[soundname]=this.global_timer;if(this.channel===this.channels.length){this.channel=0}return{stop:function stop(){channel.stop()}}}},{key:"playMusic",value:function playMusic(soundname,volume,transition){var _this2=this;if(!this.music_on){return}if(volume===undefined){volume=1}transition=transition||SoundManager.DEFAULT;this.loadSound(soundname,function(){if(!sounds[soundname]){return}if(_this2.current_loop===soundname){_this2.music[0].target_volume=volume;if(!transition){_this2.music[0].source.gain=_this2.music[0].current_volume=volume}return}if(_this2.music[0].current_volume){if(transition&SoundManager.FADE_OUT){var temp=_this2.music[1];_this2.music[1]=_this2.music[0];_this2.music[0]=temp;_this2.music[1].target_volume=0}}_this2.current_loop=soundname;_this2.music[0].target_volume=volume;if(transition&SoundManager.FADE_IN){_this2.music[0].source.gain=_this2.music[0].current_volume=0}else{_this2.music[0].source.gain=_this2.music[0].current_volume=volume}_this2.music[0].source.play(sounds[soundname],0,true)})}},{key:"loading",value:function loading(){return num_loading}}]);return SoundManager}();SoundManager.DEFAULT=SoundManager.prototype.DEFAULT=0;SoundManager.FADE_OUT=SoundManager.prototype.FADE_OUT=1;SoundManager.FADE_IN=SoundManager.prototype.FADE_IN=2;SoundManager.FADE=SoundManager.prototype.FADE=SoundManager.prototype.FADE_OUT+SoundManager.prototype.FADE_IN;function create(listenerTransform){return new SoundManager(listenerTransform)}},{}],21:[function(require,module,exports){"use strict";exports.queuefn=queuefn;exports.queueraw4=queueraw4;exports.queueraw=queueraw;exports.queuesprite=queuesprite;exports.clip=clip;exports.draw=draw;exports.create=create;exports.startup=startup;var assert=require("assert");var camera2d=require("./camera2d.js");var engine=require("./engine.js");var geom=require("./geom.js");var cos=Math.cos,max=Math.max,min=Math.min,round=Math.round,sin=Math.sin;var textures=require("./textures.js");var shaders=require("./shaders.js");var _require=require("./vmath.js"),vec2=_require.vec2,vec4=_require.vec4;var _require2=require("./vmath.js"),nextHighestPowerOfTwo=_require2.nextHighestPowerOfTwo;var BLEND_ALPHA=exports.BLEND_ALPHA=0;var BLEND_ADDITIVE=exports.BLEND_ADDITIVE=1;var sprite_vshader=void 0;var sprite_fshader=void 0;var sprite_dual_fshader=void 0;var clip_space=vec4();var sprite_shader_params={clip_space:clip_space};var last_uid=0;var sprite_queue=[];var sprite_freelist=[];function SpriteData(){this.data=new Float32Array(16);this.texs=null;this.shader=null;this.shader_params=null;this.x=0;this.y=0;this.z=0;this.blend=0;this.uid=0}function spriteDataAlloc(){if(sprite_freelist.length){return sprite_freelist.pop()}return new SpriteData}function cmpSprite(a,b){if(a.z!==b.z){return a.z-b.z}if(a.y!==b.y){return a.y-b.y}if(a.x!==b.x){return a.x-b.x}return a.uid-b.uid}function queuefn(z,fn){sprite_queue.push({fn:fn,x:0,y:0,z:z,uid:++last_uid})}function queueraw4(texs,x0,y0,x1,y1,x2,y2,x3,y3,z,u0,v0,u1,v1,color,shader,shader_params,blend){var elem=spriteDataAlloc();var data=elem.data;data[0]=(x0-camera2d.data[0])*camera2d.data[4];data[1]=(y0-camera2d.data[1])*camera2d.data[5];data[2]=(x1-camera2d.data[0])*camera2d.data[4];data[3]=(y1-camera2d.data[1])*camera2d.data[5];data[4]=(x2-camera2d.data[0])*camera2d.data[4];data[5]=(y2-camera2d.data[1])*camera2d.data[5];data[6]=(x3-camera2d.data[0])*camera2d.data[4];data[7]=(y3-camera2d.data[1])*camera2d.data[5];data[8]=color[0];data[9]=color[1];data[10]=color[2];data[11]=color[3];data[12]=u0;data[13]=v0;data[14]=u1;data[15]=v1;elem.texs=texs;elem.x=data[0];elem.y=data[1];elem.z=z;elem.shader=shader||null;if(shader_params){shader_params.clip_space=sprite_shader_params.clip_space;elem.shader_params=shader_params}else{elem.shader_params=null}elem.blend=blend||0;elem.uid=++last_uid;sprite_queue.push(elem);return elem}function queueraw(texs,x,y,z,w,h,u0,v0,u1,v1,color,shader,shader_params,blend){return queueraw4(texs,x,y,x,y+h,x+w,y+h,x+w,y,z,u0,v0,u1,v1,color,shader,shader_params,blend)}function queuesprite(sprite,x,y,z,w,h,rot,uvs,color,shader,shader_params){var elem=spriteDataAlloc();elem.texs=sprite.texs;elem.x=x=(x-camera2d.data[0])*camera2d.data[4];elem.y=y=(y-camera2d.data[1])*camera2d.data[5];elem.z=z;w*=camera2d.data[4];h*=camera2d.data[5];color=color||sprite.color;var data=elem.data;if(!rot){var x1=x-sprite.origin[0]*w;var y1=y-sprite.origin[1]*h;var x2=x1+w;var y2=y1+h;data[0]=x1;data[1]=y1;data[2]=x1;data[3]=y2;data[4]=x2;data[5]=y2;data[6]=x2;data[7]=y1}else{var dx=sprite.origin[0]*w;var dy=sprite.origin[1]*h;var cosr=cos(rot);var sinr=sin(rot);var _x=x-cosr*dx+sinr*dy;var _y=y-sinr*dx-cosr*dy;var ch=cosr*h;var cw=cosr*w;var sh=sinr*h;var sw=sinr*w;data[0]=_x;data[1]=_y;data[2]=_x-sh;data[3]=_y+ch;data[4]=_x+cw-sh;data[5]=_y+sw+ch;data[6]=_x+cw;data[7]=_y+sw}data[8]=color[0];data[9]=color[1];data[10]=color[2];data[11]=color[3];var bias=0;var tex=elem.texs[0];if(true){var zoom_level=max((uvs[2]-uvs[0])*tex.width/w,(uvs[3]-uvs[1])*tex.height/h);if(zoom_level<1){if(tex.filter_mag===gl.LINEAR){bias=.5}}else if(zoom_level>1){var mipped_texels=zoom_level/2;bias=.5+mipped_texels}}data[12]=uvs[0]+bias/tex.width;data[13]=uvs[1]+bias/tex.height;data[14]=uvs[2]-bias/tex.width;data[15]=uvs[3]-bias/tex.height;elem.uid=++last_uid;elem.shader=shader||null;elem.blend=0;if(shader_params){shader_params.clip_space=sprite_shader_params.clip_space;elem.shader_params=shader_params}else{elem.shader_params=null}sprite_queue.push(elem)}function clip(z_start,z_end,x,y,w,h){var xy=vec2();camera2d.virtualToCanvas(xy,[x,y]);var wh=vec2();camera2d.virtualToCanvas(wh,[x+w,y+h]);xy[0]=round(xy[0]);xy[1]=round(xy[1]);wh[0]=round(wh[0])-xy[0];wh[1]=round(wh[1])-xy[1];var gd_h=engine.render_height||engine.height;var scissor=[xy[0],gd_h-(xy[1]+wh[1]),wh[0],wh[1]];queuefn(z_start-.01,function(){gl.enable(gl.SCISSOR_TEST);gl.scissor(scissor[0],scissor[1],scissor[2],scissor[3])});queuefn(z_end-.01,function(){gl.disable(gl.SCISSOR_TEST)})}function diffTextures(texsa,texsb){if(texsa.length!==texsb.length){return true}for(var ii=0;ii<texsa.length;++ii){if(texsa[ii]!==texsb[ii]){return true}}return false}var batch_state=void 0;var sprite_geom=void 0;var sprite_buffer=void 0;var sprite_buffer_len=0;var sprite_buffer_batch_start=0;var sprite_buffer_idx=0;var last_blend_mode=void 0;var last_bound_shader=void 0;var MAX_VERT_COUNT=65536;var batches=[];function commit(){if(sprite_buffer_idx===sprite_buffer_batch_start){return}batches.push({state:batch_state,start:sprite_buffer_batch_start,end:sprite_buffer_idx});sprite_buffer_batch_start=sprite_buffer_idx}function commitAndFlush(){commit();if(!batches.length){return}assert(sprite_buffer_idx);sprite_geom.update(sprite_buffer,sprite_buffer_idx);sprite_geom.bind();for(var ii=0;ii<batches.length;++ii){var batch=batches[ii];var state=batch.state,start=batch.start,end=batch.end;if(last_bound_shader!==state.shader||state.shader_params){shaders.bind(sprite_vshader,state.shader||sprite_fshader,state.shader_params||sprite_shader_params);last_bound_shader=state.shader}if(last_blend_mode!==state.blend){last_blend_mode=state.blend;if(last_blend_mode===BLEND_ADDITIVE){gl.blendFunc(gl.SRC_ALPHA,gl.ONE)}else{gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA)}}textures.bindArray(state.texs);gl.drawElements(sprite_geom.mode,(end-start)*3/2,gl.UNSIGNED_SHORT,start*3)}batches.length=0;sprite_buffer_idx=0;sprite_buffer_batch_start=0}function bufferSpriteData(data){var index=sprite_buffer_idx*8;sprite_buffer_idx+=4;var c1=data[8];var c2=data[9];var c3=data[10];var c4=data[11];var u1=data[12];var v1=data[13];var u2=data[14];var v2=data[15];sprite_buffer[index]=data[0];sprite_buffer[index+1]=data[1];sprite_buffer[index+2]=c1;sprite_buffer[index+3]=c2;sprite_buffer[index+4]=c3;sprite_buffer[index+5]=c4;sprite_buffer[index+6]=u1;sprite_buffer[index+7]=v1;sprite_buffer[index+8]=data[2];sprite_buffer[index+9]=data[3];sprite_buffer[index+10]=c1;sprite_buffer[index+11]=c2;sprite_buffer[index+12]=c3;sprite_buffer[index+13]=c4;sprite_buffer[index+14]=u1;sprite_buffer[index+15]=v2;sprite_buffer[index+16]=data[4];sprite_buffer[index+17]=data[5];sprite_buffer[index+18]=c1;sprite_buffer[index+19]=c2;sprite_buffer[index+20]=c3;sprite_buffer[index+21]=c4;sprite_buffer[index+22]=u2;sprite_buffer[index+23]=v2;sprite_buffer[index+24]=data[6];sprite_buffer[index+25]=data[7];sprite_buffer[index+26]=c1;sprite_buffer[index+27]=c2;sprite_buffer[index+28]=c3;sprite_buffer[index+29]=c4;sprite_buffer[index+30]=u2;sprite_buffer[index+31]=v1}function draw(){if(!sprite_queue.length){return}gl.disable(gl.DEPTH_TEST);gl.depthMask(false);gl.enable(gl.BLEND);clip_space[0]=2/engine.viewport[2];clip_space[1]=-2/engine.viewport[3];last_blend_mode=-1;last_bound_shader=-1;if(!sprite_geom){sprite_geom=geom.create([[shaders.semantic.POSITION,gl.FLOAT,2,false],[shaders.semantic.COLOR,gl.FLOAT,4,false],[shaders.semantic.TEXCOORD,gl.FLOAT,2,false]],[],null,geom.QUADS);sprite_buffer=new Float32Array(1024);sprite_buffer_len=sprite_buffer.length/8}sprite_queue.sort(cmpSprite);batch_state=null;assert(sprite_buffer_idx===0);assert(sprite_buffer_batch_start===0);assert(batches.length===0);for(var ii=0;ii<sprite_queue.length;++ii){var elem=sprite_queue[ii];if(elem.fn){commitAndFlush();batch_state=null;elem.fn()}else{if(!batch_state||diffTextures(elem.texs,batch_state.texs)||elem.shader!==batch_state.shader||elem.shader_params!==batch_state.shader_params||elem.blend!==batch_state.blend){commit();batch_state=elem}if(sprite_buffer_idx+4>sprite_buffer_len){commitAndFlush();if(sprite_buffer_len!==MAX_VERT_COUNT){var new_length=min(sprite_buffer_len*1.25+3&~3,MAX_VERT_COUNT);sprite_buffer_len=new_length;sprite_buffer=new Float32Array(new_length*8)}}bufferSpriteData(elem.data);sprite_freelist.push(elem)}}commitAndFlush();sprite_queue.length=0;if(last_blend_mode!==BLEND_ALPHA){gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA)}}function buildRects(ws,hs){var rects=[];var total_w=0;for(var ii=0;ii<ws.length;++ii){total_w+=ws[ii]}var total_h=0;for(var _ii=0;_ii<hs.length;++_ii){total_h+=hs[_ii]}var tex_w=nextHighestPowerOfTwo(total_w);var tex_h=nextHighestPowerOfTwo(total_h);var wh=[];for(var _ii2=0;_ii2<ws.length;++_ii2){wh.push(ws[_ii2]/total_h)}var y=0;for(var jj=0;jj<hs.length;++jj){var x=0;for(var _ii3=0;_ii3<ws.length;++_ii3){var r=vec4(x/tex_w,y/tex_h,(x+ws[_ii3])/tex_w,(y+hs[jj])/tex_h);rects.push(r);x+=ws[_ii3]}y+=hs[jj]}return{widths:ws,heights:hs,wh:wh,rects:rects,total_w:total_w,total_h:total_h}}function Sprite(params){if(params.texs){this.texs=params.texs}else{this.texs=[];if(params.tex){this.texs.push(params.tex)}else if(params.layers){assert(params.name);this.texs=[];for(var ii=0;ii<params.layers;++ii){this.texs.push(textures.load({url:"img/"+params.name+"_"+ii+".png",filter_min:params.filter_min,filter_mag:params.filter_mag,wrap_s:params.wrap_s,wrap_t:params.wrap_t}))}}else if(params.name){this.texs.push(textures.load({url:"img/"+params.name+".png",filter_min:params.filter_min,filter_mag:params.filter_mag,wrap_s:params.wrap_s,wrap_t:params.wrap_t}))}else{assert(params.url);this.texs.push(textures.load(params))}}this.origin=params.origin||vec2(0,0);this.size=params.size||vec2(1,1);this.color=params.color||vec4(1,1,1,1);this.uvs=params.uvs||vec4(0,0,1,1);if(params.ws){this.uidata=buildRects(params.ws,params.hs)}}Sprite.prototype.draw=function(params){if(params.w===0||params.h===0){return}var w=(params.w||1)*this.size[0];var h=(params.h||1)*this.size[1];var uvs=typeof params.frame==="number"?this.uidata.rects[params.frame]:params.uvs||this.uvs;queuesprite(this,params.x,params.y,params.z,w,h,params.rot,uvs,params.color||this.color,params.shader,params.shader_params)};Sprite.prototype.drawDualTint=function(params){params.shader=sprite_dual_fshader;params.shader_params={color1:params.color1};this.draw(params)};function create(params){return new Sprite(params)}function startup(){clip_space[2]=-1;clip_space[3]=1;sprite_vshader=shaders.create(gl.VERTEX_SHADER,"// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n#pragma WebGL\nprecision highp float;\n\n// per-vertex input\nattribute vec2 POSITION;\nattribute vec4 COLOR;\nattribute vec2 TEXCOORD;\n\n// output\nvarying lowp vec4 interp_color;\nvarying vec2 interp_texcoord;\n\n// global parameters\nuniform vec4 clip_space;\n\nvoid main()\n{\n  interp_texcoord = TEXCOORD;\n  interp_color = COLOR;\n  gl_Position = vec4(POSITION.xy * clip_space.xy + clip_space.zw, 0.0, 1.0);\n}\n");sprite_fshader=shaders.create(gl.FRAGMENT_SHADER,"#pragma WebGL\n\nprecision lowp float;\n\nuniform sampler2D tex0;\n\nvarying lowp vec4 interp_color;\nvarying vec2 interp_texcoord;\n\nvoid main(void) {\n  vec4 tex = texture2D(tex0, interp_texcoord);\n  gl_FragColor = tex * interp_color;\n}\n");sprite_dual_fshader=shaders.create(gl.FRAGMENT_SHADER,"#pragma WebGL\n\nprecision lowp float;\n\nuniform sampler2D tex0;\nuniform sampler2D tex1;\nuniform lowp vec4 color1;\n\nvarying lowp vec4 interp_color;\nvarying vec2 interp_texcoord;\n\nvoid main(void) {\n  vec4 tex0 = texture2D(tex0,interp_texcoord);\n  vec2 tex1 = texture2D(tex1,interp_texcoord).rg;\n  float value = dot(tex0.rgb, vec3(0.2, 0.5, 0.3));\n  vec3 valueR = value * interp_color.rgb;\n  vec3 valueG = value * color1.rgb;\n  vec3 value3 = mix(tex0.rgb, valueG, tex1.g);\n  value3 = mix(value3, valueR, tex1.r);\n  gl_FragColor = vec4(value3, tex0.a * interp_color.a);\n}\n")}},{"./camera2d.js":9,"./engine.js":12,"./geom.js":14,"./shaders.js":19,"./textures.js":23,"./vmath.js":26,assert:32}],22:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();exports.create=create;var glov_engine=require("./engine.js");var glov_font=require("./font.js");var glov_ui=require("./ui.js");var abs=Math.abs,max=Math.max,min=Math.min;var _require=require("./vmath.js"),clamp=_require.clamp,vec4=_require.vec4;var mode_regex1=/^((?:[0-9]+;)*[0-9]+m)/;var mode_regex2=/([0-9]+)[;m]/g;var ESC="";var ansi_to_unicode=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,199,252,233,226,228,224,229,231,234,235,232,239,238,236,196,197,201,230,198,244,246,242,251,249,255,214,220,162,163,165,8359,402,225,237,243,250,241,209,170,186,191,8976,172,189,188,161,171,187,9617,9618,9619,9474,9508,9569,9570,9558,9557,9571,9553,9559,9565,9564,9563,9488,9492,9524,9516,9500,9472,9532,9566,9567,9562,9556,9577,9574,9568,9552,9580,9575,9576,9572,9573,9561,9560,9554,9555,9579,9578,9496,9484,9608,9604,9612,9616,9600,945,223,915,960,931,963,181,964,934,920,937,948,8734,966,949,8745,8801,177,8805,8804,8992,8993,247,8776,176,8729,183,8730,8319,178,9632,160];var MOD_CH=1;var MOD_SCROLL=2;var MOD_CLEAR=3;var MOD_CLEAREOL=4;var ansi_to_vga=[0,4,2,6,1,5,3,7];function toch(ch){if(typeof ch==="string"){ch=ch.charCodeAt(0)}if(typeof ch==="number"){return String.fromCharCode(ansi_to_unicode[ch]||ch)}else{return String(ch)[0]||" "}}var ATTR={BLINK:1,UNDERLINE:2,REVERSE:4,NUM_BITS:3};var CharInfo=function CharInfo(fg,bg,attr){this.ch=" ";this.fg=fg;this.bg=bg;this.attr=attr};var GlovTerminal=function(){function GlovTerminal(params){params=params||{};this.baud=params.baud||9600;this.w=params.w||80;this.h=params.h||25;this.x=0;this.y=0;this.fg=7;this.bg=0;this.attr=0;this.saved_x=0;this.saved_y=0;this.playback={x:0,y:0,fg:7,bg:0,attr:0};this.mod_head=null;this.mod_tail=null;this.mod_countdown=0;this.palette=params.palette||[vec4(0/64,0/64,0/63,1),vec4(0/64,0/64,42/63,1),vec4(0/64,42/64,0/63,1),vec4(0/64,42/64,42/63,1),vec4(42/64,0/64,0/63,1),vec4(42/64,0/64,42/63,1),vec4(42/64,21/64,0/63,1),vec4(42/64,42/64,42/63,1),vec4(21/64,21/64,21/63,1),vec4(21/64,21/64,63/63,1),vec4(21/64,63/64,21/63,1),vec4(21/64,63/64,63/63,1),vec4(63/64,21/64,21/63,1),vec4(63/64,21/64,63/63,1),vec4(63/64,63/64,21/63,1),vec4(63/64,63/64,63/63,1)];this.font_styles=[];for(var ii=0;ii<this.palette.length;++ii){this.font_styles.push(glov_font.style(null,{color:glov_font.intColorFromVec4Color(this.palette[ii])}))}this.char_height=params.char_height||16;this.char_width=params.char_width||9;this.font=params.font||glov_engine.font;this.buffer=new Array(this.h);this.auto_scroll=true;for(var _ii=0;_ii<this.h;++_ii){this.buffer[_ii]=new Array(this.w);for(var jj=0;jj<this.w;++jj){this.buffer[_ii][jj]=new CharInfo(this.fg,this.bg,this.attr)}}}_createClass(GlovTerminal,[{key:"domod",value:function domod(mod){switch(mod.type){case MOD_CH:this.buffer[mod.y][mod.x].ch=mod.ch;this.buffer[mod.y][mod.x].attr=mod.attr;this.buffer[mod.y][mod.x].fg=mod.fg;this.buffer[mod.y][mod.x].bg=mod.bg;this.playback.x=mod.x+1;this.playback.y=mod.y;break;case MOD_SCROLL:{var row=this.buffer[0];this.buffer=this.buffer.slice(1);this.buffer.push(row);for(var ii=0;ii<row.length;++ii){row[ii].fg=mod.fg;row[ii].bg=mod.bg;row[ii].ch=" ";row[ii].attr=0}}break;case MOD_CLEAR:for(var _ii2=0;_ii2<this.h;++_ii2){var line=this.buffer[_ii2];for(var jj=0;jj<this.w;++jj){line[jj].attr=mod.attr;line[jj].fg=mod.fg;line[jj].bg=mod.bg;line[jj].ch=" "}}this.playback.x=this.playback.y=0;break;case MOD_CLEAREOL:{var _line=this.buffer[mod.y];for(var _jj=mod.x;_jj<this.w;++_jj){_line[_jj].ch=" ";_line[_jj].attr=0;_line[_jj].fg=mod.fg;_line[_jj].bg=mod.bg}this.playback.x=this.w;this.playback.y=mod.y}break}if(this.playback.x>=this.w){this.playback.x=0;this.playback.y++}if(this.playback.y>=this.h){this.playback.y=this.h-1}}},{key:"mod",value:function mod(type,ch){var mod={type:type,ch:ch,x:this.x,y:this.y,fg:this.fg,bg:this.bg,attr:this.attr};if(!this.baud){this.domod(mod);return}if(this.mod_tail){this.mod_tail.next=mod;this.mod_tail=mod}else{this.mod_head=this.mod_tail=mod}}},{key:"normal",value:function normal(){this.color(7,0);this.attr=0}},{key:"color",value:function color(fg,bg){if(typeof fg==="number"){this.fg=fg}if(typeof bg==="number"){this.bg=bg}}},{key:"moveto",value:function moveto(x,y){if(typeof x==="number"){this.x=x}if(typeof y==="number"){this.y=y}this.checkwrap()}},{key:"offset",value:function offset(x,y){if(typeof x==="number"){this.x+=x}if(typeof y==="number"){this.y+=y}this.checkwrap()}},{key:"autoScroll",value:function autoScroll(b){this.auto_scroll=b}},{key:"checkwrap",value:function checkwrap(){if(this.x<0){this.x=0}if(this.x>=this.w){this.x=0;this.y++}if(this.y>=this.h){this.y=this.h-1;if(this.auto_scroll){this.mod(MOD_SCROLL)}}}},{key:"cr",value:function cr(){this.x=0;this.checkwrap()}},{key:"lf",value:function lf(){this.y++;this.checkwrap()}},{key:"crlf",value:function crlf(){this.x=0;this.y++;this.checkwrap()}},{key:"clear",value:function clear(){this.moveto(0,0);this.mod(MOD_CLEAR)}},{key:"cleareol",value:function cleareol(){this.mod(MOD_CLEAREOL);this.x=this.w;this.checkwrap()}},{key:"print",value:function print(params){this.moveto(params.x,params.y);this.color(params.fg,params.bg);var text=params.text||"";if(text&&!text.length){text=[text]}if(typeof text==="string"){text=text.split("")}text=text.map(toch).join("");for(var ii=0;ii<text.length;){var ch=text[ii];var handled=false;if(ch===ESC&&text[ii+1]==="["){handled=true;var code=text.slice(ii+2,ii+12);var m=void 0;if(code.match(/^\?7h/)){ii+=5}else if(code.match(/^2J/)){this.clear();ii+=4}else if(code.match(/^s/)){this.saved_x=this.x;this.saved_y=this.y;ii+=3}else if(code.match(/^u/)){this.moveto(this.saved_x,this.saved_y);ii+=3}else if(code.match(/^K/)){this.cleareol();ii+=3}else if(m=code.match(/^([0-9]*)A/)){this.offset(null,-Number(m[1]||"1"));ii+=m[0].length+2}else if(m=code.match(/^([0-9]*)B/)){this.offset(null,Number(m[1]||"1"));ii+=m[0].length+2}else if(m=code.match(/^([0-9]*)C/)){this.offset(Number(m[1]||"1"),null);ii+=m[0].length+2}else if(m=code.match(/^([0-9]*)D/)){this.offset(-Number(m[1]||"1"),null);ii+=m[0].length+2}else if(m=code.match(/^([0-9]+)(?:;([0-9]+))?(H|f)/)){this.moveto(Number(m[2]||"1")-1,Number(m[1])-1);ii+=m[0].length+2}else if(m=code.match(mode_regex1)){var ii_save=ii;ii+=m[0].length+2;var sub_str=m[1];m=mode_regex2.exec(sub_str);do{var sub_code=Number(m[1]);if(sub_code>=40){this.color(null,ansi_to_vga[sub_code-40])}else if(sub_code>=30){this.color(ansi_to_vga[sub_code-30]+(this.fg>=8?8:0),null)}else if(sub_code===1){if(this.fg<8){this.fg+=8}}else if(sub_code===0){this.normal()}else if(sub_code===4){this.attr|=ATTR.UNDERLINE}else if(sub_code===5){this.attr|=ATTR.BLINK}else if(sub_code===7){this.attr|=ATTR.REVERSE}else{handled=false;ii=ii_save}m=mode_regex2.exec(sub_str)}while(m)}else{handled=false}}else if(ch==="\n"){handled=true;++ii;this.lf()}else if(ch==="\r"){handled=true;++ii;this.cr()}if(!handled){if(this.x>=0&&this.x<this.w&&this.y>=0&&this.y<this.h){this.mod(MOD_CH,ch)}++this.x;this.checkwrap();++ii}}}},{key:"fill",value:function fill(params){var x=params.x||0;var y=params.y||0;var w=params.w||this.w;var h=params.h||this.h;var x0=clamp(x,0,this.w);var x1=clamp(x+w,0,this.w);var y0=clamp(y,0,this.h);var y1=clamp(y+h,0,this.h);var ch=toch(params.ch||" ");for(var ii=y0;ii<y1;++ii){this.moveto(x0,ii);for(var jj=x0;jj<x1;++jj){this.mod(MOD_CH,ch);this.x++}}}},{key:"ansiCharsTo",value:function ansiCharsTo(mod){var count=0;var m=false;if(mod.fg!==this.playback.fg){this.playback.fg=mod.fg;m=true;count+=3}if(mod.bg!==this.playback.bg){this.playback.bg=mod.bg;m=true;count+=3}if(mod.attr!==this.playback.attr){m=true;var clear=0;var add=0;for(var ii=0;ii<ATTR.NUM_BITS;++ii){var bit=1<<ii;if((this.playback.attr&bit)!==(mod.attr&bit)){if(mod.attr&bit){add++}else{clear=1}}}count+=(add+clear)*2}if(m){count+=2}switch(mod.type){case MOD_SCROLL:return count;case MOD_CLEAR:return count+4}var dx=mod.x-this.playback.x;var dy=mod.y-this.playback.y;if(dx||dy){var horiz=dx?3+(dx===1?0:(abs(dx)>=10?2:1)+(dx<0?1:0)):0;var vert=dy?3+(dy===1?0:(abs(dy)>=10?2:1)+(dy<0?1:0)):0;var setpos=4+(mod.x?mod.x>10?2:1:0)+(mod.y?mod.y>10?2:1:0);count+=min(horiz+vert,setpos)}switch(mod.type){case MOD_CH:return count+1;case MOD_CLEAREOL:return count+3}return count}},{key:"render",value:function render(dt,params){while(dt>=this.mod_countdown&&this.mod_head){dt-=this.mod_countdown;var mod=this.mod_head;this.mod_head=mod.next;if(!mod.next){this.mod_tail=null}this.domod(mod);var next=mod.next;if(next){var ms_per_char=1e3/(this.baud/10);if(!isFinite(ms_per_char)){ms_per_char=0}this.mod_countdown=ms_per_char*this.ansiCharsTo(next)}else{this.mod_countdown=0}}this.mod_countdown=max(0,this.mod_countdown-dt);var w=this.w,h=this.h,buffer=this.buffer,char_width=this.char_width,char_height=this.char_height,palette=this.palette;var blink=glov_engine.getFrameTimestamp()%1e3>500;params=params||{};var x=params.x||0;var y=params.y||0;var z=params.z||Z.BACKGROUND;for(var ii=0;ii<h;++ii){var jj=0;var line=buffer[ii];while(jj<w){while(jj<w&&line[jj].ch===" "){++jj}if(jj===w){continue}var jj0=jj;var fg=line[jj].fg;var text=[];while(jj<w&&(line[jj].fg===fg||line[jj].ch===" ")){var ch=line[jj].ch;if(blink&&line[jj].attr&ATTR.BLINK){ch=" "}text.push(ch);++jj}text=text.join("");glov_engine.font.drawSized(this.font_styles[fg],x+jj0*char_width,y+ii*char_height,z+.5,char_height,text)}}var box_x0=0;var box_y0=0;var last_x=void 0;var last_y=void 0;var box_color=buffer[0][0].bg;function flush(){glov_ui.drawRect(box_x0*char_width,box_y0*char_height,(last_x+1)*char_width,(last_y+1)*char_height,z,palette[box_color]);if(box_y0!==last_y&&last_y!==w-1){glov_ui.drawRect(x+(last_x+1)*char_width,y+box_y0*char_height,x+w*char_width,y+last_y*char_height,z,palette[box_color])}}for(var _ii3=0;_ii3<h;++_ii3){var _line2=buffer[_ii3];for(var _jj2=0;_jj2<w;++_jj2){var color=_line2[_jj2].bg;if(color!==box_color||box_x0>_jj2){flush();box_color=color;box_x0=_jj2;box_y0=_ii3}last_x=_jj2;last_y=_ii3}}flush()}}]);return GlovTerminal}();function create(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}return new(Function.prototype.bind.apply(GlovTerminal,[null].concat(args)))}},{"./engine.js":12,"./font.js":13,"./ui.js":25,"./vmath.js":26}],23:[function(require,module,exports){"use strict";exports.defaultFilters=defaultFilters;exports.bind=bind;exports.bindArray=bindArray;exports.createForCapture=createForCapture;exports.load=load;exports.findTexForReplacement=findTexForReplacement;exports.startup=startup;var assert=require("assert");var textures=exports.textures={};var load_count=exports.load_count=0;var aniso=4;var max_aniso=0;var aniso_enum=void 0;var default_filter_min=void 0;var default_filter_mag=void 0;var format=exports.format={R8:{count:1},RGB8:{count:3},RGBA8:{count:4}};function defaultFilters(min,mag){default_filter_min=min;default_filter_mag=mag}var _require=require("./vmath.js"),isPowerOfTwo=_require.isPowerOfTwo,nextHighestPowerOfTwo=_require.nextHighestPowerOfTwo;var bound_unit=null;var bound_tex=[];var handle_loading=void 0;var handle_error=void 0;function setUnit(unit){if(unit!==bound_unit){gl.activeTexture(gl.TEXTURE0+unit);bound_unit=unit}}function bindHandle(unit,target,handle){if(bound_tex[unit]!==handle){setUnit(unit);gl.bindTexture(target,handle);bound_tex[unit]=handle}}function unbindHandle(target,handle){for(var unit=0;unit<bound_tex.length;++unit){if(bound_tex[unit]===handle){setUnit(unit);gl.bindTexture(target,null);bound_tex[unit]=null}}}function bind(unit,tex){bindHandle(unit,tex.target,tex.eff_handle)}function bindArray(texs){for(var ii=0;ii<texs.length;++ii){var tex=texs[ii];var handle=tex.eff_handle;if(bound_tex[ii]!==handle){if(ii!==bound_unit){gl.activeTexture(gl.TEXTURE0+ii);bound_unit=ii}gl.bindTexture(tex.target,handle);bound_tex[ii]=handle}}}function Texture(params){this.loaded=false;this.load_fail=false;this.target=gl.TEXTURE_2D;this.handle=gl.createTexture();this.eff_handle=handle_loading;this.setSamplerState(params);this.format=params.format||format.RGBA8;if(params.data){this.updateData(params.width,params.height,params.data)}else if(params.url){this.loadURL(params.url)}}Texture.prototype.setSamplerState=function(params){var target=this.target;setUnit(0);bound_tex[0]=null;bindHandle(0,target,this.handle);this.filter_min=params.filter_min||default_filter_min;this.filter_mag=params.filter_mag||default_filter_mag;gl.texParameteri(target,gl.TEXTURE_MIN_FILTER,this.filter_min);gl.texParameteri(target,gl.TEXTURE_MAG_FILTER,this.filter_mag);gl.texParameteri(target,gl.TEXTURE_WRAP_S,params.wrap_s||gl.REPEAT);gl.texParameteri(target,gl.TEXTURE_WRAP_T,params.wrap_t||gl.REPEAT);this.mipmaps=this.filter_min>=9984&&this.filter_min<=9987;if(max_aniso){if(this.mipmaps&&params.filter_mag!==gl.NEAREST){gl.texParameterf(gl.TEXTURE_2D,aniso_enum,aniso)}else{gl.texParameterf(gl.TEXTURE_2D,aniso_enum,1)}}};Texture.prototype.updateData=function updateData(w,h,data){setUnit(0);bound_tex[0]=null;bindHandle(0,this.target,this.handle);this.width=w;this.height=h;if(data instanceof Uint8Array){gl.texImage2D(this.target,0,this.format.internal_type,w,h,0,this.format.internal_type,this.format.gl_type,data)}else{assert(data instanceof Image);if(!isPowerOfTwo(w)||!isPowerOfTwo(h)){this.width=nextHighestPowerOfTwo(w);this.height=nextHighestPowerOfTwo(h);gl.texImage2D(this.target,0,this.format.internal_type,this.width,this.height,0,this.format.internal_type,this.format.gl_type,null);if(w!==this.width){gl.texSubImage2D(this.target,0,1,0,this.format.internal_type,this.format.gl_type,data)}if(h!==this.height){gl.texSubImage2D(this.target,0,0,1,this.format.internal_type,this.format.gl_type,data)}gl.texSubImage2D(this.target,0,0,0,this.format.internal_type,this.format.gl_type,data)}else{gl.texImage2D(this.target,0,this.format.internal_type,this.format.internal_type,this.format.gl_type,data)}}if(this.mipmaps){gl.generateMipmap(this.target)}this.eff_handle=this.handle;this.loaded=true};Texture.prototype.loadURL=function loadURL(url){var tex=this;var img=new Image;exports.load_count=load_count+=1;var did_done=false;function done(){if(!did_done){did_done=true;exports.load_count=load_count-=1}}img.onload=function(){done();tex.format=format.RGBA8;tex.updateData(img.width,img.height,img)};function fail(){done();tex.eff_handle=handle_error;tex.load_fail=true}img.onerror=fail;img.crossOrigin="anonymous";img.src=url};Texture.prototype.copyTexImage=function(x,y,w,h){assert(w&&h);bindHandle(0,this.target,this.handle);gl.copyTexImage2D(this.target,0,gl.RGB,x,y,w,h,0);this.width=w;this.height=h};Texture.prototype.destroy=function(){delete textures[this.name];unbindHandle(this.target,this.handle);gl.deleteTexture(this.handle)};function create(params){return new Texture(params)}function createForCapture(){var texture=create({filter_min:gl.NEAREST,filter_mag:gl.NEAREST,wrap_s:gl.CLAMP_TO_EDGE,wrap_t:gl.CLAMP_TO_EDGE,format:gl.RGB8});texture.loaded=true;texture.eff_handle=texture.handle;texture.name="screen_temporary_tex";return texture}function load(params){var key=params.name||params.url;assert(key);if(textures[key]){return textures[key]}var texture=create(params);texture.name=key;textures[key]=texture;return texture}function cname(key){var idx=key.lastIndexOf("/");if(idx!==-1){key=key.slice(idx+1)}idx=key.lastIndexOf(".");if(idx!==-1){key=key.slice(0,idx)}return key.toLowerCase()}function findTexForReplacement(search_key){search_key=cname(search_key);for(var key in textures){var compare_key=cname(key);if(compare_key===search_key){return textures[key]}}return null}function startup(){default_filter_min=gl.LINEAR_MIPMAP_LINEAR;default_filter_mag=gl.LINEAR;format.R8.internal_type=gl.LUMINANCE;format.R8.gl_type=gl.UNSIGNED_BYTE;format.RGB8.internal_type=gl.RGB;format.RGB8.gl_type=gl.UNSIGNED_BYTE;format.RGBA8.internal_type=gl.RGBA;format.RGBA8.gl_type=gl.UNSIGNED_BYTE;var ext_anisotropic=gl.getExtension("EXT_texture_filter_anisotropic")||gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic");if(ext_anisotropic){aniso_enum=ext_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT;aniso=max_aniso=gl.getParameter(ext_anisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}handle_error=load({name:"error",width:2,height:2,format:format.RGBA8,filter_mag:gl.NEAREST,data:new Uint8Array([255,20,147,255,255,0,0,255,255,255,255,255,255,20,147,255])}).handle;handle_loading=load({name:"loading",width:2,height:2,format:format.RGBA8,data:new Uint8Array([127,127,127,255,0,0,0,255,64,64,64,255,127,127,127,255])}).handle;load({name:"white",width:2,height:2,format:format.RGBA8,data:new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255])})}},{"./vmath.js":26,assert:32}],24:[function(require,module,exports){"use strict";exports.queue=queue;exports.render=render;exports.fade=fade;exports.splitScreen=splitScreen;exports.pixelate=pixelate;exports.randomTransition=randomTransition;var assert=require("assert");var camera2d=require("./camera2d.js");var glov_engine=require("./engine.js");var sprites=require("./sprites.js");var shaders=require("./shaders.js");var textures=require("./textures.js");var glov_ui=require("./ui.js");var _require=require("../../common/util.js"),easeOut=_require.easeOut;var _require2=require("./vmath.js"),unit_vec=_require2.unit_vec,vec4=_require2.vec4;var floor=Math.floor,min=Math.min,pow=Math.pow,random=Math.random;var transitions=[];var IMMEDIATE=exports.IMMEDIATE="immediate";var REMOVE=exports.REMOVE="remove";var CONTINUE=exports.CONTINUE="continue";var shader_data={transition_pixelate:{fp:"#pragma WebGL\n\nprecision lowp float;\n\nvarying highp vec2 interp_texcoord;\n\nuniform sampler2D tex0;\nuniform vec4 param0;\nuniform vec4 param1;\n\nvoid main(void)\n{\n  vec2 interp_uvs = interp_texcoord;\n  // TODO: for best look, should generate an appropriate mipmap and sample from that/just render it w/ nearest neighbor\n  // result = texture2D(tex0, min(floor(interp_uvs.xy * param0.xy + 0.5) * param0.zw - param1.xy, param1.zw) );\n\n  // Unlike ARBfp version, shift RGB channels separately (3x slowdown)\n  vec4 texture0r = texture2D(tex0, min(floor(interp_uvs.xy * param0.xy + vec2(0.58, 0.5)) * param0.zw - param1.xy, param1.zw) );\n  vec4 texture0g = texture2D(tex0, min(floor(interp_uvs.xy * param0.xy + vec2(0.5, 0.48)) * param0.zw - param1.xy, param1.zw) );\n  vec4 texture0b = texture2D(tex0, min(floor(interp_uvs.xy * param0.xy + vec2(0.42, 0.5)) * param0.zw - param1.xy, param1.zw) );\n  gl_FragColor = vec4(texture0r.r, texture0g.g, texture0b.b, 1);\n}\n"}};function getShader(key){var elem=shader_data[key];if(!elem.shader){elem.shader=shaders.create(gl.FRAGMENT_SHADER,elem.fp)}return elem.shader}var GlovTransition=function GlovTransition(z,func){this.z=z;this.capture=null;this.func=func;this.accum_time=0};function transitionCapture(trans){assert(!trans.capture);trans.capture=textures.createForCapture();glov_engine.captureFramebuffer(trans.capture)}function queue(z,fn){var immediate=false;if(z===IMMEDIATE){immediate=true;z=Z.TRANSITION_FINAL}for(var ii=0;ii<transitions.length;++ii){var _trans=transitions[ii];if(_trans.z===z){assert(_trans.capture);if(!_trans.capture){return false}}}var trans=new GlovTransition(z,fn);transitions.push(trans);if(immediate){transitionCapture(trans)}return true}function destroyTexture(tex){tex.destroy()}function render(dt){dt=min(dt,100);for(var trans_idx=0;trans_idx<transitions.length;++trans_idx){var trans=transitions[trans_idx];trans.accum_time+=dt;if(!trans.capture){sprites.queuefn(trans.z+Z.TRANSITION_RANGE,transitionCapture.bind(null,trans))}else if(trans.capture){var force_end=trans_idx<transitions.length-1;var ret=trans.func(trans.z,trans.capture,trans.accum_time,force_end);if(ret===REMOVE){setTimeout(destroyTexture.bind(null,trans.capture),0);transitions.splice(trans_idx,1);trans_idx--}}}}function glovTransitionFadeFunc(fade_time,z,initial,ms_since_start,force_end){var progress=min(ms_since_start/fade_time,1);var alpha=1-easeOut(progress,2);var color=vec4(1,1,1,alpha);camera2d.setNormalized();sprites.queueraw4([initial],0,0,0,1,1,1,1,0,z,0,1,1,0,color);if(force_end||progress===1){return REMOVE}return CONTINUE}function glovTransitionSplitScreenFunc(time,border_width,slide_window,z,tex,ms_since_start,force_end){var border_color=vec4(1,1,1,1);var progress=easeOut(min(ms_since_start/time,1),2);camera2d.setNormalized();var uvs=[[0,1],[1,0]];var xoffs=progress;var v_half=uvs[0][1]+(uvs[1][1]-uvs[0][1])/2;if(slide_window){sprites.queueraw([tex],0,0,z,1-xoffs,1/2,0,uvs[0][1],uvs[1][0]*(1-progress),v_half,unit_vec);sprites.queueraw([tex],0+xoffs,1/2,z,1-xoffs,1/2,uvs[1][0]*progress,v_half,uvs[1][0],uvs[1][1],unit_vec)}else{sprites.queueraw([tex],0-xoffs,0,z,1,1/2,uvs[0][0],uvs[0][1],uvs[1][0],v_half,unit_vec);sprites.queueraw([tex],0+xoffs,1/2,z,1,1/2,uvs[0][0],v_half,uvs[1][0],uvs[1][1],unit_vec)}var border_grow_progress=min(progress*4,1);border_color[3]=border_grow_progress;border_width*=border_grow_progress;glov_ui.drawRect(0,.5-border_width,1-xoffs,.5,z+1,border_color);glov_ui.drawRect(1-xoffs-border_width,0,1-xoffs,.5,z+1,border_color);glov_ui.drawRect(xoffs,.5,1,.5+border_width,z+1,border_color);glov_ui.drawRect(xoffs,.5,xoffs+border_width,1,z+1,border_color);if(force_end||progress===1){return REMOVE}return CONTINUE}var render_scale=1;var transition_pixelate_texture=void 0;function transitionPixelateCapture(){if(!transition_pixelate_texture){transition_pixelate_texture=textures.createForCapture()}glov_engine.captureFramebuffer(transition_pixelate_texture)}function glovTransitionPixelateFunc(time,z,tex,ms_since_start,force_end){var gd_width=glov_engine.width;var progress=min(ms_since_start/time,1);camera2d.setNormalized();if(progress>.5){sprites.queuefn(z,transitionPixelateCapture);if(transition_pixelate_texture){tex=transition_pixelate_texture}}var partial_progress=(progress>.5?1-progress:progress)*2;var pixel_scale=pow(2,floor(partial_progress*8.9))/1024*gd_width*render_scale;var param0=vec4(tex.width/pixel_scale,tex.height/pixel_scale,pixel_scale/tex.width,pixel_scale/tex.height);var param1=vec4(.5/tex.width,.5/tex.height,(tex.texSizeX-1)/tex.width,(tex.texSizeY-1)/tex.height);sprites.queueraw([tex],0,0,z+1,1,1,0,1,1,0,unit_vec,getShader("transition_pixelate"),{param0:param0,param1:param1});if(force_end||progress===1){setTimeout(destroyTexture.bind(null,transition_pixelate_texture),0);transition_pixelate_texture=null;return REMOVE}return CONTINUE}function fade(fade_time){return glovTransitionFadeFunc.bind(null,fade_time)}function splitScreen(time,border_width,slide_window){border_width/=camera2d.w();return glovTransitionSplitScreenFunc.bind(null,time,border_width,slide_window)}function pixelate(fade_time){return glovTransitionPixelateFunc.bind(null,fade_time)}function randomTransition(fade_time_scale){fade_time_scale=fade_time_scale||1;var idx=floor(random()*3);switch(idx){case 0:return fade(500*fade_time_scale);case 1:return splitScreen(250*fade_time_scale,2,false);case 2:return pixelate(750*fade_time_scale);default:assert(0)}return null}},{"../../common/util.js":34,"./camera2d.js":9,"./engine.js":12,"./shaders.js":19,"./sprites.js":21,"./textures.js":23,"./ui.js":25,"./vmath.js":26,assert:32}],25:[function(require,module,exports){"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};exports.focuslog=focuslog;exports.makeColorSet=makeColorSet;exports.startup=startup;exports.getElem=getElem;exports.bindSounds=bindSounds;exports.drawHBox=drawHBox;exports.drawBox=drawBox;exports.playUISound=playUISound;exports.setMouseOver=setMouseOver;exports.focusSteal=focusSteal;exports.focusCanvas=focusCanvas;exports.isFocusedPeek=isFocusedPeek;exports.isFocused=isFocused;exports.focusNext=focusNext;exports.focusPrev=focusPrev;exports.focusCheck=focusCheck;exports.panel=panel;exports.drawTooltip=drawTooltip;exports.buttonShared=buttonShared;exports.buttonTextDraw=buttonTextDraw;exports.buttonText=buttonText;exports.buttonImage=buttonImage;exports.print=print;exports.modalDialog=modalDialog;exports.createEditBox=createEditBox;exports.tick=tick;exports.endFrame=endFrame;exports.menuUp=menuUp;exports.drawRect=drawRect;exports.drawCircle=drawCircle;exports.drawHollowCircle=drawHollowCircle;exports.drawLine=drawLine;exports.drawCone=drawCone;exports.scaleSizes=scaleSizes;exports.setFontHeight=setFontHeight;window.Z=window.Z||{};Z.BORDERS=Z.BORDERS||90;Z.UI=Z.UI||100;Z.MODAL=Z.MODAL||1e3;Z.TOOLTIP=Z.TOOLTIP||2e3;Z.DEBUG=Z.DEBUG||9800;Z.TRANSITION_FINAL=Z.TRANSITION_FINAL||9900;Z.TRANSITION_RANGE=Z.TRANSITION_RANGE||10;Z.FPSMETER=Z.FPSMETER||1e4;var assert=require("assert");var camera2d=require("./camera2d.js");var glov_edit_box=require("./edit_box.js");var effects=require("./effects.js");var glov_engine=require("./engine.js");var glov_font=require("./font.js");var glov_input=require("./input.js");var abs=Math.abs,max=Math.max,min=Math.min,round=Math.round,sqrt=Math.sqrt;var glov_sprites=require("./sprites.js");var textures=require("./textures.js");var _require=require("../../common/util.js"),clone=_require.clone,merge=_require.merge;var _require2=require("./mat43.js"),mat43=_require2.mat43,m43identity=_require2.m43identity,m43mul=_require2.m43mul;var _require3=require("./vmath.js"),clamp=_require3.clamp,lerp=_require3.lerp,vec2=_require3.vec2,vec4=_require3.vec4,v4scale=_require3.v4scale;var MODAL_DARKEN=.75;var KEYS=void 0;var pad_codes=void 0;var menu_fade_params_default={blur:[.125,.865],saturation:[.5,.1],brightness:[1,1-MODAL_DARKEN],fallback_darken:vec4(0,0,0,MODAL_DARKEN),z:Z.MODAL};function focuslog(){}function makeColorSet(color){var ret={regular:vec4(),rollover:vec4(),down:vec4(),disabled:vec4()};v4scale(ret.regular,color,1);v4scale(ret.rollover,color,.8);v4scale(ret.down,color,.7);v4scale(ret.disabled,color,.4);for(var field in ret){ret[field][3]=color[3]}return ret}function doBlurEffect(factor,params){factor=lerp(factor,params.blur[0],params.blur[1]);if(factor){effects.applyGaussianBlur({source:glov_engine.captureFramebuffer(),blur:factor})}}var desaturate_xform=mat43();var desaturate_tmp=mat43();function doDesaturateEffect(factor,params){var saturation=lerp(factor,params.saturation[0],params.saturation[1]);var brightness=lerp(factor,params.brightness[0],params.brightness[1]);if(saturation===1&&brightness===1){return}m43identity(desaturate_xform);effects.saturationMatrix(desaturate_tmp,saturation);m43mul(desaturate_xform,desaturate_xform,desaturate_tmp);effects.brightnessScaleMatrix(desaturate_tmp,brightness);m43mul(desaturate_xform,desaturate_xform,desaturate_tmp);effects.applyColorMatrix({colorMatrix:desaturate_xform,source:glov_engine.captureFramebuffer()})}var button_height=exports.button_height=32;var font_height=exports.font_height=24;var button_width=exports.button_width=200;var button_img_size=exports.button_img_size=button_height;var modal_width=exports.modal_width=600;var modal_y0=exports.modal_y0=200;var modal_title_scale=exports.modal_title_scale=1.2;var pad=exports.pad=16;var panel_pixel_scale=exports.panel_pixel_scale=32/13;var tooltip_width=exports.tooltip_width=400;var tooltip_pad=exports.tooltip_pad=8;var font_style_focused=exports.font_style_focused=glov_font.style(null,{color:255,outline_width:2,outline_color:4294967295});var font_style_normal=exports.font_style_normal=glov_font.styleColored(null,255);var font=exports.font=void 0;var sprites=exports.sprites={};var color_button=exports.color_button=makeColorSet([1,1,1,1]);var color_panel=exports.color_panel=vec4(1,1,.75,1);var modal_font_style=exports.modal_font_style=glov_font.styleColored(null,255);var sounds={};var button_mouseover=exports.button_mouseover=false;var button_focused=exports.button_focused=false;var touch_changed_focus=exports.touch_changed_focus=false;var last_frame_button_mouseover=false;var frame_button_mouseover=false;var modal_dialog=null;var modal_stealing_focus=false;var menu_up=exports.menu_up=false;var menu_fade_params=merge({},menu_fade_params_default);var menu_up_time=0;exports.this_frame_edit_boxes=[];var last_frame_edit_boxes=[];var dom_elems=[];var dom_elems_issued=0;var button_keys=void 0;var focused_last_frame=void 0;var focused_this_frame=void 0;var focused_key_not=void 0;var focused_key=void 0;var focused_key_prev1=void 0;var focused_key_prev2=void 0;function startup(_font,ui_sprites){ui_sprites=ui_sprites||{};exports.font=font=_font;KEYS=glov_input.KEYS;pad_codes=glov_input.pad_codes;function loadUISprite(name,ws,hs,only_override){var override=ui_sprites[name];if(override){sprites[name]=glov_sprites.create({name:override[0],ws:override[1],hs:override[2]})}else if(!only_override){sprites[name]=glov_sprites.create({name:"ui/"+name,ws:ws,hs:hs})}}loadUISprite("button",[4,5,4],[13]);sprites.button_regular=sprites.button;loadUISprite("button_rollover",[4,5,4],[13],true);loadUISprite("button_down",[4,5,4],[13]);loadUISprite("button_disabled",[4,5,4],[13]);loadUISprite("panel",[3,2,3],[3,10,3]);loadUISprite("menu_entry",[4,5,4],[13]);loadUISprite("menu_selected",[4,5,4],[13]);loadUISprite("menu_down",[4,5,4],[13]);loadUISprite("menu_header",[4,5,12],[13]);sprites.white=glov_sprites.create({url:"white"});button_keys={ok:{key:[],pad:[pad_codes.X]},cancel:{key:[KEYS.ESC],pad:[pad_codes.B,pad_codes.Y]}};button_keys.yes=clone(button_keys.ok);button_keys.yes.key.push(KEYS.Y);button_keys.no=clone(button_keys.cancel);button_keys.no.key.push(KEYS.N)}var dynamic_text_elem=void 0;function getElem(){if(modal_dialog){return null}if(dom_elems_issued>=dom_elems.length){var _elem=document.createElement("div");_elem.setAttribute("class","glovui_dynamic");if(!dynamic_text_elem){dynamic_text_elem=document.getElementById("dynamic_text")}dynamic_text_elem.appendChild(_elem);dom_elems.push(_elem)}var elem=dom_elems[dom_elems_issued];dom_elems_issued++;return elem}var sound_manager=void 0;function bindSounds(_sound_manager,_sounds){sound_manager=_sound_manager;sounds=_sounds;for(var key in sounds){sound_manager.loadSound(sounds[key])}}function drawHBox(coords,s,color){var uidata=s.uidata;var ws=[uidata.wh[0]*coords.h,0,uidata.wh[2]*coords.h];var x=coords.x;ws[1]=max(0,coords.w-ws[0]-ws[2]);for(var ii=0;ii<ws.length;++ii){var my_w=ws[ii];s.draw({x:x,y:coords.y,z:coords.z,color:color,w:my_w,h:coords.h,uvs:uidata.rects[ii]});x+=my_w}}function drawBox(coords,s,pixel_scale,color){var uidata=s.uidata;var scale=pixel_scale;var ws=[uidata.widths[0]*scale,0,uidata.widths[2]*scale];ws[1]=max(0,coords.w-ws[0]-ws[2]);var hs=[uidata.heights[0]*scale,0,uidata.heights[2]*scale];hs[1]=max(0,coords.h-hs[0]-hs[2]);var x=coords.x;for(var ii=0;ii<ws.length;++ii){var my_w=ws[ii];if(my_w){var y=coords.y;for(var jj=0;jj<hs.length;++jj){var my_h=hs[jj];if(my_h){s.draw({x:x,y:y,z:coords.z,color:color,w:my_w,h:my_h,uvs:uidata.rects[jj*3+ii]});y+=my_h}}x+=my_w}}}function playUISound(name){if(name==="select"){name="button_click"}if(sounds[name]&&sound_manager){sound_manager.play(sounds[name])}}function setMouseOver(key){if(last_frame_button_mouseover!==key&&frame_button_mouseover!==key){playUISound("rollover")}frame_button_mouseover=key;exports.button_mouseover=button_mouseover=true}function focusSteal(key){if(key!==focused_key){focuslog("focusSteal ",key)}focused_this_frame=true;focused_key=key}function focusCanvas(){focusSteal("canvas")}function isFocusedPeek(key){return focused_key===key}function isFocused(key){if(key!==focused_key_prev2){focused_key_prev1=focused_key_prev2;focused_key_prev2=key}if(key===focused_key||key!==focused_key_not&&!focused_this_frame&&!focused_last_frame){if(key!==focused_key){focuslog("isFocused->focusSteal")}focusSteal(key);return true}return false}function focusNext(key){focuslog("focusNext ",key);playUISound("rollover");focused_key=null;focused_last_frame=focused_this_frame=false;focused_key_not=key;glov_input.eatAllInput()}function focusPrev(key){focuslog("focusPrev ",key);playUISound("rollover");if(key===focused_key_prev2){focusSteal(focused_key_prev1)}else{focusSteal(focused_key_prev2)}glov_input.eatAllInput()}function focusCheck(key){if(modal_stealing_focus){return false}var focused=isFocused(key);if(focused){if(glov_input.keyDownEdge(KEYS.TAB)){if(glov_input.keyDown(KEYS.SHIFT)){focusPrev(key)}else{focusNext(key);focused=false}}if(glov_input.padButtonDownEdge(pad_codes.RIGHT_BUMPER)){focusNext(key);focused=false}if(glov_input.padButtonDownEdge(pad_codes.LEFT_BUMPER)){focusPrev(key)}}return focused}function panel(param){assert(typeof param.x==="number");assert(typeof param.y==="number");assert(typeof param.w==="number");assert(typeof param.h==="number");param.z=param.z||Z.UI-1;var color=param.color||color_panel;drawBox(param,sprites.panel,panel_pixel_scale,color);glov_input.click(param);glov_input.mouseOver(param)}function drawTooltip(param){assert(typeof param.x==="number");assert(typeof param.y==="number");assert(typeof param.tooltip==="string");var tooltip_w=param.tooltip_width||tooltip_width;var x=param.x;if(x+tooltip_w>camera2d.x1()){x=camera2d.x1()-tooltip_w}var z=param.z||Z.TOOLTIP;var tooltip_y0=param.y;var eff_tooltip_pad=param.tooltip_pad||tooltip_pad;var y=tooltip_y0+eff_tooltip_pad;y+=font.drawSizedWrapped(modal_font_style,x+eff_tooltip_pad,y,z+1,tooltip_w-eff_tooltip_pad*2,0,font_height,param.tooltip);y+=eff_tooltip_pad;panel({x:x,y:tooltip_y0,z:z,w:tooltip_w,h:y-tooltip_y0})}function buttonShared(param){var state="regular";var ret=false;var key=param.key||param.x+"_"+param.y;var focused=!param.disabled&&!param.no_focus&&focusCheck(key);exports.button_mouseover=button_mouseover=false;if(param.disabled){glov_input.mouseOver(param);state="disabled"}else if(glov_input.click(param)){if(!param.no_touch_mouseover||!glov_input.mousePosIsTouch()){setMouseOver(key)}if(param.touch_twice&&glov_input.mousePosIsTouch()&&!focused){exports.touch_changed_focus=touch_changed_focus=true}else{ret=true}if(!param.no_focus){focusSteal(key);focused=true}}else if(glov_input.mouseOver(param)){if(param.no_touch_mouseover&&glov_input.mousePosIsTouch()){}else if(param.touch_twice&&!focused&&glov_input.mousePosIsTouch()){}else{setMouseOver(key);state=glov_input.mouseDown()?"down":"rollover"}}exports.button_focused=button_focused=focused;if(focused){if(glov_input.keyDownEdge(KEYS.SPACE)||glov_input.keyDownEdge(KEYS.RETURN)||glov_input.padButtonDownEdge(pad_codes.A)){ret=true}}if(ret){state="down";playUISound("button_click")}if(button_mouseover&&param.tooltip){drawTooltip({x:param.x,y:param.tooltip_above?param.y-font_height*2-16:param.y+param.h+2,tooltip:param.tooltip,tooltip_width:param.tooltip_width})}return{ret:ret,state:state,focused:focused}}function buttonTextDraw(param,state,focused){var colors=param.colors||color_button;var color=colors[state];var sprite_name="button_"+state;var sprite=sprites[sprite_name];if(sprite){color=colors.regular}else{sprite=sprites.button}drawHBox(param,sprite,color);font.drawSizedAligned(focused?font_style_focused:font_style_normal,param.x,param.y,param.z+.1,param.font_height,glov_font.ALIGN.HCENTERFIT|glov_font.ALIGN.VCENTER,param.w,param.h,param.text)}function buttonText(param){assert(typeof param.x==="number");assert(typeof param.y==="number");assert(typeof param.text==="string");param.z=param.z||Z.UI;param.w=param.w||button_width;param.h=param.h||button_height;param.font_height=param.font_height||font_height;var _buttonShared=buttonShared(param),ret=_buttonShared.ret,state=_buttonShared.state,focused=_buttonShared.focused;buttonTextDraw(param,state,focused);return ret}function buttonImage(param){assert(typeof param.x==="number");assert(typeof param.y==="number");assert(param.img&&param.img.draw);param.z=param.z||Z.UI;param.w=param.w||button_img_size;param.h=param.h||param.w||button_img_size;param.shrink=param.shrink||.75;var uvs=param.img_rect||(typeof param.frame==="number"?param.img.uidata.rects[param.frame]:null);var _buttonShared2=buttonShared(param),ret=_buttonShared2.ret,state=_buttonShared2.state;var colors=param.colors||color_button;var color=colors[state];drawHBox(param,sprites.button,color);var img_w=param.img.size[0];var img_h=param.img.size[1];var img_origin=param.img.origin;var img_scale=min(param.w*param.shrink/img_w,param.h*param.shrink/img_h);img_w*=img_scale;img_h*=img_scale;var draw_param={x:param.x+(param.w-img_w)/2+img_origin[0]*img_w,y:param.y+(param.h-img_h)/2+img_origin[1]*img_h,z:param.z+.1,color:color,color1:param.color1,w:img_scale,h:img_scale,uvs:uvs,rot:param.rotation};if(param.color1){param.img.drawDualTint(draw_param)}else{param.img.draw(draw_param)}return ret}function print(style,x,y,z,text){return font.drawSized(style,x,y,z,font_height,text)}function modalDialog(params){assert(!params.title||typeof params.title==="string");assert(!params.text||typeof params.text==="string");assert(_typeof(params.buttons)==="object");assert(Object.keys(params.buttons).length);modal_dialog=params}function modalDialogRun(){var eff_button_width=modal_dialog.button_width||round(button_width/2);var game_width=camera2d.x1()-camera2d.x0();var text_w=modal_width-pad*2;var x0=camera2d.x0()+round((game_width-modal_width)/2);var x=x0+pad;var y0=modal_y0;var y=y0+pad;var eff_font_height=modal_dialog.font_height||font_height;if(modal_dialog.title){y+=font.drawSizedWrapped(modal_font_style,x,y,Z.MODAL,text_w,0,eff_font_height*modal_title_scale,modal_dialog.title);y+=round(pad*1.5)}if(modal_dialog.text){y+=font.drawSizedWrapped(modal_font_style,x,y,Z.MODAL,text_w,0,eff_font_height,modal_dialog.text);y+=pad}var buttons=modal_dialog.buttons;var keys=Object.keys(buttons);x=x0+modal_width-pad-eff_button_width-(pad+eff_button_width)*(keys.length-1);for(var ii=0;ii<keys.length;++ii){var key=keys[ii];var eff_button_keys=button_keys[key.toLowerCase()];var pressed=false;if(eff_button_keys){for(var jj=0;jj<eff_button_keys.key.length;++jj){pressed=pressed||glov_input.keyDownEdge(eff_button_keys.key[jj])}for(var _jj=0;_jj<eff_button_keys.pad.length;++_jj){pressed=pressed||glov_input.padButtonDownEdge(eff_button_keys.pad[_jj])}}if(pressed){playUISound("button_click")}if(buttonText({x:x,y:y,z:Z.MODAL,w:eff_button_width,h:button_height,text:key})||pressed){modal_dialog=null;if(buttons[key]){buttons[key]()}}x+=pad+eff_button_width}y+=button_height;y+=pad*2;panel({x:x0,y:y0,z:Z.MODAL-1,w:modal_width,h:y-y0});glov_input.eatAllInput();modal_stealing_focus=true}function createEditBox(params){return glov_edit_box.create(params)}var bad_frames=0;function tick(dt){last_frame_button_mouseover=frame_button_mouseover;frame_button_mouseover=false;focused_last_frame=focused_this_frame;focused_this_frame=false;focused_key_not=null;modal_stealing_focus=false;exports.touch_changed_focus=touch_changed_focus=false;for(var ii=0;ii<last_frame_edit_boxes.length;++ii){var edit_box=last_frame_edit_boxes[ii];var idx=exports.this_frame_edit_boxes.indexOf(edit_box);if(idx===-1){edit_box.unrun()}}last_frame_edit_boxes=exports.this_frame_edit_boxes;exports.this_frame_edit_boxes=[];while(dom_elems_issued<dom_elems.length){var elem=dom_elems.pop();dynamic_text_elem.removeChild(elem)}dom_elems_issued=0;var pp_this_frame=false;if(modal_dialog||menu_up){var params=menu_fade_params;if(!menu_up){params=menu_fade_params_default}menu_up_time+=dt;if(glov_engine.postprocessing){var factor=min(menu_up_time/500,1);glov_sprites.queuefn(params.z-2,doBlurEffect.bind(null,factor,params));glov_sprites.queuefn(params.z-1,doDesaturateEffect.bind(null,factor,params));pp_this_frame=true}else{sprites.white.draw({x:camera2d.x0(),y:camera2d.y0(),z:params.z-2,color:params.fallback_darken,w:camera2d.x1()-camera2d.x0(),h:camera2d.y1()-camera2d.y0()})}}else{menu_up_time=0}exports.menu_up=menu_up=false;if(!glov_engine.is_loading&&glov_engine.this_frame_time>250&&pp_this_frame){bad_frames++;if(bad_frames>=3){glov_engine.postprocessingAllow(false)}}else if(bad_frames){bad_frames=0}if(modal_dialog){modalDialogRun()}}function endFrame(){if(glov_input.click({x:-Infinity,y:-Infinity,w:Infinity,h:Infinity})){focusSteal("canvas")}}function menuUp(params){merge(menu_fade_params,menu_fade_params_default);if(params){merge(menu_fade_params,params)}exports.menu_up=menu_up=true;modal_stealing_focus=true;glov_input.eatAllInput()}function drawRect(x0,y0,x1,y1,z,color){var mx=min(x0,x1);var my=min(y0,y1);var Mx=max(x0,x1);var My=max(y0,y1);sprites.white.draw({x:mx,y:my,z:z,color:color,w:Mx-mx,h:My-my})}function spreadTechParams(spread){spread=min(max(spread,0),.99);var tech_params={param0:vec4(0,0,0,0)};tech_params.param0[0]=1/(1-spread);tech_params.param0[1]=-.5*tech_params.param0[0]+.5;return tech_params}function drawCircleInternal(sprite,x,y,z,r,spread,tu1,tv1,tu2,tv2,color){var x0=x-r*2+r*4*tu1;var x1=x-r*2+r*4*tu2;var y0=y-r*2+r*4*tv1;var y1=y-r*2+r*4*tv2;glov_sprites.queueraw(sprite.texs,x0,y0,z,x1-x0,y1-y0,tu1,tv1,tu2,tv2,color,glov_font.font_shaders.font_aa,spreadTechParams(spread))}function drawCircle(x,y,z,r,spread,color){if(!sprites.circle){var CIRCLE_SIZE=32;var data=new Uint8Array(CIRCLE_SIZE*CIRCLE_SIZE);var midp=(CIRCLE_SIZE-1)/2;for(var i=0;i<CIRCLE_SIZE;i++){for(var j=0;j<CIRCLE_SIZE;j++){var d=sqrt((i-midp)*(i-midp)+(j-midp)*(j-midp))/midp;var v=clamp(1-d,0,1);data[i+j*CIRCLE_SIZE]=v*255}}sprites.circle=glov_sprites.create({url:"circle",width:CIRCLE_SIZE,height:CIRCLE_SIZE,format:textures.format.R8,data:data,filter_min:gl.LINEAR,filter_max:gl.LINEAR,wrap_s:gl.CLAMP_TO_EDGE,wrap_t:gl.CLAMP_TO_EDGE,origin:vec2(.5,.5)})}drawCircleInternal(sprites.circle,x,y,z,r,spread,0,0,1,1,color)}function drawHollowCircle(x,y,z,r,spread,color){if(!sprites.hollow_circle){var CIRCLE_SIZE=128;var LINE_W=2;var data=new Uint8Array(CIRCLE_SIZE*CIRCLE_SIZE);var midp=(CIRCLE_SIZE-1)/2;for(var i=0;i<CIRCLE_SIZE;i++){for(var j=0;j<CIRCLE_SIZE;j++){var d=sqrt((i-midp)*(i-midp)+(j-midp)*(j-midp))/midp;var v=clamp(1-d,0,1);if(v>.5){v=1-v}v+=LINE_W/CIRCLE_SIZE;data[i+j*CIRCLE_SIZE]=v*255}}sprites.hollow_circle=glov_sprites.create({url:"hollow_circle",width:CIRCLE_SIZE,height:CIRCLE_SIZE,format:textures.format.R8,data:data,filter_min:gl.LINEAR,filter_max:gl.LINEAR,wrap_s:gl.CLAMP_TO_EDGE,wrap_t:gl.CLAMP_TO_EDGE,origin:vec2(.5,.5)})}drawCircleInternal(sprites.hollow_circle,x,y,z,r,spread,0,0,1,1,color)}function drawLine(x0,y0,x1,y1,z,w,spread,color){if(!sprites.line){var LINE_SIZE=32;var data=new Uint8Array(LINE_SIZE*LINE_SIZE);var midp=(LINE_SIZE-1)/2;for(var i=0;i<LINE_SIZE;i++){for(var j=0;j<LINE_SIZE;j++){var d=abs((i-midp)/midp);var v=clamp(1-d,0,1);data[i+j*LINE_SIZE]=v*255}}sprites.line=glov_sprites.create({url:"line",width:LINE_SIZE,height:LINE_SIZE,format:textures.format.R8,data:data,filter_min:gl.LINEAR,filter_max:gl.LINEAR,wrap_s:gl.CLAMP_TO_EDGE,wrap_t:gl.CLAMP_TO_EDGE,origin:vec2(.5,.5)})}var dx=x1-x0;var dy=y1-y0;var length=Math.sqrt(dx*dx+dy*dy);dx/=length;dy/=length;var tangx=-dy*w;var tangy=dx*w;glov_sprites.queueraw4(sprites.line.texs,x0+tangx,y0+tangy,x1+tangx,y1+tangy,x1-tangx,y1-tangy,x0-tangx,y0-tangy,z,0,0,1,1,color,glov_font.font_shaders.font_aa,spreadTechParams(spread))}function drawCone(x0,y0,x1,y1,z,w0,w1,spread,color){if(!sprites.cone){var CONE_SIZE=32;var data=new Uint8Array(CONE_SIZE*CONE_SIZE);var midp=(CONE_SIZE-1)/2;for(var i=0;i<CONE_SIZE;i++){for(var j=0;j<CONE_SIZE;j++){var _dx=0;var _dy=0;var d=0;if(i>midp){_dx=(i-midp)/midp;_dy=abs(j-midp)/midp;var dCircle=sqrt(_dx*_dx+_dy*_dy);d=_dx*dCircle}var v=clamp(1-d,0,1);data[i+j*CONE_SIZE]=v*255}}sprites.cone=glov_sprites.create({url:"cone",width:CONE_SIZE,height:CONE_SIZE,format:textures.format.R8,data:data,filter_min:gl.LINEAR,filter_max:gl.LINEAR,wrap_s:gl.CLAMP_TO_EDGE,wrap_t:gl.CLAMP_TO_EDGE,origin:vec2(.5,.5)})}var dx=x1-x0;var dy=y1-y0;var length=Math.sqrt(dx*dx+dy*dy);dx/=length;dy/=length;var tangx=-dy;var tangy=dx;glov_sprites.queueraw4(sprites.cone.texs,x0-tangx*w0,y0-tangy*w0,x0+tangx*w0,y0+tangy*w0,x1+tangx*w1,y1+tangy*w1,x1-tangx*w1,y1-tangy*w1,z,0,0,1,1,color,glov_font.font_shaders.font_aa,spreadTechParams(spread))}function scaleSizes(scale){exports.button_height=button_height=round(32*scale);exports.font_height=font_height=round(24*scale);exports.button_width=button_width=round(200*scale);exports.button_img_size=button_img_size=button_height;exports.modal_width=modal_width=round(600*scale);exports.modal_y0=modal_y0=round(200*scale);exports.modal_title_scale=modal_title_scale=1.2;exports.pad=pad=round(16*scale);exports.tooltip_width=tooltip_width=round(400*scale);exports.tooltip_pad=tooltip_pad=round(8*scale);exports.panel_pixel_scale=panel_pixel_scale=button_height/13}function setFontHeight(_font_height){exports.font_height=font_height=_font_height}scaleSizes(1)},{"../../common/util.js":34,"./camera2d.js":9,"./edit_box.js":10,"./effects.js":11,"./engine.js":12,"./font.js":13,"./input.js":15,"./mat43.js":17,"./sprites.js":21,"./textures.js":23,"./vmath.js":26,assert:32}],26:[function(require,module,exports){"use strict";exports.clamp=clamp;exports.lerp=lerp;exports.isPowerOfTwo=isPowerOfTwo;exports.nextHighestPowerOfTwo=nextHighestPowerOfTwo;exports.vec2=vec2;exports.vec3=vec3;exports.vec4=vec4;exports.v2abs=v2abs;exports.v2add=v2add;exports.v2addScale=v2addScale;exports.v2copy=v2copy;exports.v2distSq=v2distSq;exports.v2lengthSq=v2lengthSq;exports.v2lerp=v2lerp;exports.v2mul=v2mul;exports.v2normalize=v2normalize;exports.v2scale=v2scale;exports.v2set=v2set;exports.v2sub=v2sub;exports.v3add=v3add;exports.v3addScale=v3addScale;exports.v3copy=v3copy;exports.v3cross=v3cross;exports.v3determinant=v3determinant;exports.v3dot=v3dot;exports.v3distSq=v3distSq;exports.v3div=v3div;exports.v3floor=v3floor;exports.v3lengthSq=v3lengthSq;exports.v3mulMat4=v3mulMat4;exports.v3normalize=v3normalize;exports.v3scale=v3scale;exports.v3sub=v3sub;exports.v3zero=v3zero;exports.v4clone=v4clone;exports.v4copy=v4copy;exports.v4lerp=v4lerp;exports.v4mul=v4mul;exports.v4mulAdd=v4mulAdd;exports.v4scale=v4scale;exports.v4set=v4set;exports.v4zero=v4zero;exports.mat3=require("gl-mat3/create");exports.mat4=require("gl-mat4/create");var abs=Math.abs,floor=Math.floor,max=Math.max,min=Math.min,sqrt=Math.sqrt;function clamp(a,mn,mx){return max(mn,min(mx,a))}function lerp(a,v0,v1){return(1-a)*v0+a*v1}function isPowerOfTwo(n){return(n&n-1)===0}function nextHighestPowerOfTwo(x){--x;for(var i=1;i<32;i<<=1){x|=x>>i}return x+1}function vec2(a,b){var r=new Float32Array(2);if(a||b){r[0]=a;r[1]=b}return r}function vec3(a,b,c){var r=new Float32Array(3);if(a||b||c){r[0]=a;r[1]=b;r[2]=c}return r}function vec4(a,b,c,d){var r=new Float32Array(4);if(a||b||c||d){r[0]=a;r[1]=b;r[2]=c;r[3]=d}return r}var unit_vec=exports.unit_vec=vec4(1,1,1,1);var zero_vec=exports.zero_vec=vec4();var identity_mat3=exports.identity_mat3=exports.mat3();var identity_mat4=exports.identity_mat4=exports.mat4();var xaxis=exports.xaxis=vec4(1,0,0,0);var yaxis=exports.yaxis=vec4(0,1,0,0);var zaxis=exports.zaxis=vec4(0,0,1,0);function v2abs(out,a){out[0]=abs(a[0]);out[1]=abs(a[1]);return out}function v2add(out,a,b){out[0]=a[0]+b[0];out[1]=a[1]+b[1];return out}function v2addScale(out,a,b,s){out[0]=a[0]+b[0]*s;out[1]=a[1]+b[1]*s;return out}function v2copy(out,a){out[0]=a[0];out[1]=a[1];return out}function v2distSq(a,b){return(a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1])}function v2lengthSq(a){return a[0]*a[0]+a[1]*a[1]}function v2lerp(out,t,a,b){var it=1-t;out[0]=it*a[0]+t*b[0];out[1]=it*a[1]+t*b[1];return out}function v2mul(out,a,b){out[0]=a[0]*b[0];out[1]=a[1]*b[1];return out}function v2normalize(out,a){var len=a[0]*a[0]+a[1]*a[1];if(len>0){len=1/sqrt(len);out[0]=a[0]*len;out[1]=a[1]*len}return out}function v2scale(out,a,s){out[0]=a[0]*s;out[1]=a[1]*s;return out}function v2set(out,a,b){out[0]=a;out[1]=b;return out}function v2sub(out,a,b){out[0]=a[0]-b[0];out[1]=a[1]-b[1];return out}function v3add(out,a,b){out[0]=a[0]+b[0];out[1]=a[1]+b[1];out[2]=a[2]+b[2];return out}function v3addScale(out,a,b,s){out[0]=a[0]+b[0]*s;out[1]=a[1]+b[1]*s;out[2]=a[2]+b[2]*s;return out}function v3copy(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];return out}function v3cross(out,a,b){var a0=a[0];var a1=a[1];var a2=a[2];var b0=b[0];var b1=b[1];var b2=b[2];out[0]=a1*b2-a2*b1;out[1]=a2*b0-a0*b2;out[2]=a0*b1-a1*b0;return out}function v3determinant(a,b,c){var a00=a[0];var a01=b[0];var a02=c[0];var a10=a[1];var a11=b[1];var a12=c[1];var a20=a[2];var a21=b[2];var a22=c[2];return a00*(a22*a11-a12*a21)+a01*(-a22*a10+a12*a20)+a02*(a21*a10-a11*a20)}function v3dot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function v3distSq(a,b){return(a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1])+(a[2]-b[2])*(a[2]-b[2])}function v3div(out,a,b){out[0]=a[0]/b[0];out[1]=a[1]/b[1];out[2]=a[2]/b[2];return out}function v3floor(out,a){out[0]=floor(a[0]);out[1]=floor(a[1]);out[2]=floor(a[2]);return out}function v3lengthSq(a){return a[0]*a[0]+a[1]*a[1]+a[2]*a[2]}function v3mulMat4(out,a,m){var x=a[0];var y=a[1];var z=a[2];out[0]=x*m[0]+y*m[4]+z*m[8];out[1]=x*m[1]+y*m[5]+z*m[9];out[2]=x*m[2]+y*m[6]+z*m[10];return out}function v3normalize(out,a){var len=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];if(len>0){len=1/sqrt(len);out[0]=a[0]*len;out[1]=a[1]*len;out[2]=a[2]*len}return out}function v3scale(out,a,s){out[0]=a[0]*s;out[1]=a[1]*s;out[2]=a[2]*s;return out}function v3sub(out,a,b){out[0]=a[0]-b[0];out[1]=a[1]-b[1];out[2]=a[2]-b[2];return out}function v3zero(out){out[0]=out[1]=out[2]=0;return out}function v4clone(a){return a.slice(0)}function v4copy(out,a){out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];return out}function v4lerp(out,t,a,b){var it=1-t;out[0]=it*a[0]+t*b[0];out[1]=it*a[1]+t*b[1];out[2]=it*a[2]+t*b[2];out[3]=it*a[3]+t*b[3];return out}function v4mul(out,a,b){out[0]=a[0]*b[0];out[1]=a[1]*b[1];out[2]=a[2]*b[2];out[3]=a[3]*b[3];return out}function v4mulAdd(out,a,b,c){out[0]=a[0]*b[0]+c[0];out[1]=a[1]*b[1]+c[1];out[2]=a[2]*b[2]+c[2];out[3]=a[3]*b[3]+c[3];return out}function v4scale(out,a,s){out[0]=a[0]*s;out[1]=a[1]*s;out[2]=a[2]*s;out[3]=a[3]*s;return out}function v4set(out,a,b,c,d){out[0]=a;out[1]=b;out[2]=c;out[3]=d;return out}function v4zero(out){out[0]=out[1]=out[2]=out[3]=0;return out}},{"gl-mat3/create":1,"gl-mat4/create":4}],27:[function(require,module,exports){module.exports={font_size:8,imageW:128,imageH:128,spread:2,noFilter:1,channels:1,char_infos:[{c:32,x0:61,y0:63,xpad:3,w:1,h:1},{c:33,x0:92,y0:2,yoffs:1,xpad:1,w:1,h:5},{c:34,x0:16,y0:63,yoffs:1,xpad:1,w:3,h:2},{c:35,x0:98,y0:2,yoffs:1,xpad:1,w:5,h:5},{c:36,x0:38,y0:2,yoffs:1,xpad:1,w:4,h:6},{c:37,x0:108,y0:2,yoffs:1,xpad:1,w:5,h:5},{c:38,x0:118,y0:2,yoffs:1,xpad:1,w:5,h:5},{c:39,x0:24,y0:63,yoffs:1,xpad:1,w:1,h:2},{c:40,x0:2,y0:14,yoffs:1,xpad:1,w:2,h:5},{c:41,x0:9,y0:14,yoffs:1,xpad:1,w:2,h:5},{c:42,x0:109,y0:54,yoffs:1,xpad:1,w:3,h:3},{c:43,x0:117,y0:54,yoffs:2,xpad:1,w:3,h:3},{c:44,x0:30,y0:63,yoffs:5,xpad:1,w:2,h:2},{c:45,x0:67,y0:63,yoffs:3,xpad:1,w:3,h:1},{c:46,x0:75,y0:63,yoffs:5,xpad:1,w:1,h:1},{c:47,x0:16,y0:14,yoffs:1,xpad:1,w:5,h:5},{c:48,x0:26,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:49,x0:35,y0:14,yoffs:1,xpad:1,w:2,h:5},{c:50,x0:42,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:51,x0:51,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:52,x0:60,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:53,x0:69,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:54,x0:78,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:55,x0:87,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:56,x0:96,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:57,x0:105,y0:14,yoffs:1,xpad:1,w:4,h:5},{c:58,x0:2,y0:63,yoffs:2,xpad:1,w:1,h:3},{c:59,x0:115,y0:44,yoffs:2,xpad:1,w:1,h:4},{c:60,x0:114,y0:14,yoffs:1,xpad:1,w:3,h:5},{c:61,x0:8,y0:63,yoffs:2,xpad:1,w:3,h:3},{c:62,x0:122,y0:14,yoffs:1,xpad:1,w:3,h:5},{c:63,x0:2,y0:24,yoffs:1,xpad:1,w:4,h:5},{c:64,x0:11,y0:24,yoffs:1,xpad:1,w:5,h:5},{c:65,x0:21,y0:24,yoffs:1,xpad:1,w:4,h:5},{c:66,x0:30,y0:24,yoffs:1,xpad:1,w:4,h:5},{c:67,x0:39,y0:24,yoffs:1,xpad:1,w:3,h:5},{c:68,x0:47,y0:24,yoffs:1,xpad:1,w:4,h:5},{c:69,x0:56,y0:24,yoffs:1,xpad:1,w:3,h:5},{c:70,x0:64,y0:24,yoffs:1,xpad:1,w:3,h:5},{c:71,x0:72,y0:24,yoffs:1,xpad:1,w:4,h:5},{c:72,x0:81,y0:24,yoffs:1,xpad:1,w:4,h:5},{c:73,x0:90,y0:24,yoffs:1,xpad:1,w:3,h:5},{c:74,x0:98,y0:24,yoffs:1,xpad:1,w:4,h:5},{c:75,x0:107,y0:24,yoffs:1,xpad:1,w:4,h:5},{c:76,x0:116,y0:24,yoffs:1,xpad:1,w:3,h:5},{c:77,x0:2,y0:34,yoffs:1,xpad:1,w:5,h:5},{c:78,x0:12,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:79,x0:21,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:80,x0:30,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:81,x0:47,y0:2,yoffs:1,xpad:1,w:4,h:6},{c:82,x0:39,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:83,x0:48,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:84,x0:57,y0:34,yoffs:1,xpad:1,w:3,h:5},{c:85,x0:65,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:86,x0:74,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:87,x0:83,y0:34,yoffs:1,xpad:1,w:5,h:5},{c:88,x0:93,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:89,x0:102,y0:34,yoffs:1,xpad:1,w:4,h:5},{c:90,x0:111,y0:34,yoffs:1,xpad:1,w:3,h:5},{c:91,x0:119,y0:34,yoffs:1,xpad:1,w:2,h:5},{c:92,x0:2,y0:44,yoffs:1,xpad:1,w:5,h:5},{c:93,x0:12,y0:44,yoffs:1,xpad:1,w:2,h:5},{c:94,x0:37,y0:63,yoffs:1,xpad:1,w:3,h:2},{c:95,x0:81,y0:63,yoffs:5,xpad:1,w:4,h:1},{c:96,x0:45,y0:63,yoffs:1,xpad:1,w:2,h:2},{c:97,x0:121,y0:44,yoffs:2,xpad:1,w:4,h:4},{c:98,x0:19,y0:44,yoffs:1,xpad:1,w:4,h:5},{c:99,x0:2,y0:54,yoffs:2,xpad:1,w:3,h:4},{c:100,x0:28,y0:44,yoffs:1,xpad:1,w:4,h:5},{c:101,x0:10,y0:54,yoffs:2,xpad:1,w:4,h:4},{c:102,x0:37,y0:44,yoffs:1,xpad:1,w:3,h:5},{c:103,x0:56,y0:2,yoffs:2,xpad:1,w:4,h:6},{c:104,x0:45,y0:44,yoffs:1,xpad:1,w:4,h:5},{c:105,x0:54,y0:44,yoffs:1,xpad:1,w:1,h:5},{c:106,x0:2,y0:2,yoffs:1,xpad:1,w:2,h:7},{c:107,x0:60,y0:44,yoffs:1,xpad:1,w:4,h:5},{c:108,x0:69,y0:44,yoffs:1,xpad:1,w:1,h:5},{c:109,x0:19,y0:54,yoffs:2,xpad:1,w:5,h:4},{c:110,x0:29,y0:54,yoffs:2,xpad:1,w:4,h:4},{c:111,x0:38,y0:54,yoffs:2,xpad:1,w:4,h:4},{c:112,x0:65,y0:2,yoffs:2,xpad:1,w:4,h:6},{c:113,x0:74,y0:2,yoffs:2,xpad:1,w:4,h:6},{c:114,x0:47,y0:54,yoffs:2,xpad:1,w:3,h:4},{c:115,x0:55,y0:54,yoffs:2,xpad:1,w:4,h:4},{c:116,x0:75,y0:44,yoffs:1,xpad:1,w:3,h:5},{c:117,x0:64,y0:54,yoffs:2,xpad:1,w:4,h:4},{c:118,x0:73,y0:54,yoffs:2,xpad:1,w:4,h:4},{c:119,x0:82,y0:54,yoffs:2,xpad:1,w:5,h:4},{c:120,x0:92,y0:54,yoffs:2,xpad:1,w:3,h:4},{c:121,x0:83,y0:2,yoffs:2,xpad:1,w:4,h:6},{c:122,x0:100,y0:54,yoffs:2,xpad:1,w:4,h:4},{c:123,x0:83,y0:44,yoffs:1,xpad:1,w:3,h:5},{c:124,x0:91,y0:44,yoffs:1,xpad:1,w:1,h:5},{c:125,x0:97,y0:44,yoffs:1,xpad:1,w:3,h:5},{c:126,x0:52,y0:63,yoffs:1,xpad:1,w:4,h:2},{c:160,x0:90,y0:63,xpad:3,w:1,h:1},{c:65533,x0:105,y0:44,yoffs:2,xpad:1,w:5,h:5},{c:128263,x0:9,y0:2,yoffs:1,xpad:1,w:10,h:7},{c:128264,x0:24,y0:2,yoffs:1,xpad:1,w:9,h:7}]}},{}],28:[function(require,module,exports){module.exports={font_size:16,imageW:1024,imageH:64,spread:2,noFilter:1,channels:1,char_infos:[{c:32,x0:172,y0:21,xpad:7,w:1,h:1},{c:33,x0:137,y0:2,yoffs:3,xpad:2,w:2,h:10},{c:34,x0:81,y0:21,yoffs:3,xpad:2,w:6,h:4},{c:35,x0:144,y0:2,yoffs:3,xpad:2,w:10,h:10},{c:36,x0:59,y0:2,yoffs:3,xpad:2,w:8,h:12},{c:37,x0:159,y0:2,yoffs:3,xpad:2,w:10,h:10},{c:38,x0:174,y0:2,yoffs:3,xpad:2,w:10,h:10},{c:39,x0:92,y0:21,yoffs:3,xpad:2,w:2,h:4},{c:40,x0:189,y0:2,yoffs:3,xpad:2,w:4,h:10},{c:41,x0:198,y0:2,yoffs:3,xpad:2,w:4,h:10},{c:42,x0:41,y0:21,yoffs:3,xpad:2,w:6,h:6},{c:43,x0:52,y0:21,yoffs:5,xpad:2,w:6,h:6},{c:44,x0:99,y0:21,yoffs:11,xpad:2,w:4,h:4},{c:45,x0:141,y0:21,yoffs:7,xpad:2,w:6,h:2},{c:46,x0:152,y0:21,yoffs:11,xpad:2,w:2,h:2},{c:47,x0:207,y0:2,yoffs:3,xpad:2,w:10,h:10},{c:48,x0:222,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:49,x0:235,y0:2,yoffs:3,xpad:2,w:4,h:10},{c:50,x0:244,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:51,x0:257,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:52,x0:270,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:53,x0:283,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:54,x0:296,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:55,x0:309,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:56,x0:322,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:57,x0:335,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:58,x0:63,y0:21,yoffs:5,xpad:2,w:2,h:6},{c:59,x0:877,y0:2,yoffs:5,xpad:2,w:2,h:8},{c:60,x0:348,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:61,x0:70,y0:21,yoffs:5,xpad:2,w:6,h:6},{c:62,x0:359,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:63,x0:370,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:64,x0:383,y0:2,yoffs:3,xpad:2,w:10,h:10},{c:65,x0:398,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:66,x0:411,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:67,x0:424,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:68,x0:435,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:69,x0:448,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:70,x0:459,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:71,x0:470,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:72,x0:483,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:73,x0:496,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:74,x0:507,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:75,x0:520,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:76,x0:533,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:77,x0:544,y0:2,yoffs:3,xpad:2,w:10,h:10},{c:78,x0:559,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:79,x0:572,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:80,x0:585,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:81,x0:72,y0:2,yoffs:3,xpad:2,w:8,h:12},{c:82,x0:598,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:83,x0:611,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:84,x0:624,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:85,x0:635,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:86,x0:648,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:87,x0:661,y0:2,yoffs:3,xpad:2,w:10,h:10},{c:88,x0:676,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:89,x0:689,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:90,x0:702,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:91,x0:713,y0:2,yoffs:3,xpad:2,w:4,h:10},{c:92,x0:722,y0:2,yoffs:3,xpad:2,w:10,h:10},{c:93,x0:737,y0:2,yoffs:3,xpad:2,w:4,h:10},{c:94,x0:108,y0:21,yoffs:3,xpad:2,w:6,h:4},{c:95,x0:159,y0:21,yoffs:11,xpad:2,w:8,h:2},{c:96,x0:119,y0:21,yoffs:3,xpad:2,w:4,h:4},{c:97,x0:884,y0:2,yoffs:5,xpad:2,w:8,h:8},{c:98,x0:746,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:99,x0:897,y0:2,yoffs:5,xpad:2,w:6,h:8},{c:100,x0:759,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:101,x0:908,y0:2,yoffs:5,xpad:2,w:8,h:8},{c:102,x0:772,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:103,x0:85,y0:2,yoffs:5,xpad:2,w:8,h:12},{c:104,x0:783,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:105,x0:796,y0:2,yoffs:3,xpad:2,w:2,h:10},{c:106,x0:2,y0:2,yoffs:3,xpad:2,w:4,h:14},{c:107,x0:803,y0:2,yoffs:3,xpad:2,w:8,h:10},{c:108,x0:816,y0:2,yoffs:3,xpad:2,w:2,h:10},{c:109,x0:921,y0:2,yoffs:5,xpad:2,w:10,h:8},{c:110,x0:936,y0:2,yoffs:5,xpad:2,w:8,h:8},{c:111,x0:949,y0:2,yoffs:5,xpad:2,w:8,h:8},{c:112,x0:98,y0:2,yoffs:5,xpad:2,w:8,h:12},{c:113,x0:111,y0:2,yoffs:5,xpad:2,w:8,h:12},{c:114,x0:962,y0:2,yoffs:5,xpad:2,w:6,h:8},{c:115,x0:973,y0:2,yoffs:5,xpad:2,w:8,h:8},{c:116,x0:823,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:117,x0:986,y0:2,yoffs:5,xpad:2,w:8,h:8},{c:118,x0:999,y0:2,yoffs:5,xpad:2,w:8,h:8},{c:119,x0:2,y0:21,yoffs:5,xpad:2,w:10,h:8},{c:120,x0:17,y0:21,yoffs:5,xpad:2,w:6,h:8},{c:121,x0:124,y0:2,yoffs:5,xpad:2,w:8,h:12},{c:122,x0:28,y0:21,yoffs:5,xpad:2,w:8,h:8},{c:123,x0:834,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:124,x0:845,y0:2,yoffs:3,xpad:2,w:2,h:10},{c:125,x0:852,y0:2,yoffs:3,xpad:2,w:6,h:10},{c:126,x0:128,y0:21,yoffs:3,xpad:2,w:8,h:4},{c:160,x0:178,y0:21,xpad:7,w:1,h:1},{c:65533,x0:863,y0:2,yoffs:3,xpad:1,w:9,h:10},{c:128263,x0:11,y0:2,yoffs:1,xpad:1,w:19,h:14},{c:128264,x0:35,y0:2,yoffs:1,xpad:1,w:19,h:14}]}},{}],29:[function(require,module,exports){module.exports={font_size:32,imageW:1024,imageH:512,spread:8,channels:1,char_infos:[{c:13,x0:37,y0:377,w:1,h:1},{c:32,x0:55,y0:377,xpad:6.10156,w:1,h:1},{c:33,x0:216,y0:228,yoffs:4,xpad:1.13281,w:6,h:22},{c:34,x0:617,y0:345,yoffs:4,w:10,h:8},{c:35,x0:467,y0:307,yoffs:10,w:16,h:17},{c:36,x0:191,y0:8,yoffs:1,xpad:1.32031,w:15,h:29},{c:37,x0:673,y0:147,yoffs:4,xpad:.773438,w:26,h:23},{c:38,x0:716,y0:147,yoffs:4,xpad:.570313,w:20,h:23},{c:39,x0:644,y0:345,yoffs:4,w:5,h:8},{c:40,x0:753,y0:147,yoffs:5,w:8,h:23},{c:41,x0:778,y0:147,yoffs:5,xpad:.890625,w:7,h:23},{c:42,x0:469,y0:345,yoffs:2,w:11,h:11},{c:43,x0:500,y0:307,yoffs:9,xpad:.414063,w:15,h:17},{c:44,x0:666,y0:345,yoffs:22,w:5,h:8},{c:45,x0:993,y0:345,yoffs:16,w:9,h:3},{c:46,x0:897,y0:345,yoffs:22,w:5,h:4},{c:47,x0:802,y0:147,yoffs:4,w:13,h:23},{c:48,x0:239,y0:228,yoffs:5,xpad:.671875,w:17,h:22},{c:49,x0:208,y0:268,yoffs:5,xpad:5.67188,w:12,h:21},{c:50,x0:237,y0:268,yoffs:5,xpad:1.67188,w:16,h:21},{c:51,x0:273,y0:228,yoffs:5,xpad:1.67188,w:16,h:22},{c:52,x0:270,y0:268,yoffs:5,xpad:.671875,w:17,h:21},{c:53,x0:306,y0:228,yoffs:5,xpad:1.67188,w:16,h:22},{c:54,x0:339,y0:228,yoffs:5,xpad:.671875,w:17,h:22},{c:55,x0:304,y0:268,yoffs:5,xpad:1.67188,w:16,h:21},{c:56,x0:373,y0:228,yoffs:5,xpad:.671875,w:17,h:22},{c:57,x0:407,y0:228,yoffs:5,xpad:.671875,w:17,h:22},{c:58,x0:225,y0:345,yoffs:12,w:5,h:14},{c:59,x0:445,y0:307,yoffs:12,w:5,h:18},{c:60,x0:970,y0:307,yoffs:11,xpad:.90625,w:9,h:15},{c:61,x0:585,y0:345,yoffs:14,w:15,h:9},{c:62,x0:996,y0:307,yoffs:11,w:10,h:15},{c:63,x0:441,y0:228,yoffs:4,xpad:.195313,w:12,h:22},{c:64,x0:832,y0:147,yoffs:7,xpad:1.21094,w:23,h:23},{c:65,x0:337,y0:268,yoffs:5,w:19,h:21},{c:66,x0:373,y0:268,yoffs:5,xpad:.882813,w:18,h:21},{c:67,x0:470,y0:228,yoffs:5,xpad:.945313,w:17,h:22},{c:68,x0:408,y0:268,yoffs:5,xpad:1.01563,w:20,h:21},{c:69,x0:445,y0:268,yoffs:5,xpad:.617188,w:16,h:21},{c:70,x0:478,y0:268,yoffs:5,w:15,h:21},{c:71,x0:504,y0:228,yoffs:5,xpad:1.75,w:18,h:22},{c:72,x0:510,y0:268,yoffs:5,xpad:2.53906,w:18,h:21},{c:73,x0:545,y0:268,yoffs:5,xpad:2.54688,w:6,h:21},{c:74,x0:539,y0:228,yoffs:5,xpad:2.75781,w:6,h:22},{c:75,x0:568,y0:268,yoffs:5,w:19,h:21},{c:76,x0:604,y0:268,yoffs:5,w:16,h:21},{c:77,x0:637,y0:268,yoffs:5,xpad:2.27344,w:21,h:21},{c:78,x0:675,y0:268,yoffs:5,xpad:2.74219,w:19,h:21},{c:79,x0:872,y0:147,yoffs:4,xpad:1.22656,w:21,h:23},{c:80,x0:711,y0:268,yoffs:5,xpad:.828125,w:17,h:21},{c:81,x0:910,y0:147,yoffs:4,xpad:1.22656,w:21,h:23},{c:82,x0:745,y0:268,yoffs:5,w:19,h:21},{c:83,x0:948,y0:147,yoffs:4,xpad:1.32031,w:15,h:23},{c:84,x0:781,y0:268,yoffs:5,w:17,h:21},{c:85,x0:562,y0:228,yoffs:5,xpad:2.04688,w:19,h:22},{c:86,x0:815,y0:268,yoffs:5,w:19,h:21},{c:87,x0:851,y0:268,yoffs:5,w:30,h:21},{c:88,x0:598,y0:228,yoffs:5,w:20,h:22},{c:89,x0:898,y0:268,yoffs:5,w:18,h:21},{c:90,x0:933,y0:268,yoffs:5,xpad:.226563,w:17,h:21},{c:91,x0:831,y0:102,yoffs:4,w:9,h:25},{c:92,x0:980,y0:147,yoffs:4,w:13,h:23},{c:93,x0:857,y0:102,yoffs:4,xpad:1.70313,w:7,h:25},{c:94,x0:688,y0:345,yoffs:14,xpad:.1875,w:13,h:8},{c:95,x0:8,y0:377,yoffs:23,xpad:.4375,w:12,h:3},{c:96,x0:798,y0:345,yoffs:3,w:6,h:6},{c:97,x0:532,y0:307,yoffs:10,xpad:1.29688,w:14,h:17},{c:98,x0:8,y0:188,yoffs:4,xpad:.890625,w:16,h:23},{c:99,x0:563,y0:307,yoffs:10,xpad:.273438,w:14,h:17},{c:100,x0:41,y0:188,yoffs:4,xpad:2.07031,w:15,h:23},{c:101,x0:594,y0:307,yoffs:10,xpad:1.04688,w:15,h:17},{c:102,x0:635,y0:228,yoffs:4,w:10,h:22},{c:103,x0:73,y0:188,yoffs:10,xpad:2.07031,w:15,h:23},{c:104,x0:662,y0:228,yoffs:4,xpad:1.10156,w:16,h:22},{c:105,x0:967,y0:268,yoffs:5,xpad:1.34375,w:6,h:21},{c:106,x0:42,y0:56,yoffs:5,xpad:1.07031,w:7,h:28},{c:107,x0:695,y0:228,yoffs:4,xpad:.171875,w:15,h:22},{c:108,x0:727,y0:228,yoffs:4,xpad:1.46875,w:6,h:22},{c:109,x0:836,y0:307,yoffs:10,xpad:1.14063,w:25,h:16},{c:110,x0:878,y0:307,yoffs:10,xpad:2.03906,w:15,h:16},{c:111,x0:626,y0:307,yoffs:10,xpad:.828125,w:16,h:17},{c:112,x0:105,y0:188,yoffs:10,xpad:.890625,w:16,h:23},{c:113,x0:138,y0:188,yoffs:10,xpad:2.07031,w:15,h:23},{c:114,x0:8,y0:345,yoffs:11,xpad:.203125,w:10,h:15},{c:115,x0:659,y0:307,yoffs:10,xpad:.28125,w:13,h:17},{c:116,x0:381,y0:307,yoffs:7,xpad:.234375,w:10,h:20},{c:117,x0:910,y0:307,yoffs:11,xpad:1.64844,w:15,h:16},{c:118,x0:35,y0:345,yoffs:11,w:15,h:15},{c:119,x0:67,y0:345,yoffs:11,w:23,h:15},{c:120,x0:107,y0:345,yoffs:11,w:16,h:15},{c:121,x0:750,y0:228,yoffs:11,w:15,h:22},{c:122,x0:140,y0:345,yoffs:11,xpad:.851563,w:13,h:15},{c:123,x0:782,y0:228,yoffs:6,w:9,h:22},{c:124,x0:170,y0:188,yoffs:4,xpad:2.10156,w:6,h:23},{c:125,x0:808,y0:228,yoffs:6,xpad:.460938,w:8,h:22},{c:126,x0:868,y0:345,yoffs:16,xpad:.3125,w:12,h:5},{c:144,x0:718,y0:345,yoffs:-5,w:14,h:8},{c:160,x0:73,y0:377,xpad:6.10156,w:1,h:1},{c:161,x0:833,y0:228,yoffs:4,xpad:1.13281,w:6,h:22},{c:162,x0:193,y0:188,yoffs:7,xpad:.273438,w:14,h:23},{c:163,x0:990,y0:268,yoffs:5,xpad:.304688,w:14,h:21},{c:164,x0:408,y0:307,yoffs:9,xpad:.328125,w:20,h:20},{c:165,x0:8,y0:307,yoffs:5,w:18,h:21},{c:166,x0:224,y0:188,yoffs:4,xpad:2.10156,w:6,h:23},{c:167,x0:66,y0:56,yoffs:2,xpad:1.25,w:17,h:28},{c:168,x0:919,y0:345,yoffs:4,xpad:.453125,w:9,h:4},{c:169,x0:247,y0:188,yoffs:4,xpad:.625,w:25,h:23},{c:170,x0:375,y0:345,yoffs:4,xpad:.296875,w:10,h:12},{c:171,x0:497,y0:345,yoffs:13,xpad:.140625,w:11,h:11},{c:172,x0:553,y0:345,yoffs:13,xpad:.382813,w:15,h:10},{c:173,x0:91,y0:377,xpad:2.94531,w:1,h:1},{c:174,x0:43,y0:307,yoffs:1,xpad:.3125,w:22,h:21},{c:175,x0:945,y0:345,yoffs:4,w:9,h:4},{c:176,x0:773,y0:345,yoffs:4,w:8,h:7},{c:177,x0:689,y0:307,yoffs:9,w:14,h:17},{c:178,x0:247,y0:345,yoffs:2,xpad:.890625,w:11,h:14},{c:179,x0:942,y0:307,yoffs:2,xpad:1.52344,w:11,h:16},{c:180,x0:821,y0:345,yoffs:3,w:6,h:6},{c:181,x0:856,y0:228,yoffs:11,xpad:1.85938,w:15,h:22},{c:182,x0:82,y0:307,yoffs:5,xpad:.5,w:26,h:21},{c:183,x0:971,y0:345,yoffs:16,w:5,h:4},{c:184,x0:749,y0:345,yoffs:25,xpad:.0703125,w:7,h:8},{c:185,x0:275,y0:345,yoffs:2,xpad:.6875,w:10,h:14},{c:186,x0:402,y0:345,yoffs:4,xpad:.625,w:11,h:12},{c:187,x0:525,y0:345,yoffs:13,xpad:.140625,w:11,h:11},{c:188,x0:223,y0:8,yoffs:2,xpad:.0546875,w:25,h:29},{c:189,x0:100,y0:56,yoffs:2,xpad:1.22656,w:25,h:28},{c:190,x0:265,y0:8,yoffs:2,xpad:.109375,w:26,h:29},{c:191,x0:888,y0:228,yoffs:6,xpad:.09375,w:13,h:22},{c:192,x0:142,y0:56,yoffs:-2,w:19,h:28},{c:193,x0:178,y0:56,yoffs:-2,w:19,h:28},{c:194,x0:214,y0:56,yoffs:-2,w:19,h:28},{c:195,x0:612,y0:102,w:19,h:26},{c:196,x0:216,y0:102,yoffs:-1,w:19,h:27},{c:197,x0:250,y0:56,yoffs:-2,w:19,h:28},{c:198,x0:125,y0:307,yoffs:5,xpad:.28125,w:27,h:21},{c:199,x0:286,y0:56,yoffs:5,xpad:.945313,w:17,h:28},{c:200,x0:320,y0:56,yoffs:-2,xpad:.617188,w:16,h:28},{c:201,x0:353,y0:56,yoffs:-2,xpad:.617188,w:16,h:28},{c:202,x0:386,y0:56,yoffs:-2,xpad:.617188,w:16,h:28},{c:203,x0:252,y0:102,yoffs:-1,xpad:.617188,w:16,h:27},{c:204,x0:419,y0:56,yoffs:-2,xpad:1.54688,w:7,h:28},{c:205,x0:443,y0:56,yoffs:-2,xpad:.546875,w:8,h:28},{c:206,x0:468,y0:56,yoffs:-2,w:11,h:28},{c:207,x0:285,y0:102,yoffs:-1,w:9,h:27},{c:208,x0:169,y0:307,yoffs:5,xpad:1.22656,w:20,h:21},{c:209,x0:648,y0:102,xpad:2.74219,w:19,h:26},{c:210,x0:308,y0:8,yoffs:-2,xpad:1.22656,w:21,h:29},{c:211,x0:346,y0:8,yoffs:-2,xpad:1.22656,w:21,h:29},{c:212,x0:384,y0:8,yoffs:-2,xpad:1.22656,w:21,h:29},{c:213,x0:311,y0:102,xpad:1.22656,w:21,h:27},{c:214,x0:496,y0:56,yoffs:-1,xpad:1.22656,w:21,h:28},{c:215,x0:170,y0:345,yoffs:11,xpad:.359375,w:15,h:15},{c:216,x0:289,y0:188,yoffs:4,xpad:1.22656,w:21,h:23},{c:217,x0:422,y0:8,yoffs:-2,xpad:2.04688,w:19,h:29},{c:218,x0:458,y0:8,yoffs:-2,xpad:2.04688,w:19,h:29},{c:219,x0:494,y0:8,yoffs:-2,xpad:2.04688,w:19,h:29},{c:220,x0:534,y0:56,yoffs:-1,xpad:2.04688,w:19,h:28},{c:221,x0:570,y0:56,yoffs:-2,w:18,h:28},{c:222,x0:206,y0:307,yoffs:5,xpad:1.00781,w:17,h:21},{c:223,x0:240,y0:307,yoffs:5,xpad:1.30469,w:17,h:21},{c:224,x0:973,y0:102,yoffs:3,xpad:1.29688,w:14,h:24},{c:225,x0:8,y0:147,yoffs:3,xpad:1.29688,w:14,h:24},{c:226,x0:39,y0:147,yoffs:3,xpad:1.29688,w:14,h:24},{c:227,x0:327,y0:188,yoffs:4,xpad:1.29688,w:14,h:23},{c:228,x0:358,y0:188,yoffs:4,xpad:1.29688,w:14,h:23},{c:229,x0:881,y0:102,yoffs:2,xpad:1.29688,w:14,h:25},{c:230,x0:720,y0:307,yoffs:10,xpad:.960938,w:24,h:17},{c:231,x0:389,y0:188,yoffs:10,xpad:.273438,w:14,h:23},{c:232,x0:70,y0:147,yoffs:3,xpad:1.04688,w:15,h:24},{c:233,x0:102,y0:147,yoffs:3,xpad:1.04688,w:15,h:24},{c:234,x0:134,y0:147,yoffs:3,xpad:1.04688,w:15,h:24},{c:235,x0:420,y0:188,yoffs:4,xpad:1.04688,w:15,h:23},{c:236,x0:452,y0:188,yoffs:3,xpad:1.34375,w:6,h:23},{c:237,x0:475,y0:188,yoffs:3,w:8,h:23},{c:238,x0:500,y0:188,yoffs:3,w:11,h:23},{c:239,x0:918,y0:228,yoffs:4,w:9,h:22},{c:240,x0:528,y0:188,yoffs:4,xpad:1.53125,w:15,h:23},{c:241,x0:944,y0:228,yoffs:4,xpad:2.03906,w:15,h:22},{c:242,x0:166,y0:147,yoffs:3,xpad:.828125,w:16,h:24},{c:243,x0:199,y0:147,yoffs:3,xpad:.828125,w:16,h:24},{c:244,x0:232,y0:147,yoffs:3,xpad:.828125,w:16,h:24},{c:245,x0:560,y0:188,yoffs:4,xpad:.828125,w:16,h:23},{c:246,x0:593,y0:188,yoffs:4,xpad:.828125,w:16,h:23},{c:247,x0:302,y0:345,yoffs:11,xpad:.453125,w:14,h:14},{c:248,x0:761,y0:307,yoffs:10,xpad:.828125,w:16,h:17},{c:249,x0:265,y0:147,yoffs:3,xpad:1.64844,w:15,h:24},{c:250,x0:297,y0:147,yoffs:3,xpad:1.64844,w:15,h:24},{c:251,x0:329,y0:147,yoffs:3,xpad:1.64844,w:15,h:24},{c:252,x0:626,y0:188,yoffs:4,xpad:1.64844,w:15,h:23},{c:253,x0:40,y0:8,yoffs:3,w:15,h:30},{c:254,x0:530,y0:8,yoffs:4,xpad:.890625,w:16,h:29},{c:255,x0:563,y0:8,yoffs:4,w:15,h:29},{c:256,x0:684,y0:102,w:19,h:26},{c:257,x0:658,y0:188,yoffs:4,xpad:1.29688,w:14,h:23},{c:258,x0:349,y0:102,yoffs:-1,w:19,h:27},{c:259,x0:361,y0:147,yoffs:3,xpad:1.29688,w:14,h:24},{c:260,x0:605,y0:56,yoffs:5,w:21,h:28},{c:261,x0:689,y0:188,yoffs:10,w:16,h:23},{c:262,x0:595,y0:8,yoffs:-2,xpad:.945313,w:17,h:29},{c:263,x0:392,y0:147,yoffs:3,xpad:.273438,w:14,h:24},{c:268,x0:629,y0:8,yoffs:-2,xpad:.945313,w:17,h:29},{c:269,x0:423,y0:147,yoffs:3,xpad:.273438,w:14,h:24},{c:270,x0:643,y0:56,yoffs:-2,xpad:1.01563,w:20,h:28},{c:271,x0:722,y0:188,yoffs:4,w:22,h:23},{c:272,x0:274,y0:307,yoffs:5,xpad:1.22656,w:20,h:21},{c:273,x0:761,y0:188,yoffs:4,xpad:.0703125,w:17,h:23},{c:274,x0:720,y0:102,xpad:.617188,w:16,h:26},{c:275,x0:795,y0:188,yoffs:4,xpad:1.04688,w:15,h:23},{c:278,x0:385,y0:102,yoffs:-1,xpad:.617188,w:16,h:27},{c:279,x0:827,y0:188,yoffs:4,xpad:1.04688,w:15,h:23},{c:280,x0:680,y0:56,yoffs:5,xpad:.617188,w:16,h:28},{c:281,x0:859,y0:188,yoffs:10,xpad:1.04688,w:15,h:23},{c:282,x0:713,y0:56,yoffs:-2,xpad:.617188,w:16,h:28},{c:283,x0:454,y0:147,yoffs:3,xpad:1.04688,w:15,h:24},{c:286,x0:746,y0:56,yoffs:-1,xpad:1.75,w:18,h:28},{c:287,x0:72,y0:8,yoffs:3,xpad:2.07031,w:15,h:30},{c:290,x0:781,y0:56,yoffs:5,xpad:1.75,w:18,h:28},{c:291,x0:8,y0:8,yoffs:2,xpad:2.07031,w:15,h:31},{c:298,x0:753,y0:102,w:9,h:26},{c:299,x0:976,y0:228,yoffs:4,w:9,h:22},{c:302,x0:816,y0:56,yoffs:5,xpad:.546875,w:8,h:28},{c:303,x0:841,y0:56,yoffs:5,w:8,h:28},{c:304,x0:418,y0:102,yoffs:-1,xpad:1.54688,w:7,h:27},{c:305,x0:202,y0:345,yoffs:11,xpad:1.34375,w:6,h:15},{c:310,x0:663,y0:8,yoffs:5,w:19,h:29},{c:311,x0:104,y0:8,yoffs:4,xpad:.171875,w:15,h:30},{c:313,x0:866,y0:56,yoffs:-2,w:16,h:28},{c:314,x0:779,y0:102,w:8,h:26},{c:315,x0:699,y0:8,yoffs:5,w:16,h:29},{c:316,x0:136,y0:8,yoffs:4,xpad:1.46875,w:6,h:30},{c:317,x0:8,y0:268,yoffs:4,w:16,h:22},{c:318,x0:41,y0:268,yoffs:4,w:12,h:22},{c:321,x0:311,y0:307,yoffs:5,xpad:.046875,w:16,h:21},{c:322,x0:70,y0:268,yoffs:4,w:11,h:22},{c:323,x0:899,y0:56,yoffs:-2,xpad:2.74219,w:19,h:28},{c:324,x0:891,y0:188,yoffs:3,xpad:2.03906,w:15,h:23},{c:325,x0:732,y0:8,yoffs:5,xpad:2.74219,w:19,h:29},{c:326,x0:486,y0:147,yoffs:10,xpad:2.03906,w:15,h:24},{c:327,x0:935,y0:56,yoffs:-2,xpad:2.74219,w:19,h:28},{c:328,x0:923,y0:188,yoffs:3,xpad:2.03906,w:15,h:23},{c:332,x0:442,y0:102,xpad:1.22656,w:21,h:27},{c:333,x0:955,y0:188,yoffs:4,xpad:.828125,w:16,h:23},{c:336,x0:768,y0:8,yoffs:-2,xpad:1.22656,w:21,h:29},{c:337,x0:518,y0:147,yoffs:3,xpad:.828125,w:16,h:24},{c:338,x0:98,y0:268,yoffs:5,xpad:.390625,w:29,h:22},{c:339,x0:794,y0:307,yoffs:10,xpad:.65625,w:25,h:17},{c:340,x0:971,y0:56,yoffs:-2,w:19,h:28},{c:341,x0:988,y0:188,yoffs:3,xpad:.203125,w:10,h:23},{c:342,x0:806,y0:8,yoffs:5,w:19,h:29},{c:343,x0:8,y0:228,yoffs:11,xpad:.203125,w:10,h:23},{c:344,x0:8,y0:102,yoffs:-2,w:19,h:28},{c:345,x0:35,y0:228,yoffs:3,xpad:.203125,w:10,h:23},{c:346,x0:842,y0:8,yoffs:-2,xpad:1.32031,w:15,h:29},{c:347,x0:551,y0:147,yoffs:3,xpad:.28125,w:13,h:24},{c:350,x0:874,y0:8,yoffs:4,xpad:1.32031,w:15,h:29},{c:351,x0:62,y0:228,yoffs:10,xpad:.28125,w:13,h:23},{c:352,x0:906,y0:8,yoffs:-2,xpad:1.32031,w:15,h:29},{c:353,x0:581,y0:147,yoffs:3,xpad:.28125,w:13,h:24},{c:354,x0:44,y0:102,yoffs:5,w:17,h:28},{c:355,x0:804,y0:102,yoffs:7,xpad:.234375,w:10,h:26},{c:356,x0:78,y0:102,yoffs:-2,w:17,h:28},{c:357,x0:92,y0:228,yoffs:4,w:15,h:23},{c:362,x0:480,y0:102,xpad:2.04688,w:19,h:27},{c:363,x0:124,y0:228,yoffs:4,xpad:1.64844,w:15,h:23},{c:366,x0:938,y0:8,yoffs:-2,xpad:2.04688,w:19,h:29},{c:367,x0:912,y0:102,yoffs:2,xpad:1.64844,w:15,h:25},{c:368,x0:974,y0:8,yoffs:-2,xpad:2.04688,w:19,h:29},{c:369,x0:611,y0:147,yoffs:3,xpad:1.64844,w:15,h:24},{c:370,x0:112,y0:102,yoffs:5,xpad:2.04688,w:19,h:28},{c:371,x0:144,y0:268,yoffs:11,w:17,h:22},{c:376,x0:516,y0:102,yoffs:-1,w:18,h:27},{c:377,x0:148,y0:102,yoffs:-2,xpad:.226563,w:17,h:28},{c:378,x0:156,y0:228,yoffs:3,xpad:.851563,w:13,h:23},{c:379,x0:551,y0:102,yoffs:-1,xpad:.226563,w:17,h:27},{c:380,x0:178,y0:268,yoffs:4,xpad:.851563,w:13,h:22},{c:381,x0:182,y0:102,yoffs:-2,xpad:.226563,w:17,h:28},{c:382,x0:186,y0:228,yoffs:3,xpad:.851563,w:13,h:23},{c:402,x0:944,y0:102,yoffs:4,w:12,h:25},{c:536,x0:159,y0:8,yoffs:4,xpad:1.32031,w:15,h:30},{c:537,x0:643,y0:147,yoffs:10,xpad:.28125,w:13,h:24},{c:538,x0:8,y0:56,yoffs:5,w:17,h:29},{c:539,x0:585,y0:102,yoffs:7,xpad:.234375,w:10,h:27},{c:8226,x0:844,y0:345,yoffs:13,xpad:.28125,w:7,h:6},{c:8482,x0:430,y0:345,yoffs:5,xpad:.882813,w:22,h:12},{c:8734,x0:333,y0:345,yoffs:11,xpad:.6875,w:25,h:14},{c:65533,x0:344,y0:307,yoffs:5,w:20,h:21}]}},{}],30:[function(require,module,exports){module.exports={font_size:16,imageW:512,imageH:256,spread:4,noFilter:1,channels:1,char_infos:[{c:1,x0:106,y0:50,yoffs:2,xpad:1,w:8,h:10},{c:2,x0:123,y0:50,yoffs:2,xpad:1,w:8,h:10},{c:3,x0:319,y0:108,yoffs:4,xpad:2,w:7,h:8},{c:4,x0:104,y0:126,yoffs:4,xpad:2,w:7,h:7},{c:5,x0:479,y0:89,yoffs:3,xpad:1,w:8,h:9},{c:6,x0:496,y0:89,yoffs:3,xpad:1,w:8,h:9},{c:7,x0:296,y0:143,yoffs:6,xpad:3,w:6,h:4},{c:8,x0:4,y0:4,xpad:1,w:8,h:16},{c:9,x0:4,y0:143,yoffs:5,xpad:2,w:7,h:6},{c:10,x0:21,y0:4,xpad:1,w:8,h:16},{c:11,x0:140,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:12,x0:156,y0:50,yoffs:2,xpad:3,w:6,h:10},{c:13,x0:171,y0:50,yoffs:2,xpad:1,w:8,h:10},{c:14,x0:188,y0:50,yoffs:2,xpad:1,w:8,h:10},{c:15,x0:4,y0:108,yoffs:3,xpad:1,w:8,h:9},{c:16,x0:84,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:17,x0:100,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:18,x0:21,y0:108,yoffs:2,xpad:2,w:7,h:9},{c:19,x0:205,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:20,x0:221,y0:50,yoffs:2,xpad:1,w:8,h:10},{c:21,x0:484,y0:4,yoffs:1,xpad:2,w:7,h:12},{c:22,x0:311,y0:143,yoffs:8,xpad:2,w:7,h:4},{c:23,x0:238,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:24,x0:254,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:25,x0:270,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:26,x0:101,y0:143,yoffs:5,xpad:2,w:7,h:5},{c:27,x0:117,y0:143,yoffs:5,xpad:2,w:7,h:5},{c:28,x0:327,y0:143,yoffs:6,xpad:2,w:7,h:4},{c:29,x0:133,y0:143,yoffs:5,xpad:2,w:7,h:5},{c:30,x0:120,y0:126,yoffs:4,xpad:2,w:7,h:7},{c:31,x0:136,y0:126,yoffs:4,xpad:2,w:7,h:7},{c:32,x0:4,y0:158,xpad:8,w:1,h:1},{c:33,x0:286,y0:50,yoffs:2,xpad:3,w:6,h:10},{c:34,x0:343,y0:143,yoffs:1,xpad:2,w:7,h:4},{c:35,x0:37,y0:108,yoffs:3,xpad:2,w:7,h:9},{c:36,x0:372,y0:4,xpad:2,w:7,h:14},{c:37,x0:335,y0:108,yoffs:4,xpad:2,w:7,h:8},{c:38,x0:301,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:39,x0:359,y0:143,yoffs:1,xpad:5,w:4,h:4},{c:40,x0:317,y0:50,yoffs:2,xpad:3,w:6,h:10},{c:41,x0:332,y0:50,yoffs:2,xpad:3,w:6,h:10},{c:42,x0:149,y0:143,yoffs:5,xpad:1,w:8,h:5},{c:43,x0:166,y0:143,yoffs:5,xpad:2,w:7,h:5},{c:44,x0:372,y0:143,yoffs:9,xpad:4,w:5,h:4},{c:45,x0:14,y0:158,yoffs:7,xpad:2,w:7,h:1},{c:46,x0:466,y0:143,yoffs:10,xpad:4,w:5,h:2},{c:47,x0:351,y0:108,yoffs:4,xpad:2,w:7,h:8},{c:48,x0:347,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:49,x0:363,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:50,x0:379,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:51,x0:395,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:52,x0:411,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:53,x0:427,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:54,x0:443,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:55,x0:459,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:56,x0:475,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:57,x0:491,y0:50,yoffs:2,xpad:2,w:7,h:10},{c:58,x0:152,y0:126,yoffs:4,xpad:4,w:5,h:7},{c:59,x0:367,y0:108,yoffs:4,xpad:4,w:5,h:8},{c:60,x0:53,y0:108,yoffs:3,xpad:2,w:7,h:9},{c:61,x0:386,y0:143,yoffs:5,xpad:2,w:7,h:4},{c:62,x0:69,y0:108,yoffs:3,xpad:2,w:7,h:9},{c:63,x0:4,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:64,x0:85,y0:108,yoffs:3,xpad:2,w:7,h:9},{c:65,x0:20,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:66,x0:36,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:67,x0:52,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:68,x0:68,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:69,x0:84,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:70,x0:100,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:71,x0:116,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:72,x0:132,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:73,x0:148,y0:70,yoffs:2,xpad:3,w:6,h:10},{c:74,x0:163,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:75,x0:179,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:76,x0:195,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:77,x0:211,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:78,x0:227,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:79,x0:243,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:80,x0:259,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:81,x0:500,y0:4,yoffs:2,xpad:2,w:7,h:12},{c:82,x0:275,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:83,x0:291,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:84,x0:307,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:85,x0:323,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:86,x0:339,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:87,x0:355,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:88,x0:371,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:89,x0:387,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:90,x0:403,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:91,x0:419,y0:70,yoffs:2,xpad:3,w:6,h:10},{c:92,x0:101,y0:108,yoffs:3,xpad:2,w:7,h:9},{c:93,x0:434,y0:70,yoffs:2,xpad:3,w:6,h:10},{c:94,x0:402,y0:143,xpad:2,w:7,h:4},{c:95,x0:30,y0:158,yoffs:13,xpad:1,w:8,h:1},{c:96,x0:433,y0:143,yoffs:1,xpad:3,w:6,h:3},{c:97,x0:166,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:98,x0:449,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:99,x0:182,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:100,x0:465,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:101,x0:198,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:102,x0:481,y0:70,yoffs:2,xpad:2,w:7,h:10},{c:103,x0:497,y0:70,yoffs:5,xpad:2,w:7,h:10},{c:104,x0:4,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:105,x0:20,y0:89,yoffs:2,xpad:3,w:6,h:10},{c:106,x0:405,y0:4,yoffs:2,xpad:2,w:7,h:13},{c:107,x0:35,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:108,x0:51,y0:89,yoffs:2,xpad:3,w:6,h:10},{c:109,x0:214,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:110,x0:230,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:111,x0:246,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:112,x0:66,y0:89,yoffs:5,xpad:2,w:7,h:10},{c:113,x0:82,y0:89,yoffs:5,xpad:2,w:7,h:10},{c:114,x0:262,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:115,x0:278,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:116,x0:98,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:117,x0:294,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:118,x0:310,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:119,x0:326,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:120,x0:342,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:121,x0:114,y0:89,yoffs:5,xpad:2,w:7,h:10},{c:122,x0:358,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:123,x0:130,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:124,x0:146,y0:89,yoffs:2,xpad:4,w:5,h:10},{c:125,x0:160,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:126,x0:480,y0:143,yoffs:1,xpad:2,w:7,h:2},{c:127,x0:374,y0:126,yoffs:4,xpad:2,w:7,h:7},{c:160,x0:47,y0:158,xpad:8,w:1,h:1},{c:161,x0:176,y0:89,yoffs:2,xpad:3,w:6,h:10},{c:162,x0:116,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:163,x0:132,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:165,x0:191,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:170,x0:20,y0:143,yoffs:2,xpad:2,w:7,h:6},{c:171,x0:182,y0:143,yoffs:5,xpad:2,w:7,h:5},{c:172,x0:198,y0:143,yoffs:6,xpad:2,w:7,h:5},{c:176,x0:418,y0:143,yoffs:1,xpad:3,w:6,h:4},{c:177,x0:381,y0:108,yoffs:4,xpad:2,w:7,h:8},{c:178,x0:36,y0:143,yoffs:1,xpad:2,w:7,h:6},{c:181,x0:207,y0:89,yoffs:5,xpad:2,w:7,h:10},{c:183,x0:57,y0:158,yoffs:7,xpad:4,w:5,h:1},{c:186,x0:52,y0:143,yoffs:2,xpad:3,w:6,h:6},{c:187,x0:214,y0:143,yoffs:5,xpad:2,w:7,h:5},{c:188,x0:421,y0:4,yoffs:1,xpad:1,w:8,h:13},{c:189,x0:438,y0:4,yoffs:1,xpad:2,w:7,h:13},{c:191,x0:223,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:196,x0:148,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:197,x0:4,y0:29,xpad:2,w:7,h:12},{c:198,x0:20,y0:29,xpad:2,w:7,h:12},{c:199,x0:36,y0:29,yoffs:2,xpad:2,w:7,h:12},{c:201,x0:52,y0:29,xpad:2,w:7,h:12},{c:209,x0:68,y0:29,xpad:2,w:7,h:12},{c:214,x0:164,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:220,x0:180,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:223,x0:239,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:224,x0:196,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:225,x0:212,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:226,x0:228,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:228,x0:255,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:229,x0:244,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:230,x0:390,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:231,x0:117,y0:108,yoffs:5,xpad:2,w:7,h:9},{c:232,x0:260,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:233,x0:276,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:234,x0:292,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:235,x0:271,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:236,x0:308,y0:29,yoffs:1,xpad:3,w:6,h:11},{c:237,x0:323,y0:29,yoffs:1,xpad:3,w:6,h:11},{c:238,x0:338,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:239,x0:287,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:241,x0:303,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:242,x0:354,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:243,x0:370,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:244,x0:386,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:246,x0:319,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:247,x0:230,y0:143,yoffs:5,xpad:2,w:7,h:5},{c:249,x0:402,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:250,x0:418,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:251,x0:434,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:252,x0:335,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:255,x0:454,y0:4,yoffs:2,xpad:2,w:7,h:13},{c:402,x0:450,y0:29,yoffs:1,xpad:1,w:8,h:11},{c:915,x0:351,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:920,x0:367,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:931,x0:383,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:934,x0:399,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:937,x0:415,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:945,x0:406,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:948,x0:431,y0:89,yoffs:2,xpad:2,w:7,h:10},{c:949,x0:447,y0:89,yoffs:2,xpad:3,w:6,h:10},{c:960,x0:422,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:963,x0:438,y0:126,yoffs:5,xpad:2,w:7,h:7},{c:964,x0:397,y0:108,yoffs:4,xpad:2,w:7,h:8},{c:966,x0:133,y0:108,yoffs:3,w:9,h:9},{c:8319,x0:67,y0:143,yoffs:1,xpad:2,w:7,h:6},{c:8359,x0:467,y0:29,yoffs:1,xpad:2,w:7,h:11},{c:8729,x0:496,y0:143,yoffs:7,xpad:4,w:5,h:2},{c:8730,x0:483,y0:29,yoffs:1,xpad:1,w:8,h:11},{c:8734,x0:246,y0:143,yoffs:5,w:9,h:5},{c:8745,x0:151,y0:108,yoffs:3,xpad:2,w:7,h:9},{c:8776,x0:264,y0:143,yoffs:5,xpad:2,w:7,h:5},{c:8801,x0:454,y0:126,yoffs:4,xpad:2,w:7,h:7},{c:8804,x0:167,y0:108,yoffs:3,xpad:2,w:7,h:9},{c:8805,x0:183,y0:108,yoffs:3,xpad:2,w:7,h:9},{c:8976,x0:280,y0:143,yoffs:6,xpad:2,w:7,h:5},{c:8992,x0:388,y0:4,yoffs:2,xpad:1,w:8,h:14},{c:8993,x0:470,y0:4,xpad:4,w:5,h:13},{c:9472,x0:71,y0:158,yoffs:7,w:9,h:1},{c:9474,x0:38,y0:4,xpad:4,w:5,h:16},{c:9484,x0:199,y0:108,yoffs:7,w:9,h:9},{c:9488,x0:217,y0:108,yoffs:7,xpad:4,w:5,h:9},{c:9492,x0:413,y0:108,w:9,h:8},{c:9496,x0:431,y0:108,xpad:4,w:5,h:8},{c:9500,x0:52,y0:4,w:9,h:16},{c:9508,x0:70,y0:4,xpad:4,w:5,h:16},{c:9516,x0:231,y0:108,yoffs:7,w:9,h:9},{c:9524,x0:445,y0:108,w:9,h:8},{c:9532,x0:84,y0:4,w:9,h:16},{c:9552,x0:448,y0:143,yoffs:5,w:9,h:3},{c:9553,x0:102,y0:4,xpad:2,w:7,h:16},{c:9554,x0:4,y0:50,yoffs:5,w:9,h:11},{c:9555,x0:249,y0:108,yoffs:7,w:9,h:9},{c:9556,x0:22,y0:50,yoffs:5,w:9,h:11},{c:9557,x0:40,y0:50,yoffs:5,xpad:4,w:5,h:11},{c:9558,x0:267,y0:108,yoffs:7,xpad:2,w:7,h:9},{c:9559,x0:54,y0:50,yoffs:5,xpad:2,w:7,h:11},{c:9560,x0:463,y0:108,w:9,h:8},{c:9561,x0:481,y0:108,w:9,h:8},{c:9562,x0:4,y0:126,w:9,h:8},{c:9563,x0:22,y0:126,xpad:4,w:5,h:8},{c:9564,x0:36,y0:126,xpad:2,w:7,h:8},{c:9565,x0:52,y0:126,xpad:2,w:7,h:8},{c:9566,x0:118,y0:4,w:9,h:16},{c:9567,x0:136,y0:4,w:9,h:16},{c:9568,x0:154,y0:4,w:9,h:16},{c:9569,x0:172,y0:4,xpad:4,w:5,h:16},{c:9570,x0:186,y0:4,xpad:2,w:7,h:16},{c:9571,x0:202,y0:4,xpad:2,w:7,h:16},{c:9572,x0:70,y0:50,yoffs:5,w:9,h:11},{c:9573,x0:283,y0:108,yoffs:7,w:9,h:9},{c:9574,x0:88,y0:50,yoffs:5,w:9,h:11},{c:9575,x0:83,y0:143,yoffs:2,w:9,h:6},{c:9576,x0:68,y0:126,w:9,h:8},{c:9577,x0:86,y0:126,w:9,h:8},{c:9578,x0:218,y0:4,w:9,h:16},{c:9579,x0:236,y0:4,w:9,h:16},{c:9580,x0:254,y0:4,w:9,h:16},{c:9600,x0:470,y0:126,w:9,h:7},{c:9604,x0:301,y0:108,yoffs:7,w:9,h:9},{c:9608,x0:272,y0:4,w:9,h:16},{c:9612,x0:290,y0:4,xpad:5,w:4,h:16},{c:9616,x0:303,y0:4,w:9,h:16},{c:9617,x0:321,y0:4,xpad:1,w:8,h:16},{c:9618,x0:338,y0:4,xpad:1,w:8,h:16},{c:9619,x0:355,y0:4,xpad:1,w:8,h:16},{c:9632,x0:488,y0:126,yoffs:4,xpad:2,w:7,h:7},{c:65533,x0:462,y0:89,yoffs:3,xpad:1,w:8,h:10}]}},{}],31:[function(require,module,exports){"use strict";exports.main=main;var glov_engine=require("./glov/engine.js");var glov_input=require("./glov/input.js");var glov_local_storage=require("./glov/local_storage.js");var glov_sprites=require("./glov/sprites.js");var glov_terminal=require("./glov/terminal.js");var glov_ui=require("./glov/ui.js");var floor=Math.floor,random=Math.random,min=Math.min;var _require=require("./glov/vmath.js"),vec2=_require.vec2,vec4=_require.vec4,v4clone=_require.v4clone;glov_local_storage.storage_prefix="glovjs-playground";window.Z=window.Z||{};Z.BACKGROUND=0;Z.SPRITES=10;Z.PARTICLES=20;Z.UI_TEST=200;var game_width=exports.game_width=720;var game_height=exports.game_height=400;var sprites=exports.sprites={};var ansi_files=["[?7h[40m[2J[4C[0;1;34mWelcome to[38C[33mSy[0;33mso[1mp:\r\n[50C[34mJi[0;34mm  Ess[1mer\r\n[0;34m     \r\n            \r\n        \r\n            \r\n           \r\n[1;36m [0;36m [1m [0;36m [1m    [0;36m    [1m [0;36m [1m [0;36m   [1m [0;36m\r\n [1m  [0;36m     [1m   [0;36m   [1m    [0;36m    [1m   [0;36m[6C[1m   [0;36m   [1m [0;36m\r\n [1m  [0;36m     [1m   [0;36m [1m [0;36m [1m [0;36m   [1m   [0;36m [1m   [0;36m\r\n [1m [32m[0;32m    [1m[0;32m [1m[0;32m [1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[6C[1m[0;32m [1m[0;32m   [1m[0;32m[1m[0;32m\r\n [1;36m [32m[0;32m    [1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[5C[1m[0;32m[1m[0;32m[1m[0;32m  [1m[0;32m[1m[0;32m[1m[0;32m[13;1H[1;36m[32m[0;32m [1m[0;32m [1m[0;32m[1m[0;32m[1m[0;32m   [1m[0;32m   [1m[0;32m  [1m[0;32m[5C[1m[0;32m[1m[0;32m[1m[0;32m [1m[0;32m[1m[0;32m  [1m[0;32m[14;1H   [1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m   [1m[0;32m   [1m[0;32m  [1m[0;32m[5C[1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m[1m[0;32m  [1m[0;32m[15;1H   [1m[0;32m[1m[0;32m[1m[0;32m  [1m[0;32m[1m[0;32m   [1m[0;32m   [1m[0;32m[1m[0;32m[1m[0;32m  [1m[0;32m[1m[0;32m [1m[0;32m[1m[0;32m[16;1H                 \r\n\r\n\r\n[6C[1;33m [52C \r\n[0;33m[1;43m[40m[43m[40m[43m[40m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[43m [40m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m  [0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[21;1H[1m[0;33m[1;43m[0;33m[1;43m[0;33m[43m  [40m[1;43m [0;33m[1;43m [0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[22;1H[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[43m [1m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m   [0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[23;1H[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m     [0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[24;1H[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[43m [40m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[43m [1m[0;33m[1;43m   [0;33m[1;43m[0;33m[1;43m[0;33m[1;43m[0;33m[0m\r\n","[40m[2J[4C[0;1;35mMerchant Cruiser[2H  [0;31m[20C[s\r\n[u[1;37mShip Category [0m#[1m1[3H  [0;31m[1;30m   [0m   [s\r\n[u[1;44m[0m  [1;30m  [37m  [0;31m   [34m[s\r\n[u[4H  [31m[5C[1;37m [34m[31;44m:[40m[s\r\n[u[44m[0;31m:[34m[37m[5C[31m[5C[1;37mThe  [35mMerchant Cruiser[s\r\n[u  [37mis the standard fare for[5H  [0;31m[37m  [1;30m   [s\r\n[u[34;44m[0;34m   [1;30m   [0;31m[5C[1;37mearning a living in t[s\r\n[uhe universe.   These craft[6H  [0;31m  [1;30m   [34m[44m[40m[s\r\n[u[44m[0;34m[37m   [1;30m [0;31m[5C[1;37mare moderately fast, [s\r\n[uwell armored and have hard[7H  [0;31m [1;30m   [34;44m[40m[s\r\n[u[44m[0;34m[6C[31m[5C[1;37mpoints  for  many different accessori[s\r\n[ues.   Many[8H  [0;31m[1;30m    [34m[44m[0;34m   [1;30m.[s\r\n[u[0m[31m[5C[1;37mcartels use the Merchant Cruiser as  their only[9H[s\r\n[u  [0;31m    [1;34m[44m[0;34m   [1;30m.[0;31m[5C[1;37m[s\r\n[uship type.   The Merchant is the craft by which[10H  [0;31m [37m  [s\r\n[u[1;34m[44m[0;34m [1;30m  [0;31m[5C[1;37mcombat specs a[s\r\n[ure rated for a standard.[11H  [0;31m[1;30m   [34m[0;34m [s\r\n[u [1;37m [0;31m   [34m[s\r\n[u[12H  [31m[13H    [1;30m [34m[44m[40m[s\r\n[u[44m[37m[0m[34m   [1;30m[0;31m[14H  [1;30m   [34m[s\r\n[u[30m[5C [0;34m [1;30m  [0;31m[15H  [0m\r\n","[40m[2J[6C[0;34m. [7C. [36m[35m.  [34m [1;30mJohn[s\r\n[u[0;34m.[1;30mDailey Software Presents   [0;34m [1m.[7C[0;34m.\r\n[2;1H[9C[8C.[8C[36m[22C[1;30m.[0;34m  .[10C[1;30m..[0;34m\r\n[3;1H[27C[37m        [47m [40m[47m [40m[34m.[7C. [s\r\n[u. [36m[5C[1;34m.[0;34m. [36m   [34m [1m.[4;1H[8C[0;34m.[s\r\n[u[6C.[6C. [36m[37m[1;33;47m[0m  [34m.[37m[s\r\n[u[1;33;47m[0m  [47m [40m[1;33;47m[0m[34m[13C[1;37m+ [s\r\n[u   [30m.[0;34m  .[5;1H[6C[1;30m [0;34m.[32m[1m[9C[s\r\n[u[0;34m .[37m[1;33;47m[1C[0m[34m[37m [36m[37m[s\r\n[u[1;33;47m[1C[0;34m[37m  [1;33;47m[1C[0m [18C[34m.[s\r\n[u[36m    [1;37m[6;1H   [0;34m. . [1;44m[37m[42m[40m[s\r\n[u[42m[32;43m[40m[0;35m.  [34m[6C[37m   [1;33;47m[40m[s\r\n[u[0m [34m.[37m [34m.[37m[1;33;47m[0m    [s\r\n[u[1;33;47m[0m    [34m. .[9C.[32m[1;42m[37m[40m\r\n[7;1H[6C[0;34m[1;44m[37;42m[34;44m[37m[32m[43m[40m[s\r\n[u[42m[34;44m[9C[33;47m[0m  [1;33m  [47m[0m   [s\r\n[u[1;33m  [47m[0m [1;30m.[0;34m[37m[1;33m   [0;36m[35m.[s\r\n[u  [34m[7C[32m[33;42m [1;37m[8;1H[6C[0;34m[s\r\n[u[32;44m[1;43m[37;42m[32m[34;44m[37m[42m[34;44m[40m[s\r\n[u[9C[0m[1;33m   [43m[2C[0m[1;33m[0;34m [37m[1;33m[s\r\n[u[43m[2C[0m[1;33m [0m [1;33m[43m[3C[0;34m.   .    [s\r\n[u[1;32;42m[0;33;42m [1;37m[32m[0;33;42m[1;37m[40m\r\n[9;1H[5C[0;34m. [1;44m[37;42m[47m[32;44m[37m[32m[40m[s\r\n[u[34;40m[9C[33m[43m[1C[0m[33m[1;43m[40m  [43m[40m[s\r\n[u[0;34m. [1;33m   [43m[1C[0m[33m[1;43m[40m[10C[0;34m[s\r\n[u[1;44m[32m[0;33;42m[1;37m[0;33;42m[1;32m[40m[s\r\n[u[42m[37m[10;1H[5C[0;34m. [1;44m[37;47m[44m[32m[40m[s\r\n[u[43m[42m[0;32m  [34m[7C[1;33;43m[0;33m[1;43m[40m[s\r\n[u[40m   [43m[0;35m. [37m[34m   [1;33;43m[0;33m[s\r\n[u[1;43m[40m[9C[0;34m[1;44m  [37m[42m  [32m[40m[s\r\n[u[42m[37m[11;1H[10C[0;34m[1;32m[0;32m   [34m.[8C[s\r\n[u[1;33;43m[1C[0m[33m   [1;43m[7C[3C[0;33m[s\r\n[u[1;43m[7C[0;34m[44m [1;32;42m[44m[34m[37m[40m[s\r\n[u[42m[0;33;42m [1;32m[0;33;42m[12;1H[8C[34;40m. .[5C.[s\r\n[u[6C [1;33;43m[0;33m  [34m.[1;33;43m[0;33m[34m. [s\r\n[u[1;33;43m[0;33m  [37m   [34m.[1;33;43m[0;33m [37m [s\r\n[u[1;33;43m[0;33m[1;34m.[0;34m. [36m  [34m[1;44m [40m[s\r\n[u[44m[32m[37;42m[44m[34m[32m[0;33;42m[1;32m[40m[s\r\n[u[42m   [13;1H[7C[0;34m.   [6C. .[5C[33m[37m[33m [s\r\n[u [34m    [33m[37m[33m [1;30m.[0;34m  .[1;44m [40m[s\r\n[u[44m [37;42m[32m[34;44m[32m[34m  [0;33;42m[40m[s\r\n[u[42m[1;32m[34;44m[42m [14;1H[27C[0;33m    .988 [s\r\n[u [34m.[36m [34m. [1;32;44m[34m      [0;33;42m[40m[s\r\n[u[42m[1;32m[0;33;42m[1;32m[34;44m [32m[15;1H[10C[40m[s\r\n[u[0;34m.   .[5C.    [36m[33m[36m[35m. [33m[34m.[33m[s\r\n[u[34m[37m    [34m[33m   [36m   [34m[1;32;42m[40m[s\r\n[u[34;44m  [32m[0;33;42m[1;32m[34;44m[32m[40m[s\r\n[u[0;33;42m[1;32m[34;44m  [16;1H[1C[0;34m[9C.[5C[5C . [s\r\n[u  [33m [34m  [33m   [34m [36m[35m.  [34m [33m[8C[s\r\n[u[1;32;42m[44m[34m [37m[32m[42m [0;33;42m[40m[s\r\n[u[42m[1;32m [34;44m[17;1H[11C[5;30;40m[23C[0;33m[11C[s\r\n[u  [5C[32m[1;42m[44m[34m[37m[34m[32;42m[40m[s\r\n[u[0;33;42m[1;37m[32m[44m[34m[18;1H[3C[0;34m. .   [s\r\n[u [5;37m[6C[0;36m[5C[1;34m.[0;34m. [36m   [34m [1m.[7C[s\r\n[u[0;34m.[15C[33;42m[1;32m[44m[37m[42m[32m[40m[s\r\n[u[0;33;42m[1;32m[37m[32m[0;33;42m[19;1H[1C[40m[s\r\n[u[36;40m[35m. [34m[1m. [5;30m[0;5m[0;1m[0;5m[1;30m  [s\r\n[u[0;34m.        [33mb a r r e[34m.[33mn  r e a[34m.[33ml[36m[s\r\n[u[33mm s[34m[5C.[33;42m[1;32m[34;44m [32m[40m[s\r\n[u[0;33;42m[1;32m[0;33;42m[1;37m[32m[0;33;42m[40m\r\n[20;1H  [34m..[7C[5;37m  [0;1;30m. [0;34m[7C.[36m [33me    l[s\r\n[u[5Ci [34m.   [33mt  [34m.  [33me[8C[42m [1;32m[44m[40m[s\r\n[u[44m[34m[37m [34m[42m [0;33;42m[1;32m[0;33;42m[40m[s\r\n[u[42m[1;32m [0;33;42m[1;32m[0;33;42m[21;1H[1C[40m[s\r\n[u[34;40m.[9C[1;5;30m   [0;36m[20C[34m[19C.   [32m[s\r\n[u[1;44m[34m[37m[34m[42m [32m[0;33;42m[40m[s\r\n[u[1;34;44m[22;1H[6C[30;40mCopyright (c) 1999 John Dailey   Origin[s\r\n[ual game design by Mehul Patel[0m\r\n","[2J[30C[0;33m[16C \r\n[12C[6C[6C    \r\n[10C[22C[11C\r\n[9C [49C\r\n[9C   [6C[32m[6C[1;37mSOMETHING WONDEFUL HAPPENS![C[0;33m[5C\r\n[9C     [32m[1m[0;32m    [1m-=-=-=-=-=-=-=-=-=-=-=-=-=-[2C[0;33m  [5C\r\n[8C     [1;32m[0;32m[31C[33m[9C\r\n[6C   [7C[1;32m[0;32m[30C[33m  [8C\r\n      [16C[1;32m[30C[0;33m   [6C\r\n          [1;31mL[0;31megend [1mO[0;31mf [1mT[0;31mhe [1mR[0;31med [1mD[0;31mragon[1m [32mVersion [37;44m4.00a[32;40m has been   [0;33m        [1;32m[0;32m\r\n [1m[0;32m   [33m   [1;32minstalled on this system.  Take this chance to [3C[0;33m      [1;32m[0;32m\r\n[A[79C[37m [1;32m[0;32m [33m   [1;32mmeet [37mOlivia[32m, the severed head.                    [0;33m     [1;32m[0;32m\r\n[A[79C[1m[0;32m [33m[1;32m[0;33m[4C[1;32m       [36m   [30m    [7C[0;33m[4C[1;30m      [11C[0;33m    [1;32m[0;32m\r\n[1m[0;32m [1m   [0;32m[C[37mHonor[C[1;32m [11C[0;33m   [3C[1;30mDeath[12C[0;33m      [1;32m[0;32m\r\n[A[79C [1m[0;32m[1m[0;32m[C[1;30mMind[32m         [2C[0;33m[7C[3C[37mDespair[1;30m [8C[0;33m[5C[1;32m  [0;32m\r\n[A[79C[37m [32m    [1m[0;32m [1m[0;32m[2C[37mLove[1;35m  [32m [35m [32m [2C[0;33m[32m[1m [0;33m[4C[1;30mQuietus[2C[0m [6C[33m    [32m[1m [0;32m\r\n[8C[4C[1;30mHope[32m [0;33m    [32m[1m[3C[0;34m   [37mThe Dragon[6C[33m   [32m [1m [0;32m\r\n[11C[33m     [32m[1m[7C[0m           [1;31m   [2C[0;33m   [32m[1m\r\n[11C[0;33m [6C[32m[1m[0;33m[5C    [5C[32m[1m\r\n[12C[0;33m[12C[32m[1m[0;33m[6C[6C[8C[32m[1m\r\n[28C[0;32m[1m[26C[0;33m[12C[32m[1m\r\n[29C\r\n[0m\r\n","[0m[1m[0m[1;30m   T h e   [0mI n t [1me l l e c t u[5;30m[0ma l   W a s t e l [1;30ma n d     [0m[1m[0m\r\n[1m[0m[1;30m[0m[1;30m[0m[1m[0m\r\n:[1;30m[0m[26C[34mM a [1mi n  M e [0;34mn u[37m[26C[1;30m[0m[1m[0m\r\n[1m[0m[1;30m[0m[1;30m[0m[1;30m[0m[1m[0m\r\n[1m[0m[1;30m[0m[21C[1;30mW [0mW i [1mV  v 4 . [0m2 4 [1;30ma[0m[16C[1;30m   [0m[1m[0m\r\n[1m [47m  [30m[40m [37;47m  [30m[40m [37;47m  [30m[40m[0m\r\n [1;47m    Messaging Menu[30m     [40m [37;47m  [30m[40m [37;47m   Misc/System Menu [0;30;47m   [1;40m[0m\r\n[1;30m [37;47m [0;34;47m[1mA[0;34;47m[1;37muto[30m-Message [0;30;47m      [1;40m [37;47m    E-Mail Options [30m   [40m [37;47m [0;34;47m[1mO[0;34;47m[1;37mLog [30mOff          [0;30;47m [1;40m[0m\r\n[1;30m [37;47m [0;34;47m[1mS[0;34;47m[1;37mcan[30m Message[0;30;47ms[1m      [40m [37;47m [0;34;47m[1mE[0;34;47m[1;37m-m[30mail a Use[0;30;47mr     [1;40m [37;47m [0;34;47m[1mD[0;34;47m[1;37mefa[30mults Sec[0;30;47mtion   [1;40m[0m\r\n[1;30m [37;47m [0;34;47m[1mP[0;34;47m[1;37most [30ma Messa[0;30;47mge[1m     [40m [37;47m [0;34;47m[1mM[0;34;47m[1;37mai[30mlbox Sca[0;30;47mn      [1;40m [37;47m [0;34;47m[1mL[0;34;47m[1;37mast [30mCallers       [40m[0m\r\n[1;30m [37;47m [0;34;47m[1mQ[0;34;47m[1;37muic[30mk Messag[0;30;47me Scan [1;40m [37;47m [0;34;47m[1mK[0;34;47m[1;37mil[30ml E-Mail [0;30;47mSent  [1;40m [37;47m [0;34;47m[1mX[0;34;47m[1;37mExp[30mert Mode       [40m[0m\r\n[1;30m [37;47m [0;34;47m[1mH[0;34;47m[1;37mop [30mTo Anoth[0;30;47mer Sub[1m [40m [37;47m                     [0;30;47m [1;40m [37;47m [0;34;47m[1mW[0;34;47m[1;37mWIV [30mSlash M[0;30;47menu    [1;40m[0m\r\n[1;30m [37;47m [0;34;47m[1mN[0;34;47m[1;37mew [30mMessage [0;30;47mScan   [1;40m [37;47m  More Messaging Opts[0;30;47m [1;40m [37;47m                       [30;40m[0m\r\n[1;30m [37;47m [0;34;47m[1mR[0;34;47m[1;37memo[30mve a Mes[0;30;47msage   [1;40m [37;47m [0;34;47m[1m*[0;34;47m[1;37mLi[30mst Subs [0;30;47mAvail. [1;40m [37;47m         Games       [0;30;47m  [1;40m[0m\r\n[1;30m [37;47m [0;34;47m[1mZ[0;34;47m[1;37mExp[30mress N-S[0;30;47mcan    [1;40m [37;47m [0;34;47m[1m+[0;30;47m/[1;34m-[0;34;47m[1;30mMove in [0;30;47mSubs   [1;40m [37;47m [0;34;47m[1m.[0;34;47m[1;37mOn-[30mLine Doo[0;30;47mrs     [1;40m[0m\r\n[1;30m [37;47m [0;34;47m[1mF[0;34;47m[1;37meed[30mback to [0;30;47mSysop  [1;40m [37;47m [0;34;47m[1m][0;30;47m/[1;34m[[0;34;47m[1;30mMove in [0;30;47mConfs  [1;40m [37;47m [0;34;47m[1mG[0;34;47m[1;37mSco[30mres Etc        [40m[0m\r\n[1;30m [37;47m  [30m[40m [37;47m                      [30;40m [37;47m  [30m[40m[0m\r\n[1;30m [37m[47m  [30m[40m [37;47m  [30m[40m [37;47m  [30m[40m[0m\r\n",'[1C[0;34m  [1;31mClass M [0;32mplanets have a thick Oxygen/Nitrogen\r\n  [34m   [32matmosphere.  Specific gravity  within 0.7 to\r\n[1;30m [0;32m1.3   Earth  normal.   Random,  but   mostly\r\n[1;30m      [0m[7C.[5C[1m    [30m[5C [0;32mmanageable weather  current  patterns,  with\r\n[1;30m [37m[9C[30m [0;34m[12C[1;30m  [0;32mtemperatures  ranging  from  0 to 40 degrees\r\n[1;30m[9C [0;34m[44m [1m [0;34m[6C[1;30m[5C [0;32mCelsius. Fertile soil, excellent for Organic\r\n[1;30m    [5C[44m [34m       [30;40m[6C[37m   [30m [0;32mproduction.  Mineral deposits, very good for\r\n[1;30m[5C[0m   [34m[1;44m    [0;34m[9C[1;30m [0;32mEquipment production. Chemical elements good\r\n[1;30m[7C [44m  [34m   [40m   [0m[7C[1;30m [0;32mfor Fuel Ore.  Class M planets are excellent\r\n[1;30m   [7C[0;34m[44m  [1m  [40m[7C[30m     [0;32mfor  humanoid  colonization  and  promote an\r\n[1;30m    [0m[7C[1;30m.[0;34m    [1;30m[5C    [0;32mexcellent population growth curve as well as\r\n[1;30m [6C[37m[6C[30m[7C[0m[6C[1m[30m. [0;32ma very  good  population  harmony  quotient.\r\n[1;30m [0;32mThey  have  an above  average  "habitability\r\n  [34m   [32mband".    Drawbacks  include  overpopulation\r\n [34m  [32mproblems, political unrest and human-induced\r\n[35Cdestruction of the BioSphere.[0m\r\n',"[?7h[40m[2J[8C[0;1;30m[47m[37m[0m[1;30;47m[40m[37m [0;33m  [1;30m[47m[0m[1;30;47m[40m\r\n[8C[47m[37m[0m[1;30;47m[40m    [37m [0;33m [37m  [1;30m\r\n[7C[47m[40m[0;34m [37m[1m[47m[40m[0m [34m\r\n[10C[37m[47m  [40m[47m [1m[0m[1;47m[0m[34m\r\n[10C [37m[1;47m[0m[1;30m[0m[1;47m[0m[34m\r\n[10C [1;30m  [0;34m\r\n[11C [1;30m  [0;34m \r\n[12C [1;30m [0;34m\r\n[13C[37m [1;30m[47m[0m[34m\r\n[14C[37m[1;30;47m[1C[0;34m[7C[37m\r\n[16C[34m[37m[1;30;47m[1C[1C[0m[34m[8C[37m\r\n[20C[34m[37m[1;30;47m[40m[47m[43m[47m[0m[34m[7C[37m\r\n  [1;31m\"[37mThere's[13C[0;34m[37m [1;30;47m[40m[47m[43m[10C[0m\r\n[5C[1mnothin' like[9C[30;47m[40m[47m[43m[6C[0m\r\n[7C[1mmetal on bone[8C[30m[47m[43m[0m\r\n[9C[1mto fulfill the[12C[0;33m[1;30;43m[0m[5C[31m \r\n[10C[1;37mbloodlust!![31m\"[17C[30;43m[0m[41m[3C[31;40m[30;41m/[31;40m\r\n[41C[1;30;43m[0m[41m[2C[31;40m[1;37;41m[31m[0;31m\r\n[37C .  [37m[41m[40m [31m \r\n    [1mCONTRATULATIONS on another[6C[0;31m[1;37;41m[0;31m [1;30;47m[0m[41m[1C[31;40m. .\r\n[14C[1;33mV I C T O R Y [31m!!![6C[0;31m [37m[1;30;47m[0;43m[33;40m[31m[33m [31m .\r\n[35C[33m[31;43m[1m[0;31;43m[1m[0;33m\r\n[32C[30;47m=[1;31;40m [0;30;47m=[43m/[31m[33;40m[31;43m[1;37;42m[0;30;43m[33;40m[0m[255D","[?7h[40m[2J[0;30;44m                                                                        [2;1H                                                                              [3;1H                                                                              [4;1H                                                                                [5;1H                                                      [6;1H                                                      [7;1H                                                                [8;1H                                                             [9;1H                                                             [10;1H                                                          [11;1H                                                           [12;1H                                                           [13;1H                                                  [14;1H                                                     [15;1H                                                                          [16;1H              t h e  n t e l l e c t u a l w a s t e l a n d               [17;1H                                                                          [18;1H                                                                                [19;1H                                                                                [20;1H                                                                                [21;1H                                                                               [22;1H                                                                              [23;1H                                                                        [0m\r\n","[40m[2J[3C[0;1;35mTholian Sentinel[2H [0;31m[21C[s\r\n[u[1;37mShip Category [0m# [1m14[3H [0;31m[1;30m   [0m   [34m  [s\r\n[u [37m    [1;30m[0;31m [34m[s\r\n[u[4H [31m [1;37m[5C[34m[37;44m[0m[34m    [s\r\n[u[37m  [31m  [1;37mYoung corporations in need of planetary defense sh[s\r\n[uould[5H [0;31m   [1;30m   [34m[44m [1C[0;34m[5C[37m. [31m [s\r\n[u [1;37mconsider the [35mSentinel[37m.   With its new planetary combat\r\n[6H [0;31m[5C[37m [1;34m[35;44m[0;35m[34m  [37m    [31m  [s\r\n[u[1;37mguidance system, this ship's normal combat odds of 1:1[7H [0;31m[s\r\n[u [1;30m[5C[34m[35;44m[0;35m[34m[37m   [1;30m  [0;31m  [s\r\n[u[1;37mshoot  up  to  4:1  when defending a corporate planet.[8H [0;31m[s\r\n[u  [1;30m.[0m  [1;30m[34m[35;44m[0;35m[34m[7C[31m  [s\r\n[u[1;37mWhen  an  enemy  ship  enters  a  sector  containing a[9H [0;31m[s\r\n[u[5C[44m [1;34;40m[35;44m[0;35m[34m[44m [30m[37;40m   [s\r\n[u[31m  [1;35mSentinel [37mset in defense  of  a  corporate  planet, th[s\r\n[ue[10H [0;31m    [1;34;44m [40m[35;44m[0;35m[34m[s\r\n[u[30;44m[1;34m[2C[30;40m [0;31m  [1;37mhostile vessel must first[s\r\n[u destroy the [35mSentinel [37mand all[11H [0;31m[37m [1;30m [s\r\n[u[34;44m[2C[40m[37m[0m[34m[1;30m. [34;44m[1C[37;40m  [s\r\n[u[0;31m  [1;37mof  its  fighters before  it  may land and attempt any\r\n[12H [0;31m  [1;37maction toward the planet.   Rememb[s\r\n[uer: the [35mSentinel [37mwas[13H [0;31m  [1;30m   [0m[7C[1;30m[s\r\n[u   [0;31m  [1;37mdesigned primarily for planetary defense,  if used f[s\r\n[uor[14H [0;31m[1;30m.  [34;44m[0;34m[1m[37;44m[0m[34m [s\r\n[u[1;44m[1C[30;40m. [0;31m  [1;37moffensive purposes its combat odd[s\r\n[us are 1:1.[15H [0;31m [34m[s\r\n[u[0m\r\n","[?7h[40m[2J[13;41H[0;1;31m[2D[1A[0;35m[14;41H[1;31m[13;39H[1A[0;35m[14;40H[1;31m[3A[0;35m[15;41H[1;31m[13;38H[1A[0;35m[14;39H[1;31m[3A[0;35m [15;40H[1;31m[5A[0;35m[16;41H[1;31m[12;43H[0;35m[6D[14;38H[1;31m[3A[0;35m[15;39H[1;31m[5A[0;35m [16;40H[1;31m[7A[0;35m[17;41H[1;31m[11;43H[0;35m[B[B[1;31m[12;37H[0;35m[1A[15;38H[1;31m[5A[0;35m[16;39H[1;31m[7A[0;35m [17;40H[1;31m[9A[0;35m[18;41H[1;31m[1A[7A[0;35m[B [B[14;45H[1;31m[1A[12D[1A[0;35m[14;36H[1;31m[3A[0;35m[5B[1;31m[7A[0;35m[17;39H[1;31m[9A[0;35m [18;40H[1;31m[11A[0;35m[11B[1;31m[9A[0;35m[17;43H[1;31m[7A[0;35m [B[15;45H[1;31m[1A[1A[14D[1A[0;35m[14;35H[1;31m[3A[0;35m[17;38H[1;31m[9A[0;35m[18;39H[1;31m[11A[0;35m[1A[31m[8;43H[35m[18;43H[1;31m[9A[0;35m [17;44H[1;31m[7A[0;35m[16;45H[1;31m[1A[1A[1A[16D[1A[0;35m[14;34H[1;31m[3A[0;35m [1A[16;36H[1;31m[8;38H[0;35m[1A[1A[31m[1A [B[B[35m[B [18;44H[1;31m[9A[0;35m[17;45H[1;31m[7A[0;35m[16;46H[1;31m[1A[1A[13;32H[B[3A[0;35m[1A [16;35H[1;31m[7A[0;35m[17;36H[1;31m[9A[0;35m[1A[5;40H[31m[1A[B [B[B[35m[B[18;45H[1;31m[9A[0;35m[17;46H[1;31m[7A[0;35m[16;47H[1;31m[1A[13;31H[1A[0;35m[14;32H[1;31m[B[5A[0;35m[16;34H[1;31m[7A[0;35m [17;35H[1;31m[9A[0;35m[1A[5;39H[31m[1A [1A[B[B [B[B[35m[B[18;46H[1;31m[9A[0;35m[17;47H[1;31m[7A[0;35m[16;48H[1;31m[14;50H[1A[22D[1A[0;35m[1A[15;32H[1;31m[B[7A[0;35m[17;34H[1;31m[9A[0;35m [18;35H[1;31m[11A[0;35m[1A[31m[4;39H[1A[C[B [B[7;46H[35m[B[18;47H[1;31m[9A[0;35m [17;48H[1;31m[7A[0;35m[5B[1;31m[3A[0;35m[14;51H[1;31m[1A[24D[1A[0;35m[14;30H[1;31m[3A[0;35m[15;31H[1;31m[B[B[9A[0;35m[18;34H[1;31m[11A[0;35m[1A[31m[1A[1A[1A [1A[C[B [B[7;47H[35m[B [B[7B[1;31m[5A[0;35m[15;51H[1;31m[3A[0;35m[14;52H[1;31m[1A[26D[1A[0;35m[14;29H[1;31m[3A[0;35m[15;30H[1;31m[B[B[B[11A[0;35m[1A[31m[1A [1A[1A[1A[1;42H[B [B[7;48H[35m[B[9B[1;31m[7A[0;35m[16;51H[1;31m[5A[0;35m [15;52H[1;31m[3A[0;35m[14;53H[1;31m[1A[28D[1A[0;35m[14;28H[1;31m[3A[0;35m[15;29H[1;31m[5A[0;35m[16;30H[1;31m[8;32H[0;35m[18;32H[1;31m[5;35H[0;31m[1A [1A[1A [1A[3C[B[7;49H[35m[9;51H[17;51H[1;31m[7A[0;35m [16;52H[1;31m[5A[0;35m[15;53H[1;31m[3A[0;35m[14;54H[1;31m[1A[12;27H[0;35m[14;27H[1;31m[3A[0;35m[15;28H[1;31m[5A[0;35m[16;29H[1;31m[7A[0;35m[17;30H[1;31m[9A[0;35m[18;31H[1;31m[11A[0;35m[1A[31m[4;35H[1A [1A [1A[5C[8;51H[35m[18;51H[1;31m[9A[0;35m [17;52H[1;31m[7A[0;35m[16;53H[1;31m[5A[0;35m[B[B[1;31m[12;26H[0;35m[14;26H[1;31m[3A[0;35m [15;27H[1;31m[5A[0;35m[1A[17;29H[1;31m[9A[0;35m[18;30H[1;31m[11A[0;35m[1A[31m[1A[3;35H[1A [1A[7;51H[35m[B [18;52H[1;31m[9A[0;35m[17;53H[1;31m[11;55H[0;35m[B[B[1;31m[11;26H[0;35m[15;26H[1;31m[5A[0;35m [1A[17;28H[1;31m[9A[0;35m[18;29H[1;31m[11A[0;35m[1A[31m[1A [1A[2;35H[1A[7;52H[35m[B[18;53H[1;31m[1A[11;56H[0;35m[3B[1;31m[1A[10;26H[0;35m[1A [17;27H[1;31m[9A[0;35m[18;28H[1;31m[11A[0;35m[5;31H[31m[1A [1A[1;35H[7;53H[35m[11B[1;31m[12;58H[0;35m[14;58H[1;31m[1A[9;26H[0;35m[17;26H[1;31m[9A[0;35m [18;27H[1;31m[11A[0;35m[4;31H[31m[1A [1A[18;55H[1m[11;58H[0;35m[B[14;59H[1;31m[10;24H[0;35m[8;26H[1A[1A[31m[4;30H[1A[1A [1A[18;56H[1m[1A[7A[0;35m[B [B[14;60H[1;31m[10;23H[0;35m[1A[7;26H[1A[31m[1A[1A[1A[1A[1A[18;57H[1m[9A[0;35m[17;58H[1;31m[7A[0;35m [B[B[B[1;31m[12;20H[0;35m[10;22H[1A [1A[6;26H[31m[1A [1A[1A[1A[1A[8;58H[35m[18;58H[1;31m[9A[0;35m [17;59H[1;31m[7A[0;35m[B[B[14;62H[1;31m[1A[12;19H[0;35m[1A[1A[1A[1A [1A[5;26H[31m[1A [1A[1A[1A[7;58H[35m[B [18;59H[1;31m[9A[0;35m[17;60H[1;31m[7A[0;35m[B[15;62H[1;31m[3A[0;35m[14;63H[1;31m[1A[12;18H[0;35m[1A [1A[1A[1A[1A[1A[31m[4;26H[1A [1A[1A[7;59H[35m[B[B[B[16;62H[1;31m[5A[0;35m[15;63H[1;31m[3A[0;35m[14;64H[1;31m[1A[11;18H[0;35m[1A [1A[1A[1A[1A[31m[1A[3;26H[1A [1A[7;60H[35m[B[B[17;62H[1;31m[1A[5A[0;35m[15;64H[1;31m[1A[10;18H[0;35m[1A [1A[1A[1A[31m[1A[2;26H[1A[7;61H[35m[B[18;62H[1;31m[1A[1A[1A[9;18H[0;35m[1A [1A[1A[31m[1A[1;26H[7;62H[35m[B[18;63H[1;31m[1A[1A[1A[1A[8;18H[0;35m[1A[1A[31m[1A[1A[2;24H[7;63H[35m[B[18;64H[1;31m[1A[1A[1A[1A[1A[7;18H[0;35m[1A[31m[1A[1A[1A[1A[1A[7;64H[35m[11B[1;31m[16;67H[1A[1A[1A[8;16H[0;31m[6;18H[1A [1A[1A[1A[1A[17;67H[1m[1A[1A[1A[1A[8;15H[0;31m[1A[5;18H[1A [1A[1A[1A[17;68H[1m[1A[1A[1A[1A[8;14H[0;31m[1A[4;18H[1A [1A[1A[17;69H[1m[1A[14;72H[8;13H[0;31m[1A [1A[3;18H[1A [1A[18;69H[1m[1A[8;12H[0;31m[1A [1A [1A[2;18H[1A[18;70H[1m[1A[8;11H[0;31m[1A[1A [1A [1A[1;18H[18;71H[1m[1A[7;11H[0;31m[1A[1A [1A [1A[18;72H[1m[5;12H[0;31m[1A [1A [1A[6;10H[4;12H[1A [1A [1A[6;9H[1A[3;12H[1A [1A[8;6H[6;8H[1A [1A[2;12H[1A[8;5H[1A[1A[1A [1A [1A[1A[1A[8;4H[1A[5;7H[1A [1A [1A[1A[8;3H[1A [1A[4;7H[1A [1A [1A[8;2H[1A [1A [1A[3;7H[1A [1A[8;1H[1A[1A [1A [1A[2;7H[1A[7;1H[1A[1A [1A [1A[1A[1A[5;2H[1A [1A [1A[1A[4;2H[1A [1A [1A[3;2H[1A [1A[2;2H[1A[2D[2D[30m [2;1H [3;1H [4;1H [5;1H [6;1H [7;1H [8;1H [9;1H [10;1H [11;1H [12;1H [13;1H [14;1H [15;1H [16;1H [17;1H [18;1H [19;1H [20;1H [21;1H [22;1H [23;1H [24;1H [25;1H [24A [2;2H [3;2H [4;2H [5;2H [6;2H [7;2H [8;2H [9;2H [10;2H [11;2H [12;2H [13;2H [14;2H [15;2H [16;2H [17;2H [18;2H [19;2H [20;2H [21;2H [22;2H [23;2H [24;2H [25;2H [24A [2;3H [3;3H [4;3H [5;3H [6;3H [7;3H [8;3H [9;3H [10;3H [11;3H [12;3H [13;3H [14;3H [15;3H [16;3H [17;3H [18;3H [19;3H [20;3H [21;3H [22;3H [23;3H [24;3H [25;3H [24A [2;4H [3;4H [4;4H [5;4H [6;4H [7;4H [8;4H [9;4H [10;4H [11;4H [12;4H [13;4H [14;4H [15;4H [16;4H [17;4H [18;4H [19;4H [20;4H [21;4H [22;4H [23;4H [24;4H [25;4H [24A [2;5H [3;5H [4;5H [5;5H [6;5H [7;5H [8;5H [9;5H [10;5H [11;5H [12;5H [13;5H [14;5H [15;5H [16;5H [17;5H [18;5H [19;5H [20;5H [21;5H [22;5H [23;5H [24;5H [25;5H [24A [2;6H [3;6H [4;6H [5;6H [6;6H [7;6H [8;6H [9;6H [10;6H [11;6H [12;6H [13;6H [14;6H [15;6H [16;6H [17;6H [18;6H [19;6H [20;6H [21;6H [22;6H [23;6H [24;6H [25;6H [24A [2;7H [3;7H [4;7H [5;7H [6;7H [7;7H [8;7H [9;7H [10;7H [11;7H [12;7H [13;7H [14;7H [15;7H [16;7H [17;7H [18;7H [19;7H [20;7H [21;7H [22;7H [23;7H [24;7H [25;7H [24A [2;8H [3;8H [4;8H [5;8H [6;8H [7;8H [8;8H [9;8H [10;8H [11;8H [12;8H [13;8H [14;8H [15;8H [16;8H [17;8H [18;8H [19;8H [20;8H [21;8H [22;8H [23;8H [24;8H [25;8H [24A [2;9H [3;9H [4;9H [5;9H [6;9H [7;9H [8;9H [9;9H [10;9H [11;9H [12;9H [13;9H [14;9H [15;9H [16;9H [17;9H [18;9H [19;9H [20;9H [21;9H [22;9H [23;9H [24;9H [25;9H [24A [2;10H [3;10H [4;10H [5;10H [6;10H [7;10H [8;10H [9;10H [10;10H [11;10H [12;10H [13;10H [14;10H [15;10H [16;10H [17;10H [18;10H [19;10H [20;10H [21;10H [22;10H [23;10H [24;10H [25;10H [24A [2;11H [3;11H [4;11H [5;11H [6;11H [7;11H [8;11H [9;11H [10;11H [11;11H [12;11H [13;11H [14;11H [15;11H [16;11H [17;11H [18;11H [19;11H [20;11H [21;11H [22;11H [23;11H [24;11H [25;11H [24A [2;12H [3;12H [4;12H [5;12H [6;12H [7;12H [8;12H [9;12H [10;12H [11;12H [12;12H [13;12H [14;12H [15;12H [16;12H [17;12H [18;12H [19;12H [20;12H [21;12H [22;12H [23;12H [24;12H [25;12H [24A [2;13H [3;13H [4;13H [5;13H [6;13H [7;13H [8;13H [9;13H [10;13H [11;13H [12;13H [13;13H [14;13H [15;13H [16;13H [17;13H [18;13H [19;13H [20;13H [21;13H [22;13H [23;13H [24;13H [25;13H [24A [2;14H [3;14H [4;14H [5;14H [6;14H [7;14H [8;14H [9;14H [10;14H [11;14H [12;14H [13;14H [14;14H [15;14H [16;14H [17;14H [18;14H [19;14H [20;14H [21;14H [22;14H [23;14H [24;14H [25;14H [24A [2;15H [3;15H [4;15H [5;15H [6;15H [7;15H [8;15H [9;15H [10;15H [11;15H [12;15H [13;15H [14;15H [15;15H [16;15H [17;15H [18;15H [19;15H [20;15H [21;15H [22;15H [23;15H [24;15H [25;15H [24A [2;16H [3;16H [4;16H [5;16H [6;16H [7;16H [8;16H [9;16H [10;16H [11;16H [12;16H [13;16H [14;16H [15;16H [16;16H [17;16H [18;16H [19;16H [20;16H [21;16H [22;16H [23;16H [24;16H [25;16H [24A [2;17H [3;17H [4;17H [5;17H [6;17H [7;17H [8;17H [9;17H [10;17H [11;17H [12;17H [13;17H [14;17H [15;17H [16;17H [17;17H [18;17H [19;17H [20;17H [21;17H [22;17H [23;17H [24;17H [25;17H [24A [2;18H [3;18H [4;18H [5;18H [6;18H [7;18H [8;18H [9;18H [10;18H [11;18H [12;18H [13;18H [14;18H [15;18H [16;18H [17;18H [18;18H [19;18H [20;18H [21;18H [22;18H [23;18H [24;18H [25;18H [24A [2;19H [3;19H [4;19H [5;19H [6;19H [7;19H [8;19H [9;19H [10;19H [11;19H [12;19H [13;19H [14;19H [15;19H [16;19H [17;19H [18;19H [19;19H [20;19H [21;19H [22;19H [23;19H [24;19H [25;19H [24A [2;20H [3;20H [4;20H [5;20H [6;20H [7;20H [8;20H [9;20H [10;20H [11;20H [12;20H [13;20H [14;20H [15;20H [16;20H [17;20H [18;20H [19;20H [20;20H [21;20H [22;20H [23;20H [24;20H [25;20H [24A [2;21H [3;21H [4;21H [5;21H [6;21H [7;21H [8;21H [9;21H [10;21H [11;21H [12;21H [13;21H [14;21H [15;21H [16;21H [17;21H [18;21H [19;21H [20;21H [21;21H [22;21H [23;21H [24;21H [25;21H [24A [2;22H [3;22H [4;22H [5;22H [6;22H [7;22H [8;22H [9;22H [10;22H [11;22H [12;22H [13;22H [14;22H [15;22H [16;22H [17;22H [18;22H [19;22H [20;22H [21;22H [22;22H [23;22H [24;22H [25;22H [24A [2;23H [3;23H [4;23H [5;23H [6;23H [7;23H [8;23H [9;23H [10;23H [11;23H [12;23H [13;23H [14;23H [15;23H [16;23H [17;23H [18;23H [19;23H [20;23H [21;23H [22;23H [23;23H [24;23H [25;23H [24A [2;24H [3;24H [4;24H [5;24H [6;24H [7;24H [8;24H [9;24H [10;24H [11;24H [12;24H [13;24H [14;24H [15;24H [16;24H [17;24H [18;24H [19;24H [20;24H [21;24H [22;24H [23;24H [24;24H [25;24H [24A [2;25H [3;25H [4;25H [5;25H [6;25H [7;25H [8;25H [9;25H [10;25H [11;25H [12;25H [13;25H [14;25H [15;25H [16;25H [17;25H [18;25H [19;25H [20;25H [21;25H [22;25H [23;25H [24;25H [25;25H [24A [2;26H [3;26H [4;26H [5;26H [6;26H [7;26H [8;26H [9;26H [10;26H [11;26H [12;26H [13;26H [14;26H [15;26H [16;26H [17;26H [18;26H [19;26H [20;26H [21;26H [22;26H [23;26H [24;26H [25;26H [24A [2;27H [3;27H [4;27H [5;27H [6;27H [7;27H [8;27H [9;27H [10;27H [11;27H [12;27H [13;27H [14;27H [15;27H [16;27H [17;27H [18;27H [19;27H [20;27H [21;27H [22;27H [23;27H [24;27H [25;27H [24A [2;28H [3;28H [4;28H [5;28H [6;28H [7;28H [8;28H [9;28H [10;28H [11;28H [12;28H [13;28H [14;28H [15;28H [16;28H [17;28H [18;28H [19;28H [20;28H [21;28H [22;28H [23;28H [24;28H [25;28H [24A [2;29H [3;29H [4;29H [5;29H [6;29H [7;29H [8;29H [9;29H [10;29H [11;29H [12;29H [13;29H [14;29H [15;29H [16;29H [17;29H [18;29H [19;29H [20;29H [21;29H [22;29H [23;29H [24;29H [25;29H [24A [2;30H [3;30H [4;30H [5;30H [6;30H [7;30H [8;30H [9;30H [10;30H [11;30H [12;30H [13;30H [14;30H [15;30H [16;30H [17;30H [18;30H [19;30H [20;30H [21;30H [22;30H [23;30H [24;30H [25;30H [24A [2;31H [3;31H [4;31H [5;31H [6;31H [7;31H [8;31H [9;31H [10;31H [11;31H [12;31H [13;31H [14;31H [15;31H [16;31H [17;31H [18;31H [19;31H [20;31H [21;31H [22;31H [23;31H [24;31H [25;31H [24A [2;32H [3;32H [4;32H [5;32H [6;32H [7;32H [8;32H [9;32H [10;32H [11;32H [12;32H [13;32H [14;32H [15;32H [16;32H [17;32H [18;32H [19;32H [20;32H [21;32H [22;32H [23;32H [24;32H [25;32H [24A [2;33H [3;33H [4;33H [5;33H [6;33H [7;33H [8;33H [9;33H [10;33H [11;33H [12;33H [13;33H [14;33H [15;33H [16;33H [17;33H [18;33H [19;33H [20;33H [21;33H [22;33H [23;33H [24;33H [25;33H [24A [2;34H [3;34H [4;34H [5;34H [6;34H [7;34H [8;34H [9;34H [10;34H [11;34H [12;34H [13;34H [14;34H [15;34H [16;34H [17;34H [18;34H [19;34H [20;34H [21;34H [22;34H [23;34H [24;34H [25;34H [24A [2;35H [3;35H [4;35H [5;35H [6;35H [7;35H [8;35H [9;35H [10;35H [11;35H [12;35H [13;35H [14;35H [15;35H [16;35H [17;35H [18;35H [19;35H [20;35H [21;35H [22;35H [23;35H [24;35H [25;35H [24A [2;36H [3;36H [4;36H [5;36H [6;36H [7;36H [8;36H [9;36H [10;36H [11;36H [12;36H [13;36H [14;36H [15;36H [16;36H [17;36H [18;36H [19;36H [20;36H [21;36H [22;36H [23;36H [24;36H [25;36H [24A [2;37H [3;37H [4;37H [5;37H [6;37H [7;37H [8;37H [9;37H [10;37H [11;37H [12;37H [13;37H [14;37H [15;37H [16;37H [17;37H [18;37H [19;37H [20;37H [21;37H [22;37H [23;37H [24;37H [25;37H [24A [2;38H [3;38H [4;38H [5;38H [6;38H [7;38H [8;38H [9;38H [10;38H [11;38H [12;38H [13;38H [14;38H [15;38H [16;38H [17;38H [18;38H [19;38H [20;38H [21;38H [22;38H [23;38H [24;38H [25;38H [24A [2;39H [3;39H [4;39H [5;39H [6;39H [7;39H [8;39H [9;39H [10;39H [11;39H [12;39H [13;39H [14;39H [15;39H [16;39H [17;39H [18;39H [19;39H [20;39H [21;39H [22;39H [23;39H [24;39H [25;39H [24A [2;40H [3;40H [4;40H [5;40H [6;40H [7;40H [8;40H [9;40H [10;40H [11;40H [12;40H [13;40H [14;40H [15;40H [16;40H [17;40H [18;40H [19;40H [20;40H [21;40H [22;40H [23;40H [24;40H [25;40H [24A [2;41H [3;41H [4;41H [5;41H [6;41H [7;41H [8;41H [9;41H [10;41H [11;41H [12;41H [13;41H [14;41H [15;41H [16;41H [17;41H [18;41H [19;41H [20;41H [21;41H [22;41H [23;41H [24;41H [25;41H [24A [2;42H [3;42H [4;42H [5;42H [6;42H [7;42H [8;42H [9;42H [10;42H [11;42H [12;42H [13;42H [14;42H [15;42H [16;42H [17;42H [18;42H [19;42H [20;42H [21;42H [22;42H [23;42H [24;42H [25;42H [24A [2;43H [3;43H [4;43H [5;43H [6;43H [7;43H [8;43H [9;43H [10;43H [11;43H [12;43H [13;43H [14;43H [15;43H [16;43H [17;43H [18;43H [19;43H [20;43H [21;43H [22;43H [23;43H [24;43H [25;43H [24A [2;44H [3;44H [4;44H [5;44H [6;44H [7;44H [8;44H [9;44H [10;44H [11;44H [12;44H [13;44H [14;44H [15;44H [16;44H [17;44H [18;44H [19;44H [20;44H [21;44H [22;44H [23;44H [24;44H [25;44H [24A [2;45H [3;45H [4;45H [5;45H [6;45H [7;45H [8;45H [9;45H [10;45H [11;45H [12;45H [13;45H [14;45H [15;45H [16;45H [17;45H [18;45H [19;45H [20;45H [21;45H [22;45H [23;45H [24;45H [25;45H [24A [2;46H [3;46H [4;46H [5;46H [6;46H [7;46H [8;46H [9;46H [10;46H [11;46H [12;46H [13;46H [14;46H [15;46H [16;46H [17;46H [18;46H [19;46H [20;46H [21;46H [22;46H [23;46H [24;46H [25;46H [24A [2;47H [3;47H [4;47H [5;47H [6;47H [7;47H [8;47H [9;47H [10;47H [11;47H [12;47H [13;47H [14;47H [15;47H [16;47H [17;47H [18;47H [19;47H [20;47H [21;47H [22;47H [23;47H [24;47H [25;47H [24A [2;48H [3;48H [4;48H [5;48H [6;48H [7;48H [8;48H [9;48H [10;48H [11;48H [12;48H [13;48H [14;48H [15;48H [16;48H [17;48H [18;48H [19;48H [20;48H [21;48H [22;48H [23;48H [24;48H [25;48H [24A [2;49H [3;49H [4;49H [5;49H [6;49H [7;49H [8;49H [9;49H [10;49H [11;49H [12;49H [13;49H [14;49H [15;49H [16;49H [17;49H [18;49H [19;49H [20;49H [21;49H [22;49H [23;49H [24;49H [25;49H [24A [2;50H [3;50H [4;50H [5;50H [6;50H [7;50H [8;50H [9;50H [10;50H [11;50H [12;50H [13;50H [14;50H [15;50H [16;50H [17;50H [18;50H [19;50H [20;50H [21;50H [22;50H [23;50H [24;50H [25;50H [24A [2;51H [3;51H [4;51H [5;51H [6;51H [7;51H [8;51H [9;51H [10;51H [11;51H [12;51H [13;51H [14;51H [15;51H [16;51H [17;51H [18;51H [19;51H [20;51H [21;51H [22;51H [23;51H [24;51H [25;51H [24A [2;52H [3;52H [4;52H [5;52H [6;52H [7;52H [8;52H [9;52H [10;52H [11;52H [12;52H [13;52H [14;52H [15;52H [16;52H [17;52H [18;52H [19;52H [20;52H [21;52H [22;52H [23;52H [24;52H [25;52H [24A [2;53H [3;53H [4;53H [5;53H [6;53H [7;53H [8;53H [9;53H [10;53H [11;53H [12;53H [13;53H [14;53H [15;53H [16;53H [17;53H [18;53H [19;53H [20;53H [21;53H [22;53H [23;53H [24;53H [25;53H [24A [2;54H [3;54H [4;54H [5;54H [6;54H [7;54H [8;54H [9;54H [10;54H [11;54H [12;54H [13;54H [14;54H [15;54H [16;54H [17;54H [18;54H [19;54H [20;54H [21;54H [22;54H [23;54H [24;54H [25;54H [24A [2;55H [3;55H [4;55H [5;55H [6;55H [7;55H [8;55H [9;55H [10;55H [11;55H [12;55H [13;55H [14;55H [15;55H [16;55H [17;55H [18;55H [19;55H [20;55H [21;55H [22;55H [23;55H [24;55H [25;55H [24A [2;56H [3;56H [4;56H [5;56H [6;56H [7;56H [8;56H [9;56H [10;56H [11;56H [12;56H [13;56H [14;56H [15;56H [16;56H [17;56H [18;56H [19;56H [20;56H [21;56H [22;56H [23;56H [24;56H [25;56H [24A [2;57H [3;57H [4;57H [5;57H [6;57H [7;57H [8;57H [9;57H [10;57H [11;57H [12;57H [13;57H [14;57H [15;57H [16;57H [17;57H [18;57H [19;57H [20;57H [21;57H [22;57H [23;57H [24;57H [25;57H [24A [2;58H [3;58H [4;58H [5;58H [6;58H [7;58H [8;58H [9;58H [10;58H [11;58H [12;58H [13;58H [14;58H [15;58H [16;58H [17;58H [18;58H [19;58H [20;58H [21;58H [22;58H [23;58H [24;58H [25;58H [24A [2;59H [3;59H [4;59H [5;59H [6;59H [7;59H [8;59H [9;59H [10;59H [11;59H [12;59H [13;59H [14;59H [15;59H [16;59H [17;59H [18;59H [19;59H [20;59H [21;59H [22;59H [23;59H [24;59H [25;59H [24A [2;60H [3;60H [4;60H [5;60H [6;60H [7;60H [8;60H [9;60H [10;60H [11;60H [12;60H [13;60H [14;60H [15;60H [16;60H [17;60H [18;60H [19;60H [20;60H [21;60H [22;60H [23;60H [24;60H [25;60H [24A [2;61H [3;61H [4;61H [5;61H [6;61H [7;61H [8;61H [9;61H [10;61H [11;61H [12;61H [13;61H [14;61H [15;61H [16;61H [17;61H [18;61H [19;61H [20;61H [21;61H [22;61H [23;61H [24;61H [25;61H [24A [2;62H [3;62H [4;62H [5;62H [6;62H [7;62H [8;62H [9;62H [10;62H [11;62H [12;62H [13;62H [14;62H [15;62H [16;62H [17;62H [18;62H [19;62H [20;62H [21;62H [22;62H [23;62H [24;62H [25;62H [24A [2;63H [3;63H [4;63H [5;63H [6;63H [7;63H [8;63H [9;63H [10;63H [11;63H [12;63H [13;63H [14;63H [15;63H [16;63H [17;63H [18;63H [19;63H [20;63H [21;63H [22;63H [23;63H [24;63H [25;63H [24A [2;64H [3;64H [4;64H [5;64H [6;64H [7;64H [8;64H [9;64H [10;64H [11;64H [12;64H [13;64H [14;64H [15;64H [16;64H [17;64H [18;64H [19;64H [20;64H [21;64H [22;64H [23;64H [24;64H [25;64H [24A [2;65H [3;65H [4;65H [5;65H [6;65H [7;65H [8;65H [9;65H [10;65H [11;65H [12;65H [13;65H [14;65H [15;65H [16;65H [17;65H [18;65H [19;65H [20;65H [21;65H [22;65H [23;65H [24;65H [25;65H [24A [2;66H [3;66H [4;66H [5;66H [6;66H [7;66H [8;66H [9;66H [10;66H [11;66H [12;66H [13;66H [14;66H [15;66H [16;66H [17;66H [18;66H [19;66H [20;66H [21;66H [22;66H [23;66H [24;66H [25;66H [24A [2;67H [3;67H [4;67H [5;67H [6;67H [7;67H [8;67H [9;67H [10;67H [11;67H [12;67H [13;67H [14;67H [15;67H [16;67H [17;67H [18;67H [19;67H [20;67H [21;67H [22;67H [23;67H [24;67H [25;67H [24A [2;68H [3;68H [4;68H [5;68H [6;68H [7;68H [8;68H [9;68H [10;68H [11;68H [12;68H [13;68H [14;68H [15;68H [16;68H [17;68H [18;68H [19;68H [20;68H [21;68H [22;68H [23;68H [24;68H [25;68H [24A [2;69H [3;69H [4;69H [5;69H [6;69H [7;69H [8;69H [9;69H [10;69H [11;69H [12;69H [13;69H [14;69H [15;69H [16;69H [17;69H [18;69H [19;69H [20;69H [21;69H [22;69H [23;69H [24;69H [25;69H [24A [2;70H [3;70H [4;70H [5;70H [6;70H [7;70H [8;70H [9;70H [10;70H [11;70H [12;70H [13;70H [14;70H [15;70H [16;70H [17;70H [18;70H [19;70H [20;70H [21;70H [22;70H [23;70H [24;70H [25;70H [24A [2;71H [3;71H [4;71H [5;71H [6;71H [7;71H [8;71H [9;71H [10;71H [11;71H [12;71H [13;71H [14;71H [15;71H [16;71H [17;71H [18;71H [19;71H [20;71H [21;71H [22;71H [23;71H [24;71H [25;71H [24A [2;72H [3;72H [4;72H [5;72H [6;72H [7;72H [8;72H [9;72H [10;72H [11;72H [12;72H [13;72H [14;72H [15;72H [16;72H [17;72H [18;72H [19;72H [20;72H [21;72H [22;72H [23;72H [24;72H [25;72H [24A [2;73H [3;73H [4;73H [5;73H [6;73H [7;73H [8;73H [9;73H [10;73H [11;73H [12;73H [13;73H [14;73H [15;73H [16;73H [17;73H [18;73H [19;73H [20;73H [21;73H [22;73H [23;73H [24;73H [25;73H [24A [2;74H [3;74H [4;74H [5;74H [6;74H [7;74H [8;74H [9;74H [10;74H [11;74H [12;74H [13;74H [14;74H [15;74H [16;74H [17;74H [18;74H [19;74H [20;74H [21;74H [22;74H [23;74H [24;74H [25;74H [24A [2;75H [3;75H [4;75H [5;75H [6;75H [7;75H [8;75H [9;75H [10;75H [11;75H [12;75H [13;75H [14;75H [15;75H [16;75H [17;75H [18;75H [19;75H [20;75H [21;75H [22;75H [23;75H [24;75H [25;75H [24A [2;76H [3;76H [4;76H [5;76H [6;76H [7;76H [8;76H [9;76H [10;76H [11;76H [12;76H [13;76H [14;76H [15;76H [16;76H [17;76H [18;76H [19;76H [20;76H [21;76H [22;76H [23;76H [24;76H [25;76H [24A [2;77H [3;77H [4;77H [5;77H [6;77H [7;77H [8;77H [9;77H [10;77H [11;77H [12;77H [13;77H [14;77H [15;77H [16;77H [17;77H [18;77H [19;77H [20;77H [21;77H [22;77H [23;77H [24;77H [25;77H [24A [2;78H [3;78H [4;78H [5;78H [6;78H [7;78H [8;78H [9;78H [10;78H [11;78H [12;78H [13;78H [14;78H [15;78H [16;78H [17;78H [18;78H [19;78H [20;78H [21;78H [22;78H [23;78H [24;78H [25;78H [24A [2;79H [3;79H [4;79H [5;79H [6;79H [7;79H [8;79H [9;79H [10;79H [11;79H [12;79H [13;79H [14;79H [15;79H [16;79H [17;79H [18;79H [19;79H [20;79H [21;79H [22;79H [23;79H [24;79H [25;79H [24A [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C [79C[K[11;21H[1;34m- Welcome to the Intellectual Wasteland -[0m"];var color_white=vec4(1,1,1,1);function main(canvas){glov_engine.startup({canvas:canvas,game_width:game_width,game_height:game_height,pixely:"strict",viewport_postprocess:true,font:{info:require("./img/font/vga_16x1.json"),texture:"font/vga_16x1"},pixel_aspect:640/480/(720/400),show_fps:false});var terminal=glov_terminal.create();glov_ui.scaleSizes(13/32);glov_ui.setFontHeight(16);var createSprite=glov_sprites.create;var KEYS=glov_input.KEYS;var sprite_size=64;function initGraphics(){sprites.white=createSprite({url:"white"});sprites.game_bg=createSprite({url:"white",size:vec2(game_width,game_height)})}var auto_advance=true;var term_idx=0;var terminal_countdown=0;function test(dt){if(!test.color_sprite){test.color_sprite=v4clone(color_white);test.character={x:random()*(game_width-sprite_size)+sprite_size*.5,y:random()*(game_height-sprite_size)+sprite_size*.5}}if(glov_input.keyDownEdge(KEYS.LEFT)){auto_advance=false;terminal_countdown=0;term_idx--}if(glov_input.keyDownEdge(KEYS.RIGHT)){auto_advance=false;terminal_countdown=0;term_idx++}terminal.baud=glov_input.keyDown(KEYS.SPACE)?Infinity:9600;if(!terminal_countdown||dt>=terminal_countdown){if(term_idx===undefined){term_idx=0}if(auto_advance){term_idx=min(term_idx||0,ansi_files.length)+1}if(term_idx>ansi_files.length||term_idx<=0){if(!test.terminal_inited){var getch=function getch(ii,jj){return 176+floor(random()*(224-176))};test.terminal_inited=true;terminal.autoScroll(false);terminal.moveto(0,0);for(var ii=0;ii<25;++ii){var str=[ii===0?"":ii===24?"":""];for(var jj=1;jj<79;++jj){if(ii===0){str.push("")}else if(ii===24){str.push("")}else{str.push(getch(ii,jj))}}str.push(ii===0?"":ii===24?"":"");terminal.print({x:0,y:ii,text:str,fg:8,bg:0})}terminal.moveto(0,0)}terminal.color(floor(random()*16),floor(random()*8));var x=1+floor(random()*78);var y=1+floor(random()*23);terminal.fill({x:x,y:y,w:min(79-x,1+floor(random()*10)),h:min(24-y,1+floor(random()*8)),ch:32+floor(random()*(255-32))});terminal_countdown=100}else{terminal.color(7,0);terminal.clear();var data=ansi_files[term_idx-1];terminal.print({x:0,y:0,text:data});terminal_countdown=auto_advance?1500:1e9}}else{terminal_countdown-=dt}terminal.render(dt,{z:Z.BACKGROUND+1})}function testInit(dt){glov_engine.setState(test);test(dt)}initGraphics();glov_engine.setState(testInit)}},{"./glov/engine.js":12,"./glov/input.js":15,"./glov/local_storage.js":16,"./glov/sprites.js":21,"./glov/terminal.js":22,"./glov/ui.js":25,"./glov/vmath.js":26,"./img/font/vga_16x1.json":30}],32:[function(require,module,exports){"use strict";function ok(exp,msg){if(exp){return}throw new Error("Assertion failed"+(msg?": "+msg:""))}module.exports=ok;module.exports.ok=ok;function equal(a,b){if(a===b){return}throw new Error('Assertion failed: "'+a+'"==="'+b+'"')}module.exports.equal=equal},{}],33:[function(require,module,exports){"use strict";(function(){var debug=document.getElementById("debug");window.onerror=function(e,file,line){debug.innerText=e+"\n  at "+file+"("+line+")"};window.debugmsg=function(msg,clear){if(clear){debug.innerText=msg}else{debug.innerText+=msg+"\n"}}})();window.onload=function(){var main=require("./main.js");var canvas=document.getElementById("canvas");function resizeCanvas(){var css_to_real=window.devicePixelRatio||1;window.pixel_scale=css_to_real;canvas.width=Math.round(canvas.clientWidth*css_to_real);canvas.height=Math.round(canvas.clientHeight*css_to_real)}window.addEventListener("resize",resizeCanvas,false);resizeCanvas();var contextNames=["webgl","experimental-webgl"];for(var i=0;i<contextNames.length;i+=1){try{window.gl=canvas.getContext(contextNames[i])}catch(e){}if(window.gl){return main.main(canvas)}}window.alert("Sorry, but your browser does not support WebGL or does not have it enabled.");document.getElementById("loading").style.visibility="hidden"}},{"./main.js":31}],34:[function(require,module,exports){"use strict";exports.easeInOut=easeInOut;exports.easeIn=easeIn;exports.easeOut=easeOut;exports.clone=clone;exports.merge=merge;exports.defaults=defaults;exports.cloneShallow=cloneShallow;exports.clamp=clamp;exports.lerp=lerp;exports.mix=mix;exports.sign=sign;exports.round100=round100;exports.round1000=round1000;exports.fract=fract;exports.nearSame=nearSame;exports.titleCase=titleCase;exports.lineCircleIntersect=lineCircleIntersect;var abs=Math.abs,floor=Math.floor,min=Math.min,max=Math.max,round=Math.round,pow=Math.pow,sqrt=Math.sqrt;function easeInOut(v,a){var va=pow(v,a);return va/(va+pow(1-v,a))}function easeIn(v,a){return 2*easeInOut(.5*v,a)}function easeOut(v,a){return 2*easeInOut(.5+.5*v,a)-1}function clone(obj){return JSON.parse(JSON.stringify(obj))}function merge(dest,src){for(var f in src){dest[f]=src[f]}return dest}function defaults(dest,src){for(var f in src){if(!Object.prototype.hasOwnProperty.call(dest,f)){dest[f]=src[f]}}return dest}function cloneShallow(src){return merge({},src)}function clamp(v,mn,mx){return min(max(mn,v),mx)}function lerp(a,v0,v1){return(1-a)*v0+a*v1}function mix(v0,v1,a){return(1-a)*v0+a*v1}function sign(a){return a<0?-1:a>0?1:0}function round100(a){return round(a*100)/100}function round1000(a){return round(a*1e3)/1e3}function fract(a){return a-floor(a)}function nearSame(a,b,tol){return abs(b-a)<=tol}function titleCase(str){return str.split(" ").map(function(word){return""+word[0].toUpperCase()+word.slice(1)}).join(" ")}var EPSILON=1e-5;function lineCircleIntersect(p1,p2,pCircle,radius){var dp=[p2[0]-p1[0],p2[1]-p1[1]];var a=dp[0]*dp[0]+dp[1]*dp[1];var b=2*(dp[0]*(p1[0]-pCircle[0])+dp[1]*(p1[1]-pCircle[1]));var c=pCircle[0]*pCircle[0]+pCircle[1]*pCircle[1];c+=p1[0]*p1[0]+p1[1]*p1[1];c-=2*(pCircle[0]*p1[0]+pCircle[1]*p1[1]);c-=radius*radius;var bb4ac=b*b-4*a*c;if(abs(a)<EPSILON||bb4ac<0){return false}var mu1=(-b+sqrt(bb4ac))/(2*a);var mu2=(-b-sqrt(bb4ac))/(2*a);if(mu1>=0&&mu1<=1||mu2>=0&&mu2<=1){return true}return false}},{}]},{},[33]);
//# sourceMappingURL=wrapper.bundle.js.map
