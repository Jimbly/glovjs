{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/@jimbly/howler/src/howler.core.js","node_modules/dot-prop/index.js","node_modules/gl-mat3/create.js","node_modules/gl-mat3/fromMat4.js","node_modules/gl-mat4/copy.js","node_modules/gl-mat4/create.js","node_modules/gl-mat4/invert.js","node_modules/gl-mat4/multiply.js","node_modules/gl-mat4/perspective.js","node_modules/gl-mat4/transpose.js","node_modules/is-obj/index.js","src/client/app.js","src/client/glov/bootstrap.js","src/client/glov/camera2d.js","src/client/glov/cmds.js","src/client/glov/edit_box.js","src/client/glov/effects.js","src/client/glov/engine.js","src/client/glov/filewatch.js","src/client/glov/font.js","src/client/glov/geom.js","src/client/glov/glb/decode-utf8.js","src/client/glov/glb/gltf-type-utils.js","src/client/glov/glb/parser.js","src/client/glov/glb/unpack-binary-json.js","src/client/glov/glb/unpack-glb-buffers.js","src/client/glov/in_event.js","src/client/glov/input.js","src/client/glov/link.js","src/client/glov/local_storage.js","src/client/glov/mat43.js","src/client/glov/models.js","src/client/glov/net.js","src/client/glov/particles.js","src/client/glov/perf.js","src/client/glov/pointer_lock.js","src/client/glov/polyfill.js","src/client/glov/settings.js","src/client/glov/shaders.js","src/client/glov/sound.js","src/client/glov/soundscape.js","src/client/glov/sprites.js","src/client/glov/subscription_manager.js","src/client/glov/textures.js","src/client/glov/transition.js","src/client/glov/ui.js","src/client/glov/urlhash.js","src/client/glov/vmath.js","src/client/glov/walltime.js","src/client/glov/webfs.js","src/client/glov/wsclient.js","src/client/img/font/04b03_8x1.json","src/client/img/font/04b03_8x2.json","src/client/img/font/palanquin32.json","src/client/main.js","src/client/shims/assert.js","src/client/shims/buffer.js","src/client/shims/not_worker.js","src/common/ack.js","src/common/base64.js","src/common/cmd_parse.js","src/common/md5.js","src/common/packet.js","src/common/tiny-events.js","src/common/util.js","src/common/wscommon.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","HowlerGlobal","this","init","prototype","self","Howler","_counter","_html5AudioPool","html5PoolSize","_codecs","_howls","_muted","_volume","_canPlayEvent","_navigator","window","navigator","masterGain","noAudio","usingWebAudio","autoSuspend","ctx","safeToPlay","autoUnlock","_setup","volume","vol","parseFloat","setupAudioContext","gain","setValueAtTime","currentTime","_webAudio","ids","_getSoundIds","j","sound","_soundById","_node","mute","muted","stop","unload","close","codecs","ext","replace","state","_autoSuspend","Audio","test","oncanplaythrough","_setupCodecs","audioTest","err","canPlayType","mpegTest","checkOpera","userAgent","match","isOldOpera","parseInt","split","mp3","mpeg","opus","ogg","oga","wav","aac","caf","m4a","mp4","weba","webm","dolby","flac","_unlockAudio","_audioUnlocked","_mobileUnloaded","sampleRate","_scratchBuffer","createBuffer","unlock","audioNode","_unlocked","_releaseHtml5Audio","load","_autoResume","onUnlockFinish","document","removeEventListener","_emit","source","createBufferSource","buffer","connect","destination","start","noteOn","resume","onended","disconnect","addEventListener","_obtainHtml5Audio","pop","audio","push","suspend","_sounds","_paused","_suspendTimer","clearTimeout","setTimeout","then","_resumeAfterSuspend","Howl","src","console","error","_autoplay","autoplay","_format","format","_html5","html5","_loop","loop","_pool","pool","_preload","preload","_rate","rate","_sprite","sprite","_src","undefined","_xhrWithCredentials","xhrWithCredentials","_xhrHeaders","xhrHeaders","_duration","_state","_endTimers","_queue","_playLock","_onend","onend","fn","_onfade","onfade","_onload","onload","_onloaderror","onloaderror","_onplayerror","onplayerror","_onpause","onpause","_onplay","onplay","_onstop","onstop","_onmute","onmute","_onvolume","onvolume","_onrate","onrate","_onseek","onseek","_onunlock","onunlock","_onresume","event","action","play","url","str","exec","toLowerCase","warn","location","protocol","slice","Sound","loadBuffer","internal","id","num","_ended","_id","_inactiveSound","soundId","_loadQueue","seek","Math","max","_seek","duration","timeout","abs","setParams","_start","_stop","sound_volume","node","playWebAudio","_refreshBuffer","_playStart","bufferSource","noteGrainOn","Infinity","bind","once","_clearTimer","playHtml5","playbackRate","Promise","catch","paused","loadedNoReadyState","ejecta","readyState","isCocoonJS","listener","pause","_rateSeek","_stopFade","noteOff","_cleanBuffer","isNaN","arguments","_clearSound","_interval","args","index","indexOf","apply","fade","from","to","len","end","linearRampToValueAtTime","_startFadeInterval","isGroup","diff","steps","stepLen","lastTick","Date","now","_fadeTo","setInterval","tick","min","round","clearInterval","cancelScheduledValues","loopStart","loopEnd","playing","seekAndEmit","emitSeek","realTime","rateSeek","sounds","_errorFn","_loadFn","splice","remCache","cache","on","events","off","isId","keys","Object","Array","isArray","msg","task","shift","ended","_drain","reset","limit","cnt","_panner","isIOS","vendor","checkIE","howl","_parent","parent","create","createGain","createGainNode","_errorListener","_loadListener","ceil","__default","loadSound","data","atob","dataView","Uint8Array","charCodeAt","decodeAudioData","xhr","XMLHttpRequest","open","withCredentials","responseType","forEach","key","setRequestHeader","status","response","onerror","safeXhrSend","send","arraybuffer","success","AudioContext","webkitAudioContext","iOS","platform","appVersion","version","safari","define","amd","global","isObj","getPathSegments","path","pathArr","parts","get","obj","value","propertyIsEnumerable","set","root","delete","_delete","has","out","Float32Array","fromMat4","copy","invert","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","multiply","b","b0","b1","b2","b3","perspective","fovy","aspect","near","far","tan","nf","transpose","x","type","_typeof","called_once","main","debug","getElementById","file","line","col","errorobj","stack","message","origin","join","show","glov_error_report","innerText","debugmsg","clear","virtualToCanvas","setSafeAreaPadding","safeAreaPadding","domToCanvasRatio","screenAspect","setAspectFixed","setAspectFixed2","zoom","setNormalized","x0Real","y0Real","x1Real","y1Real","wReal","hReal","x0","y0","x1","y1","w","h","xScale","yScale","htmlPos","htmlSize","domToVirtual","domDeltaToVirtual","virtualToDom","virtualToFontSize","virtualToDomPosParam","tickCamera2D","startup","engine","safearea_pad","screen_width","screen_height","render_width","render_height","render_viewport_w","render_viewport_h","render_offset_x","render_offset_y_top","render_offset_y_bottom","reapply","dst","ignore_safe_area","wscale","hscale","left","right","top","bottom","old","pa","pixel_aspect","inv_aspect","inv_desired_aspect","margin","_margin","_margin2","y","factor","inv_factor","height","devicePixelRatio","width","viewport","eff_screen_width","eff_screen_height","_margin3","setViewport","cmd_parse_mod","local_storage","cmd_parse","storage","textures","PI","cmd","handle","defaultHandler","registerValue","TYPE_FLOAT","label","range","fov_min","v","setFOV","store","byteFormat","bytes","toFixed","register","help","func","resp_func","filter","gpu_mem","sort","map","perf_state","geom","tex","toUpperCase","defines","definesChanged","webgl2","cmdDesc","cmd_data","list","autoComplete","access","str_cname","canonical","str_lc","cname","safearea","TYPE_STRING","usage","default_value","String","Number","ii","disable_data","getJSON","setJSON","camera2d","glov_input","glov_ui","focuslog","GlovUIEditBox","params","z","Z","UI","button_width","allow_modal","font_height","text","placeholder","max_len","initial_focus","onetime_focus","auto_unfocus","initial_select","spellcheck","applyParams","is_focused","elem","input","submitted","pointer_lock","last_frame","new_text","focus","focusSteal","pointerLockExit","focusNext","was_glov_focused","glov_focused","focusCheck","dom_focused","activeElement","blur","focused","key_opt","in_event_cb","pointerLockEnter","keyUpEdge","KEYS","ESC","setText","focusCanvas","canceled","_this","global_frame_index","updateFocus","this_frame_edit_boxes","getElem","textContent","form","createElement","setAttribute","random","ev","preventDefault","appendChild","span","select","pos","style","size","old_fontsize","fontSize","new_fontsize","click","peek","eatAllKeyboardInput","SUBMIT","CANCEL","registerShader","grayScaleMatrix","sepiaMatrix","negativeMatrix","saturationMatrix","hueMatrix","brightnessAddMatrix","brightnessScaleMatrix","additiveMatrix","contrastMatrix","applyCopy","applyPixelyExpand","applyGaussianBlur","applyColorMatrix","clearAlpha","shaders","vec2","vec3","vec4","v4set","shader_data","vp_copy","vp","fp","pixely_expand","gaussian_blur","color_matrix","getShader","shader","inited","clip_space","copy_uv_scale","shader_params_default","shader_params_color_matrix","shader_params_gaussian_blur","shader_params_pixely_expand","quad_geom","semantic","POSITION","gl","FLOAT","QUADS","colorMatrix","sampleRadius","Gauss","orig_pixel_size","saturationScale","is","angle","cos","s","sin","brightnessOffset","scale","additiveRGB","contrastScale","applyEffect","effect","view_w","view_h","target_w","target_h","bindArray","texs","draw","setSamplerState","filter_min","LINEAR","filter_mag","wrap_s","CLAMP_TO_EDGE","wrap_t","resx","resy","hblur","captureFramebuffer","vblur","final_viewport","clear_color","clearColor","COLOR_BUFFER_BIT","max_size","min_size","inputTexture0","res","shader_copy","glow","matrix","mout","old_dt","getParameter","DEPTH_TEST","disable","colorMask","white","enable","setGlobalMatrices","setGameDims","postprocessingAllow","glCheckError","releaseCanvas","reloadSafe","defineCausesReload","updateMatrices","getFrameTimestamp","getFrameIndex","getFrameDt","getFrameDtActual","setState","stateActive","resizing","addTickFunc","postTick","getTemporaryTexture","setupProjection","start3DRendering","projectionZBias","setErrorReportDetails","loadsPending","DEBUG","assert","cmds","effects","glov_font","font_info_palanquin32","mat3FromMat4","mat4Copy","mat4Invert","mat4Mul","mat4Transpose","mat4Perspective","asin","floor","sqrt","models","perf","settings","soundLoading","soundStartup","soundTick","sprites","texturesTick","glov_transition","urlhash","clamp","defaults","nearSame","ridx","mat3","mat4","v3mulMat4","v3iNormalize","v4copy","v4same","canvas","glov_particles","antialias","game_width","game_height","TYPE_SET","change","any_3d","ZFAR","ZNEAR","fov_y","fov_x","mat_projection","mat_view","mat_m","mat_vp","mat_mv","mat_mv_no_skew","mat_mvp","mat_mv_inv_transform","mat_inv_view","projection_inverse","light_diffuse","light_dir_vs","light_ambient","light_dir_ws","font","app_state","border_color","mat_temp","_mat_view","new_fov","is_ios_safari","ua","is_ios","webkit","postprocessing_reset_version","postprocessing","allow","gl_err","getError","getExtension","loseContext","ignored","reload","reloading_defines","onURLChange","handleDefinesChanged","normalizeRow","m","idx","mat_model","global_timer","this_frame_time","hrtime","this_frame_time_actual","after_loading_state","is_loading","new_state","test_state","mspf","mspf_update_time","mspf_frame_count","last_tick_cpu","mspf_tick","mspf_tick_accum","PERF_HISTORY_SIZE","glov_perf_state","fpsgraph","history","addMetric","name","show_stat","show_graph","labels","fps: ","fps","ms/f: ","msF","cpu: ","cpu","line_scale_top","colors","interactable","do_borders","do_viewport_postprocess","need_repos","app_tick_functions","cb","post_tick","opts","ticks","inactive","equal","temporary_textures","resetEffects","temp","destroy","SAFARI_FULLSCREEN_ASPECT","screen","SAFARI_DIMS","896,414","812,375","736,414","716,414","667,375","647,375","548,320","availWidth","availHeight","safariTopSafeArea","last_canvas_width","last_canvas_height","last_body_height","safearea_elem","safearea_ignore_bottom","safearea_values","last_safearea_values","checkResize","vv","visualViewport","css_to_real","innerWidth","innerHeight","body","new_width","clientWidth","new_height","clientHeight","sa_width","offsetWidth","sa_height","offsetHeight","offsetLeft","offsetTop","pixel_scale","scroll","xywh","last_temp_idx","_tex","createForCapture","do_filter_linear","do_wrap","copyTexImage","NEAREST","REPEAT","frame_requested","requestFrame","max_fps","SLOWLOAD","requestAnimationFrame","mat_projection_10","had_3d_this_frame","use_fov_y","use_width","use_height","znear","zfar","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","BLEND","depthMask","DEPTH_BUFFER_BIT","CULL_FACE","dist","at_z","fixNatives","is_startup","old_val","defineProperty","enumerable","_a","hrnow","performance","last_tick","timestamp","dt","hidden","webkitHidden","rise","_rise","tickInput","tickUI","ul","lr","viewport2","view_height","font_size","elem_fullscreen","drawRect","BORDERS","show_metrics","_ii","render","endFrame","_ii2","error_report_details","error_report_details_str","escape","k","last_error_time","crash_idx","filtered_errors","glovErrorReport","getURLBase","lastIndexOf","href","periodiclyRequestFrame","error_report","is_pixely","pixely","powerPreference","high","context_names","force_webgl1","NOWEBGL2","ts","log","FORCEWEBGL2","rc","context_opts","good","jj","getContext","alert","visibility","viewport_postprocess","depthFunc","LEQUAL","cullFace","BACK","pixelStorei","UNPACK_ALIGNMENT","ambient","mvp","mv_inv_trans","view","projection","defaultFilters","LINEAR_MIPMAP_LINEAR","font_info_04b03x2","font_info_04b03x1","info","texture","bindSounds","ui_sounds","button_click","rollover","show_fps","load_count","loading","elem_loading_text","loading_elem","glov_engine","filewatchOn","filewatchMessageHandler","filewatchTriggerChange","filewatchStartup","by_ext","by_match","ext_or_search","message_cb","onFileChange","filename","ext_idx","did_reload","client","onMsg","intColorFromVec4Color","vec4ColorFromIntColor","styleColored","styleAlpha","v4clone","v4scale","COLOR_MODE","SINGLE","GRADIENT","ALIGN","HLEFT","HCENTER","HRIGHT","HMASK","VTOP","VCENTER","VBOTTOM","VMASK","HFIT","HWRAP","HCENTERFIT","HVCENTER","HVCENTERFIT","GlovFontStyle","color_vec4","outline_width","outline_color","glow_xoffs","glow_yoffs","glow_inner","glow_outer","glow_color","color","colorUR","colorLR","colorLL","color_mode","font_shaders","glov_font_default_style","font_style","fields","ret","_f","colorAlpha","alpha","tech_params","tech_params_dirty","temp_color","createTechniqueParameters","param0","outlineColor","glowColor","glowParams","tex0","techParamsSet","param","tpv","techParamsGet","GlovFont","font_info","texture_name","noFilter","font_aa","tex_w","imageW","tex_h","imageH","char_infos","char_info","sc","_char_info","xpad","yoffs","replacement_character","infoFromChar","default_style","applied_style","drawSizedColor","drawSized","drawScaled","drawSizedAligned","_x","_y","align","x_size","y_size","getStringWidth","drawSizedColorWrapped","indent","drawScaledWrapped","drawSizedWrapped","wrapLines","word_cb","wrapLinesScaled","numLines","applyStyle","numlines","wordCallback","linenum","word","getCharacterWidth","xsc","x_advance","calcXAdvance","word_start","word_x0","space_info","space_size","hard_wrap","newx","char_w","tabsize","word_width","ysc","last_width","num_lines","xoffs","y2","x2","word_w","font_texel_scale","isFinite","y_offset","avg_scale_font","camera_xscale","camera_yscale","avg_scale_combined","tile_state","delta_per_source_pixel","spread","delta_per_dest_pixel","padding1","padding4","outer_scaled","value2","padding_in_font_space","z_advance","rel_x_scale","rel_y_scale","char_scale","xsc2","ysc2","pad_scale","tile_width","tile_height","u0","u1","v0","v1","queueraw","determineShader","outline","font_aa_outline_glow","font_aa_outline","font_aa_glow","fontShadersInit","_len","_key","Function","concat","createIndices","createQuads","TRIANGLES","TRIANGLE_FAN","gl_byte_size","5120","5121","5122","5123","5126","bound_geom","bound_array_buf","bound_index_buf","quad_index_buf","quad_index_buf_len","deleteBuffer","bindBuffer","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","attrib_enabled","enableVertexAttribArray","bits","disable_mask","enable_mask","disableVertexAttribArray","_n","getQuadIndexBuf","quad_count","arr","Uint16Array","vidx","bufferData","STATIC_DRAW","idxs","ibo","ibo_size","formatInfo","stride","elem_count","used_attribs","common_byte_size","fmt","sem","gltype","count","byte_size","Geom","verts","mode","format_info","vert_count","vert_gpu_mem","vbo","orig_mode","ibo_owned","updateSub","offset","bufferSubData","update","num_verts","DYNAMIC_DRAW","subarray","dispose","bound_attribs","normalized","vertexAttribPointer","drawElements","UNSIGNED_SHORT","drawArrays","GeomMultiQuads","ec","geoms","num_sub_verts","sub_data","decode","charCache","charFromCodePt","fromCodePoint","fromCharCode","result","array","codePt","byte1","buffLen","getAccessorTypeFromSize","TYPES","ATTRIBUTE_TYPE_TO_COMPONENTS","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE","5125","ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY","Int8Array","Int16Array","Uint32Array","unpackGLBBuffers","unpackBinaryJson","padTo4Bytes","byteLength","decode_utf8","MAGIC_glTF","GLB_FILE_HEADER_SIZE","GLB_CHUNK_HEADER_SIZE","GLB_CHUNK_TYPE_JSON","GLB_CHUNK_TYPE_BIN","LE","BE","GLBParser","binaryByteOffset","packedJson","json","parseBinary","DataView","glbArrayBuffer","magic1","getUint32","fileLength","valid","jsonChunkLength","jsonChunkFormat","jsonChunkOffset","jsonChunk","jsonText","JSON","parse","binaryChunkStart","binChunkFormat","arrayBuffer","parseInternal","unpackedBuffers","parseSync","getApplicationData","getArrayBuffer","getBinaryByteOffset","getBufferView","glTFBufferView","byteOffset","getBuffer","glTFAccessor","ArrayType","componentType","components","bytesPerComponent","bufferViews","bufferView","getImageData","glTFImage","typedArray","mimeType","getImage","arrayBufferView","blob","Blob","urlCreator","URL","webkitURL","imageUrl","createObjectURL","img","Image","parser","parseJSONPointer","matches","_index","decodeJSONPointer","object","buffers","pointer","field","unpackJsonArraysRecursive","topJson","options","element","newObject","getArrayBufferAtOffset","binaryBuffer","ArrayBuffer","sourceArray","binaryArray","getArrayTypeAndLength","accessor","unpackAccessors","accessors","accessorBuffers","_getArrayTypeAndLengt","unpackImages","images","imageBuffers","image","imate","topOfFrame","cbs","code_or_pos","keyCode","pageX","pageY","button","pointerLocked","eatAllInput","mousePos","mouseMoved","mouseWheel","mouseOver","mouseDown","mousePosIsTouch","isTouchDown","numTouches","keyDown","keyDownEdge","padGetAxes","padButtonDown","padButtonDownEdge","padButtonUpEdge","mouseUpEdge","mouseDownEdge","mouseConsumeClicks","drag","longPress","dragDrop","dragOver","in_event","soundResume","v2add","v2copy","v2lengthSq","v2set","v2scale","v2sub","UP_EDGE","UP","DOWN","DOWN_EDGE","TOUCH_AS_MOUSE","map_analog_to_dpad","mouse_log","ANY","POINTERLOCK","BACKSPACE","TAB","ENTER","RETURN","SHIFT","CTRL","ALT","SPACE","PAGEUP","PAGEDOWN","END","HOME","LEFT","RIGHT","INS","DEL","NUMPAD_DIVIDE","EQUALS","MINUS","SLASH","TILDE","Proxy","target","prop","PAD","A","SELECT","B","X","Y","LB","LEFT_BUMPER","RB","RIGHT_BUMPER","LT","LEFT_TRIGGER","RT","RIGHT_TRIGGER","START","LEFT_STICK","RIGHT_STICK","ANALOG_UP","ANALOG_LEFT","ANALOG_DOWN","ANALOG_RIGHT","pad_to_touch","key_state_new","pad_states","gamepad_data","mouse_pos","last_mouse_pos","mouse_pos_is_touch","mouse_over_captured","mouse_down","mouse_wheel","movement_questionable_frames","MOVEMENT_QUESTIONABLE_FRAMES","input_eaten_kb","input_eaten_mouse","touches","touch_mode","pad_mode","TYPE_INT","eventTimestamp","timeStamp","TouchData","touch","delta","total","cur_pos","start_pos","start_time","dispatched","dispatched_drag_over","up_edge","down_edge","down_time","origin_time","down","is_edge","MIN_EVENT_TIME_DELTA","timeDelta","et","KeyData","keyUp","setMouseToMid","isLocked","pointerlock_touch_id","when","enter","onPointerLockEnter","touch_data","exit","last_event","skip","isTrusted","sourceCapabilities","currentTarget","eventlog","pairs","letEventThrough","tagName","className","stopPropagation","unload_protected","beforeUnload","returnValue","protectUnload","onKeyUp","ctrlKey","ks","onKeyDown","no_stop","F5","F12","I","altKey","metaKey","shiftKey","mouse_moved","temp_delta","last_abs_move","last_abs_move_time","onMouseMove","any_movement","movementX","movementY","abs_move","onMouseDown","no_click","touch_id","onMouseUp","onWheel","deltaY","wheelDelta","detail","touch_pos","released_touch_id","onTouchChange","cancelable","ct","seen","new_count","old_count","last_touch","identifier","released_touch","released_ids","_touch","release","_touch2","new_id","_touch3","onBlurOrFocus","evt","ANALOG_MAP","genAnalogMap","_canvas","passive_param","passive","WheelEvent","DEADZONE","DEADZONE_SQ","NUM_STICKS","PAD_THRESHOLD","getGamepadData","gpd","sticks","updatePadState","ps","padcode","_touch_id","gamepadUpdate","gamepads","webkitGamepads","getGamepads","webkitGetGamepads","numGamePads","gamepad","buttons","numButtons","axes","pair","magnitude","endFrameTickMap","keycode","skip_mouse","mousePosParam","check_pos","checkPos","pos_param","drag_target","stickindex","padindex","sub","padButtonDownInternal","padButtonDownEdgeInternal","padButtonUpEdgeInternal","padButtonShared","max_click_dist","max_dist","phys","in_event_button","min_dist","is_down_edge","eat_clicks","payload","drag_payload","min_time","long_press_dispatched","time","long_press","link","linkText","linkTick","ui","state_cache","good_url","clicked","frame","a_elem","onclick","style_link","style_link_hover","mouseover","underline_w","drawLine","clearAll","exportAll","importAll","storage_prefix","lsd","localStorage","stringify","def","key_prefix","prefix","RegExp","serialized","mat43","m43identity","m43mul","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","b4","b5","b6","b7","b8","glb_parser","renderer","box_glb","default_vshader","default_fshader","initShaders","Model","base_url","array_buffer","skip_attr","TANGENT","glb_data","glb","glb_json","objs","meshes","mesh","primitives","material","materials","bct","pbrMetallicRoughness","baseColorTexture","texture_def","sampler_def","samplers","sampler","uri","magFilter","minFilter","wrapS","wrapT","bidx","total_size","attr","attributes","_accessor","geom_format","geom_count","my_vert_count","vert","_attr","kk","indices","mat","drawGeom","_ii3","model","box","model_box","buildString","packet","subscription_manager","WSClient","wscommon","subs","pver","PROTOCOL_VERSION","default_flags","PACKET_DEBUG","auto_create_user","Boolean","build_timestamp_string","toISOString","preloadParticleData","v2lerp","v2mul","v3add","v4lerp","v4mul","blend_map","BLEND_ALPHA","additive","BLEND_ADDITIVE","particle_data","defs","part_name","particles","part_def","normalizeValue","normalizeValueVec","vec","normalizeParticle","particle_manager","norm","blend","color_track","size_track","accel","rot","rot_vel","lifespan","kill_time_accel","_e","_arr","findParticle","normalizeEmitter","part_map","part_idx","particle","vel","emit_rate","emit_time","emit_initial","normalizeDef","system_lifespan","emitters","instValue","instValueVec","temp_color2","temp_size","temp_size2","ParticleSystem","def_in","age","kill_hard","kill_soft","part_sets","part_set","_def","emitter","countdown","started","stopped","part","age_norm","dts","weight","_weight","queueraw4","dt_orig","tickParticle","init_dt","emitter_def","emitParticle","remaining_dt","emit_dt","tickPartSet","_ii4","tickEmitter","ParticleManager","systems","system","_key2","v3copy","metrics","METRIC_PAD","bg_default","bg_mouse_over","bg_fade","fps_graph","fps_style","metric","history_size","num_labels","showMetric","pad","METRIC_VALUE_WIDTH","line_height","max_label_w","max_labels","drew_any","label_w","FPSMETER","bg","showMetricGraph","small","LINE_WIDTH","LINE_PAD","LINE_HEIGHT","NUM_LINES","history_index","line_scale","line_index","bar_max","line_jj","bar_min","bars_stack","lesser","line_kk","y_graph","user_want_locked","on_ptr_lock","pointerLog","exitPointerLock","requestPointerLock","onPointerLockChange","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","onPointerLockError","_elem","_on_ptr_lock","mozRequestPointerLock","webkitRequestPointerLock","mozExitPointerLock","webkitExitPointerLock","begin","Int32Array","delim","fill","cmpDefault","cmp","titleCase","true","ver","addInclude","addReservedDefine","setInternalDefines","addGlobal","matchAll","texturesUnloadDynamic","webFSGetFile","last_id","bound_prog","ATTR0","ATTR1","COLOR","COLOR_0","ATTR2","TEXCOORD","TEXCOORD_0","ATTR3","NORMAL","ATTR4","TEXCOORD_1","globals","error_fp","error_vp","vp_attr_regex","uniform_regex","sampler_regex","include_regex","type_size","float","includes","loadInclude","report_queued","shader_errors","reportShaderError","doReport","parseIncludes","supplied_uniforms","replacement","str2","webgl2_header","webgl2_header_fp","webgl2_header_vp","Shader","endsWith","FRAGMENT_SHADER","VERTEX_SHADER","createShader","programs","compile","header","found","uniforms","type_name","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","error_text","getShaderInfoLog","trim","uniformSetValue","unif","uniform1fv","uniform2fv","uniform3fv","uniform4fv","uniformMatrix3fv","uniformMatrix4fv","prog","createProgram","attachShader","bindAttribLocation","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","getUniformLocation","glob","_name","uniform1i","_jj","reserved","WEBGL2","internal_defines","applyDefines","shaderReload","deleteProgram","new_values","onShaderChange","_globals","soundLoad","soundResumed","soundPlay","soundPlayMusic","FADE_DEFAULT","FADE_OUT","FADE_IN","FADE","DEFAULT_FADE_RATE","num_loading","default_params","ext_list","fade_rate","sound_params","last_played","fades","music","base","preferred_ext","srcs","suffix","for_reload","tryLoad","streaming","glov_load_opts","extra","soundReload","sound_name","current_volume","target_volume","sys_volume","need_play","max_fade","mus","fade_amt","soundname","as_music","last_played_time","fadeOut","transition","start_vol","_sys_volume","DEFAULT_PERIOD","DEFAULT_PERIOD_NOISE","DEFAULT_ADD_DELAY","inherit_props","SoundScape","base_path","layers","intensity","tags","layer","files","odds","odds_total","add_delay","period","period_noise","tag","layer_state","active","rel_intensity","last_add","layer_data","getTag","setTag","setIntensity","getLayer","priority","taglayer","active_list","to_remove","wanted","min_intensity","active_files","active_sound","add_blocked","valid_files","_idx","_file","_sound","_data","spriteQueuePush","spriteQueuePop","queuefn","queuesprite","clip","buildRects","nextHighestPowerOfTwo","sprite_vshader","sprite_fshader","sprite_dual_fshader","sprite_shader_params","last_uid","sprite_queue","sprite_freelist","sprite_queue_stack","SpriteData","shader_params","uid","spriteDataAlloc","cmpSprite","x3","y3","uvs","nozoom","pixel_perfect","dx","dy","cosr","sinr","ch","cw","sh","sw","ubias","vbias","zoom_level","mipped_texels","z_start","z_end","xy","wh","gd_h","scissor","SCISSOR_TEST","diffTextures","texsa","texsb","batch_state","sprite_geom","sprite_buffer","sprite_buffer_len","sprite_buffer_batch_start","sprite_buffer_idx","last_blend_mode","last_bound_shader","MAX_VERT_COUNT","batches","commit","commitAndFlush","batch","ONE","bufferSpriteData","c1","c2","c3","c4","u2","v2","new_length","ws","hs","rects","total_w","total_h","hw","non_square","asp","widths","heights","Sprite","onLoad","src_width","src_height","uidata","drawDualTint","color1","dot_prop","EventEmitter","md5","isPacket","util","ClientChannelWorker","channel_id","subscriptions","subscribe_failed","got_subscribe","handlers","handleChannelData","handleApplyChannelData","inherits","onSubscribe","autosubscribed","onceSubscribe","emit","channel_type","cmd_list","cmds_list_by_worker","resp","addServerCommands","getChannelData","setChannelData","skip_predict","q","pak","wsPak","writeAnsiString","writeBool","writeJSON","removeMsgHandler","broadcast","silent_error","SubscriptionManager","channels","logged_in","login_credentials","logged_in_username","was_logged_in","logging_in","logging_out","first_connect","server_time","server_time_interp","handleConnect","handleChannelMessage","handleServerTime","handleAdminMsg","onceConnected","connected","reconnect","socket","resub","channel","loginInternal","login","readAnsiString","is_packet","readBool","readJSON","debug_msg","contents","getChannel","readInt","getServerTime","subscribe","do_subscribe","getUserId","loggedIn","getMyUserChannel","user_id","unsubscribe","onLogin","handleLoginResponse","logged_in_display_name","display_name","password","secret","userCreateInternal","hashedPassword","username","hashed_password","userCreate","password_confirm","email","hashed_password_confirm","logout","_this2","_channel","sendCmdParse","command","channel_ids","last_error","tryNext","isArrayBound","getExternalTextureURL","setExternalTextureBaseURL","findTexForReplacement","callEach","isPowerOfTwo","TEX_UNLOAD_TIME","aniso","max_aniso","aniso_enum","default_filter_min","default_filter_mag","cube_faces","R8","RGB8","RGBA8","mag","bound_unit","bound_tex","handle_loading","handle_error","setUnit","unit","activeTexture","TEXTURE0","bindHandle","bindTexture","unbindAll","TEXTURE_2D","last_use","eff_handle","auto_unload_textures","Texture","loaded","load_fail","is_array","TEXTURE_2D_ARRAY","is_cube","TEXTURE_CUBE_MAP","createTexture","on_load","soft_error","auto_unload","updateData","loadURL","updateGPUMem","new_size","mipmaps","texParameteri","TEXTURE_MIN_FILTER","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","texParameterf","destroyed","np2","texImage2D","internal_type","gl_type","num_images","texImage3D","texSubImage2D","tex_size","face","drawImage","_num_images","_ctx","generateMipmap","texture_base_url","TEX_RETRY_COUNT","next","did_next","done","fail","crossOrigin","retries","handleLoad","err_details","_err","copyTexImage2D","RGB","deleteTexture","last_temporary_id","unique_name","search_key","compare_key","tick_next_tex","textureReload","LUMINANCE","UNSIGNED_BYTE","RGBA","ext_anisotropic","TEXTURE_MAX_ANISOTROPY_EXT","MAX_TEXTURE_MAX_ANISOTROPY_EXT","queue","splitScreen","pixelate","randomTransition","pow","easeOut","unit_vec","transitions","IMMEDIATE","REMOVE","CONTINUE","transition_pixelate","GlovTransition","capture","accum_time","transitionCapture","trans","immediate","TRANSITION_FINAL","_trans","destroyTexture","trans_idx","TRANSITION_RANGE","force_end","glovTransitionFadeFunc","fade_time","initial","ms_since_start","progress","glovTransitionSplitScreenFunc","border_width","slide_window","v_half","border_grow_progress","render_scale","transition_pixelate_texture","transitionPixelateCapture","glovTransitionPixelateFunc","gd_width","partial_progress","param1","texSizeX","texSizeY","fade_time_scale","makeColorSet","loadUISprite","drawHBox","drawVBox","drawBox","playUISound","setMouseOver","isFocusedPeek","isFocused","focusPrev","panel","drawTooltip","buttonShared","buttonTextDraw","buttonText","buttonImage","print","modalDialog","modalDialogClear","modalTextEntry","createEditBox","slider","menuUp","provideUserString","drawCircle","drawHollowCircle","drawCone","scaleSizes","setModalSizes","setFontHeight","setTooltipWidth","MODAL","TOOLTIP","glov_edit_box","glov_sprites","clone","lerp","merge","MODAL_DARKEN","menu_fade_params_default","saturation","brightness","fallback_darken","regular","disabled","doBlurEffect","desaturate_xform","desaturate_tmp","doDesaturateEffect","button_height","modal_button_width","button_img_size","modal_width","modal_y0","modal_title_scale","modal_pad","panel_pixel_scale","tooltip_panel_pixel_scale","tooltip_width","tooltip_pad","font_style_focused","font_style_normal","color_button","color_panel","modal_font_style","button_mouseover","button_focused","touch_changed_focus","last_frame_button_mouseover","frame_button_mouseover","modal_dialog","modal_stealing_focus","menu_up","menu_fade_params","menu_up_time","last_frame_edit_boxes","dom_elems","dom_elems_issued","button_keys","focused_last_frame","focused_this_frame","focused_key_not","focused_key","focused_key_prev1","focused_key_prev2","pad_focus_left","pad_focus_right","overrides","only_override","override","ui_sprites","pad_focus_dpad","button_regular","ok","O","cancel","yes","no","N","dynamic_text_elem","per_frame_dom_alloc","last_elem","sum","coords","my_w","my_h","quiet","tooltip","tooltip_w","tooltip_y0","eff_tooltip_pad","tooltip_above","draw_only","rollover_quiet","no_focus","key_opts","no_touch_mouseover","touch_twice","drag_over","z_bias","button_last_color","base_name","sprite_name","hpad","_buttonShared","shrink","img_rect","_buttonShared2","no_bg","img_origin","img_w","img_h","largest_w_horiz","largest_w_vert","pad_top","draw_param","left_align","rotation","flip","title","dom_requirement","virtual_size","modalDialogRun","fullscreen_mode","eff_font_height","eff_button_height","vpad","general_scale","old_h","_modal_dialog","click_anywhere","eff_modal_width","eff_button_width","max_total_button_width","text_w","tick_key","avail_width","eff_button_keys","pressed","eb","edit_text","val","old_fn","getText","old_tick","eb_ret","run","edit_w","color_slider_handle","color_slider_handle_grab","color_slider_handle_over","slider_dragging","draggable_width","grabbed","handle_center_pos","handle_h","handle_w","slider_handle","handle_x","handle_y","handle_color","pp_bad_frames","pp_this_frame","NOPP","edit_box","unrun","removeChild","copyTextToClipboard","textArea","position","border","boxShadow","background","execCommand","thing","copy_success","OK","mx","my","Mx","My","spreadTechParams","drawCircleInternal","tu1","tv1","tu2","tv2","circle","CIRCLE_SIZE","midp","d","filter_max","hollow_circle","LINE_W","LINE_SIZE","tangx","tangy","w0","w1","cone","CONE_SIZE","_dx","_dy","dCircle","_modal_button_width","title_scale","_font_height","_tooltip_width","_tooltip_panel_pixel_scale","onChange","route","refreshTitle","go","HISTORY_UPDATE_TIME","title_suffix","url_base","on_change","cmpNumKeys","route_param_regex","routes","route_string","regex","new_route","queryString","regex_value","getValue","query_string","_m","_r","m2","last_history_str","goInternal","hides","otherkey","dirty","_opts","new_value","_v","_opts2","eff_title","toString","values","root_value","outer","route_title","_key3","_opts3","hide_values","_key4","_opts4","periodicRefreshTitle","onPopState","on_url_change","last_history_set_time","scheduled","need_push_state","updateHistory","new_need_push_state","new_str","delay","pushState","replaceState","regex_search","regex_type","onpopstate","vec1","v2abs","v2addScale","v2distSq","v2div","v2floor","v2normalize","v2same","v3iAdd","v3addScale","v3cross","v3determinant","v3dot","v3distSq","v3div","v3iFloor","v3floor","v3lengthSq","v3lerp","v3iMax","v3iMin","v3mul","v3normalize","v3perspectiveProject","v3round","v3same","v3scale","v3set","v3sub","v3iSub","v3zero","v4add","v4mulAdd","v4zero","half_vec","zero_vec","identity_mat3","identity_mat4","xaxis","yaxis","zaxis","it","invw","offs","sync","seconds","webFSExists","webFSReportUnused","fs","glov_webfs","decoded","used","u8","idxo","idxi","byte","encoding","report_ignore_regex","tot_size","webFSReload","scriptTag","old_fs","old_value","getElementsByTagName","ack","ackInitReceiver","walltime","wsHandleMessage","disconnected","retry_scheduled","retry_count","disconnect_time","last_receive_time","last_send_time","auto_path","path2","onConnectAck","onAppVer","onError","timeSinceDisconnect","on_app_ver_mismatch","app_ver","client_id","sendMessage","wrappedCallback","checkForNewAppVersion","app_ver_check_in_progress","responseText","delayed_recheck","retryConnection","for_reconnect","WebSocket","binaryType","guard","abort","skip_close","failAll","retry","doPing","PING_TIME","glov_local_storage","net","soundscape","BACKGROUND","SPRITES","PARTICLES","UI_TEST","ss","initGraphics","genFiles","epic","night","bass","fg","button_spacing","testInit","exp","Buffer","isBuffer","ackWrapPakStart","ackWrapPakPayload","ackWrapPakFinish","ackHandleMessage","receiver","last_pak_id","resp_cbs","responses_waiting","ACKFLAG_IS_RESP","ACKFLAG_ERR","ACKFLAG_DATA_JSON","flags","ack_data","writeInt","resp_pak_id","resp_pak_id_offs","getOffset","data_offs","appendRemaining","writeString","makeReadable","zeroInt","updateFlags","ackReadHeader","getFlags","pak_id","readString","net_data_or_pak","send_func","pak_func","handle_func","net_data","expecting_response","timeout_id","sent_response","preSendResp","respFunc","resp_data","ref_pak","orig_send","chr_table","encode","dv","effi","decodeNativeBrowser","allocator","decode_size","encodeNativeNode","decodeNativeNode","buffer_len","write","BROWSER","base64Decode","base64Encode","isInteger","TYPE_NAME","checkAccess","CmdParse","cmds_for_complete","was_not_found","default_handler","cmdList","access_show","access_run","setDefaultHandler","store_key","init_value","store_value","cmpCmd","new_cmds","_cname","first_tok","stringUtf8Encode","utftext","rotateLeft","lValue","iShiftBits","addUnsigned","lX","lY","lX8","lY8","lX4","lY4","lResult","F","G","H","FF","ac","GG","HH","II","convertToWordArray","string","lWordCount","lMessageLength","lNumberOfWords_temp1","lNumberOfWords_temp2","lNumberOfWords","lWordArray","lBytePosition","lByteCount","wordToHex","wordToHexValue","wordToHexValue_temp","lByte","lCount","substr","AA","BB","CC","DD","S11","S12","S13","S14","S21","S22","S23","S24","S31","S32","S33","S34","S41","S42","S43","S44","packetBufPoolAlloc","packetBufPoolFree","PACKET_RESERVED1","PACKET_RESERVED2","FLAG_PACKET_INTERNAL","PACKET_UNOWNED_BUFFER","log2","FALSYS","NaN","PAK_BUF_DEFAULT_SIZE","UNDERRUN","POOL_PACKETS","POOL_TIMEOUT","POOL_BUF_BY_SIZE","pak_pool","pak_debug_pool","buf_pool","allocDataView","pool_idx","packet_pool_idx","wrapU8AsDataView","utf8ByteLength","utf8WriteChar","buf","buf_offs","poolBuf","Packet","init_size","pak_debug","reinit","has_flags","buf_len","bufs","bsizes","readable","ref_count","fit","ref","poolDebug","totalSize","setReadable","bsize","flush","extra_bytes","no_advance","new_offs","advance","writeU8","readU8","neg","setUint16","setUint32","low_bits","zeroes","sign","getUint16","high_bits","writeFloat","setFloat32","readFloat","getFloat32","writeU32","readU32","byte_length","utf8ReadChar","string_assembly","end_offset","_c","writeBuffer","null_buf","readBuffer","do_copy","append","_buf","_bsize","_offs","toJSON","setBuffer","getBufferLen","writeFlags","readFlags","read","getInternalFlags","PacketDebug","in_pool","warned","pool_timer","types","write_fn","read_fn","found_idx","fname","cur_offs","read_len","saved_ref_count","type_idx","packetCreate","packetFromBuffer","need_copy","_pak","packetFromJSON","js_obj","_listeners","addListener","ee","hasListener","removeListener","filterNotOnce","any","any_once","nop","empty","easeInOut","easeIn","cloneShallow","mix","round100","round1000","fract","lineCircleIntersect","logdata","toNumber","randomNot","toArray","va","dest","hasOwnProperty","mn","tol","EPSILON","p1","p2","pCircle","radius","dp","bb4ac","mu1","mu2","ctor","superCtor","constructor","writable","configurable","not_value","max_value","array_like","re","pre_clear","wsPakSendDest","CONNECTION_TIMEOUT","PAK_HEADER_SIZE","ws_server","wsPakSendFinish","_pak$ws_data","ws_data","ack_resp_pkt_id","wsPakSend","sendMessageInternal","sendFunc","pakFunc","handleFunc","handler","error_msg"],"mappings":"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","file":"app.bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","/*!\n *  howler.js v2.1.3\n *  howlerjs.com\n *\n *  (c) 2013-2019, James Simpson of GoldFire Studios\n *  goldfirestudios.com\n *\n *  Modified by Jimb Esser:\n *    Fix inconsistent return of self.\n *    Do not throw uncaught promise rejections at startup\n *    Fix audio not resuming upon keypress\n *    Fix audio not resuming upon mousedown\n *    Fix pre-loading entire audio file when streaming is desired\n *    Unlock audio even if WebAudio is disabled\n *    Expose `safeToPlay` so app doesn't queue up hundreds of sounds before we can play any\n *    Add `volume` parameter to `play()` so you can play a sound a specific volume without popping\n *    Add extra delay before firing `end` event to prevent sounds from being stopped before they even start on Android\n *    Fix creating unbounded number of Audio elements when `unlock` is called multiple times\n *    Fix calling createBufferSource() on every touch event if not unlocked\n *\n *  MIT License\n */\n\n(function() {\n\n  'use strict';\n\n  /** Global Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create the global controller. All contained methods and properties apply\n   * to all sounds that are currently playing or will be in the future.\n   */\n  var HowlerGlobal = function() {\n    this.init();\n  };\n  HowlerGlobal.prototype = {\n    /**\n     * Initialize the global Howler object.\n     * @return {Howler}\n     */\n    init: function() {\n      var self = this || Howler;\n\n      // Create a global ID counter.\n      self._counter = 1000;\n\n      // Pool of unlocked HTML5 Audio objects.\n      self._html5AudioPool = [];\n      self.html5PoolSize = 10;\n\n      // Internal properties.\n      self._codecs = {};\n      self._howls = [];\n      self._muted = false;\n      self._volume = 1;\n      self._canPlayEvent = 'canplaythrough';\n      self._navigator = (typeof window !== 'undefined' && window.navigator) ? window.navigator : null;\n\n      // Public properties.\n      self.masterGain = null;\n      self.noAudio = false;\n      self.usingWebAudio = true;\n      self.autoSuspend = true;\n      self.ctx = null;\n      self.safeToPlay = false;\n\n      // Set to false to disable the auto audio unlocker.\n      self.autoUnlock = true;\n\n      // Setup the various state values for global tracking.\n      self._setup();\n\n      return self;\n    },\n\n    /**\n     * Get/set the global volume for all sounds.\n     * @param  {Float} vol Volume from 0.0 to 1.0.\n     * @return {Howler/Float}     Returns self or current volume.\n     */\n    volume: function(vol) {\n      var self = this || Howler;\n      vol = parseFloat(vol);\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!self.ctx) {\n        setupAudioContext();\n      }\n\n      if (typeof vol !== 'undefined' && vol >= 0 && vol <= 1) {\n        self._volume = vol;\n\n        // Don't update any of the nodes if we are muted.\n        if (self._muted) {\n          return self;\n        }\n\n        // When using Web Audio, we just need to adjust the master gain.\n        if (self.usingWebAudio) {\n          self.masterGain.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n        }\n\n        // Loop through and change volume for all HTML5 audio nodes.\n        for (var i=0; i<self._howls.length; i++) {\n          if (!self._howls[i]._webAudio) {\n            // Get all of the sounds in this Howl group.\n            var ids = self._howls[i]._getSoundIds();\n\n            // Loop through all sounds and change the volumes.\n            for (var j=0; j<ids.length; j++) {\n              var sound = self._howls[i]._soundById(ids[j]);\n\n              if (sound && sound._node) {\n                sound._node.volume = sound._volume * vol;\n              }\n            }\n          }\n        }\n\n        return self;\n      }\n\n      return self._volume;\n    },\n\n    /**\n     * Handle muting and unmuting globally.\n     * @param  {Boolean} muted Is muted or not.\n     */\n    mute: function(muted) {\n      var self = this || Howler;\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!self.ctx) {\n        setupAudioContext();\n      }\n\n      self._muted = muted;\n\n      // With Web Audio, we just need to mute the master gain.\n      if (self.usingWebAudio) {\n        self.masterGain.gain.setValueAtTime(muted ? 0 : self._volume, Howler.ctx.currentTime);\n      }\n\n      // Loop through and mute all HTML5 Audio nodes.\n      for (var i=0; i<self._howls.length; i++) {\n        if (!self._howls[i]._webAudio) {\n          // Get all of the sounds in this Howl group.\n          var ids = self._howls[i]._getSoundIds();\n\n          // Loop through all sounds and mark the audio node as muted.\n          for (var j=0; j<ids.length; j++) {\n            var sound = self._howls[i]._soundById(ids[j]);\n\n            if (sound && sound._node) {\n              sound._node.muted = (muted) ? true : sound._muted;\n            }\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Handle stopping all sounds globally.\n     */\n    stop: function() {\n      var self = this || Howler;\n\n      // Loop through all Howls and stop them.\n      for (var i=0; i<self._howls.length; i++) {\n        self._howls[i].stop();\n      }\n\n      return self;\n    },\n\n    /**\n     * Unload and destroy all currently loaded Howl objects.\n     * @return {Howler}\n     */\n    unload: function() {\n      var self = this || Howler;\n\n      for (var i=self._howls.length-1; i>=0; i--) {\n        self._howls[i].unload();\n      }\n\n      // Create a new AudioContext to make sure it is fully reset.\n      if (self.usingWebAudio && self.ctx && typeof self.ctx.close !== 'undefined') {\n        self.ctx.close();\n        self.ctx = null;\n        setupAudioContext();\n      }\n\n      return self;\n    },\n\n    /**\n     * Check for codec support of specific extension.\n     * @param  {String} ext Audio file extention.\n     * @return {Boolean}\n     */\n    codecs: function(ext) {\n      return (this || Howler)._codecs[ext.replace(/^x-/, '')];\n    },\n\n    /**\n     * Setup various state values for global tracking.\n     * @return {Howler}\n     */\n    _setup: function() {\n      var self = this || Howler;\n\n      // Keeps track of the suspend/resume state of the AudioContext.\n      self.state = self.ctx ? self.ctx.state || 'suspended' : 'suspended';\n      if  (self.state === 'running') {\n        self.safeToPlay = true;\n      }\n\n      // Automatically begin the 30-second suspend process\n      self._autoSuspend();\n\n      // Check if audio is available.\n      if (!self.usingWebAudio) {\n        // No audio is available on this system if noAudio is set to true.\n        if (typeof Audio !== 'undefined') {\n          try {\n            var test = new Audio();\n\n            // Check if the canplaythrough event is available.\n            if (typeof test.oncanplaythrough === 'undefined') {\n              self._canPlayEvent = 'canplay';\n            }\n          } catch(e) {\n            self.noAudio = true;\n          }\n        } else {\n          self.noAudio = true;\n        }\n      }\n\n      // Test to make sure audio isn't disabled in Internet Explorer.\n      try {\n        var test = new Audio();\n        if (test.muted) {\n          self.noAudio = true;\n        }\n      } catch (e) {}\n\n      // Check for supported codecs.\n      if (!self.noAudio) {\n        self._setupCodecs();\n      }\n\n      return self;\n    },\n\n    /**\n     * Check for browser support for various codecs and cache the results.\n     * @return {Howler}\n     */\n    _setupCodecs: function() {\n      var self = this || Howler;\n      var audioTest = null;\n\n      // Must wrap in a try/catch because IE11 in server mode throws an error.\n      try {\n        audioTest = (typeof Audio !== 'undefined') ? new Audio() : null;\n      } catch (err) {\n        return self;\n      }\n\n      if (!audioTest || typeof audioTest.canPlayType !== 'function') {\n        return self;\n      }\n\n      var mpegTest = audioTest.canPlayType('audio/mpeg;').replace(/^no$/, '');\n\n      // Opera version <33 has mixed MP3 support, so we need to check for and block it.\n      var checkOpera = self._navigator && self._navigator.userAgent.match(/OPR\\/([0-6].)/g);\n      var isOldOpera = (checkOpera && parseInt(checkOpera[0].split('/')[1], 10) < 33);\n\n      self._codecs = {\n        mp3: !!(!isOldOpera && (mpegTest || audioTest.canPlayType('audio/mp3;').replace(/^no$/, ''))),\n        mpeg: !!mpegTest,\n        opus: !!audioTest.canPlayType('audio/ogg; codecs=\"opus\"').replace(/^no$/, ''),\n        ogg: !!audioTest.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\n        oga: !!audioTest.canPlayType('audio/ogg; codecs=\"vorbis\"').replace(/^no$/, ''),\n        wav: !!audioTest.canPlayType('audio/wav; codecs=\"1\"').replace(/^no$/, ''),\n        aac: !!audioTest.canPlayType('audio/aac;').replace(/^no$/, ''),\n        caf: !!audioTest.canPlayType('audio/x-caf;').replace(/^no$/, ''),\n        m4a: !!(audioTest.canPlayType('audio/x-m4a;') || audioTest.canPlayType('audio/m4a;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        mp4: !!(audioTest.canPlayType('audio/x-mp4;') || audioTest.canPlayType('audio/mp4;') || audioTest.canPlayType('audio/aac;')).replace(/^no$/, ''),\n        weba: !!audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, ''),\n        webm: !!audioTest.canPlayType('audio/webm; codecs=\"vorbis\"').replace(/^no$/, ''),\n        dolby: !!audioTest.canPlayType('audio/mp4; codecs=\"ec-3\"').replace(/^no$/, ''),\n        flac: !!(audioTest.canPlayType('audio/x-flac;') || audioTest.canPlayType('audio/flac;')).replace(/^no$/, '')\n      };\n\n      return self;\n    },\n\n    /**\n     * Some browsers/devices will only allow audio to be played after a user interaction.\n     * Attempt to automatically unlock audio on the first user interaction.\n     * Concept from: http://paulbakaus.com/tutorials/html5/web-audio-on-ios/\n     * @return {Howler}\n     */\n    _unlockAudio: function() {\n      var self = this || Howler;\n\n      // Only run this if Web Audio is supported and it hasn't already been unlocked.\n      // JE: Unlock even if not using WebAudio; Also, _audioUnlocked is never true here, and would be false while unlocking anyway\n      // if (self._audioUnlocked || !self.ctx) {\n      //   return self;\n      // }\n\n      self._audioUnlocked = false;\n      self.autoUnlock = false;\n\n      if (self.ctx) {\n        // Some mobile devices/platforms have distortion issues when opening/closing tabs and/or web views.\n        // Bugs in the browser (especially Mobile Safari) can cause the sampleRate to change from 44100 to 48000.\n        // By calling Howler.unload(), we create a new AudioContext with the correct sampleRate.\n        if (!self._mobileUnloaded && self.ctx.sampleRate !== 44100) {\n          self._mobileUnloaded = true;\n          self.unload();\n        }\n\n        // Scratch buffer for enabling iOS to dispose of web audio buffers correctly, as per:\n        // http://stackoverflow.com/questions/24119684\n        self._scratchBuffer = self.ctx.createBuffer(1, 1, 22050);\n      }\n\n      // Call this method on touch start to create and play a buffer,\n      // then check if the audio actually played to determine if\n      // audio has now been unlocked on iOS, Android, etc.\n      var unlock = function(e) {\n        // Create a pool of unlocked HTML5 Audio objects that can\n        // be used for playing sounds without user interaction. HTML5\n        // Audio objects must be individually unlocked, as opposed\n        // to the WebAudio API which only needs a single activation.\n        // This must occur before WebAudio setup or the source.onended\n        // event will not fire.\n        // JE: Don't add more to the pool than desired\n        while (self._html5AudioPool.length < self.html5PoolSize) {\n          try {\n            var audioNode = new Audio();\n\n            // Mark this Audio object as unlocked to ensure it can get returned\n            // to the unlocked pool when released.\n            audioNode._unlocked = true;\n\n            // Add the audio node to the pool.\n            self._releaseHtml5Audio(audioNode);\n          } catch (e) {\n            self.noAudio = true;\n            break;\n          }\n        }\n\n        // Loop through any assigned audio nodes and unlock them.\n        for (var i=0; i<self._howls.length; i++) {\n          if (!self._howls[i]._webAudio) {\n            // Get all of the sounds in this Howl group.\n            var ids = self._howls[i]._getSoundIds();\n\n            // Loop through all sounds and unlock the audio nodes.\n            for (var j=0; j<ids.length; j++) {\n              var sound = self._howls[i]._soundById(ids[j]);\n\n              if (sound && sound._node && !sound._node._unlocked) {\n                sound._node._unlocked = true;\n                sound._node.load();\n              }\n            }\n          }\n        }\n\n        // Fix Android can not play in suspend state.\n        self._autoResume();\n\n        function onUnlockFinish() {\n          // Update the unlocked state and prevent this check from happening again.\n          self._audioUnlocked = true;\n          self.safeToPlay = true;\n\n          // Remove the touch start listener.\n          document.removeEventListener('touchstart', unlock, true);\n          document.removeEventListener('touchend', unlock, true);\n          document.removeEventListener('click', unlock, true);\n          document.removeEventListener('mousedown', unlock, true);\n          document.removeEventListener('keydown', unlock, true);\n\n          // Let all sounds know that audio has been unlocked.\n          for (var i=0; i<self._howls.length; i++) {\n            self._howls[i]._emit('unlock');\n          }\n        }\n\n        if (self.ctx) {\n          // Create an empty buffer.\n          var source = self.ctx.createBufferSource();\n          source.buffer = self._scratchBuffer;\n          source.connect(self.ctx.destination);\n\n          // Play the empty buffer.\n          if (typeof source.start === 'undefined') {\n            source.noteOn(0);\n          } else {\n            source.start(0);\n          }\n\n          // Calling resume() on a stack initiated by user gesture is what actually unlocks the audio on Android Chrome >= 55.\n          if (typeof self.ctx.resume === 'function') {\n            self.ctx.resume();\n          }\n\n          // Setup a timeout to check that we are unlocked on the next event loop.\n          source.onended = function() {\n            source.disconnect(0);\n            onUnlockFinish();\n          };\n        } else {\n          // JE: non-WebAudio - we received user input, assume unlocked immediately\n          onUnlockFinish();\n        }\n      };\n\n      // Setup a touch start listener to attempt an unlock in.\n      document.addEventListener('touchstart', unlock, true);\n      document.addEventListener('touchend', unlock, true);\n      document.addEventListener('click', unlock, true);\n      document.addEventListener('mousedown', unlock, true);\n      document.addEventListener('keydown', unlock, true);\n\n      return self;\n    },\n\n    /**\n     * Get an unlocked HTML5 Audio object from the pool. If none are left,\n     * return a new Audio object and throw a warning.\n     * @return {Audio} HTML5 Audio object.\n     */\n    _obtainHtml5Audio: function() {\n      var self = this || Howler;\n\n      // Return the next object from the pool if one exists.\n      if (self._html5AudioPool.length) {\n        return self._html5AudioPool.pop();\n      }\n\n      // JE: Disabling this, it causes un-ignorable Uncaught Promise Rejection errors in Chrome.\n      // //.Check if the audio is locked and throw a warning.\n      // var testPlay = new Audio().play();\n      // if (testPlay && typeof Promise !== 'undefined' && (testPlay instanceof Promise || typeof testPlay.then === 'function')) {\n      //   testPlay.catch(function() {\n      //     console.warn('HTML5 Audio pool exhausted, returning potentially locked audio object.');\n      //   });\n      // }\n\n      return new Audio();\n    },\n\n    /**\n     * Return an activated HTML5 Audio object to the pool.\n     * @return {Howler}\n     */\n    _releaseHtml5Audio: function(audio) {\n      var self = this || Howler;\n\n      // Don't add audio to the pool if we don't know if it has been unlocked.\n      if (audio._unlocked) {\n        self._html5AudioPool.push(audio);\n      }\n\n      return self;\n    },\n\n    /**\n     * Automatically suspend the Web Audio AudioContext after no sound has played for 30 seconds.\n     * This saves processing/energy and fixes various browser-specific bugs with audio getting stuck.\n     * @return {Howler}\n     */\n    _autoSuspend: function() {\n      var self = this;\n\n      if (!self.autoSuspend || !self.ctx || typeof self.ctx.suspend === 'undefined' || !Howler.usingWebAudio) {\n        return self;\n      }\n\n      // Check if any sounds are playing.\n      for (var i=0; i<self._howls.length; i++) {\n        if (self._howls[i]._webAudio) {\n          for (var j=0; j<self._howls[i]._sounds.length; j++) {\n            if (!self._howls[i]._sounds[j]._paused) {\n              return self;\n            }\n          }\n        }\n      }\n\n      if (self._suspendTimer) {\n        clearTimeout(self._suspendTimer);\n      }\n\n      // If no sound has played after 30 seconds, suspend the context.\n      self._suspendTimer = setTimeout(function() {\n        if (!self.autoSuspend) {\n          return;\n        }\n\n        self._suspendTimer = null;\n        self.state = 'suspending';\n        self.ctx.suspend().then(function() {\n          self.state = 'suspended';\n\n          if (self._resumeAfterSuspend) {\n            delete self._resumeAfterSuspend;\n            self._autoResume();\n          }\n        });\n      }, 30000);\n\n      return self;\n    },\n\n    /**\n     * Automatically resume the Web Audio AudioContext when a new sound is played.\n     * @return {Howler}\n     */\n    _autoResume: function() {\n      var self = this;\n\n      if (!self.ctx || typeof self.ctx.resume === 'undefined' || !Howler.usingWebAudio) {\n        return self;\n      }\n\n      if (self.state === 'running' && self._suspendTimer) {\n        clearTimeout(self._suspendTimer);\n        self._suspendTimer = null;\n      } else if (self.state === 'suspended') {\n        self.ctx.resume().then(function() {\n          self.state = 'running';\n          // Emit to all Howls that the audio has resumed.\n          for (var i=0; i<self._howls.length; i++) {\n            self._howls[i]._emit('resume');\n          }\n        });\n\n        if (self._suspendTimer) {\n          clearTimeout(self._suspendTimer);\n          self._suspendTimer = null;\n        }\n      } else if (self.state === 'suspending') {\n        self._resumeAfterSuspend = true;\n      }\n\n      return self;\n    }\n  };\n\n  // Setup the global audio controller.\n  var Howler = new HowlerGlobal();\n\n  /** Group Methods **/\n  /***************************************************************************/\n\n  /**\n   * Create an audio group controller.\n   * @param {Object} o Passed in properties for this group.\n   */\n  var Howl = function(o) {\n    var self = this;\n\n    // Throw an error if no source is provided.\n    if (!o.src || o.src.length === 0) {\n      console.error('An array of source files must be passed with any new Howl.');\n      return;\n    }\n\n    self.init(o);\n  };\n  Howl.prototype = {\n    /**\n     * Initialize a new Howl group object.\n     * @param  {Object} o Passed in properties for this group.\n     * @return {Howl}\n     */\n    init: function(o) {\n      var self = this;\n\n      // If we don't have an AudioContext created yet, run the setup.\n      if (!Howler.ctx) {\n        setupAudioContext();\n      }\n\n      // Setup user-defined default properties.\n      self._autoplay = o.autoplay || false;\n      self._format = (typeof o.format !== 'string') ? o.format : [o.format];\n      self._html5 = o.html5 || false;\n      self._muted = o.mute || false;\n      self._loop = o.loop || false;\n      self._pool = o.pool || 5;\n      self._preload = (typeof o.preload === 'boolean') ? o.preload : true;\n      self._rate = o.rate || 1;\n      self._sprite = o.sprite || {};\n      self._src = (typeof o.src !== 'string') ? o.src : [o.src];\n      self._volume = o.volume !== undefined ? o.volume : 1;\n      self._xhrWithCredentials = o.xhrWithCredentials || false;\n      self._xhrHeaders = o.xhrHeaders || null;\n\n      // Setup all other default properties.\n      self._duration = 0;\n      self._state = 'unloaded';\n      self._sounds = [];\n      self._endTimers = {};\n      self._queue = [];\n      self._playLock = false;\n\n      // Setup event listeners.\n      self._onend = o.onend ? [{fn: o.onend}] : [];\n      self._onfade = o.onfade ? [{fn: o.onfade}] : [];\n      self._onload = o.onload ? [{fn: o.onload}] : [];\n      self._onloaderror = o.onloaderror ? [{fn: o.onloaderror}] : [];\n      self._onplayerror = o.onplayerror ? [{fn: o.onplayerror}] : [];\n      self._onpause = o.onpause ? [{fn: o.onpause}] : [];\n      self._onplay = o.onplay ? [{fn: o.onplay}] : [];\n      self._onstop = o.onstop ? [{fn: o.onstop}] : [];\n      self._onmute = o.onmute ? [{fn: o.onmute}] : [];\n      self._onvolume = o.onvolume ? [{fn: o.onvolume}] : [];\n      self._onrate = o.onrate ? [{fn: o.onrate}] : [];\n      self._onseek = o.onseek ? [{fn: o.onseek}] : [];\n      self._onunlock = o.onunlock ? [{fn: o.onunlock}] : [];\n      self._onresume = [];\n\n      // Web Audio or HTML5 Audio?\n      self._webAudio = Howler.usingWebAudio && !self._html5;\n\n      // Automatically try to enable audio.\n      if (Howler.autoUnlock) { // JE: Unlock even if not using WebAudio\n        Howler._unlockAudio();\n      }\n\n      // Keep track of this Howl group in the global controller.\n      Howler._howls.push(self);\n\n      // If they selected autoplay, add a play event to the load queue.\n      if (self._autoplay) {\n        self._queue.push({\n          event: 'play',\n          action: function() {\n            self.play();\n          }\n        });\n      }\n\n      // Load the source file unless otherwise specified.\n      if (self._preload) {\n        self.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Load the audio file.\n     * @return {Howler}\n     */\n    load: function() {\n      var self = this;\n      var url = null;\n\n      // If no audio is available, quit immediately.\n      if (Howler.noAudio) {\n        self._emit('loaderror', null, 'No audio support.');\n        return self;\n      }\n\n      // Make sure our source is in an array.\n      if (typeof self._src === 'string') {\n        self._src = [self._src];\n      }\n\n      // Loop through the sources and pick the first one that is compatible.\n      for (var i=0; i<self._src.length; i++) {\n        var ext, str;\n\n        if (self._format && self._format[i]) {\n          // If an extension was specified, use that instead.\n          ext = self._format[i];\n        } else {\n          // Make sure the source is a string.\n          str = self._src[i];\n          if (typeof str !== 'string') {\n            self._emit('loaderror', null, 'Non-string found in selected audio sources - ignoring.');\n            continue;\n          }\n\n          // Extract the file extension from the URL or base64 data URI.\n          ext = /^data:audio\\/([^;,]+);/i.exec(str);\n          if (!ext) {\n            ext = /\\.([^.]+)$/.exec(str.split('?', 1)[0]);\n          }\n\n          if (ext) {\n            ext = ext[1].toLowerCase();\n          }\n        }\n\n        // Log a warning if no extension was found.\n        if (!ext) {\n          console.warn('No file extension was found. Consider using the \"format\" property or specify an extension.');\n        }\n\n        // Check if this extension is available.\n        if (ext && Howler.codecs(ext)) {\n          url = self._src[i];\n          break;\n        }\n      }\n\n      if (!url) {\n        self._emit('loaderror', null, 'No codec support for selected audio sources.');\n        return self;\n      }\n\n      self._src = url;\n      self._state = 'loading';\n\n      // If the hosting page is HTTPS and the source isn't,\n      // drop down to HTML5 Audio to avoid Mixed Content errors.\n      if (window.location.protocol === 'https:' && url.slice(0, 5) === 'http:') {\n        self._html5 = true;\n        self._webAudio = false;\n      }\n\n      // Create a new sound object and add it to the pool.\n      new Sound(self);\n\n      // Load and decode the audio data for playback.\n      if (self._webAudio) {\n        loadBuffer(self);\n      }\n\n      return self;\n    },\n\n    /**\n     * Play a sound or resume previous playback.\n     * @param  {String/Number} sprite   Sprite name for sprite playback or sound id to continue previous.\n     * @param  {Number} volume\n     * @param  {Boolean} internal Internal Use: true prevents event firing.\n     * @return {Number}          Sound ID.\n     */\n    play: function(sprite, volume, internal) {\n      var self = this;\n      var id = null;\n\n      // Determine if a sprite, sound id or nothing was passed\n      if (typeof sprite === 'number') {\n        id = sprite;\n        sprite = null;\n      } else if (typeof sprite === 'string' && self._state === 'loaded' && !self._sprite[sprite]) {\n        // If the passed sprite doesn't exist, do nothing.\n        return null;\n      } else if (typeof sprite === 'undefined') {\n        // Use the default sound sprite (plays the full audio length).\n        sprite = '__default';\n\n        // Check if there is a single paused sound that isn't ended.\n        // If there is, play that sound. If not, continue as usual.\n        if (!self._playLock) {\n          var num = 0;\n          for (var i=0; i<self._sounds.length; i++) {\n            if (self._sounds[i]._paused && !self._sounds[i]._ended) {\n              num++;\n              id = self._sounds[i]._id;\n            }\n          }\n\n          if (num === 1) {\n            sprite = null;\n          } else {\n            id = null;\n          }\n        }\n      }\n\n      // Get the selected node, or get one from the pool.\n      var sound = id ? self._soundById(id) : self._inactiveSound();\n\n      // If the sound doesn't exist, do nothing.\n      if (!sound) {\n        return null;\n      }\n\n      // Select the sprite definition.\n      if (id && !sprite) {\n        sprite = sound._sprite || '__default';\n      }\n\n      // If the sound hasn't loaded, we must wait to get the audio's duration.\n      // We also need to wait to make sure we don't run into race conditions with\n      // the order of function calls.\n      if (self._state !== 'loaded') {\n        // Set the sprite value on this sound.\n        sound._sprite = sprite;\n\n        // Mark this sound as not ended in case another sound is played before this one loads.\n        sound._ended = false;\n\n        // Add the sound to the queue to be played on load.\n        var soundId = sound._id;\n        self._queue.push({\n          event: 'play',\n          action: function() {\n            self.play(soundId);\n          }\n        });\n\n        return soundId;\n      }\n\n      // Don't play the sound if an id was passed and it is already playing.\n      if (id && !sound._paused) {\n        // Trigger the play event, in order to keep iterating through queue.\n        if (!internal) {\n          self._loadQueue('play');\n        }\n\n        return sound._id;\n      }\n\n      // Make sure the AudioContext isn't suspended, and resume it if it is.\n      if (self._webAudio) {\n        Howler._autoResume();\n      }\n\n      // Determine how long to play for and where to start playing.\n      var seek = Math.max(0, sound._seek > 0 ? sound._seek : self._sprite[sprite][0] / 1000);\n      var duration = Math.max(0, ((self._sprite[sprite][0] + self._sprite[sprite][1]) / 1000) - seek);\n      var timeout = (duration * 1000) / Math.abs(sound._rate);\n      // JE: With short timeouts, we get clipped on no sound at all on Android\n      timeout += 500;\n      var start = self._sprite[sprite][0] / 1000;\n      var stop = (self._sprite[sprite][0] + self._sprite[sprite][1]) / 1000;\n      sound._sprite = sprite;\n\n      // Mark the sound as ended instantly so that this async playback\n      // doesn't get grabbed by another call to play while this one waits to start.\n      sound._ended = false;\n\n      // Update the parameters of the sound.\n      var setParams = function() {\n        sound._paused = false;\n        sound._seek = seek;\n        sound._start = start;\n        sound._stop = stop;\n        sound._loop = !!(sound._loop || self._sprite[sprite][2]);\n      };\n\n      // End the sound instantly if seek is at the end.\n      if (seek >= stop) {\n        self._ended(sound);\n        return null;\n      }\n\n      var sound_volume = typeof volume === 'number' ? volume : sound._volume;\n\n      // Begin the actual playback.\n      var node = sound._node;\n      if (self._webAudio) {\n        // Fire this when the sound is ready to play to begin Web Audio playback.\n        var playWebAudio = function() {\n          self._playLock = false;\n          setParams();\n          self._refreshBuffer(sound);\n\n          // Setup the playback params.\n          var vol = (sound._muted || self._muted) ? 0 : sound_volume;\n          node.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n          sound._playStart = Howler.ctx.currentTime;\n\n          // Play the sound using the supported method.\n          if (typeof node.bufferSource.start === 'undefined') {\n            sound._loop ? node.bufferSource.noteGrainOn(0, seek, 86400) : node.bufferSource.noteGrainOn(0, seek, duration);\n          } else {\n            sound._loop ? node.bufferSource.start(0, seek, 86400) : node.bufferSource.start(0, seek, duration);\n          }\n\n          // Start a new timer if none is present.\n          if (timeout !== Infinity) {\n            self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n          }\n\n          if (!internal) {\n            setTimeout(function() {\n              self._emit('play', sound._id);\n              self._loadQueue();\n            }, 0);\n          }\n        };\n\n        if (Howler.state === 'running') {\n          playWebAudio();\n        } else {\n          self._playLock = true;\n\n          // Wait for the audio context to resume before playing.\n          self.once('resume', playWebAudio);\n\n          // Cancel the end timer.\n          self._clearTimer(sound._id);\n        }\n      } else {\n        // Fire this when the sound is ready to play to begin HTML5 Audio playback.\n        var playHtml5 = function() {\n          node.currentTime = seek;\n          node.muted = sound._muted || self._muted || Howler._muted || node.muted;\n          node.volume = sound_volume * Howler.volume();\n          node.playbackRate = sound._rate;\n\n          // Some browsers will throw an error if this is called without user interaction.\n          try {\n            var play = node.play();\n\n            // Support older browsers that don't support promises, and thus don't have this issue.\n            if (play && typeof Promise !== 'undefined' && (play instanceof Promise || typeof play.then === 'function')) {\n              // Implements a lock to prevent DOMException: The play() request was interrupted by a call to pause().\n              self._playLock = true;\n\n              // Set param values immediately.\n              setParams();\n\n              // Releases the lock and executes queued actions.\n              play\n                .then(function() {\n                  self._playLock = false;\n                  node._unlocked = true;\n                  if (!internal) {\n                    self._emit('play', sound._id);\n                    self._loadQueue();\n                  }\n                })\n                .catch(function() {\n                  self._playLock = false;\n                  self._emit('playerror', sound._id, 'Playback was unable to start. This is most commonly an issue ' +\n                    'on mobile devices and Chrome where playback was not within a user interaction.');\n\n                  // Reset the ended and paused values.\n                  sound._ended = true;\n                  sound._paused = true;\n                });\n            } else if (!internal) {\n              self._playLock = false;\n              setParams();\n              self._emit('play', sound._id);\n              self._loadQueue();\n            }\n\n            // Setting rate before playing won't work in IE, so we set it again here.\n            node.playbackRate = sound._rate;\n\n            // If the node is still paused, then we can assume there was a playback issue.\n            if (node.paused) {\n              self._emit('playerror', sound._id, 'Playback was unable to start. This is most commonly an issue ' +\n                'on mobile devices and Chrome where playback was not within a user interaction.');\n              return;\n            }\n\n            // Setup the end timer on sprites or listen for the ended event.\n            if (sprite !== '__default' || sound._loop) {\n              self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n            } else {\n              self._endTimers[sound._id] = function() {\n                // Fire ended on this audio node.\n                self._ended(sound);\n\n                // Clear this listener.\n                node.removeEventListener('ended', self._endTimers[sound._id], false);\n              };\n              node.addEventListener('ended', self._endTimers[sound._id], false);\n            }\n          } catch (err) {\n            self._emit('playerror', sound._id, err);\n          }\n        };\n\n        // If this is streaming audio, make sure the src is set and load again.\n        if (node.src === 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA') {\n          node.src = self._src;\n          node.load();\n        }\n\n        // Play immediately if ready, or wait for the 'canplaythrough'e vent.\n        var loadedNoReadyState = (window && window.ejecta) || (!node.readyState && Howler._navigator.isCocoonJS);\n        if (node.readyState >= 3 || loadedNoReadyState) {\n          playHtml5();\n        } else {\n          self._playLock = true;\n\n          var listener = function() {\n            // Begin playback.\n            playHtml5();\n\n            // Clear this listener.\n            node.removeEventListener(Howler._canPlayEvent, listener, false);\n          };\n          node.addEventListener(Howler._canPlayEvent, listener, false);\n\n          // Cancel the end timer.\n          self._clearTimer(sound._id);\n        }\n      }\n\n      return sound._id;\n    },\n\n    /**\n     * Pause playback and save current position.\n     * @param  {Number} id The sound ID (empty to pause all in group).\n     * @return {Howl}\n     */\n    pause: function(id) {\n      var self = this;\n\n      // If the sound hasn't loaded or a play() promise is pending, add it to the load queue to pause when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'pause',\n          action: function() {\n            self.pause(id);\n          }\n        });\n\n        return self;\n      }\n\n      // If no id is passed, get all ID's to be paused.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Clear the end timer.\n        self._clearTimer(ids[i]);\n\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound && !sound._paused) {\n          // Reset the seek position.\n          sound._seek = self.seek(ids[i]);\n          sound._rateSeek = 0;\n          sound._paused = true;\n\n          // Stop currently running fades.\n          self._stopFade(ids[i]);\n\n          if (sound._node) {\n            if (self._webAudio) {\n              // Make sure the sound has been created.\n              if (!sound._node.bufferSource) {\n                continue;\n              }\n\n              if (typeof sound._node.bufferSource.stop === 'undefined') {\n                sound._node.bufferSource.noteOff(0);\n              } else {\n                sound._node.bufferSource.stop(0);\n              }\n\n              // Clean up the buffer source.\n              self._cleanBuffer(sound._node);\n            } else if (!isNaN(sound._node.duration) || sound._node.duration === Infinity) {\n              sound._node.pause();\n            }\n          }\n        }\n\n        // Fire the pause event, unless `true` is passed as the 2nd argument.\n        if (!arguments[1]) {\n          self._emit('pause', sound ? sound._id : null);\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Stop playback and reset to start.\n     * @param  {Number} id The sound ID (empty to stop all in group).\n     * @param  {Boolean} internal Internal Use: true prevents event firing.\n     * @return {Howl}\n     */\n    stop: function(id, internal) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to stop when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'stop',\n          action: function() {\n            self.stop(id);\n          }\n        });\n\n        return self;\n      }\n\n      // If no id is passed, get all ID's to be stopped.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Clear the end timer.\n        self._clearTimer(ids[i]);\n\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound) {\n          // Reset the seek position.\n          sound._seek = sound._start || 0;\n          sound._rateSeek = 0;\n          sound._paused = true;\n          sound._ended = true;\n\n          // Stop currently running fades.\n          self._stopFade(ids[i]);\n\n          if (sound._node) {\n            if (self._webAudio) {\n              // Make sure the sound's AudioBufferSourceNode has been created.\n              if (sound._node.bufferSource) {\n                if (typeof sound._node.bufferSource.stop === 'undefined') {\n                  sound._node.bufferSource.noteOff(0);\n                } else {\n                  sound._node.bufferSource.stop(0);\n                }\n\n                // Clean up the buffer source.\n                self._cleanBuffer(sound._node);\n              }\n            } else if (!isNaN(sound._node.duration) || sound._node.duration === Infinity) {\n              sound._node.currentTime = sound._start || 0;\n              sound._node.pause();\n\n              // If this is a live stream, stop download once the audio is stopped.\n              if (sound._node.duration === Infinity) {\n                self._clearSound(sound._node);\n              }\n            }\n          }\n\n          if (!internal) {\n            self._emit('stop', sound._id);\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Mute/unmute a single sound or all sounds in this Howl group.\n     * @param  {Boolean} muted Set to true to mute and false to unmute.\n     * @param  {Number} id    The sound ID to update (omit to mute/unmute all).\n     * @return {Howl}\n     */\n    mute: function(muted, id) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to mute when capable.\n      if (self._state !== 'loaded'|| self._playLock) {\n        self._queue.push({\n          event: 'mute',\n          action: function() {\n            self.mute(muted, id);\n          }\n        });\n\n        return self;\n      }\n\n      // If applying mute/unmute to all sounds, update the group's value.\n      if (typeof id === 'undefined') {\n        if (typeof muted === 'boolean') {\n          self._muted = muted;\n        } else {\n          return self._muted;\n        }\n      }\n\n      // If no id is passed, get all ID's to be muted.\n      var ids = self._getSoundIds(id);\n\n      for (var i=0; i<ids.length; i++) {\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        if (sound) {\n          sound._muted = muted;\n\n          // Cancel active fade and set the volume to the end value.\n          if (sound._interval) {\n            self._stopFade(sound._id);\n          }\n\n          if (self._webAudio && sound._node) {\n            sound._node.gain.setValueAtTime(muted ? 0 : sound._volume, Howler.ctx.currentTime);\n          } else if (sound._node) {\n            sound._node.muted = Howler._muted ? true : muted;\n          }\n\n          self._emit('mute', sound._id);\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the volume of this sound or of the Howl group. This method can optionally take 0, 1 or 2 arguments.\n     *   volume() -> Returns the group's volume value.\n     *   volume(id) -> Returns the sound id's current volume.\n     *   volume(vol) -> Sets the volume of all sounds in this Howl group.\n     *   volume(vol, id) -> Sets the volume of passed sound id.\n     * @return {Howl/Number} Returns self or current volume.\n     */\n    volume: function() {\n      var self = this;\n      var args = arguments;\n      var vol, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // Return the value of the groups' volume.\n        return self._volume;\n      } else if (args.length === 1 || args.length === 2 && typeof args[1] === 'undefined') {\n        // First check if this is an ID, and if not, assume it is a new volume.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          vol = parseFloat(args[0]);\n        }\n      } else if (args.length >= 2) {\n        vol = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // Update the volume or return the current volume.\n      var sound;\n      if (typeof vol !== 'undefined' && vol >= 0 && vol <= 1) {\n        // If the sound hasn't loaded, add it to the load queue to change volume when capable.\n        if (self._state !== 'loaded'|| self._playLock) {\n          self._queue.push({\n            event: 'volume',\n            action: function() {\n              self.volume.apply(self, args);\n            }\n          });\n\n          return self;\n        }\n\n        // Set the group volume.\n        if (typeof id === 'undefined') {\n          self._volume = vol;\n        }\n\n        // Update one or all volumes.\n        id = self._getSoundIds(id);\n        for (var i=0; i<id.length; i++) {\n          // Get the sound.\n          sound = self._soundById(id[i]);\n\n          if (sound) {\n            sound._volume = vol;\n\n            // Stop currently running fades.\n            if (!args[2]) {\n              self._stopFade(id[i]);\n            }\n\n            if (self._webAudio && sound._node && !sound._muted) {\n              sound._node.gain.setValueAtTime(vol, Howler.ctx.currentTime);\n            } else if (sound._node && !sound._muted) {\n              sound._node.volume = vol * Howler.volume();\n            }\n\n            self._emit('volume', sound._id);\n          }\n        }\n      } else {\n        sound = id ? self._soundById(id) : self._sounds[0];\n        return sound ? sound._volume : 0;\n      }\n\n      return self;\n    },\n\n    /**\n     * Fade a currently playing sound between two volumes (if no id is passed, all sounds will fade).\n     * @param  {Number} from The value to fade from (0.0 to 1.0).\n     * @param  {Number} to   The volume to fade to (0.0 to 1.0).\n     * @param  {Number} len  Time in milliseconds to fade.\n     * @param  {Number} id   The sound id (omit to fade all sounds).\n     * @return {Howl}\n     */\n    fade: function(from, to, len, id) {\n      var self = this;\n\n      // If the sound hasn't loaded, add it to the load queue to fade when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'fade',\n          action: function() {\n            self.fade(from, to, len, id);\n          }\n        });\n\n        return self;\n      }\n\n      // Make sure the to/from/len values are numbers.\n      from = parseFloat(from);\n      to = parseFloat(to);\n      len = parseFloat(len);\n\n      // Set the volume to the start position.\n      self.volume(from, id);\n\n      // Fade the volume of one or all sounds.\n      var ids = self._getSoundIds(id);\n      for (var i=0; i<ids.length; i++) {\n        // Get the sound.\n        var sound = self._soundById(ids[i]);\n\n        // Create a linear fade or fall back to timeouts with HTML5 Audio.\n        if (sound) {\n          // Stop the previous fade if no sprite is being used (otherwise, volume handles this).\n          if (!id) {\n            self._stopFade(ids[i]);\n          }\n\n          // If we are using Web Audio, let the native methods do the actual fade.\n          if (self._webAudio && !sound._muted) {\n            var currentTime = Howler.ctx.currentTime;\n            var end = currentTime + (len / 1000);\n            sound._volume = from;\n            sound._node.gain.setValueAtTime(from, currentTime);\n            sound._node.gain.linearRampToValueAtTime(to, end);\n          }\n\n          self._startFadeInterval(sound, from, to, len, ids[i], typeof id === 'undefined');\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Starts the internal interval to fade a sound.\n     * @param  {Object} sound Reference to sound to fade.\n     * @param  {Number} from The value to fade from (0.0 to 1.0).\n     * @param  {Number} to   The volume to fade to (0.0 to 1.0).\n     * @param  {Number} len  Time in milliseconds to fade.\n     * @param  {Number} id   The sound id to fade.\n     * @param  {Boolean} isGroup   If true, set the volume on the group.\n     */\n    _startFadeInterval: function(sound, from, to, len, id, isGroup) {\n      var self = this;\n      var vol = from;\n      var diff = to - from;\n      var steps = Math.abs(diff / 0.01);\n      var stepLen = Math.max(4, (steps > 0) ? len / steps : len);\n      var lastTick = Date.now();\n\n      // Store the value being faded to.\n      sound._fadeTo = to;\n\n      // Update the volume value on each interval tick.\n      sound._interval = setInterval(function() {\n        // Update the volume based on the time since the last tick.\n        var tick = (Date.now() - lastTick) / len;\n        lastTick = Date.now();\n        vol += diff * tick;\n\n        // Make sure the volume is in the right bounds.\n        vol = Math.max(0, vol);\n        vol = Math.min(1, vol);\n\n        // Round to within 2 decimal points.\n        vol = Math.round(vol * 100) / 100;\n\n        // Change the volume.\n        if (self._webAudio) {\n          sound._volume = vol;\n        } else {\n          self.volume(vol, sound._id, true);\n        }\n\n        // Set the group's volume.\n        if (isGroup) {\n          self._volume = vol;\n        }\n\n        // When the fade is complete, stop it and fire event.\n        if ((to < from && vol <= to) || (to > from && vol >= to)) {\n          clearInterval(sound._interval);\n          sound._interval = null;\n          sound._fadeTo = null;\n          self.volume(to, sound._id);\n          self._emit('fade', sound._id);\n        }\n      }, stepLen);\n    },\n\n    /**\n     * Internal method that stops the currently playing fade when\n     * a new fade starts, volume is changed or the sound is stopped.\n     * @param  {Number} id The sound id.\n     * @return {Howl}\n     */\n    _stopFade: function(id) {\n      var self = this;\n      var sound = self._soundById(id);\n\n      if (sound && sound._interval) {\n        if (self._webAudio) {\n          sound._node.gain.cancelScheduledValues(Howler.ctx.currentTime);\n        }\n\n        clearInterval(sound._interval);\n        sound._interval = null;\n        self.volume(sound._fadeTo, id);\n        sound._fadeTo = null;\n        self._emit('fade', id);\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the loop parameter on a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   loop() -> Returns the group's loop value.\n     *   loop(id) -> Returns the sound id's loop value.\n     *   loop(loop) -> Sets the loop value for all sounds in this Howl group.\n     *   loop(loop, id) -> Sets the loop value of passed sound id.\n     * @return {Howl/Boolean} Returns self or current loop value.\n     */\n    loop: function() {\n      var self = this;\n      var args = arguments;\n      var loop, id, sound;\n\n      // Determine the values for loop and id.\n      if (args.length === 0) {\n        // Return the grou's loop value.\n        return self._loop;\n      } else if (args.length === 1) {\n        if (typeof args[0] === 'boolean') {\n          loop = args[0];\n          self._loop = loop;\n        } else {\n          // Return this sound's loop value.\n          sound = self._soundById(parseInt(args[0], 10));\n          return sound ? sound._loop : false;\n        }\n      } else if (args.length === 2) {\n        loop = args[0];\n        id = parseInt(args[1], 10);\n      }\n\n      // If no id is passed, get all ID's to be looped.\n      var ids = self._getSoundIds(id);\n      for (var i=0; i<ids.length; i++) {\n        sound = self._soundById(ids[i]);\n\n        if (sound) {\n          sound._loop = loop;\n          if (self._webAudio && sound._node && sound._node.bufferSource) {\n            sound._node.bufferSource.loop = loop;\n            if (loop) {\n              sound._node.bufferSource.loopStart = sound._start || 0;\n              sound._node.bufferSource.loopEnd = sound._stop;\n            }\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the playback rate of a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   rate() -> Returns the first sound node's current playback rate.\n     *   rate(id) -> Returns the sound id's current playback rate.\n     *   rate(rate) -> Sets the playback rate of all sounds in this Howl group.\n     *   rate(rate, id) -> Sets the playback rate of passed sound id.\n     * @return {Howl/Number} Returns self or the current playback rate.\n     */\n    rate: function() {\n      var self = this;\n      var args = arguments;\n      var rate, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // We will simply return the current rate of the first node.\n        id = self._sounds[0]._id;\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new rate value.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else {\n          rate = parseFloat(args[0]);\n        }\n      } else if (args.length === 2) {\n        rate = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // Update the playback rate or return the current value.\n      var sound;\n      if (typeof rate === 'number') {\n        // If the sound hasn't loaded, add it to the load queue to change playback rate when capable.\n        if (self._state !== 'loaded' || self._playLock) {\n          self._queue.push({\n            event: 'rate',\n            action: function() {\n              self.rate.apply(self, args);\n            }\n          });\n\n          return self;\n        }\n\n        // Set the group rate.\n        if (typeof id === 'undefined') {\n          self._rate = rate;\n        }\n\n        // Update one or all volumes.\n        id = self._getSoundIds(id);\n        for (var i=0; i<id.length; i++) {\n          // Get the sound.\n          sound = self._soundById(id[i]);\n\n          if (sound) {\n            // Keep track of our position when the rate changed and update the playback\n            // start position so we can properly adjust the seek position for time elapsed.\n            if (self.playing(id[i])) {\n              sound._rateSeek = self.seek(id[i]);\n              sound._playStart = self._webAudio ? Howler.ctx.currentTime : sound._playStart;\n            }\n            sound._rate = rate;\n\n            // Change the playback rate.\n            if (self._webAudio && sound._node && sound._node.bufferSource) {\n              sound._node.bufferSource.playbackRate.setValueAtTime(rate, Howler.ctx.currentTime);\n            } else if (sound._node) {\n              sound._node.playbackRate = rate;\n            }\n\n            // Reset the timers.\n            var seek = self.seek(id[i]);\n            var duration = ((self._sprite[sound._sprite][0] + self._sprite[sound._sprite][1]) / 1000) - seek;\n            var timeout = (duration * 1000) / Math.abs(sound._rate);\n\n            // Start a new end timer if sound is already playing.\n            if (self._endTimers[id[i]] || !sound._paused) {\n              self._clearTimer(id[i]);\n              self._endTimers[id[i]] = setTimeout(self._ended.bind(self, sound), timeout);\n            }\n\n            self._emit('rate', sound._id);\n          }\n        }\n      } else {\n        sound = self._soundById(id);\n        return sound ? sound._rate : self._rate;\n      }\n\n      return self;\n    },\n\n    /**\n     * Get/set the seek position of a sound. This method can optionally take 0, 1 or 2 arguments.\n     *   seek() -> Returns the first sound node's current seek position.\n     *   seek(id) -> Returns the sound id's current seek position.\n     *   seek(seek) -> Sets the seek position of the first sound node.\n     *   seek(seek, id) -> Sets the seek position of passed sound id.\n     * @return {Howl/Number} Returns self or the current seek position.\n     */\n    seek: function() {\n      var self = this;\n      var args = arguments;\n      var seek, id;\n\n      // Determine the values based on arguments.\n      if (args.length === 0) {\n        // We will simply return the current position of the first node.\n        id = self._sounds[0]._id;\n      } else if (args.length === 1) {\n        // First check if this is an ID, and if not, assume it is a new seek position.\n        var ids = self._getSoundIds();\n        var index = ids.indexOf(args[0]);\n        if (index >= 0) {\n          id = parseInt(args[0], 10);\n        } else if (self._sounds.length) {\n          id = self._sounds[0]._id;\n          seek = parseFloat(args[0]);\n        }\n      } else if (args.length === 2) {\n        seek = parseFloat(args[0]);\n        id = parseInt(args[1], 10);\n      }\n\n      // If there is no ID, bail out.\n      if (typeof id === 'undefined') {\n        return self;\n      }\n\n      // If the sound hasn't loaded, add it to the load queue to seek when capable.\n      if (self._state !== 'loaded' || self._playLock) {\n        self._queue.push({\n          event: 'seek',\n          action: function() {\n            self.seek.apply(self, args);\n          }\n        });\n\n        return self;\n      }\n\n      // Get the sound.\n      var sound = self._soundById(id);\n\n      if (sound) {\n        if (typeof seek === 'number' && seek >= 0) {\n          // Pause the sound and update position for restarting playback.\n          var playing = self.playing(id);\n          if (playing) {\n            self.pause(id, true);\n          }\n\n          // Move the position of the track and cancel timer.\n          sound._seek = seek;\n          sound._ended = false;\n          self._clearTimer(id);\n\n          // Update the seek position for HTML5 Audio.\n          if (!self._webAudio && sound._node && !isNaN(sound._node.duration)) {\n            sound._node.currentTime = seek;\n          }\n\n          // Seek and emit when ready.\n          var seekAndEmit = function() {\n            self._emit('seek', id);\n\n            // Restart the playback if the sound was playing.\n            if (playing) {\n              self.play(id, undefined, true);\n            }\n          };\n\n          // Wait for the play lock to be unset before emitting (HTML5 Audio).\n          if (playing && !self._webAudio) {\n            var emitSeek = function() {\n              if (!self._playLock) {\n                seekAndEmit();\n              } else {\n                setTimeout(emitSeek, 0);\n              }\n            };\n            setTimeout(emitSeek, 0);\n          } else {\n            seekAndEmit();\n          }\n        } else {\n          if (self._webAudio) {\n            var realTime = self.playing(id) ? Howler.ctx.currentTime - sound._playStart : 0;\n            var rateSeek = sound._rateSeek ? sound._rateSeek - sound._seek : 0;\n            return sound._seek + (rateSeek + realTime * Math.abs(sound._rate));\n          } else {\n            return sound._node.currentTime;\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Check if a specific sound is currently playing or not (if id is provided), or check if at least one of the sounds in the group is playing or not.\n     * @param  {Number}  id The sound id to check. If none is passed, the whole sound group is checked.\n     * @return {Boolean} True if playing and false if not.\n     */\n    playing: function(id) {\n      var self = this;\n\n      // Check the passed sound ID (if any).\n      if (typeof id === 'number') {\n        var sound = self._soundById(id);\n        return sound ? !sound._paused : false;\n      }\n\n      // Otherwise, loop through all sounds and check if any are playing.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (!self._sounds[i]._paused) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    /**\n     * Get the duration of this sound. Passing a sound id will return the sprite duration.\n     * @param  {Number} id The sound id to check. If none is passed, return full source duration.\n     * @return {Number} Audio duration in seconds.\n     */\n    duration: function(id) {\n      var self = this;\n      var duration = self._duration;\n\n      // If we pass an ID, get the sound and return the sprite length.\n      var sound = self._soundById(id);\n      if (sound) {\n        duration = self._sprite[sound._sprite][1] / 1000;\n      }\n\n      return duration;\n    },\n\n    /**\n     * Returns the current loaded state of this Howl.\n     * @return {String} 'unloaded', 'loading', 'loaded'\n     */\n    state: function() {\n      return this._state;\n    },\n\n    /**\n     * Unload and destroy the current Howl object.\n     * This will immediately stop all sound instances attached to this group.\n     */\n    unload: function() {\n      var self = this;\n\n      // Stop playing any active sounds.\n      var sounds = self._sounds;\n      for (var i=0; i<sounds.length; i++) {\n        // Stop the sound if it is currently playing.\n        if (!sounds[i]._paused) {\n          self.stop(sounds[i]._id);\n        }\n\n        // Remove the source or disconnect.\n        if (!self._webAudio) {\n          // Set the source to 0-second silence to stop any downloading (except in IE).\n          self._clearSound(sounds[i]._node);\n\n          // Remove any event listeners.\n          sounds[i]._node.removeEventListener('error', sounds[i]._errorFn, false);\n          sounds[i]._node.removeEventListener(Howler._canPlayEvent, sounds[i]._loadFn, false);\n\n          // Release the Audio object back to the pool.\n          Howler._releaseHtml5Audio(sounds[i]._node);\n        }\n\n        // Empty out all of the nodes.\n        delete sounds[i]._node;\n\n        // Make sure all timers are cleared out.\n        self._clearTimer(sounds[i]._id);\n      }\n\n      // Remove the references in the global Howler object.\n      var index = Howler._howls.indexOf(self);\n      if (index >= 0) {\n        Howler._howls.splice(index, 1);\n      }\n\n      // Delete this sound from the cache (if no other Howl is using it).\n      var remCache = true;\n      for (i=0; i<Howler._howls.length; i++) {\n        if (Howler._howls[i]._src === self._src || self._src.indexOf(Howler._howls[i]._src) >= 0) {\n          remCache = false;\n          break;\n        }\n      }\n\n      if (cache && remCache) {\n        delete cache[self._src];\n      }\n\n      // Clear global errors.\n      Howler.noAudio = false;\n\n      // Clear out `self`.\n      self._state = 'unloaded';\n      self._sounds = [];\n      self = null;\n\n      return null;\n    },\n\n    /**\n     * Listen to a custom event.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to call.\n     * @param  {Number}   id    (optional) Only listen to events for this sound.\n     * @param  {Number}   once  (INTERNAL) Marks event to fire only once.\n     * @return {Howl}\n     */\n    on: function(event, fn, id, once) {\n      var self = this;\n      var events = self['_on' + event];\n\n      if (typeof fn === 'function') {\n        events.push(once ? {id: id, fn: fn, once: once} : {id: id, fn: fn});\n      }\n\n      return self;\n    },\n\n    /**\n     * Remove a custom event. Call without parameters to remove all events.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to remove. Leave empty to remove all.\n     * @param  {Number}   id    (optional) Only remove events for this sound.\n     * @return {Howl}\n     */\n    off: function(event, fn, id) {\n      var self = this;\n      var events = self['_on' + event];\n      var i = 0;\n\n      // Allow passing just an event and ID.\n      if (typeof fn === 'number') {\n        id = fn;\n        fn = null;\n      }\n\n      if (fn || id) {\n        // Loop through event store and remove the passed function.\n        for (i=0; i<events.length; i++) {\n          var isId = (id === events[i].id);\n          if (fn === events[i].fn && isId || !fn && isId) {\n            events.splice(i, 1);\n            break;\n          }\n        }\n      } else if (event) {\n        // Clear out all events of this type.\n        self['_on' + event] = [];\n      } else {\n        // Clear out all events of every type.\n        var keys = Object.keys(self);\n        for (i=0; i<keys.length; i++) {\n          if ((keys[i].indexOf('_on') === 0) && Array.isArray(self[keys[i]])) {\n            self[keys[i]] = [];\n          }\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Listen to a custom event and remove it once fired.\n     * @param  {String}   event Event name.\n     * @param  {Function} fn    Listener to call.\n     * @param  {Number}   id    (optional) Only listen to events for this sound.\n     * @return {Howl}\n     */\n    once: function(event, fn, id) {\n      var self = this;\n\n      // Setup the event listener.\n      self.on(event, fn, id, 1);\n\n      return self;\n    },\n\n    /**\n     * Emit all events of a specific type and pass the sound id.\n     * @param  {String} event Event name.\n     * @param  {Number} id    Sound ID.\n     * @param  {Number} msg   Message to go with event.\n     * @return {Howl}\n     */\n    _emit: function(event, id, msg) {\n      var self = this;\n      var events = self['_on' + event];\n\n      // Loop through event store and fire all functions.\n      for (var i=events.length-1; i>=0; i--) {\n        // Only fire the listener if the correct ID is used.\n        if (!events[i].id || events[i].id === id || event === 'load') {\n          setTimeout(function(fn) {\n            fn.call(this, id, msg);\n          }.bind(self, events[i].fn), 0);\n\n          // If this event was setup with `once`, remove it.\n          if (events[i].once) {\n            self.off(event, events[i].fn, events[i].id);\n          }\n        }\n      }\n\n      // Pass the event type into load queue so that it can continue stepping.\n      self._loadQueue(event);\n\n      return self;\n    },\n\n    /**\n     * Queue of actions initiated before the sound has loaded.\n     * These will be called in sequence, with the next only firing\n     * after the previous has finished executing (even if async like play).\n     * @return {Howl}\n     */\n    _loadQueue: function(event) {\n      var self = this;\n\n      if (self._queue.length > 0) {\n        var task = self._queue[0];\n\n        // Remove this task if a matching event was passed.\n        if (task.event === event) {\n          self._queue.shift();\n          self._loadQueue();\n        }\n\n        // Run the task if no event type is passed.\n        if (!event) {\n          task.action();\n        }\n      }\n\n      return self;\n    },\n\n    /**\n     * Fired when playback ends at the end of the duration.\n     * @param  {Sound} sound The sound object to work with.\n     * @return {Howl}\n     */\n    _ended: function(sound) {\n      var self = this;\n      var sprite = sound._sprite;\n\n      // If we are using IE and there was network latency we may be clipping\n      // audio before it completes playing. Lets check the node to make sure it\n      // believes it has completed, before ending the playback.\n      if (!self._webAudio && sound._node && !sound._node.paused && !sound._node.ended && sound._node.currentTime < sound._stop) {\n        setTimeout(self._ended.bind(self, sound), 100);\n        return self;\n      }\n\n      // Should this sound loop?\n      var loop = !!(sound._loop || self._sprite[sprite][2]);\n\n      // Fire the ended event.\n      self._emit('end', sound._id);\n\n      // Restart the playback for HTML5 Audio loop.\n      if (!self._webAudio && loop) {\n        self.stop(sound._id, true).play(sound._id);\n      }\n\n      // Restart this timer if on a Web Audio loop.\n      if (self._webAudio && loop) {\n        self._emit('play', sound._id);\n        sound._seek = sound._start || 0;\n        sound._rateSeek = 0;\n        sound._playStart = Howler.ctx.currentTime;\n\n        var timeout = ((sound._stop - sound._start) * 1000) / Math.abs(sound._rate);\n        self._endTimers[sound._id] = setTimeout(self._ended.bind(self, sound), timeout);\n      }\n\n      // Mark the node as paused.\n      if (self._webAudio && !loop) {\n        sound._paused = true;\n        sound._ended = true;\n        sound._seek = sound._start || 0;\n        sound._rateSeek = 0;\n        self._clearTimer(sound._id);\n\n        // Clean up the buffer source.\n        self._cleanBuffer(sound._node);\n\n        // Attempt to auto-suspend AudioContext if no sounds are still playing.\n        Howler._autoSuspend();\n      }\n\n      // When using a sprite, end the track.\n      if (!self._webAudio && !loop) {\n        self.stop(sound._id, true);\n      }\n\n      return self;\n    },\n\n    /**\n     * Clear the end timer for a sound playback.\n     * @param  {Number} id The sound ID.\n     * @return {Howl}\n     */\n    _clearTimer: function(id) {\n      var self = this;\n\n      if (self._endTimers[id]) {\n        // Clear the timeout or remove the ended listener.\n        if (typeof self._endTimers[id] !== 'function') {\n          clearTimeout(self._endTimers[id]);\n        } else {\n          var sound = self._soundById(id);\n          if (sound && sound._node) {\n            sound._node.removeEventListener('ended', self._endTimers[id], false);\n          }\n        }\n\n        delete self._endTimers[id];\n      }\n\n      return self;\n    },\n\n    /**\n     * Return the sound identified by this ID, or return null.\n     * @param  {Number} id Sound ID\n     * @return {Object}    Sound object or null.\n     */\n    _soundById: function(id) {\n      var self = this;\n\n      // Loop through all sounds and find the one with this ID.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (id === self._sounds[i]._id) {\n          return self._sounds[i];\n        }\n      }\n\n      return null;\n    },\n\n    /**\n     * Return an inactive sound from the pool or create a new one.\n     * @return {Sound} Sound playback object.\n     */\n    _inactiveSound: function() {\n      var self = this;\n\n      self._drain();\n\n      // Find the first inactive node to recycle.\n      for (var i=0; i<self._sounds.length; i++) {\n        if (self._sounds[i]._ended) {\n          return self._sounds[i].reset();\n        }\n      }\n\n      // If no inactive node was found, create a new one.\n      return new Sound(self);\n    },\n\n    /**\n     * Drain excess inactive sounds from the pool.\n     */\n    _drain: function() {\n      var self = this;\n      var limit = self._pool;\n      var cnt = 0;\n      var i = 0;\n\n      // If there are less sounds than the max pool size, we are done.\n      if (self._sounds.length < limit) {\n        return;\n      }\n\n      // Count the number of inactive sounds.\n      for (i=0; i<self._sounds.length; i++) {\n        if (self._sounds[i]._ended) {\n          cnt++;\n        }\n      }\n\n      // Remove excess inactive sounds, going in reverse order.\n      for (i=self._sounds.length - 1; i>=0; i--) {\n        if (cnt <= limit) {\n          return;\n        }\n\n        if (self._sounds[i]._ended) {\n          // Disconnect the audio source when using Web Audio.\n          if (self._webAudio && self._sounds[i]._node) {\n            self._sounds[i]._node.disconnect(0);\n          }\n\n          // Remove sounds until we have the pool size.\n          self._sounds.splice(i, 1);\n          cnt--;\n        }\n      }\n    },\n\n    /**\n     * Get all ID's from the sounds pool.\n     * @param  {Number} id Only return one ID if one is passed.\n     * @return {Array}    Array of IDs.\n     */\n    _getSoundIds: function(id) {\n      var self = this;\n\n      if (typeof id === 'undefined') {\n        var ids = [];\n        for (var i=0; i<self._sounds.length; i++) {\n          ids.push(self._sounds[i]._id);\n        }\n\n        return ids;\n      } else {\n        return [id];\n      }\n    },\n\n    /**\n     * Load the sound back into the buffer source.\n     * @param  {Sound} sound The sound object to work with.\n     * @return {Howl}\n     */\n    _refreshBuffer: function(sound) {\n      var self = this;\n\n      // Setup the buffer source for playback.\n      sound._node.bufferSource = Howler.ctx.createBufferSource();\n      sound._node.bufferSource.buffer = cache[self._src];\n\n      // Connect to the correct node.\n      if (sound._panner) {\n        sound._node.bufferSource.connect(sound._panner);\n      } else {\n        sound._node.bufferSource.connect(sound._node);\n      }\n\n      // Setup looping and playback rate.\n      sound._node.bufferSource.loop = sound._loop;\n      if (sound._loop) {\n        sound._node.bufferSource.loopStart = sound._start || 0;\n        sound._node.bufferSource.loopEnd = sound._stop || 0;\n      }\n      sound._node.bufferSource.playbackRate.setValueAtTime(sound._rate, Howler.ctx.currentTime);\n\n      return self;\n    },\n\n    /**\n     * Prevent memory leaks by cleaning up the buffer source after playback.\n     * @param  {Object} node Sound's audio node containing the buffer source.\n     * @return {Howl}\n     */\n    _cleanBuffer: function(node) {\n      var self = this;\n      var isIOS = Howler._navigator && Howler._navigator.vendor.indexOf('Apple') >= 0;\n\n      if (Howler._scratchBuffer && node.bufferSource) {\n        node.bufferSource.onended = null;\n        node.bufferSource.disconnect(0);\n        if (isIOS) {\n          try { node.bufferSource.buffer = Howler._scratchBuffer; } catch(e) {}\n        }\n      }\n      node.bufferSource = null;\n\n      return self;\n    },\n\n    /**\n     * Set the source to a 0-second silence to stop any downloading (except in IE).\n     * @param  {Object} node Audio node to clear.\n     */\n    _clearSound: function(node) {\n      var checkIE = /MSIE |Trident\\//.test(Howler._navigator && Howler._navigator.userAgent);\n      if (!checkIE) {\n        node.src = 'data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA';\n      }\n    }\n  };\n\n  /** Single Sound Methods **/\n  /***************************************************************************/\n\n  /**\n   * Setup the sound object, which each node attached to a Howl group is contained in.\n   * @param {Object} howl The Howl parent group.\n   */\n  var Sound = function(howl) {\n    this._parent = howl;\n    this.init();\n  };\n  Sound.prototype = {\n    /**\n     * Initialize a new Sound object.\n     * @return {Sound}\n     */\n    init: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Setup the default parameters.\n      self._muted = parent._muted;\n      self._loop = parent._loop;\n      self._volume = parent._volume;\n      self._rate = parent._rate;\n      self._seek = 0;\n      self._paused = true;\n      self._ended = true;\n      self._sprite = '__default';\n\n      // Generate a unique ID for this sound.\n      self._id = ++Howler._counter;\n\n      // Add itself to the parent's pool.\n      parent._sounds.push(self);\n\n      // Create the new node.\n      self.create();\n\n      return self;\n    },\n\n    /**\n     * Create and setup a new sound object, whether HTML5 Audio or Web Audio.\n     * @return {Sound}\n     */\n    create: function() {\n      var self = this;\n      var parent = self._parent;\n      var volume = (Howler._muted || self._muted || self._parent._muted) ? 0 : self._volume;\n\n      if (parent._webAudio) {\n        // Create the gain node for controlling volume (the source will connect to this).\n        self._node = (typeof Howler.ctx.createGain === 'undefined') ? Howler.ctx.createGainNode() : Howler.ctx.createGain();\n        self._node.gain.setValueAtTime(volume, Howler.ctx.currentTime);\n        self._node.paused = true;\n        self._node.connect(Howler.masterGain);\n      } else if (!Howler.noAudio) {\n        // Get an unlocked Audio object from the pool.\n        self._node = Howler._obtainHtml5Audio();\n\n        // Listen for errors (http://dev.w3.org/html5/spec-author-view/spec.html#mediaerror).\n        self._errorFn = self._errorListener.bind(self);\n        self._node.addEventListener('error', self._errorFn, false);\n\n        // Listen for 'canplaythrough' event to let us know the sound is ready.\n        self._loadFn = self._loadListener.bind(self);\n        self._node.addEventListener(Howler._canPlayEvent, self._loadFn, false);\n\n        // Setup the new audio node.\n        self._node.src = parent._src;\n        // JE: If _html5 was requested, then we want this audio streamed, not buffered!\n        self._node.preload = parent._html5 ? 'metadata' : 'auto';\n        self._node.volume = volume * Howler.volume();\n\n        // Begin loading the source.\n        self._node.load();\n      }\n\n      return self;\n    },\n\n    /**\n     * Reset the parameters of this sound to the original state (for recycle).\n     * @return {Sound}\n     */\n    reset: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Reset all of the parameters of this sound.\n      self._muted = parent._muted;\n      self._loop = parent._loop;\n      self._volume = parent._volume;\n      self._rate = parent._rate;\n      self._seek = 0;\n      self._rateSeek = 0;\n      self._paused = true;\n      self._ended = true;\n      self._sprite = '__default';\n\n      // Generate a new ID so that it isn't confused with the previous sound.\n      self._id = ++Howler._counter;\n\n      return self;\n    },\n\n    /**\n     * HTML5 Audio error listener callback.\n     */\n    _errorListener: function() {\n      var self = this;\n\n      // Fire an error event and pass back the code.\n      self._parent._emit('loaderror', self._id, self._node.error ? self._node.error.code : 0);\n\n      // Clear the event listener.\n      self._node.removeEventListener('error', self._errorFn, false);\n    },\n\n    /**\n     * HTML5 Audio canplaythrough listener callback.\n     */\n    _loadListener: function() {\n      var self = this;\n      var parent = self._parent;\n\n      // Round up the duration to account for the lower precision in HTML5 Audio.\n      parent._duration = Math.ceil(self._node.duration * 10) / 10;\n\n      // Setup a sprite if none is defined.\n      if (Object.keys(parent._sprite).length === 0) {\n        parent._sprite = {__default: [0, parent._duration * 1000]};\n      }\n\n      if (parent._state !== 'loaded') {\n        parent._state = 'loaded';\n        parent._emit('load');\n        parent._loadQueue();\n      }\n\n      // Clear the event listener.\n      self._node.removeEventListener(Howler._canPlayEvent, self._loadFn, false);\n    }\n  };\n\n  /** Helper Methods **/\n  /***************************************************************************/\n\n  var cache = {};\n\n  /**\n   * Buffer a sound from URL, Data URI or cache and decode to audio source (Web Audio API).\n   * @param  {Howl} self\n   */\n  var loadBuffer = function(self) {\n    var url = self._src;\n\n    // Check if the buffer has already been cached and use it instead.\n    if (cache[url]) {\n      // Set the duration from the cache.\n      self._duration = cache[url].duration;\n\n      // Load the sound into this Howl.\n      loadSound(self);\n\n      return;\n    }\n\n    if (/^data:[^;]+;base64,/.test(url)) {\n      // Decode the base64 data URI without XHR, since some browsers don't support it.\n      var data = atob(url.split(',')[1]);\n      var dataView = new Uint8Array(data.length);\n      for (var i=0; i<data.length; ++i) {\n        dataView[i] = data.charCodeAt(i);\n      }\n\n      decodeAudioData(dataView.buffer, self);\n    } else {\n      // Load the buffer from the URL.\n      var xhr = new XMLHttpRequest();\n      xhr.open('GET', url, true);\n      xhr.withCredentials = self._xhrWithCredentials;\n      xhr.responseType = 'arraybuffer';\n\n      // Apply any custom headers to the request.\n      if (self._xhrHeaders) {\n        Object.keys(self._xhrHeaders).forEach(function(key) {\n          xhr.setRequestHeader(key, self._xhrHeaders[key]);\n        });\n      }\n\n      xhr.onload = function() {\n        // Make sure we get a successful response back.\n        var code = (xhr.status + '')[0];\n        if (code !== '0' && code !== '2' && code !== '3') {\n          self._emit('loaderror', null, 'Failed loading audio file with status: ' + xhr.status + '.');\n          return;\n        }\n\n        decodeAudioData(xhr.response, self);\n      };\n      xhr.onerror = function() {\n        // If there is an error, switch to HTML5 Audio.\n        if (self._webAudio) {\n          self._html5 = true;\n          self._webAudio = false;\n          self._sounds = [];\n          delete cache[url];\n          self.load();\n        }\n      };\n      safeXhrSend(xhr);\n    }\n  };\n\n  /**\n   * Send the XHR request wrapped in a try/catch.\n   * @param  {Object} xhr XHR to send.\n   */\n  var safeXhrSend = function(xhr) {\n    try {\n      xhr.send();\n    } catch (e) {\n      xhr.onerror();\n    }\n  };\n\n  /**\n   * Decode audio data from an array buffer.\n   * @param  {ArrayBuffer} arraybuffer The audio data.\n   * @param  {Howl}        self\n   */\n  var decodeAudioData = function(arraybuffer, self) {\n    // Fire a load error if something broke.\n    var error = function() {\n      self._emit('loaderror', null, 'Decoding audio data failed.');\n    };\n\n    // Load the sound on success.\n    var success = function(buffer) {\n      if (buffer && self._sounds.length > 0) {\n        cache[self._src] = buffer;\n        loadSound(self, buffer);\n      } else {\n        error();\n      }\n    };\n\n    // Decode the buffer into an audio source.\n    if (typeof Promise !== 'undefined' && Howler.ctx.decodeAudioData.length === 1) {\n      Howler.ctx.decodeAudioData(arraybuffer).then(success).catch(error);\n    } else {\n      Howler.ctx.decodeAudioData(arraybuffer, success, error);\n    }\n  };\n\n  /**\n   * Sound is now loaded, so finish setting everything up and fire the loaded event.\n   * @param  {Howl} self\n   * @param  {Object} buffer The decoded buffer sound source.\n   */\n  var loadSound = function(self, buffer) {\n    // Set the duration.\n    if (buffer && !self._duration) {\n      self._duration = buffer.duration;\n    }\n\n    // Setup a sprite if none is defined.\n    if (Object.keys(self._sprite).length === 0) {\n      self._sprite = {__default: [0, self._duration * 1000]};\n    }\n\n    // Fire the loaded event.\n    if (self._state !== 'loaded') {\n      self._state = 'loaded';\n      self._emit('load');\n      self._loadQueue();\n    }\n  };\n\n  /**\n   * Setup the audio context when available, or switch to HTML5 Audio mode.\n   */\n  var setupAudioContext = function() {\n    // If we have already detected that Web Audio isn't supported, don't run this step again.\n    if (!Howler.usingWebAudio) {\n      return;\n    }\n\n    // Check if we are using Web Audio and setup the AudioContext if we are.\n    try {\n      if (typeof AudioContext !== 'undefined') {\n        Howler.ctx = new AudioContext();\n      } else if (typeof webkitAudioContext !== 'undefined') {\n        Howler.ctx = new webkitAudioContext();\n      } else {\n        Howler.usingWebAudio = false;\n      }\n    } catch(e) {\n      Howler.usingWebAudio = false;\n    }\n\n    // If the audio context creation still failed, set using web audio to false.\n    if (!Howler.ctx) {\n      Howler.usingWebAudio = false;\n    }\n\n    // Check if a webview is being used on iOS8 or earlier (rather than the browser).\n    // If it is, disable Web Audio as it causes crashing.\n    var iOS = (/iP(hone|od|ad)/.test(Howler._navigator && Howler._navigator.platform));\n    var appVersion = Howler._navigator && Howler._navigator.appVersion.match(/OS (\\d+)_(\\d+)_?(\\d+)?/);\n    var version = appVersion ? parseInt(appVersion[1], 10) : null;\n    if (iOS && version && version < 9) {\n      var safari = /safari/.test(Howler._navigator && Howler._navigator.userAgent.toLowerCase());\n      if (Howler._navigator && !safari) {\n        Howler.usingWebAudio = false;\n      }\n    }\n\n    // Create and expose the master GainNode when using Web Audio (useful for plugins or advanced usage).\n    if (Howler.usingWebAudio) {\n      Howler.masterGain = (typeof Howler.ctx.createGain === 'undefined') ? Howler.ctx.createGainNode() : Howler.ctx.createGain();\n      Howler.masterGain.gain.setValueAtTime(Howler._muted ? 0 : Howler._volume, Howler.ctx.currentTime);\n      Howler.masterGain.connect(Howler.ctx.destination);\n    }\n\n    // Re-run the setup on Howler.\n    Howler._setup();\n  };\n\n  // Add support for AMD (Asynchronous Module Definition) libraries such as require.js.\n  if (typeof define === 'function' && define.amd) {\n    define([], function() {\n      return {\n        Howler: Howler,\n        Howl: Howl\n      };\n    });\n  }\n\n  // Add support for CommonJS libraries such as browserify.\n  if (typeof exports !== 'undefined') {\n    exports.Howler = Howler;\n    exports.Howl = Howl;\n  }\n\n  // Define globally in case AMD is not available or unused.\n  if (typeof window !== 'undefined') {\n    window.HowlerGlobal = HowlerGlobal;\n    window.Howler = Howler;\n    window.Howl = Howl;\n    window.Sound = Sound;\n  } else if (typeof global !== 'undefined') { // Add to global in Node.js (for testing, etc).\n    global.HowlerGlobal = HowlerGlobal;\n    global.Howler = Howler;\n    global.Howl = Howl;\n    global.Sound = Sound;\n  }\n}());\n","'use strict';\nconst isObj = require('is-obj');\n\nfunction getPathSegments(path) {\n\tconst pathArr = path.split('.');\n\tconst parts = [];\n\n\tfor (let i = 0; i < pathArr.length; i++) {\n\t\tlet p = pathArr[i];\n\n\t\twhile (p[p.length - 1] === '\\\\' && pathArr[i + 1] !== undefined) {\n\t\t\tp = p.slice(0, -1) + '.';\n\t\t\tp += pathArr[++i];\n\t\t}\n\n\t\tparts.push(p);\n\t}\n\n\treturn parts;\n}\n\nmodule.exports = {\n\tget(obj, path, value) {\n\t\tif (!isObj(obj) || typeof path !== 'string') {\n\t\t\treturn value === undefined ? obj : value;\n\t\t}\n\n\t\tconst pathArr = getPathSegments(path);\n\n\t\tfor (let i = 0; i < pathArr.length; i++) {\n\t\t\tif (!Object.prototype.propertyIsEnumerable.call(obj, pathArr[i])) {\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t\tobj = obj[pathArr[i]];\n\n\t\t\tif (obj === undefined || obj === null) {\n\t\t\t\t// `obj` is either `undefined` or `null` so we want to stop the loop, and\n\t\t\t\t// if this is not the last bit of the path, and\n\t\t\t\t// if it did't return `undefined`\n\t\t\t\t// it would return `null` if `obj` is `null`\n\t\t\t\t// but we want `get({foo: null}, 'foo.bar')` to equal `undefined`, or the supplied value, not `null`\n\t\t\t\tif (i !== pathArr.length - 1) {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t},\n\n\tset(obj, path, value) {\n\t\tif (!isObj(obj) || typeof path !== 'string') {\n\t\t\treturn obj;\n\t\t}\n\n\t\tconst root = obj;\n\t\tconst pathArr = getPathSegments(path);\n\n\t\tfor (let i = 0; i < pathArr.length; i++) {\n\t\t\tconst p = pathArr[i];\n\n\t\t\tif (!isObj(obj[p])) {\n\t\t\t\tobj[p] = {};\n\t\t\t}\n\n\t\t\tif (i === pathArr.length - 1) {\n\t\t\t\tobj[p] = value;\n\t\t\t}\n\n\t\t\tobj = obj[p];\n\t\t}\n\n\t\treturn root;\n\t},\n\n\tdelete(obj, path) {\n\t\tif (!isObj(obj) || typeof path !== 'string') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst pathArr = getPathSegments(path);\n\n\t\tfor (let i = 0; i < pathArr.length; i++) {\n\t\t\tconst p = pathArr[i];\n\n\t\t\tif (i === pathArr.length - 1) {\n\t\t\t\tdelete obj[p];\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tobj = obj[p];\n\n\t\t\tif (!isObj(obj)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t},\n\n\thas(obj, path) {\n\t\tif (!isObj(obj) || typeof path !== 'string') {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst pathArr = getPathSegments(path);\n\n\t\tfor (let i = 0; i < pathArr.length; i++) {\n\t\t\tif (isObj(obj)) {\n\t\t\t\tif (!(pathArr[i] in obj)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tobj = obj[pathArr[i]];\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t}\n};\n","module.exports = create\n\n/**\n * Creates a new identity mat3\n *\n * @alias mat3.create\n * @returns {mat3} a new 3x3 matrix\n */\nfunction create() {\n  var out = new Float32Array(9)\n  out[0] = 1\n  out[1] = 0\n  out[2] = 0\n  out[3] = 0\n  out[4] = 1\n  out[5] = 0\n  out[6] = 0\n  out[7] = 0\n  out[8] = 1\n  return out\n}\n","module.exports = fromMat4\n\n/**\n * Copies the upper-left 3x3 values into the given mat3.\n *\n * @alias mat3.fromMat4\n * @param {mat3} out the receiving 3x3 matrix\n * @param {mat4} a   the source 4x4 matrix\n * @returns {mat3} out\n */\nfunction fromMat4(out, a) {\n  out[0] = a[0]\n  out[1] = a[1]\n  out[2] = a[2]\n  out[3] = a[4]\n  out[4] = a[5]\n  out[5] = a[6]\n  out[6] = a[8]\n  out[7] = a[9]\n  out[8] = a[10]\n  return out\n}\n","module.exports = copy;\n\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nfunction copy(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n};","module.exports = create;\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\nfunction create() {\n    var out = new Float32Array(16);\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n};","module.exports = invert;\n\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nfunction invert(out, a) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15],\n\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n\n        // Calculate the determinant\n        det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) { \n        return null; \n    }\n    det = 1.0 / det;\n\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n\n    return out;\n};","module.exports = multiply;\n\n/**\n * Multiplies two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the first operand\n * @param {mat4} b the second operand\n * @returns {mat4} out\n */\nfunction multiply(out, a, b) {\n    var a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3],\n        a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7],\n        a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11],\n        a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n\n    // Cache only the current line of the second matrix\n    var b0  = b[0], b1 = b[1], b2 = b[2], b3 = b[3];  \n    out[0] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[1] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[2] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[3] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\n    out[4] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[5] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[6] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[7] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\n    out[8] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[9] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[10] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[11] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n\n    b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\n    out[12] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n    out[13] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n    out[14] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n    out[15] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n    return out;\n};","module.exports = perspective;\n\n/**\n * Generates a perspective projection matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\nfunction perspective(out, fovy, aspect, near, far) {\n    var f = 1.0 / Math.tan(fovy / 2),\n        nf = 1 / (near - far);\n    out[0] = f / aspect;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = f;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = (far + near) * nf;\n    out[11] = -1;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = (2 * far * near) * nf;\n    out[15] = 0;\n    return out;\n};","module.exports = transpose;\n\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {mat4} a the source matrix\n * @returns {mat4} out\n */\nfunction transpose(out, a) {\n    // If we are transposing ourselves we can skip a few steps but have to cache some values\n    if (out === a) {\n        var a01 = a[1], a02 = a[2], a03 = a[3],\n            a12 = a[6], a13 = a[7],\n            a23 = a[11];\n\n        out[1] = a[4];\n        out[2] = a[8];\n        out[3] = a[12];\n        out[4] = a01;\n        out[6] = a[9];\n        out[7] = a[13];\n        out[8] = a02;\n        out[9] = a12;\n        out[11] = a[14];\n        out[12] = a03;\n        out[13] = a13;\n        out[14] = a23;\n    } else {\n        out[0] = a[0];\n        out[1] = a[4];\n        out[2] = a[8];\n        out[3] = a[12];\n        out[4] = a[1];\n        out[5] = a[5];\n        out[6] = a[9];\n        out[7] = a[13];\n        out[8] = a[2];\n        out[9] = a[6];\n        out[10] = a[10];\n        out[11] = a[14];\n        out[12] = a[3];\n        out[13] = a[7];\n        out[14] = a[11];\n        out[15] = a[15];\n    }\n    \n    return out;\n};","'use strict';\nmodule.exports = function (x) {\n\tvar type = typeof x;\n\treturn x !== null && (type === 'object' || type === 'function');\n};\n","/* eslint global-require:off */\n\n// Startup code.\n\nlet called_once = false;\nwindow.onload = function () {\n  if (called_once) {\n    return;\n  }\n  called_once = true;\n  require('./glov/bootstrap.js');\n  require('./main.js').main();\n};","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\n// Things that should be done before requiring or running any user-level code or other engine code\n\nrequire('./polyfill.js');\n\nlet debug = document.getElementById('debug');\nwindow.onerror = function (e, file, line, col, errorobj) {\n  let msg = `${e}\\n  at ${file}(${line}:${col})`;\n  if (errorobj && errorobj.stack) {\n    msg = `${errorobj.stack}`;\n    if (errorobj.message) {\n      if (msg.indexOf(errorobj.message) === -1) {\n        msg = `${errorobj.message}\\n${msg}`;\n      }\n    }\n    let origin = document.location.origin || '';\n    if (origin) {\n      if (origin.slice(-1) !== '/') {\n        origin += '/';\n      }\n      msg = msg.split(origin).join(''); // replace\n    }\n    // fixup weird Firefox weirdness\n    msg = msg.replace(/\\[\\d+\\]</g, '') // remove funny [123] at start of stack lines\n    .replace(/<?\\/<?/g, '/') // remove funny <s, they mess up people's copy and paste\n    .replace(/\\n([^ ])/g, '\\n  $1'); // add indentation if missing\n  }\n  let show = true;\n  if (window.glov_error_report) {\n    show = window.glov_error_report(msg, file, line, col);\n  }\n  if (show) {\n    debug.innerText = `${msg}\\n\\nPlease report this error to the developer, and then reload this page.`;\n  }\n};\nwindow.debugmsg = function (msg, clear) {\n  if (clear) {\n    debug.innerText = msg;\n  } else {\n    debug.innerText += `${msg}\\n`;\n  }\n};","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint no-shadow:off */\n\nconst engine = require('./engine.js');\n\nconst { round } = Math;\n\nconst safearea_pad = new Float32Array(4); // left, right, top, bottom\n// 0: x0_real\n// 1: y0_real\n// 2: x1_real\n// 3: y1_real\n// 4: x_scale\n// 5: y_scale\n// 6: css_to_real\n// 7: inverse viewport x_scale\n// 8: inverse viewport y_scale\n// 9: x0\n// 10: y0\n// 11: x1\n// 12: y1\nexport const data = new Float32Array(13);\n\nlet screen_width;\nlet screen_height;\n// Note: render_* not used by FRVR at this time\nlet render_width;\nlet render_height;\nexport let render_viewport_w;\nexport let render_viewport_h;\nexport let render_offset_x;\nlet render_offset_y_top;\nexport let render_offset_y_bottom;\n\nfunction reapply() {\n  if (render_width) {\n    data[4] = render_width / (data[2] - data[0]);\n    data[5] = render_height / (data[3] - data[1]);\n    data[7] = (data[2] - data[0]) / render_viewport_w;\n    data[8] = (data[3] - data[1]) / render_viewport_h;\n  } else {\n    data[4] = screen_width / (data[2] - data[0]);\n    data[5] = screen_height / (data[3] - data[1]);\n  }\n}\n\n// To get to coordinates used by OpenGL / canvas\nexport function virtualToCanvas(dst, src) {\n  dst[0] = (src[0] - data[0]) * data[4];\n  dst[1] = (src[1] - data[1]) * data[5];\n}\n\n// Sets the 2D \"camera\" used to translate sprite positions to screen space.  Affects sprites queued\n//  after this call\nexport function set(x0, y0, x1, y1, ignore_safe_area) {\n  if (ignore_safe_area || render_width) {\n    data[9] = data[0] = x0;\n    data[10] = data[1] = y0;\n    data[11] = data[2] = x1;\n    data[12] = data[3] = y1;\n  } else {\n    data[9] = x0;\n    data[10] = y0;\n    data[11] = x1;\n    data[12] = y1;\n    let wscale = (x1 - x0) / (screen_width - safearea_pad[0] - safearea_pad[1]);\n    let hscale = (y1 - y0) / (screen_height - safearea_pad[2] - safearea_pad[3]);\n    data[0] = x0 - safearea_pad[0] * wscale;\n    data[1] = y0 - safearea_pad[2] * hscale;\n    data[2] = x1 + safearea_pad[1] * wscale;\n    data[3] = y1 + safearea_pad[3] * hscale;\n  }\n\n  reapply();\n}\n\nexport function setSafeAreaPadding(left, right, top, bottom) {\n  safearea_pad[0] = round(left);\n  safearea_pad[1] = round(right);\n  safearea_pad[2] = round(top);\n  safearea_pad[3] = round(bottom);\n  // Called while updating screen width/height, reapply() should get called later\n}\n\nexport function safeAreaPadding() {\n  return safearea_pad;\n}\n\nconst stack = [];\nexport function push() {\n  stack.push(data.slice(0));\n}\nexport function pop() {\n  let old = stack.pop();\n  set(old[0], old[1], old[2], old[3], true);\n}\n\nexport function domToCanvasRatio() {\n  return data[6];\n}\n\nexport function screenAspect() {\n  return (screen_width - safearea_pad[0] - safearea_pad[1]) / (screen_height - safearea_pad[2] - safearea_pad[3]);\n}\n\n// Drawing area 0,0-w,h\n// But keep the aspect ratio of those things drawn to be correct\n// This may create a padding or margin on either top and bottom or sides of the screen\n// User users constant values in this range for consistent UI on all devices\nexport function setAspectFixed(w, h) {\n  let pa = render_width ? 1 : engine.pixel_aspect;\n  let inv_aspect = h / pa / w;\n  let inv_desired_aspect;\n  if (render_width) {\n    inv_desired_aspect = render_height / render_width;\n  } else {\n    inv_desired_aspect = 1 / screenAspect();\n  }\n  if (inv_aspect > inv_desired_aspect) {\n    let margin = (h / pa / inv_desired_aspect - w) / 2;\n    set(-margin, 0, w + margin, h, false);\n  } else {\n    let margin = (w * pa * inv_desired_aspect - h) / 2;\n    set(0, -margin, w, h + margin, false);\n  }\n}\n\n// Primary drawing area at least W x H\n// But keep the aspect ratio of those things drawn to be correct\n// Similar to setAspectFixed() but keeps (0,0) in the upper left (all padding\n//   is added to right and bottom)\n// Requires users to use camera2d.w()/ and camera2d.h() to determine reasonable\n//   UI positioning\nexport function setAspectFixed2(w, h) {\n  let pa = render_width ? 1 : engine.pixel_aspect;\n  let inv_aspect = h / pa / w;\n  let inv_desired_aspect;\n  if (render_width) {\n    inv_desired_aspect = render_height / render_width;\n  } else {\n    inv_desired_aspect = 1 / screenAspect();\n  }\n  if (inv_aspect > inv_desired_aspect) {\n    let margin = h / pa / inv_desired_aspect - w;\n    set(0, 0, w + margin, h, false);\n  } else {\n    let margin = w * pa * inv_desired_aspect - h;\n    set(0, 0, w, h + margin, false);\n  }\n}\n\nexport function zoom(x, y, factor) {\n  let inv_factor = 1.0 / factor;\n  set(x - (x - data[0]) * inv_factor, y - (y - data[1]) * inv_factor, x + (data[2] - x) * inv_factor, y + (data[3] - y) * inv_factor, true);\n}\n\nexport function setNormalized() {\n  set(0, 0, 1, 1, true);\n}\n\nexport function x0Real() {\n  return data[0];\n}\nexport function y0Real() {\n  return data[1];\n}\nexport function x1Real() {\n  return data[2];\n}\nexport function y1Real() {\n  return data[3];\n}\nexport function wReal() {\n  return data[2] - data[0];\n}\nexport function hReal() {\n  return data[3] - data[1];\n}\nexport function x0() {\n  return data[9];\n}\nexport function y0() {\n  return data[10];\n}\nexport function x1() {\n  return data[11];\n}\nexport function y1() {\n  return data[12];\n}\nexport function w() {\n  return data[11] - data[9];\n}\nexport function h() {\n  return data[12] - data[10];\n}\nexport function xScale() {\n  return data[4];\n}\nexport function yScale() {\n  return data[5];\n}\n\nexport function htmlPos(x, y) {\n  if (render_width) {\n    return [100 * (((x - data[0]) / data[7] + render_offset_x) / screen_width), 100 * (((y - data[1]) / data[8] + render_offset_y_top) / screen_height)];\n  } else {\n    return [100 * (x - data[0]) / (data[2] - data[0]), 100 * (y - data[1]) / (data[3] - data[1])];\n  }\n}\nexport function htmlSize(w, h) {\n  if (render_width) {\n    return [100 * w / data[7] / screen_width, 100 * h / data[8] / screen_height];\n  } else {\n    return [100 * w / (data[2] - data[0]), 100 * h / (data[3] - data[1])];\n  }\n}\n\nexport function domToVirtual(dst, src) {\n  if (render_width) {\n    dst[0] = (src[0] * data[6] - render_offset_x) * data[7] + data[0];\n    dst[1] = (src[1] * data[6] - render_offset_y_top) * data[8] + data[1];\n  } else {\n    dst[0] = src[0] * data[6] / data[4] + data[0];\n    dst[1] = src[1] * data[6] / data[5] + data[1];\n  }\n}\n\nexport function domDeltaToVirtual(dst, src) {\n  if (render_width) {\n    dst[0] = src[0] * data[6] * data[7];\n    dst[1] = src[1] * data[6] * data[8];\n  } else {\n    dst[0] = src[0] * data[6] / data[4];\n    dst[1] = src[1] * data[6] / data[5];\n  }\n}\n\n// To get to coordinates used by mouse events\nexport function virtualToDom(dst, src) {\n  if (render_width) {\n    dst[0] = (render_offset_x + (src[0] - data[0]) / data[7]) / data[6];\n    dst[1] = (render_offset_y_top + (src[1] - data[1]) / data[8]) / data[6];\n  } else {\n    dst[0] = (src[0] - data[0]) * data[4] / data[6];\n    dst[1] = (src[1] - data[1]) * data[5] / data[6];\n  }\n}\n\nexport function virtualToFontSize(height) {\n  if (render_width) {\n    return height / (data[6] * data[8]) * 0.84;\n  } else {\n    return height * data[5] / data[6] * 0.84;\n  }\n}\n\n// dst/src are x/y/w/h objects (e.g. from input system)\nexport function virtualToDomPosParam(dst, src) {\n  if (render_width) {\n    dst.x = (render_offset_x + (src.x - data[0]) / data[7]) / data[6];\n    dst.w = src.w / data[7] / data[6];\n    dst.y = (render_offset_y_top + (src.y - data[1]) / data[8]) / data[6];\n    dst.h = src.h / data[8] / data[6];\n  } else {\n    dst.x = (src.x - data[0]) * data[4] / data[6];\n    dst.w = src.w * data[4] / data[6];\n    dst.y = (src.y - data[1]) * data[5] / data[6];\n    dst.h = src.h * data[5] / data[6];\n  }\n}\n\nexport function tickCamera2D() {\n  data[6] = window.devicePixelRatio || 1; /* css_to_real */\n  screen_width = engine.width;\n  screen_height = engine.height;\n  let viewport = [0, 0, screen_width, screen_height];\n  if (engine.render_width) {\n    // Note: render_* not used by FRVR at this time\n    render_width = engine.render_width;\n    render_height = engine.render_height;\n    // Find an offset so this rendered viewport is centered while preserving aspect ratio, just like setAspectFixed\n    let pa = engine.pixel_aspect;\n    let inv_aspect = render_height / pa / render_width;\n    let eff_screen_width = screen_width - safearea_pad[0] - safearea_pad[1];\n    let eff_screen_height = screen_height - safearea_pad[2] - safearea_pad[3];\n    let inv_desired_aspect = eff_screen_height / eff_screen_width;\n    if (inv_aspect > inv_desired_aspect) {\n      let margin = (render_height / inv_desired_aspect - render_width * pa) / 2 * eff_screen_height / render_height;\n      render_offset_x = safearea_pad[0] + round(margin);\n      render_offset_y_top = safearea_pad[2];\n      render_offset_y_bottom = safearea_pad[3];\n      render_viewport_w = round(eff_screen_width - margin * 2);\n      render_viewport_h = eff_screen_height;\n    } else {\n      let margin = (render_width * inv_desired_aspect - render_height / pa) / 2 * eff_screen_width / render_width;\n      render_offset_x = safearea_pad[0];\n      render_offset_y_top = safearea_pad[2] + round(margin);\n      render_offset_y_bottom = safearea_pad[3] + round(margin);\n      render_viewport_w = eff_screen_width;\n      render_viewport_h = round(eff_screen_height - margin * 2);\n    }\n    viewport[2] = render_width;\n    viewport[3] = render_height;\n  } else {\n    render_width = render_height = 0;\n    render_offset_x = 0;\n    render_offset_y_top = 0;\n    render_offset_y_bottom = 0;\n  }\n\n  reapply();\n\n  // let screen_width = engine.width;\n  // let screen_height = engine.height;\n  // let screen_aspect = screen_width / screen_height;\n  // let view_aspect = game_width / game_height;\n  // if (screen_aspect > view_aspect) {\n  //   let viewport_width = game_height * screen_aspect;\n  //   let half_diff = (viewport_width - game_width) / 2;\n  //   viewportRectangle = [-half_diff, 0, game_width + half_diff, game_height];\n  // } else {\n  //   let viewport_height = game_width / screen_aspect;\n  //   let half_diff = (viewport_height - game_height) / 2;\n  //   viewportRectangle = [0, -half_diff, game_width, game_height + half_diff];\n  // }\n\n  engine.setViewport(viewport);\n}\n\nexport function startup() {\n  set(0, 0, engine.width, engine.height);\n  tickCamera2D();\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst cmd_parse_mod = require('../../common/cmd_parse.js');\nconst local_storage = require('./local_storage.js');\nexport let cmd_parse = cmd_parse_mod.create({ storage: local_storage });\n\nconst engine = require('./engine.js');\nconst textures = require('./textures.js');\nconst { PI, round } = Math;\n\nwindow.cmd = function (str) {\n  cmd_parse.handle(null, str, cmd_parse_mod.defaultHandler);\n};\n\ncmd_parse.registerValue('fov', {\n  type: cmd_parse.TYPE_FLOAT,\n  label: 'FOV',\n  range: [1, 179],\n  get: () => round(engine.fov_min * 180 / PI),\n  set: v => engine.setFOV(v * PI / 180),\n  store: true\n});\n\nfunction byteFormat(bytes) {\n  if (bytes > 850000) {\n    return `${(bytes / (1024 * 1024)).toFixed(2)}MB`;\n  }\n  if (bytes > 850) {\n    return `${(bytes / 1024).toFixed(2)}KB`;\n  }\n  return `${bytes}B`;\n}\n\ncmd_parse.register({\n  cmd: 'texmem',\n  help: 'Displays texture memory usage',\n  func: function (str, resp_func) {\n    let keys = Object.keys(textures.textures);\n    keys = keys.filter(a => textures.textures[a].gpu_mem > 1024);\n    keys.sort((a, b) => textures.textures[a].gpu_mem - textures.textures[b].gpu_mem);\n    resp_func(null, keys.map(a => `${byteFormat(textures.textures[a].gpu_mem)} ${a}`).join('\\n'));\n  }\n});\n\ncmd_parse.register({\n  cmd: 'gpumem',\n  help: 'Displays GPU memory usage summary',\n  func: function (str, resp_func) {\n    let { gpu_mem } = engine.perf_state;\n    resp_func(null, `${byteFormat(gpu_mem.geom)} Geo\\n${byteFormat(gpu_mem.tex)} Tex\\n${byteFormat(gpu_mem.geom + gpu_mem.tex)} Total`);\n  }\n});\n\ncmd_parse.register({\n  cmd: 'd',\n  help: 'Toggles a debug define',\n  func: function (str, resp_func) {\n    str = str.toUpperCase();\n    engine.defines[str] = !engine.defines[str];\n    resp_func(null, `D=${str} now ${engine.defines[str] ? 'SET' : 'unset'}`);\n    engine.definesChanged();\n  }\n});\n\ncmd_parse.register({\n  cmd: 'renderer',\n  help: 'Displays current renderer',\n  func: function (str, resp_func) {\n    resp_func(null, `Renderer=WebGL${engine.webgl2 ? 2 : 1}`);\n  }\n});\n\nfunction cmdDesc(cmd_data) {\n  return `/${cmd_data.cmd} - ${cmd_data.help}`;\n}\n\ncmd_parse.register({\n  cmd: 'help',\n  help: 'Searches commands',\n  func: function (str, resp_func) {\n    let list = cmd_parse.autoComplete('', this && this.access);\n    if (str) {\n      let str_cname = cmd_parse.canonical(str);\n      let str_lc = str.toLowerCase();\n      list = list.filter(cmd_data => cmd_data.cname.indexOf(str_cname) !== -1 || cmd_data.help.toLowerCase().indexOf(str_lc) !== -1);\n    }\n    if (!list.length) {\n      return void resp_func(null, `No commands found matching \"${str}\"`);\n    }\n    resp_func(null, list.map(cmdDesc).join('\\n'));\n  }\n});\n\nexport let safearea = [-1, -1, -1, -1];\ncmd_parse.registerValue('safe_area', {\n  label: 'Safe Area',\n  type: cmd_parse.TYPE_STRING,\n  usage: 'Safe Area value: Use -1 for auto based on browser environment,\\n' + 'or 0-25 for percentage of screen size\\n' + '  Usage: /safe_area [value]\\n' + '  Usage: /safe_area horizontal,vertical\\n' + '  Usage: /safe_area left,right,top,bottom',\n  default_value: '-1',\n  get: () => safearea[0] === -1 ? '-1 (auto)' : safearea.join(','),\n  set: v => {\n    v = String(v);\n    let keys = v.split(',');\n    if (v && keys.length === 1) {\n      safearea[0] = safearea[1] = safearea[2] = safearea[3] = Number(v);\n    } else if (keys.length === 2) {\n      safearea[0] = safearea[1] = Number(keys[0]);\n      safearea[2] = safearea[3] = Number(keys[1]);\n    } else if (keys.length === 4) {\n      for (let ii = 0; ii < 4; ++ii) {\n        safearea[ii] = Number(keys[ii]);\n      }\n    } else {\n      // error, ignore?\n    }\n  },\n  store: true\n});\n\ncmd_parse.register({\n  cmd: 'webgl2_auto',\n  help: 'Resets WebGL2 auto-detection',\n  func: function (str, resp_func) {\n    let disable_data = local_storage.getJSON('webgl2_disable');\n    if (!disable_data) {\n      return resp_func(null, 'WebGL2 is already being auto-detected');\n    }\n    local_storage.setJSON('webgl2_disable', undefined);\n    return resp_func(null, 'WebGL2 was disabled, will attempt to use it again on the next load');\n  }\n});","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst camera2d = require('./camera2d.js');\nconst engine = require('./engine.js');\nconst glov_input = require('./input.js');\nconst glov_ui = require('./ui.js');\n\nconst { focuslog } = glov_ui;\n\nclass GlovUIEditBox {\n  constructor(params) {\n    this.x = 0;\n    this.y = 0;\n    this.z = Z.UI; // actually in DOM, so above everything!\n    this.w = glov_ui.button_width;\n    this.type = 'text';\n    this.allow_modal = false;\n    // this.h = glov_ui.button_height;\n    this.font_height = glov_ui.font_height;\n    this.text = '';\n    this.placeholder = '';\n    this.max_len = 0;\n    this.initial_focus = false;\n    this.onetime_focus = false;\n    this.auto_unfocus = false;\n    this.initial_select = false;\n    this.spellcheck = true;\n    this.applyParams(params);\n    this.is_focused = false;\n\n    this.elem = null;\n    this.input = null;\n    this.submitted = false;\n    this.pointer_lock = false;\n    this.last_frame = 0;\n  }\n  applyParams(params) {\n    if (!params) {\n      return;\n    }\n    for (let f in params) {\n      this[f] = params[f];\n    }\n  }\n  getText() {\n    return this.text;\n  }\n  setText(new_text) {\n    if (this.input) {\n      this.input.value = new_text;\n    }\n    this.text = new_text;\n  }\n  focus() {\n    if (this.input) {\n      this.input.focus();\n    } else {\n      this.onetime_focus = true;\n    }\n    glov_ui.focusSteal(this);\n    this.is_focused = true;\n    if (this.pointer_lock) {\n      glov_input.pointerLockExit();\n    }\n  }\n  unfocus() {\n    glov_ui.focusNext(this);\n  }\n  isFocused() {\n    // call after .run()\n    return this.is_focused;\n  }\n\n  updateFocus() {\n    let was_glov_focused = this.is_focused;\n    let glov_focused = glov_ui.focusCheck(this);\n    let dom_focused = this.input && document.activeElement === this.input;\n    if (was_glov_focused !== glov_focused) {\n      // something external (from clicks/keys in GLOV) changed, apply it if it doesn't match\n      if (glov_focused && !dom_focused && this.input) {\n        focuslog('GLOV focused, DOM not, focusing', this);\n        this.input.focus();\n      }\n      if (!glov_focused && dom_focused) {\n        focuslog('DOM focused, GLOV not, and changed, blurring', this);\n        this.input.blur();\n      }\n    } else if (dom_focused && !glov_focused) {\n      focuslog('DOM focused, GLOV not, stealing', this);\n      glov_ui.focusSteal(this);\n      glov_focused = true;\n    } else if (!dom_focused && glov_focused) {\n      // Leave it alone, it may be a browser pop-up such as for passwords\n    }\n    let focused = glov_focused;\n\n    if (focused) {\n      let key_opt = this.pointer_lock && !this.text ? { in_event_cb: glov_input.pointerLockEnter } : null;\n      if (glov_input.keyUpEdge(glov_input.KEYS.ESC, key_opt)) {\n        if (this.text) {\n          this.setText('');\n        } else {\n          glov_ui.focusCanvas();\n          if (this.input) {\n            this.input.blur();\n          }\n          focused = false;\n          this.canceled = true;\n        }\n      }\n    }\n    this.is_focused = focused;\n    return focused;\n  }\n\n  run(params) {\n    this.applyParams(params);\n\n    if (this.last_frame !== engine.global_frame_index - 1) {\n      // it's been more than a frame, we must have not been running, discard async events\n      this.submitted = false;\n    }\n    this.last_frame = engine.global_frame_index;\n\n    this.canceled = false;\n    let focused = this.updateFocus();\n\n    glov_ui.this_frame_edit_boxes.push(this);\n    let elem = glov_ui.getElem(this.allow_modal, this.elem);\n    if (elem !== this.elem) {\n      if (elem) {\n        // new DOM element, initialize\n        elem.textContent = '';\n        let form = document.createElement('form');\n        form.setAttribute('autocomplete', 'off');\n        let input = document.createElement('input');\n        input.setAttribute('autocomplete', `auto_off_${Math.random()}`);\n        input.setAttribute('type', this.type);\n        input.setAttribute('placeholder', this.placeholder);\n        if (this.max_len) {\n          input.setAttribute('maxLength', this.max_len);\n        }\n        input.setAttribute('tabindex', 2);\n        form.addEventListener('submit', ev => {\n          ev.preventDefault();\n          this.submitted = true;\n          this.text = this.input.value;\n          if (this.pointer_lock && !this.text) {\n            glov_input.pointerLockEnter('edit_box_submit');\n          }\n        }, true);\n        form.appendChild(input);\n        let span = document.createElement('span');\n        span.setAttribute('tabindex', 3);\n        form.appendChild(span);\n        elem.appendChild(form);\n        input.value = this.text;\n        this.input = input;\n        if (this.initial_focus || this.onetime_focus) {\n          input.focus();\n          this.onetime_focus = false;\n        }\n        if (this.initial_select) {\n          input.select();\n        }\n      } else {\n        this.input = null;\n      }\n      this.submitted = false;\n      this.elem = elem;\n    } else {\n      if (this.input) {\n        this.text = this.input.value;\n      }\n    }\n    if (elem) {\n      let pos = camera2d.htmlPos(this.x, this.y);\n      if (!this.spellcheck) {\n        elem.spellcheck = false;\n      }\n      elem.style.left = `${pos[0]}%`;\n      elem.style.top = `${pos[1]}%`;\n      let size = camera2d.htmlSize(this.w, 0);\n      elem.style.width = `${size[0]}%`;\n      let old_fontsize = elem.style.fontSize || '?px';\n      let new_fontsize = `${camera2d.virtualToFontSize(this.font_height).toFixed(0)}px`;\n      if (new_fontsize !== old_fontsize) {\n        elem.style.fontSize = new_fontsize;\n      }\n    }\n\n    if (focused) {\n      if (this.auto_unfocus) {\n        if (glov_input.click({ peek: true })) {\n          glov_ui.focusSteal('canvas');\n        }\n      }\n      // keyboard input is handled by the INPUT element, but allow mouse events to trickle\n      glov_input.eatAllKeyboardInput();\n    }\n\n    if (this.submitted) {\n      this.submitted = false;\n      return this.SUBMIT;\n    }\n    if (this.canceled) {\n      this.canceled = false;\n      return this.CANCEL;\n    }\n    return null;\n  }\n  unrun() {\n    // remove from DOM or hide\n    this.elem = null;\n    this.input = null;\n  }\n}\nGlovUIEditBox.prototype.SUBMIT = 'submit';\nGlovUIEditBox.prototype.CANCEL = 'cancel';\n\nexport function create(params) {\n  return new GlovUIEditBox(params);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n// Some code from Turbulenz: Copyright (c) 2012-2013 Turbulenz Limited\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst engine = require('./engine.js');\nconst geom = require('./geom.js');\nconst shaders = require('./shaders.js');\nconst textures = require('./textures.js');\nconst { vec2, vec3, vec4, v4set } = require('./vmath.js');\n\nconst shader_data = {\n  vp_copy: {\n    vp: 'glov/shaders/effects_copy.vp'\n  },\n  copy: {\n    fp: 'glov/shaders/effects_copy.fp'\n  },\n  pixely_expand: {\n    fp: 'glov/shaders/pixely_expand.fp'\n  },\n  gaussian_blur: {\n    fp: 'glov/shaders/effects_gaussian_blur.fp'\n  },\n  // bloom_merge: {\n  //   fp: 'glov/shaders/effects_bloom_merge.fp',\n  // },\n  // bloom_threshold: {\n  //   fp: 'glov/shaders/effects_bloom_threshold.fp',\n  // },\n  color_matrix: {\n    fp: 'glov/shaders/effects_color_matrix.fp'\n  }\n  // distort: {\n  //   fp: 'glov/shaders/effects_distort.fp',\n  // },\n};\n\nexport function registerShader(key, obj) {\n  shader_data[key] = obj;\n}\n\nfunction getShader(key) {\n  let elem = shader_data[key];\n  if (!elem.shader) {\n    if (elem.fp) {\n      elem.shader = shaders.create(elem.fp);\n    } else {\n      elem.shader = shaders.create(elem.vp);\n    }\n  }\n  return elem.shader;\n}\n\nlet inited = false;\nlet clip_space = vec4(2, 2, -1, -1);\nlet copy_uv_scale = vec2(1, 1);\nlet shader_params_default = {\n  clip_space,\n  copy_uv_scale\n};\n// let shader_params_distort;\nlet shader_params_color_matrix;\n// let shader_params_bloom;\n// let shader_params_bloom_merge;\nlet shader_params_gaussian_blur;\nlet shader_params_pixely_expand;\nlet quad_geom;\nfunction startup() {\n  inited = true;\n\n  quad_geom = geom.create([[shaders.semantic.POSITION, gl.FLOAT, 2, false]], new Float32Array([0, 0, 1, 0, 1, 1, 0, 1]), null, geom.QUADS); // TODO: use gl.TRIANGLE_STRIP instead, save index buffer binding\n\n  // shader_params_distort = {\n  //   clip_space,\n  //   copy_uv_scale,\n  //   strength: vec2(0, 0),\n  //   transform: new Float32Array([0, 0, 0, 0, 0, 0]),\n  //   invTransform: vec4(0, 0, 0, 0),\n  // };\n\n  shader_params_color_matrix = {\n    clip_space,\n    copy_uv_scale,\n    colorMatrix: new Float32Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])\n  };\n\n  // shader_params_bloom = {\n  //   clip_space,\n  //   copy_uv_scale,\n  //   bloomThreshold: 0,\n  //   thresholdCuttoff: 0,\n  // };\n\n  // shader_params_bloom_merge = {\n  //   clip_space,\n  //   copy_uv_scale,\n  //   bloomIntensity: 0,\n  //   bloomSaturation: 0,\n  //   originalIntensity: 0,\n  //   originalSaturation: 0,\n  // };\n\n  // Gaussian Blur effect (also used by bloom)\n  shader_params_gaussian_blur = {\n    clip_space,\n    copy_uv_scale,\n    sampleRadius: vec3(1, 1, 1),\n    Gauss: new Float32Array([0.93, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1])\n  };\n\n  shader_params_pixely_expand = {\n    clip_space,\n    copy_uv_scale,\n    orig_pixel_size: vec4()\n  };\n}\n\nexport function grayScaleMatrix(dst) {\n  dst[0] = 0.2126;\n  dst[1] = 0.2126;\n  dst[2] = 0.2126;\n  dst[3] = 0.7152;\n  dst[4] = 0.7152;\n  dst[5] = 0.7152;\n  dst[6] = 0.0722;\n  dst[7] = 0.0722;\n  dst[8] = 0.0722;\n  dst[9] = dst[10] = dst[11] = 0;\n}\n\nexport function sepiaMatrix(dst) {\n  dst[0] = 0.393;\n  dst[1] = 0.349;\n  dst[2] = 0.272;\n  dst[3] = 0.769;\n  dst[4] = 0.686;\n  dst[5] = 0.534;\n  dst[6] = 0.189;\n  dst[7] = 0.168;\n  dst[8] = 0.131;\n  dst[9] = dst[10] = dst[11] = 0;\n}\n\nexport function negativeMatrix(dst) {\n  dst[0] = dst[4] = dst[8] = -1;\n  dst[1] = dst[2] = dst[3] = dst[5] = dst[6] = dst[7] = 0;\n  dst[9] = dst[10] = dst[11] = 1;\n}\n\nexport function saturationMatrix(dst, saturationScale) {\n  let is = 1 - saturationScale;\n  dst[0] = is * 0.2126 + saturationScale;\n  dst[1] = is * 0.2126;\n  dst[2] = is * 0.2126;\n  dst[3] = is * 0.7152;\n  dst[4] = is * 0.7152 + saturationScale;\n  dst[5] = is * 0.7152;\n  dst[6] = is * 0.0722;\n  dst[7] = is * 0.0722;\n  dst[8] = is * 0.0722 + saturationScale;\n  dst[9] = dst[10] = dst[11] = 0;\n}\n\nexport function hueMatrix(dst, angle) {\n  ////\n  //// Uncomment to calculate new coeffecients should luminance\n  //// values 0.2126 0.7152 0.0722 change.\n  //let lumR = 0.2126;\n  //let lumG = 0.7152;\n  //let lumB = 0.0722;\n  ////\n  //let r23 = Math.sqrt(2 / 3);\n  //let r12 = 1 / Math.sqrt(2);\n  //let r13 = 1 / Math.sqrt(3);\n  //let r16 = 1 / Math.sqrt(6);\n  //let M = [r23, 0, r13, -r16, r12, r13, -r16, -r12, r13, 0, 0, 0];\n  //let zx = (r23 * lumR) - (r16 * lumG) - (r16 * lumB);\n  //let zy =                (r12 * lumG) - (r12 * lumB);\n  //let zz = (r13 * lumR) + (r13 * lumG) + (r13 * lumB);\n  //let x = zx / zz;\n  //let y = zy / zz;\n  //let C = [1, 0, x, 0, 1, y, 0, 0, 1, 0, 0, 0];\n  //m43mul(M, M, C);\n  //console.log(\"Pre transform = \", M);\n  //let E = [1, 0, -x, 0, 1, -y, 0, 0, 1, 0, 0, 0];\n  //let N = [r23, -r16, -r16, 0, r12, -r12, r13, r13, r13, 0, 0, 0];\n  //m43mul(N, E, N);\n  //console.log(\"Post transform = \", N);\n  ////\n  //// Final matrix is then: m43Mul(Pre, [c, s, 0, -s, c, 0, 0, 0, 1, 0, 0, 0, ], Post);\n  //// for c = cos(angle), s = sin(angle)\n  ////\n  //let out = \"\";\n  //out += \"let c = Math.cos(angle);\\n\";\n  //out += \"let s = Math.sin(angle);\\n\";\n  //out += \"dst[0] = (\" + (N[0]*M[0]+N[3]*M[1]) + \" * c) + (\" + (N[3]*M[0]-N[0]*M[1]) + \" * s) + \" + lumR+\";\\n\";\n  //out += \"dst[1] = (\" + (-lumR)               + \" * c) + (\" + (N[4]*M[0]-N[1]*M[1]) + \" * s) + \" + lumR+\";\\n\";\n  //out += \"dst[2] = (\" + (-lumR)               + \" * c) + (\" + (N[5]*M[0]-N[2]*M[1]) + \" * s) + \" + lumR+\";\\n\";\n  //out += \"dst[3] = (\" + (-lumG)               + \" * c) + (\" + (N[3]*M[3]-N[0]*M[4]) + \" * s) + \" + lumG+\";\\n\";\n  //out += \"dst[4] = (\" + (N[1]*M[3]+N[4]*M[4]) + \" * c) + (\" + (N[4]*M[3]-N[1]*M[4]) + \" * s) + \" + lumG+\";\\n\";\n  //out += \"dst[5] = (\" + (-lumG)               + \" * c) + (\" + (N[5]*M[3]-N[2]*M[4]) + \" * s) + \" + lumG+\";\\n\";\n  //out += \"dst[6] = (\" + (-lumB)               + \" * c) + (\" + (N[3]*M[6]-N[0]*M[7]) + \" * s) + \" + lumB+\";\\n\";\n  //out += \"dst[7] = (\" + (-lumB)               + \" * c) + (\" + (N[4]*M[6]-N[1]*M[7]) + \" * s) + \" + lumB+\";\\n\";\n  //out += \"dst[8] = (\" + (N[2]*M[6]+N[5]*M[7]) + \" * c) + (\" + (N[5]*M[6]-N[2]*M[7]) + \" * s) + \" + lumB+\";\\n\";\n  //console.log(out);\n  let c = Math.cos(angle);\n  let s = Math.sin(angle);\n  dst[0] = 0.7874 * c + -0.3712362230889293 * s + 0.2126;\n  dst[1] = -0.2126 * c + 0.20611404610069642 * s + 0.2126;\n  dst[2] = -0.2126 * c + -0.9485864922785551 * s + 0.2126;\n  dst[3] = -0.7152 * c + -0.4962902913954023 * s + 0.7152;\n  dst[4] = 0.2848 * c + 0.08105997779422341 * s + 0.7152;\n  dst[5] = -0.7152 * c + 0.6584102469838492 * s + 0.7152;\n  dst[6] = -0.0722 * c + 0.8675265144843316 * s + 0.0722;\n  dst[7] = -0.0722 * c + -0.28717402389491986 * s + 0.0722;\n  dst[8] = 0.9278 * c + 0.290176245294706 * s + 0.0722;\n  dst[9] = dst[10] = dst[11] = 0;\n}\n\nexport function brightnessAddMatrix(dst, brightnessOffset) {\n  dst[0] = dst[4] = dst[8] = 1;\n  dst[1] = dst[2] = dst[3] = dst[5] = dst[6] = dst[7] = 0;\n  dst[9] = dst[10] = dst[11] = brightnessOffset;\n}\n\nexport function brightnessScaleMatrix(dst, scale) {\n  dst[0] = dst[4] = dst[8] = scale;\n  dst[1] = dst[2] = dst[3] = dst[5] = dst[6] = dst[7] = 0;\n  dst[9] = dst[10] = dst[11] = 0;\n}\n\nexport function additiveMatrix(dst, additiveRGB) {\n  dst[0] = dst[4] = dst[8] = 1;\n  dst[1] = dst[2] = dst[3] = dst[5] = dst[6] = dst[7] = 0;\n  dst[9] = additiveRGB[0];\n  dst[10] = additiveRGB[1];\n  dst[11] = additiveRGB[2];\n}\n\nexport function contrastMatrix(dst, contrastScale) {\n  dst[0] = dst[4] = dst[8] = contrastScale;\n  dst[1] = dst[2] = dst[3] = dst[5] = dst[6] = dst[7] = 0;\n  dst[9] = dst[10] = dst[11] = 0.5 * (1 - contrastScale);\n}\n\n// effect: { shader, params, texs }\nfunction applyEffect(effect, view_w, view_h) {\n  let viewport = engine.viewport;\n  let target_w = viewport[2];\n  let target_h = viewport[3];\n  view_w = view_w || target_w;\n  view_h = view_h || target_h;\n\n  // Set values for parameters used by all effects\n  clip_space[0] = 2.0 * view_w / target_w;\n  clip_space[1] = 2.0 * view_h / target_h;\n  // clip_space[2] = -1.0;\n  // clip_space[3] = -1.0;\n  // copy_uv_scale[0] = target_w / effect.coord_source.width;\n  // copy_uv_scale[1] = target_h / effect.coord_source.height;\n\n  shaders.bind(getShader('vp_copy'), getShader(effect.shader), effect.params);\n  textures.bindArray(effect.texs);\n  quad_geom.draw();\n}\n\n// // TODO: Update for RTBBCTT and port to new GLOV.js\n// function applyBloomTODO(params) {\n//   let source = params.source;\n//   let blur1 = params.blurTarget1;\n//   let blur2 = params.blurTarget2;\n//   let dest = params.destination;\n//   if (!source || !dest || !blur1 || !blur2 || !blur1.colorTexture0 ||\n//     !blur2.colorTexture0 || blur1 === blur2 || blur1 === dest ||\n//     source === blur1.colorTexture0 || source === dest.colorTexture0) {\n//     return false;\n//   }\n//\n//   let effectParams = this.effectParams;\n//   let techparams;\n//\n//   // Threshold copy.\n//   techparams = this.bloomThresholdParameters;\n//   effectParams.technique = this.bloomThresholdTechnique;\n//   effectParams.params = techparams;\n//\n//   techparams.bloomThreshold = (params.bloomThreshold !== undefined) ? params.bloomThreshold : 0.65;\n//   techparams.thresholdCutoff = Math.exp((params.thresholdCutoff !== undefined) ? params.thresholdCutoff : 3);\n//   techparams.inputTexture0 = source;\n//   effectParams.destination = blur1;\n//   this.applyEffect(effectParams);\n//\n//   // Gaussian blur.\n//   techparams = this.gaussianBlurParameters;\n//   effectParams.technique = this.gaussianBlurTechnique;\n//   effectParams.params = techparams;\n//\n//   let sampleRadius = (params.blurRadius || 20);\n//   techparams.sampleRadius[0] = sampleRadius / source.width;\n//   techparams.sampleRadius[1] = 0;\n//   techparams.sampleRadius[2] = 1;\n//   techparams.inputTexture0 = blur1.colorTexture0;\n//   effectParams.destination = blur2;\n//   this.applyEffect(effectParams);\n//\n//   techparams.sampleRadius[0] = 0;\n//   techparams.sampleRadius[1] = sampleRadius / source.height;\n//   techparams.sampleRadius[2] = 1;\n//   techparams.inputTexture0 = blur2.colorTexture0;\n//   effectParams.destination = blur1;\n//   this.applyEffect(effectParams);\n//\n//   // Merge.\n//   techparams = this.bloomMergeParameters;\n//   effectParams.technique = this.bloomMergeTechnique;\n//   effectParams.params = techparams;\n//\n//   techparams.bloomIntensity = (params.bloomIntensity !== undefined) ? params.bloomIntensity : 1.2;\n//   techparams.bloomSaturation = (params.bloomSaturation !== undefined) ? params.bloomSaturation : 1.2;\n//   techparams.originalIntensity = (params.originalIntensity !== undefined) ? params.originalIntensity : 1.0;\n//   techparams.originalSaturation = (params.originalSaturation !== undefined) ? params.originalSaturation : 1.0;\n//   techparams.inputTexture0 = source;\n//   techparams.inputTexture1 = blur1.colorTexture0;\n//   effectParams.destination = dest;\n//   this.applyEffect(effectParams);\n//\n//   return true;\n// }\n\nexport function applyCopy(params) {\n  if (!inited) {\n    startup();\n  }\n  applyEffect({\n    shader: params.shader || 'copy',\n    params: shader_params_default,\n    texs: [params.source]\n  });\n}\n\nexport function applyPixelyExpand(params) {\n  if (!inited) {\n    startup();\n  }\n  let source = params.source;\n  source.setSamplerState({\n    filter_min: gl.LINEAR,\n    filter_mag: gl.LINEAR,\n    wrap_s: gl.CLAMP_TO_EDGE,\n    wrap_t: gl.CLAMP_TO_EDGE\n  });\n\n  // do horizontal blur for primary lines\n  let resx = source.width;\n  let resy = source.height;\n  let sampleRadius = (params.hblur || 0.25) / resx;\n  shader_params_gaussian_blur.sampleRadius[0] = sampleRadius;\n  shader_params_gaussian_blur.sampleRadius[1] = 0;\n  shader_params_gaussian_blur.sampleRadius[2] = 1;\n  applyEffect({\n    shader: 'gaussian_blur',\n    params: shader_params_gaussian_blur,\n    texs: [source]\n  }, resx, resy);\n  let hblur = engine.captureFramebuffer(null, resx, resy, true, false);\n\n  // do seperable gaussian blur for scanlines (using horizontal blur from above)\n  sampleRadius = (params.vblur || 0.75) / resy;\n  shader_params_gaussian_blur.sampleRadius[0] = 0;\n  shader_params_gaussian_blur.sampleRadius[1] = sampleRadius;\n  shader_params_gaussian_blur.sampleRadius[2] = 1;\n  applyEffect({\n    shader: 'gaussian_blur',\n    params: shader_params_gaussian_blur,\n    texs: [hblur]\n  }, resx, resy);\n  let vblur = engine.captureFramebuffer(null, resx, resy, true, false);\n\n  // combine at full res\n  v4set(shader_params_pixely_expand.orig_pixel_size, source.width, source.height, 1 / source.width, 1 / source.height);\n\n  engine.setViewport(params.final_viewport);\n  if (params.clear_color) {\n    gl.clearColor(params.clear_color[0], params.clear_color[1], params.clear_color[2], params.clear_color[3]);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n  }\n\n  applyEffect({\n    shader: 'pixely_expand',\n    params: shader_params_pixely_expand,\n    texs: [source, hblur, vblur]\n  });\n}\n\nexport function applyGaussianBlur(params) {\n  if (!inited) {\n    startup();\n  }\n  let source = params.source;\n  source.setSamplerState({\n    filter_min: gl.LINEAR,\n    filter_mag: gl.LINEAR,\n    wrap_s: gl.CLAMP_TO_EDGE,\n    wrap_t: gl.CLAMP_TO_EDGE\n  });\n  let max_size = params.max_size || 512;\n  let min_size = params.min_size || 128;\n\n  // Quick shrink down to 512->256->128 (or other specified min/max size)\n  let inputTexture0 = source;\n\n  let viewport = engine.viewport;\n  let res = max_size;\n  while (res > viewport[2] || res > viewport[3]) {\n    res /= 2;\n  }\n\n  while (res > min_size) {\n    applyEffect({\n      shader: params.shader_copy || 'copy',\n      params: shader_params_default,\n      texs: [inputTexture0]\n    }, res, res);\n    inputTexture0 = engine.captureFramebuffer(null, res, res, true, false);\n    res /= 2;\n  }\n\n  // Do seperable blur\n  let sampleRadius = (params.blur || 1) / res;\n  shader_params_gaussian_blur.sampleRadius[0] = sampleRadius;\n  shader_params_gaussian_blur.sampleRadius[1] = 0;\n  shader_params_gaussian_blur.sampleRadius[2] = params.glow || 1;\n  applyEffect({\n    shader: 'gaussian_blur',\n    params: shader_params_gaussian_blur,\n    texs: [inputTexture0]\n  }, res, res);\n  let blur = engine.captureFramebuffer(null, res, res, true, false);\n\n  shader_params_gaussian_blur.sampleRadius[0] = 0;\n  shader_params_gaussian_blur.sampleRadius[1] = sampleRadius;\n  shader_params_gaussian_blur.sampleRadius[2] = params.glow || 1;\n  applyEffect({\n    shader: 'gaussian_blur',\n    params: shader_params_gaussian_blur,\n    texs: [blur]\n  });\n\n  return true;\n}\n\nexport function applyColorMatrix(params) {\n  if (!inited) {\n    startup();\n  }\n  let source = params.source;\n  source.setSamplerState({\n    filter_min: gl.LINEAR,\n    filter_mag: gl.LINEAR,\n    wrap_s: gl.CLAMP_TO_EDGE,\n    wrap_t: gl.CLAMP_TO_EDGE\n  });\n\n  let matrix = params.colorMatrix;\n  let mout = shader_params_color_matrix.colorMatrix;\n\n  mout[0] = matrix[0];\n  mout[1] = matrix[3];\n  mout[2] = matrix[6];\n  mout[3] = matrix[9];\n  mout[4] = matrix[1];\n  mout[5] = matrix[4];\n  mout[6] = matrix[7];\n  mout[7] = matrix[10];\n  mout[8] = matrix[2];\n  mout[9] = matrix[5];\n  mout[10] = matrix[8];\n  mout[11] = matrix[11];\n\n  applyEffect({\n    shader: 'color_matrix',\n    params: shader_params_color_matrix,\n    texs: [source]\n  });\n\n  return true;\n}\n\n// // TODO: Update for RTBBCTT and port to new GLOV.js\n// export function applyDistortTODO(params) {\n//   let source = params.source;\n//   let dest = params.destination;\n//   let distort = params.distortion;\n//   if (!source || !dest || !distort || !dest.colorTexture0 ||\n//     source === dest.colorTexture0 || distort === dest.colorTexture0) {\n//     return false;\n//   }\n//\n//   // input transform.\n//   //  a b tx\n//   //  c d ty\n//   let a;\n//   let b;\n//   let c;\n//   let d;\n//   let tx;\n//   let ty;\n//\n//   let transform = params.transform;\n//   if (transform) {\n//     // transform col-major.\n//     a = transform[0];\n//     b = transform[2];\n//     tx = transform[4];\n//     c = transform[1];\n//     d = transform[3];\n//     ty = transform[5];\n//   } else {\n//     a = d = 1;\n//     b = c = 0;\n//     tx = ty = 0;\n//   }\n//\n//   let effectParams = this.effectParams;\n//   let techparams = this.distortParameters;\n//   effectParams.technique = this.distortTechnique;\n//   effectParams.params = techparams;\n//\n//   // TODO: Cache 'transform', 'invTransform', etc in the code below\n//   techparams.transform[0] = a;\n//   techparams.transform[1] = b;\n//   techparams.transform[2] = tx;\n//   techparams.transform[3] = c;\n//   techparams.transform[4] = d;\n//   techparams.transform[5] = ty;\n//\n//   // Compute inverse transform to use in distort texture displacement..\n//   let idet = 1 / (a * d - b * c);\n//   let ia = techparams.invTransform[0] = (idet * d);\n//   let ib = techparams.invTransform[1] = (idet * -b);\n//   let ic = techparams.invTransform[2] = (idet * -c);\n//   let id = techparams.invTransform[3] = (idet * a);\n//\n//   // Compute max pixel offset after transform for normalisation.\n//   let x1 = ((ia + ib) * (ia + ib)) + ((ic + id) * (ic + id));\n//   let x2 = ((ia - ib) * (ia - ib)) + ((ic - id) * (ic - id));\n//   let x3 = ((-ia + ib) * (-ia + ib)) + ((-ic + id) * (-ic + id));\n//   let x4 = ((-ia - ib) * (-ia - ib)) + ((-ic - id) * (-ic - id));\n//   let xmax = 0.5 * Math.sqrt(Math.max(x1, x2, x3, x4));\n//\n//   let strength = (params.strength || 10);\n//   techparams.strength[0] = strength / (source.width * xmax);\n//   techparams.strength[1] = strength / (source.height * xmax);\n//\n//   techparams.inputTexture0 = source;\n//   techparams.distortTexture = distort; // linear / repeat\n//   effectParams.destination = dest;\n//   this.applyEffect(effectParams);\n//\n//   return true;\n// }\n\nexport function clearAlpha() {\n  let old_dt = gl.getParameter(gl.DEPTH_TEST);\n  if (old_dt) {\n    gl.disable(gl.DEPTH_TEST);\n  }\n  gl.colorMask(false, false, false, true);\n  applyCopy({ source: textures.textures.white });\n  gl.colorMask(true, true, true, true);\n  if (old_dt) {\n    gl.enable(gl.DEPTH_TEST);\n  }\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint-env browser */\n\nrequire('./bootstrap.js'); // Just in case it's not in app.js\n\nexport let DEBUG = String(document.location).match(/^https?:\\/\\/localhost/);\n\nrequire('not_worker'); // This module cannot be required from a worker bundle\n\nconst assert = require('assert');\nconst camera2d = require('./camera2d.js');\nconst cmds = require('./cmds.js');\nconst effects = require('./effects.js');\nconst glov_font = require('./font.js');\nconst font_info_palanquin32 = require('../img/font/palanquin32.json');\nconst geom = require('./geom.js');\nconst input = require('./input.js');\nconst local_storage = require('./local_storage.js');\nconst mat3FromMat4 = require('gl-mat3/fromMat4');\nconst mat4Copy = require('gl-mat4/copy');\nconst mat4Invert = require('gl-mat4/invert');\nconst mat4Mul = require('gl-mat4/multiply');\nconst mat4Transpose = require('gl-mat4/transpose');\nconst mat4Perspective = require('gl-mat4/perspective');\nconst { asin, cos, floor, min, max, PI, round, sin, sqrt } = Math;\nconst models = require('./models.js');\nconst perf = require('./perf.js');\nconst settings = require('./settings.js');\nconst shaders = require('./shaders.js');\nconst { soundLoading, soundStartup, soundTick } = require('./sound.js');\nconst sprites = require('./sprites.js');\nconst textures = require('./textures.js');\nconst { texturesTick } = textures;\nconst glov_transition = require('./transition.js');\nconst glov_ui = require('./ui.js');\nconst urlhash = require('./urlhash.js');\nconst { clamp, defaults, nearSame, ridx } = require('../../common/util.js');\nconst { mat3, mat4, vec3, vec4, v3mulMat4, v3iNormalize, v4copy, v4same, v4set } = require('./vmath.js');\n\nexport let canvas;\nexport let webgl2;\nexport let glov_particles;\n\nexport let width;\nexport let height;\nexport let pixel_aspect = 1;\nexport let antialias;\n\nexport let game_width;\nexport let game_height;\n\nexport let render_width;\nexport let render_height;\n\n//eslint-disable-next-line no-use-before-define\nexport let defines = urlhash.register({ key: 'D', type: urlhash.TYPE_SET, change: definesChanged });\n\nexport let any_3d = false;\nexport let ZFAR;\nexport let ZNEAR;\nexport let fov_y = 1;\nexport let fov_x = 1;\nexport let fov_min = 60 * PI / 180;\n\nexport let mat_projection = mat4();\nexport let mat_view = mat4();\nlet mat_m = mat4();\nexport let mat_vp = mat4();\nlet mat_mv = mat4();\nlet mat_mv_no_skew = mat4();\nlet mat_mvp = mat4();\nlet mat_mv_inv_transform = mat3();\nlet mat_inv_view = mat3();\nlet projection_inverse = vec4();\n\nexport let light_diffuse = vec3(0.75, 0.75, 0.75);\nlet light_dir_vs = vec3(0, 0, 0);\nexport let light_ambient = vec3(0.25, 0.25, 0.25);\nexport let light_dir_ws = vec3(-1, -2, -3);\n\nexport let font;\nexport let app_state = null;\nexport const border_color = vec4(0, 0, 0, 1);\n\nlet mat_temp = mat4();\nexport function setGlobalMatrices(_mat_view) {\n  mat4Copy(mat_view, _mat_view);\n  mat4Mul(mat_vp, mat_projection, mat_view);\n  v3iNormalize(light_dir_ws);\n  v3mulMat4(light_dir_vs, light_dir_ws, mat_view);\n  mat4Invert(mat_temp, mat_view);\n  mat3FromMat4(mat_inv_view, mat_temp);\n}\n\nexport function setFOV(new_fov) {\n  fov_min = new_fov;\n}\n\nexport function setGameDims(w, h) {\n  game_width = w;\n  game_height = h;\n}\n\nlet is_ios_safari = function () {\n  let ua = window.navigator.userAgent;\n  let is_ios = ua.match(/iPad/i) || ua.match(/iPhone/i);\n  let webkit = ua.match(/WebKit/i);\n  return is_ios && webkit && !ua.match(/CriOS/i);\n}();\n\n// Didn't need this for a while, but got slow on iOS recently :(\nconst postprocessing_reset_version = '3';\nexport let postprocessing = local_storage.get('glov_no_postprocessing') !== postprocessing_reset_version;\nexport function postprocessingAllow(allow) {\n  local_storage.set('glov_no_postprocessing', allow ? undefined : postprocessing_reset_version);\n  postprocessing = allow;\n}\n\nexport function glCheckError() {\n  let gl_err = gl.getError();\n  if (gl_err) {\n    console.error(gl_err);\n    throw new Error(gl_err);\n  }\n}\n\nexport function releaseCanvas() {\n  try {\n    if (gl) {\n      let ext = gl.getExtension('WEBGL_lose_context');\n      if (ext) {\n        ext.loseContext();\n      }\n    }\n  } catch (ignored) {\n    // nothing, it's fine\n  }\n}\n\nexport function reloadSafe() {\n  // Release canvas to not leak memory on Firefox\n  releaseCanvas();\n  document.location.reload();\n}\nwindow.reloadSafe = reloadSafe;\n\nlet reloading_defines = {};\nexport function defineCausesReload(define) {\n  reloading_defines[define] = defines[define];\n}\ndefineCausesReload('FORCEWEBGL2');\ndefineCausesReload('NOWEBGL2');\nexport function definesChanged() {\n  for (let key in reloading_defines) {\n    if (defines[key] !== reloading_defines[key]) {\n      urlhash.onURLChange(reloadSafe);\n      break;\n    }\n  }\n  shaders.handleDefinesChanged();\n}\n\nfunction normalizeRow(m, idx) {\n  let len = m[idx] * m[idx] + m[idx + 1] * m[idx + 1] + m[idx + 2] * m[idx + 2];\n  if (len > 0) {\n    len = 1 / sqrt(len);\n    m[idx] *= len;\n    m[idx + 1] *= len;\n    m[idx + 2] *= len;\n  }\n}\n\nexport function updateMatrices(mat_model) {\n  // PERFTODO: depending on rendering path, only some of these are needed (m + vp or just mvp)\n  mat4Copy(mat_m, mat_model);\n\n  mat4Mul(mat_mv, mat_view, mat_model);\n  mat4Mul(mat_mvp, mat_projection, mat_mv);\n  // TODO: Can expand and simplify all of this, especially below\n  // Compute the inverse transform of thee model_view matrix, discarding scale,\n  // to be used for getting normals into view space\n  mat4Copy(mat_temp, mat_model);\n  normalizeRow(mat_temp, 0);\n  normalizeRow(mat_temp, 4);\n  normalizeRow(mat_temp, 8);\n  mat4Mul(mat_mv_no_skew, mat_view, mat_temp);\n  mat4Invert(mat_temp, mat_mv_no_skew);\n  mat4Transpose(mat_temp, mat_temp);\n  mat3FromMat4(mat_mv_inv_transform, mat_temp);\n}\nexport let global_timer = 0;\nexport function getFrameTimestamp() {\n  return global_timer;\n}\n\nexport let global_frame_index = 0;\nexport function getFrameIndex() {\n  return global_frame_index;\n}\n\nexport let this_frame_time = 0;\nexport function getFrameDt() {\n  return this_frame_time;\n}\n\nexport let hrtime = 0;\n\n// Wall time, may contain large jumps, may be 0 or negative\nlet this_frame_time_actual = 0;\nexport function getFrameDtActual() {\n  return this_frame_time_actual;\n}\n\nlet after_loading_state = null;\nexport let is_loading = true;\nexport function setState(new_state) {\n  if (is_loading) {\n    after_loading_state = new_state;\n  } else {\n    app_state = new_state;\n  }\n}\n\nexport function stateActive(test_state) {\n  if (is_loading) {\n    return after_loading_state === test_state;\n  } else {\n    return app_state === test_state;\n  }\n}\n\nlet mspf = 1000;\nlet mspf_update_time = 0;\nlet mspf_frame_count = 0;\nlet last_tick_cpu = 0;\nlet mspf_tick = 1000;\n// let net_time = 1000;\nlet mspf_tick_accum = 0;\n// let net_time_accum = 0;\nexport const PERF_HISTORY_SIZE = 128;\nexport let perf_state = window.glov_perf_state = {\n  fpsgraph: {\n    index: 0,\n    history: new Float32Array(PERF_HISTORY_SIZE * 2)\n  },\n  gpu_mem: {\n    tex: 0,\n    geom: 0\n  }\n};\nlet fpsgraph = perf_state.fpsgraph;\n\nperf.addMetric({\n  name: 'fps',\n  show_stat: 'show_fps', // always, if we're showing any metrics\n  show_graph: 'fps_graph',\n  labels: {\n    'fps: ': () => (1000 / mspf).toFixed(1),\n    'ms/f: ': () => mspf.toFixed(0),\n    'cpu: ': () => mspf_tick.toFixed(0)\n    // 'net: ': () => net_time.toFixed(0),\n  },\n  data: fpsgraph, // contain .index and .history (stride of colors.length)\n  line_scale_top: 50,\n  colors: [\n  // vec4(0.161, 0.678, 1, 1), // net time\n  vec4(1, 0.925, 0.153, 1), // cpu/tick time\n  vec4(0, 0.894, 0.212, 1)],\n  interactable: DEBUG\n});\n\nlet do_borders = true;\nlet do_viewport_postprocess = false;\nlet need_repos = 0;\n\nexport function resizing() {\n  return need_repos;\n}\n\nlet app_tick_functions = [];\nexport function addTickFunc(cb) {\n  app_tick_functions.push(cb);\n}\n\nlet post_tick = [];\nexport function postTick(opts) {\n  opts.ticks = opts.ticks || 1; // run in how many ticks?\n  opts.inactive = opts.inactive || false; // run even if inactive?\n  assert.equal(typeof opts.fn, 'function');\n  post_tick.push(opts);\n}\n\nlet temporary_textures = {};\n\nfunction resetEffects() {\n  for (let key in temporary_textures) {\n    let temp = temporary_textures[key];\n    // Release unused textures\n    while (temp.list.length > temp.idx) {\n      temp.list.pop().destroy();\n    }\n    if (!temp.idx) {\n      delete temporary_textures[key];\n    } else {\n      temp.idx = 0;\n    }\n  }\n}\n\nconst SAFARI_FULLSCREEN_ASPECT = function () {\n  let screen = window.screen;\n  if (!is_ios_safari || !screen) {\n    return 0;\n  }\n  const SAFARI_DIMS = { // wxh : [fullscreen aspect]\n    // iPhone XR\n    // iPhone 11 Pro Max\n    // iPhone XS Max\n    // iPhone 11\n    '896,414': 896 / 414,\n    // iPhone 11 Pro\n    // iPhone X (probably)\n    '812,375': 812 / 375,\n    // iPhone 8 Plus\n    '736,414': 736 / 414,\n    // iPhone 6s+\n    // iPhone 6+\n    '716,414': 736 / 414, // (screen.availWidth reports 20 less)\n    // iPhone 8\n    // iPhone 7 (10.1)\n    // iPhone 7 (11.4)\n    '667,375': 667 / 375,\n    // iPhone 6s\n    // iPhone 6\n    '647,375': 667 / 375, // (screen.availWidth reports 20 less)\n    // iPhone 5s\n    '548,320': 568 / 320 // (screen.availWidth reports 20 less)\n  };\n  let key = `${max(screen.availWidth, screen.availHeight)},${min(screen.availWidth, screen.availHeight)}`;\n  return SAFARI_DIMS[key] || 0;\n}();\nfunction safariTopSafeArea(view_w, view_h) {\n  // Detect if the URL bar is hidden, but should be a safe area\n  if (SAFARI_FULLSCREEN_ASPECT && nearSame(view_w / view_h, SAFARI_FULLSCREEN_ASPECT, 0.001)) {\n    // Note: if user has scaling enabled, the padding required might be different\n    //   but the same holds true for the safe area padding detected via CSS!\n    return 50 * (window.devicePixelRatio || 1); // seems to be 50pts on all devices\n  }\n  return 0;\n}\n\nlet last_canvas_width;\nlet last_canvas_height;\nlet last_body_height;\nlet safearea_elem;\nlet safearea_ignore_bottom = false;\nlet safearea_values = [0, 0, 0, 0];\nlet last_safearea_values = [0, 0, 0, 0];\nfunction checkResize() {\n  // use VisualViewport on at least iOS Safari - deal with tabs and keyboard\n  //   shrinking the viewport without changing the window height\n  let vv = window.visualViewport || {};\n  let css_to_real = window.devicePixelRatio || 1;\n  let view_w = vv.width || window.innerWidth;\n  let view_h = vv.height || window.innerHeight;\n  if (view_h !== last_body_height) {\n    // set this *before* getting canvas and safearea_elem dims below\n    last_body_height = view_h;\n    document.body.style.height = `${view_h}px`;\n  }\n  let new_width = round(canvas.clientWidth * css_to_real) || 1;\n  let new_height = round(canvas.clientHeight * css_to_real) || 1;\n\n  if (cmds.safearea[0] === -1) {\n    if (safearea_elem) {\n      let sa_width = safearea_elem.offsetWidth;\n      let sa_height = safearea_elem.offsetHeight;\n      if (sa_width && sa_height) {\n        v4set(safearea_values, safearea_elem.offsetLeft * css_to_real, new_width - (sa_width + safearea_elem.offsetLeft) * css_to_real, max(safearea_elem.offsetTop * css_to_real, safariTopSafeArea(view_w, view_h)),\n        // Note: Possibly ignoring bottom safe area, it seems not useful on iPhones (does not\n        //  adjust when keyboard is up, only obscured in the middle, if obeying left/right safe area)\n        safearea_ignore_bottom ? 0 : new_height - (sa_height + safearea_elem.offsetTop) * css_to_real);\n      }\n    }\n  } else {\n    v4set(safearea_values, new_width * clamp(cmds.safearea[0], 0, 25) / 100, new_width * clamp(cmds.safearea[1], 0, 25) / 100, new_height * clamp(cmds.safearea[2], 0, 25) / 100, new_height * clamp(cmds.safearea[3], 0, 25) / 100);\n  }\n  if (!v4same(safearea_values, last_safearea_values)) {\n    v4copy(last_safearea_values, safearea_values);\n    camera2d.setSafeAreaPadding(safearea_values[0], safearea_values[1], safearea_values[2], safearea_values[3]);\n    need_repos = max(need_repos, 1);\n  }\n\n  if (new_width !== last_canvas_width || new_height !== last_canvas_height) {\n    window.pixel_scale = css_to_real; // for debug\n    last_canvas_width = canvas.width = new_width || 1;\n    last_canvas_height = canvas.height = new_height || 1;\n    // For the next 10 frames, make sure font size is correct\n    need_repos = 10;\n  }\n  if (is_ios_safari && (window.visualViewport || need_repos)) {\n    // we have accurate view information, or screen was just rotated / resized\n    // force scroll to top\n    window.scroll(0, 0);\n  }\n}\n\nexport let viewport = vec4(0, 0, 1, 1);\nexport function setViewport(xywh) {\n  v4copy(viewport, xywh);\n  gl.viewport(xywh[0], xywh[1], xywh[2], xywh[3]);\n}\n\nlet last_temp_idx = 0;\nexport function getTemporaryTexture(w, h) {\n  let key = w ? `${w}_${h}` : 'screen';\n  let temp = temporary_textures[key];\n  if (!temp) {\n    temp = temporary_textures[key] = { list: [], idx: 0 };\n  }\n  if (temp.idx >= temp.list.length) {\n    let tex = textures.createForCapture(`temp_${key}_${++last_temp_idx}`);\n    temp.list.push(tex);\n  }\n  let tex = temp.list[temp.idx++];\n  return tex;\n}\n\nexport function captureFramebuffer(tex, w, h, do_filter_linear, do_wrap) {\n  if (!w && render_width) {\n    w = render_width;\n    h = render_height;\n  }\n  if (!tex) {\n    tex = getTemporaryTexture(w, h);\n  }\n  if (w) {\n    tex.copyTexImage(viewport[0], viewport[1], w, h);\n  } else {\n    tex.copyTexImage(0, 0, width, height);\n  }\n  tex.setSamplerState({\n    filter_min: do_filter_linear ? gl.LINEAR : gl.NEAREST,\n    filter_mag: do_filter_linear ? gl.LINEAR : gl.NEAREST,\n    wrap_s: do_wrap ? gl.REPEAT : gl.CLAMP_TO_EDGE,\n    wrap_t: do_wrap ? gl.REPEAT : gl.CLAMP_TO_EDGE\n  });\n  return tex;\n}\n\nlet frame_requested = false;\nfunction requestFrame() {\n  if (frame_requested) {\n    return;\n  }\n  frame_requested = true;\n  let max_fps = settings.max_fps;\n  if (defines.SLOWLOAD && is_loading) {\n    // Safari on CrossBrowserTesting needs this in order to have some time to load/decode audio data\n    // TODO: Instead, generally, if loading, compare last_tick_cpu vs dt, and if\n    //   we're not idle for at least half of the time and we have *internal*\n    //   loads (textures, sounds, models, NOT user code), delay so that we are.\n    max_fps = 2;\n  }\n  if (max_fps) {\n    // eslint-disable-next-line no-use-before-define\n    setTimeout(tick, round(1000 / max_fps));\n  } else {\n    // eslint-disable-next-line no-use-before-define\n    requestAnimationFrame(tick);\n  }\n}\n\nlet mat_projection_10;\nexport let had_3d_this_frame;\n\nexport function setupProjection(use_fov_y, use_width, use_height, znear, zfar) {\n  mat4Perspective(mat_projection, use_fov_y, use_width / use_height, znear, zfar);\n  mat_projection_10 = mat_projection[10];\n  v4set(projection_inverse, 2 / (use_width * mat_projection[0]), // projection_matrix.m00),\n  2 / (use_height * mat_projection[5]), // projection_matrix.m11),\n  -(1 + mat_projection[8]) / mat_projection[0], // projection_matrix.m20) / projection_matrix.m00,\n  -(1 + mat_projection[9]) / mat_projection[5] // projection_matrix.m21) / projection_matrix.m11\n  );\n}\n\nexport function start3DRendering() {\n  had_3d_this_frame = true;\n  gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n  gl.enable(gl.BLEND);\n  gl.enable(gl.DEPTH_TEST);\n  gl.depthMask(true);\n\n  setupProjection(fov_y, width, height, ZNEAR, ZFAR);\n\n  gl.viewport(viewport[0], viewport[1], viewport[2], viewport[3]);\n  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT); // eslint-disable-line no-bitwise\n  gl.enable(gl.CULL_FACE);\n}\n\nexport function projectionZBias(dist, at_z) {\n  if (!dist) {\n    mat_projection[10] = mat_projection_10;\n    return;\n  }\n  //let e = 2 * ZFAR * ZNEAR / (ZFAR - ZNEAR) * (dist / (at_z * (at_z + dist)));\n  let e = 0.2 * (dist / (at_z * (at_z + dist)));\n  e = max(e, 2e-7);\n  mat_projection[10] = mat_projection_10 + e;\n}\n\nfunction fixNatives(is_startup) {\n  // If any browser extensions have added things to the Array prototype, remove them!\n  let b = [];\n  for (let a in b) {\n    console[is_startup ? 'log' : 'error'](`Found invasive enumerable property \"${a}\" on Array.prototype, removing...`);\n    let old_val = b[a];\n    delete Array.prototype[a];\n    // If this fails to work, perhaps try using Object.preventExtensions(Array.prototype) in an inline header script?\n    // eslint-disable-next-line no-extend-native\n    Object.defineProperty(Array.prototype, a, { value: old_val, enumerable: false });\n  }\n  for (let a in b) {\n    // Failed: code that iterates arrays will fail\n    assert(false, `Array.prototype has unremovable member ${a}`);\n  }\n}\n\nexport const hrnow = window.performance ? window.performance.now.bind(window.performance) : Date.now.bind(Date);\n\nlet last_tick = 0;\nfunction tick(timestamp) {\n  frame_requested = false;\n  // if (timestamp < 1e12) { // high resolution timer\n  //   this ends up being a value way back in time, relative to what hrnow() returns,\n  //   and even back in time relative to input events already dispatched,\n  //   causing timing confusion, so ignore it, just call hrnow()\n  //   hrtime = timestamp;\n  // } else { // probably integer milliseconds since epoch, or nothing\n  hrtime = hrnow();\n  // }\n  let now = round(hrtime); // Code assumes integer milliseconds\n  if (!last_tick) {\n    last_tick = now;\n  }\n  this_frame_time_actual = now - last_tick;\n  let dt = min(max(this_frame_time_actual, 1), 250);\n  this_frame_time = dt;\n  last_tick = now;\n  global_timer += dt;\n  ++global_frame_index;\n\n  fixNatives(false);\n\n  // let this_net_time = wsclient.getNetTime();\n  // fpsgraph.history[(fpsgraph.index % PERF_HISTORY_SIZE) * 3 + 0] = this_net_time;\n  fpsgraph.history[fpsgraph.index % PERF_HISTORY_SIZE * 2 + 1] = this_frame_time_actual;\n  fpsgraph.index++;\n  fpsgraph.history[fpsgraph.index % PERF_HISTORY_SIZE * 2 + 0] = 0;\n\n  ++mspf_frame_count;\n  mspf_tick_accum += last_tick_cpu;\n  // net_time_accum += this_net_time;\n  if (now - mspf_update_time > 1000) {\n    if (!mspf_update_time) {\n      mspf_update_time = now;\n    } else {\n      mspf = (now - mspf_update_time) / mspf_frame_count;\n      mspf_tick = mspf_tick_accum / mspf_frame_count;\n      mspf_tick_accum = 0;\n      // net_time = net_time_accum / mspf_frame_count;\n      // net_time_accum = 0;\n      mspf_frame_count = 0;\n      mspf_update_time = now;\n    }\n  }\n\n  if (document.hidden || document.webkitHidden) {\n    resetEffects();\n    last_tick_cpu = 0;\n    for (let ii = post_tick.length - 1; ii >= 0; --ii) {\n      if (post_tick[ii].inactive && ! --post_tick[ii].ticks) {\n        post_tick[ii].fn();\n        ridx(post_tick, ii);\n      }\n    }\n    requestFrame();\n    return;\n  }\n\n  had_3d_this_frame = false;\n  checkResize();\n  width = canvas.width;\n  height = canvas.height;\n\n  if (any_3d) {\n    // setting the fov values for the frame even if we don't do 3D this frame, because something\n    // might need it before start3DRendering() (e.g. mouse click inverse projection)\n    if (width > height) {\n      fov_y = fov_min;\n      let rise = width / height * sin(fov_y / 2) / cos(fov_y / 2);\n      fov_x = 2 * asin(rise / sqrt(rise * rise + 1));\n    } else {\n      fov_x = fov_min;\n      let rise = height / width * sin(fov_x / 2) / cos(fov_x / 2);\n      fov_y = 2 * asin(rise / sqrt(rise * rise + 1));\n    }\n  }\n  textures.bind(0, textures.textures.error);\n\n  camera2d.tickCamera2D();\n  camera2d.setAspectFixed(game_width, game_height);\n\n  soundTick(dt);\n  input.tickInput();\n  glov_ui.tickUI(dt);\n\n  if (need_repos) {\n    --need_repos;\n    let ul = [];\n    camera2d.virtualToDom(ul, [0, 0]);\n    let lr = [];\n    camera2d.virtualToDom(lr, [game_width - 1, game_height - 1]);\n    let viewport2 = [ul[0], ul[1], lr[0], lr[1]];\n    let view_height = viewport2[3] - viewport2[1];\n    // default font size of 16 when at height of game_height\n    let font_size = min(256, max(2, floor(view_height / 800 * 16)));\n    let elem_fullscreen = document.getElementById('fullscreen');\n    if (elem_fullscreen) {\n      elem_fullscreen.style['font-size'] = `${font_size}px`;\n    }\n  }\n\n  if (do_borders) {\n    // Borders\n    glov_ui.drawRect(camera2d.x0Real(), camera2d.y0Real(), camera2d.x1Real(), 0, Z.BORDERS, border_color);\n    glov_ui.drawRect(camera2d.x0Real(), game_height, camera2d.x1Real(), camera2d.y1Real(), Z.BORDERS, border_color);\n    glov_ui.drawRect(camera2d.x0Real(), 0, 0, game_height, Z.BORDERS, border_color);\n    glov_ui.drawRect(game_width, 0, camera2d.x1Real(), game_height, Z.BORDERS, border_color);\n  }\n\n  if (settings.show_metrics) {\n    perf.draw();\n  }\n\n  for (let ii = 0; ii < app_tick_functions.length; ++ii) {\n    app_tick_functions[ii](dt);\n  }\n  if (app_state) {\n    app_state(dt);\n  }\n\n  glov_particles.tick(dt); // *after* app_tick, so newly added/killed particles can be queued into the draw list\n  glov_transition.render(dt);\n\n  if (had_3d_this_frame) {\n    gl.disable(gl.CULL_FACE);\n  } else {\n    // delayed clear (and general GL init) until after app_state, app might change clear color\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n    gl.enable(gl.BLEND);\n    gl.disable(gl.DEPTH_TEST);\n    gl.depthMask(false);\n    gl.viewport(viewport[0], viewport[1], viewport[2], viewport[3]);\n    // TODO: for do_viewport_post_process, we need to enable gl.scissor to avoid clearing the whole screen!\n    // gl.scissor(0, 0, viewport[2] - viewport[0], viewport[3] - viewport[1]);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n  }\n\n  sprites.draw();\n\n  glov_ui.endFrame();\n\n  if (render_width) {\n    let source = captureFramebuffer();\n    let clear_color = [0, 0, 0, 1];\n    let final_viewport = [camera2d.render_offset_x, camera2d.render_offset_y_bottom, camera2d.render_viewport_w, camera2d.render_viewport_h];\n    if (do_viewport_postprocess) {\n      effects.applyPixelyExpand({ source, final_viewport, clear_color });\n    } else {\n      if (clear_color) {\n        gl.clearColor(clear_color[0], clear_color[1], clear_color[2], clear_color[3]);\n        gl.clear(gl.COLOR_BUFFER_BIT);\n      }\n      setViewport(final_viewport);\n      // gl.scissor(0, 0, width, height);\n      effects.applyCopy({ source });\n    }\n  }\n\n  input.endFrame();\n  resetEffects();\n  texturesTick();\n\n  for (let ii = post_tick.length - 1; ii >= 0; --ii) {\n    if (! --post_tick[ii].ticks) {\n      post_tick[ii].fn();\n      ridx(post_tick, ii);\n    }\n  }\n\n  last_tick_cpu = hrnow() - now;\n  fpsgraph.history[fpsgraph.index % PERF_HISTORY_SIZE * 2 + 0] = last_tick_cpu;\n  requestFrame();\n}\n\nlet error_report_details = {};\nlet error_report_details_str = '';\nexport function setErrorReportDetails(key, value) {\n  if (value) {\n    error_report_details[key] = escape(String(value));\n  } else {\n    delete error_report_details[key];\n  }\n  error_report_details_str = `&${Object.keys(error_report_details).map(k => `${k}=${error_report_details[k]}`).join('&')}`;\n}\nsetErrorReportDetails('ver', BUILD_TIMESTAMP);\nlet last_error_time = 0;\nlet crash_idx = 0;\n// Errors from plugins that we don't want to get reported to us, or show the user!\nlet filtered_errors = /avast_submit|vc_request_action/;\nfunction glovErrorReport(msg, file, line, col) {\n  ++crash_idx;\n  let now = Date.now();\n  setTimeout(requestFrame, 1);\n  let dt = now - last_error_time;\n  last_error_time = now;\n  if (dt < 30 * 1000) {\n    // Less than 30 seconds since the last error, either we're erroring every\n    // frame, or this is a secondary error caused by the first, do not report it.\n    // Could maybe hash the error message and just report each message once, and\n    // flag errors as primary or secondary.\n    return false;\n  }\n  if (msg.match(filtered_errors)) {\n    return false;\n  }\n  // Post to an error reporting endpoint that (probably) doesn't exist - it'll get in the logs anyway!\n  let url = urlhash.getURLBase(); // base like http://foo.com/bar/index.html or http://foo.com/bar/\n  let idx = url.lastIndexOf('/'); // Remove anything after the last slash\n  if (idx !== -1 && idx > 8) {\n    // > 'https://'.length\n    url = url.slice(0, idx + 1);\n  }\n  url += `errorReport?cidx=${crash_idx}&file=${escape(file)}&line=${line}&col=${col}&url=${escape(location.href)}` + `&msg=${escape(msg)}${error_report_details_str}`;\n  let xhr = new XMLHttpRequest();\n  xhr.open('POST', url, true);\n  xhr.send(null);\n  return true;\n}\n\nfunction periodiclyRequestFrame() {\n  requestFrame();\n  setTimeout(periodiclyRequestFrame, 5000);\n}\n\nexport function startup(params) {\n  fixNatives(true);\n\n  canvas = document.getElementById('canvas');\n  safearea_elem = document.getElementById('safearea');\n\n  if (params.error_report !== false) {\n    window.glov_error_report = glovErrorReport;\n  }\n\n  safearea_ignore_bottom = params.safearea_ignore_bottom || false;\n\n  // resize the canvas to fill browser window dynamically\n  window.addEventListener('resize', checkResize, false);\n  checkResize();\n\n  let is_pixely = params.pixely && params.pixely !== 'off';\n  antialias = params.antialias || !is_pixely && params.antialias !== false;\n  let powerPreference = params.high ? 'high-performance' : 'default';\n  let context_names = ['webgl2', 'webgl', 'experimental-webgl'];\n  let force_webgl1 = defines.NOWEBGL2;\n  let disable_data = local_storage.getJSON('webgl2_disable');\n  // Check if a previous, recent run had an error that hinted we should disable WebGL2\n  if (disable_data && disable_data.ua === navigator.userAgent && disable_data.ts > Date.now() - 7 * 24 * 60 * 60 * 1000) {\n    console.log('Disabling WebGL2 because a previous run encountered a related error');\n    force_webgl1 = true;\n  }\n  if (DEBUG && !defines.FORCEWEBGL2) {\n    let rc = local_storage.getJSON('run_count', 0) + 1;\n    local_storage.setJSON('run_count', rc);\n    if (rc % 2) {\n      force_webgl1 = true;\n    }\n  }\n  if (force_webgl1) {\n    context_names.splice(0, 1);\n  }\n  let context_opts = [{ antialias, powerPreference }, { powerPreference }, {}];\n  let good = false;\n  webgl2 = false;\n  for (let i = 0; !good && i < context_names.length; i += 1) {\n    for (let jj = 0; !good && jj < context_opts.length; ++jj) {\n      try {\n        window.gl = canvas.getContext(context_names[i], context_opts[jj]);\n        if (window.gl) {\n          if (context_names[i] === 'webgl2') {\n            webgl2 = true;\n          }\n          good = true;\n          break;\n        }\n      } catch (e) {\n        // ignore\n      }\n    }\n  }\n  if (!good) {\n    // eslint-disable-next-line no-alert\n    window.alert('Sorry, but your browser does not support WebGL or does not have it enabled.');\n    document.getElementById('loading').style.visibility = 'hidden';\n    document.getElementById('nowebgl').style.visibility = 'visible';\n    return false;\n  }\n  console.log(`Using WebGL${webgl2 ? 2 : 1}`);\n\n  assert(gl);\n  canvas.focus();\n  width = canvas.width;\n  height = canvas.height;\n  game_width = params.game_width || 1280;\n  game_height = params.game_height || 960;\n  any_3d = params.any_3d || false;\n  ZNEAR = params.znear || 0.7;\n  ZFAR = params.zfar || 10000;\n  if (params.pixely === 'strict') {\n    render_width = game_width;\n    render_height = game_height;\n    if (params.viewport_postprocess) {\n      do_viewport_postprocess = true;\n    }\n  } else {\n    render_width = undefined;\n    render_height = undefined;\n  }\n  pixel_aspect = params.pixel_aspect || 1;\n\n  gl.depthFunc(gl.LEQUAL);\n  // gl.enable(gl.SCISSOR_TEST);\n  if (!any_3d) {\n    gl.disable(gl.CULL_FACE);\n  }\n  gl.cullFace(gl.BACK);\n  gl.clearColor(0, 0.1, 0.2, 1);\n  gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1); // Allow RGB texture data with non-mult-4 widths\n\n  textures.startup();\n  geom.startup();\n  shaders.startup({\n    light_diffuse,\n    light_dir_vs,\n    ambient: light_ambient,\n    mat_m: mat_m,\n    mat_mv: mat_mv,\n    mat_vp: mat_vp,\n    mvp: mat_mvp,\n    mv_inv_trans: mat_mv_inv_transform,\n    mat_inv_view: mat_inv_view,\n    view: mat_view,\n    projection: mat_projection,\n    projection_inverse\n  });\n  camera2d.startup();\n  sprites.startup();\n  input.startup(canvas, params);\n  if (any_3d) {\n    models.startup();\n  }\n\n  /* eslint-disable global-require */\n  glov_particles = require('./particles.js').create();\n\n  if (is_pixely) {\n    textures.defaultFilters(gl.NEAREST, gl.NEAREST);\n  } else {\n    textures.defaultFilters(gl.LINEAR_MIPMAP_LINEAR, gl.LINEAR);\n  }\n\n  const font_info_04b03x2 = require('../img/font/04b03_8x2.json');\n  const font_info_04b03x1 = require('../img/font/04b03_8x1.json');\n  if (params.font) {\n    font = glov_font.create(params.font.info, params.font.texture);\n  } else if (params.pixely === 'strict') {\n    font = glov_font.create(font_info_04b03x1, 'font/04b03_8x1');\n  } else if (is_pixely) {\n    font = glov_font.create(font_info_04b03x2, 'font/04b03_8x2');\n  } else {\n    font = glov_font.create(font_info_palanquin32, 'font/palanquin32');\n  }\n  params.font = font;\n  glov_ui.startup(params);\n\n  soundStartup(params.sound);\n  glov_ui.bindSounds(defaults(params.ui_sounds || {}, {\n    button_click: 'button_click',\n    rollover: 'rollover'\n  }));\n\n  camera2d.setAspectFixed(game_width, game_height);\n\n  if (params.state) {\n    setState(params.state);\n  }\n  if (params.do_borders !== undefined) {\n    do_borders = params.do_borders;\n  }\n  if (params.show_fps !== undefined) {\n    settings.show_fps = params.show_fps;\n  }\n\n  periodiclyRequestFrame();\n  return true;\n}\n\nexport function loadsPending() {\n  return textures.load_count + soundLoading() + models.load_count;\n}\n\nfunction loading() {\n  let load_count = loadsPending();\n  let elem_loading_text = document.getElementById('loading_text');\n  if (elem_loading_text) {\n    elem_loading_text.innerText = `Loading (${load_count})...`;\n  }\n  if (!load_count) {\n    is_loading = false;\n    app_state = after_loading_state;\n    // Clear after next frame, so something is rendered to the canvas\n    postTick({\n      ticks: 2,\n      fn: function () {\n        let loading_elem = document.getElementById('loading');\n        if (loading_elem) {\n          loading_elem.style.visibility = 'hidden';\n        }\n      }\n    });\n  }\n}\napp_state = loading;\n\nwindow.glov_engine = exports;","const assert = require('assert');\n\nlet by_ext = {};\nlet by_match = [];\n\n// cb(filename)\nexport function filewatchOn(ext_or_search, cb) {\n  if (ext_or_search[0] === '.') {\n    assert(!by_ext[ext_or_search]);\n    by_ext[ext_or_search] = cb;\n  } else {\n    by_match.push([ext_or_search, cb]);\n  }\n}\n\nlet message_cb;\n// cb(message)\nexport function filewatchMessageHandler(cb) {\n  message_cb = cb;\n}\n\nfunction onFileChange(filename) {\n  console.log(`FileWatch change: ${filename}`);\n  let ext_idx = filename.lastIndexOf('.');\n  let did_reload = false;\n  if (ext_idx !== -1) {\n    let ext = filename.slice(ext_idx);\n    if (by_ext[ext]) {\n      by_ext[ext](filename);\n      did_reload = true;\n    }\n  }\n  for (let ii = 0; ii < by_match.length; ++ii) {\n    if (filename.match(by_match[ii][0])) {\n      by_match[ii][1](filename);\n      did_reload = true;\n    }\n  }\n  if (message_cb && did_reload) {\n    message_cb(`Reloading: ${filename}`);\n  }\n}\n\nexport function filewatchTriggerChange(filename) {\n  onFileChange(filename);\n}\n\nexport function filewatchStartup(client) {\n  client.onMsg('filewatch', onFileChange);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint no-bitwise:off, complexity:off, no-shadow:off */\n\nconst assert = require('assert');\nconst camera2d = require('./camera2d.js');\nconst { floor, max, round } = Math;\nconst shaders = require('./shaders.js');\nconst sprites = require('./sprites.js');\nconst textures = require('./textures.js');\nconst { clamp } = require('../../common/util.js');\nconst { vec4, v4clone, v4scale } = require('./vmath.js');\n\n/*\n\nfont_style = glov_font.style(null, {\n  color: 0xFFFFFFff,\n  outline_width: 0,\n  outline_color: 0x00000000,\n  glow_xoffs: 0,\n  glow_yoffs: 0,\n  glow_inner: 0,\n  glow_outer: 0,\n  glow_color: 0x000000ff,\n});\n\n */\n\n// typedef struct FontCharInfo {\n//   int c;\n//   float x0;\n//   float y0;\n//   int w;\n//   int h;\n//   int imgIdx;\n// } FontCharInfo;\n\n// typedef struct FontInfo {\n//   AS_NAME(CharInfo) FontCharInfo **char_infos;\n//   int font_size;\n//   float x0;\n//   float y0;\n//   int imageW;\n//   int imageH;\n//   int spread;\n// } FontInfo;\n\nexport const COLOR_MODE = {\n  SINGLE: 0,\n  GRADIENT: 1\n};\n\nexport const ALIGN = {\n  HLEFT: 0,\n  HCENTER: 1,\n  HRIGHT: 2,\n  HMASK: 3,\n\n  VTOP: 0 << 2,\n  VCENTER: 1 << 2,\n  VBOTTOM: 2 << 2,\n  VMASK: 3 << 2,\n\n  HFIT: 1 << 4,\n  HWRAP: 1 << 5, // only for glovMarkup*, not drawSizedAligned below, use drawSizedWrapped below instead\n\n  HCENTERFIT: 1 | 1 << 4,\n  HVCENTER: 1 | 1 << 2, // to avoid doing bitwise ops elsewhere\n  HVCENTERFIT: 1 | 1 << 2 | 1 << 4 // to avoid doing bitwise ops elsewhere\n};\n\n// typedef struct GlovFontStyle\n// {\n//   // These members will never be changed (safe to initialize with GlovFontStyle foo = {1.0, 0xfff, etc};\n//   float outline_width;\n//   U32 outline_color;\n//   // Glow: can be used for a dropshadow as well\n//   //   inner can be negative to have the glow be less opaque (can also just change the alpha of the glow color)\n//   //   a glow would be e.g. (0, 0, -1, 5)\n//   //   a dropshadow would be e.g. (3.25, 3.25, -2.5, 5)\n//   float glow_xoffs;\n//   float glow_yoffs;\n//   float glow_inner;\n//   float glow_outer;\n//   U32 glow_color;\n//   U32 color; // upper left, or single color\n//   U32 colorUR; // upper right\n//   U32 colorLR; // lower right\n//   U32 colorLL; // lower left\n//   GlovFontColorMode color_mode;\n// } GlovFontStyle;\n\n/* Default GlovFontStyle:\n  font_style = {\n    outline_width: 0, outline_color: 0x00000000,\n    glow_xoffs: 0, glow_yoffs: 0, glow_inner: 0, glow_outer: 0, glow_color: 0x00000000,\n    color: 0xFFFFFFff\n  };\n\n  font_style = {\n    outline_width: 0, outline_color: 0x00000000,\n    glow_xoffs: 0, glow_yoffs: 0, glow_inner: 0, glow_outer: 0, glow_color: 0x00000000,\n    // Color gradient: UL, UR, LR, LL\n    color: 0xFFFFFFff, colorUR: 0xFFFFFFff, colorLR: 0x000000ff, colorLL: 0x000000ff,\n    color_mode: glov_font.COLOR_MODE.GRADIENT,\n  };\n*/\n\nfunction GlovFontStyle() {\n  this.color_vec4 = vec4(1, 1, 1, 1); // Matches GlovFontStyle.prototype.color below\n}\nGlovFontStyle.prototype.outline_width = 0;\nGlovFontStyle.prototype.outline_color = 0x00000000;\nGlovFontStyle.prototype.glow_xoffs = 0;\nGlovFontStyle.prototype.glow_yoffs = 0;\nGlovFontStyle.prototype.glow_inner = 0;\nGlovFontStyle.prototype.glow_outer = 0;\nGlovFontStyle.prototype.glow_color = 0x00000000;\nGlovFontStyle.prototype.color = 0xFFFFFFff;\nGlovFontStyle.prototype.colorUR = 0;\nGlovFontStyle.prototype.colorLR = 0;\nGlovFontStyle.prototype.colorLL = 0;\nGlovFontStyle.prototype.color_mode = COLOR_MODE.SINGLE;\n\nexport const font_shaders = {};\n\nexport function intColorFromVec4Color(v) {\n  return (v[0] * 255 | 0) << 24 | (v[1] * 255 | 0) << 16 | (v[2] * 255 | 0) << 8 | (v[3] * 255 | 0);\n}\n\nexport function vec4ColorFromIntColor(v, c) {\n  v[0] = (c >> 24 & 0xFF) / 255;\n  v[1] = (c >> 16 & 0xFF) / 255;\n  v[2] = (c >> 8 & 0xFF) / 255;\n  v[3] = (c & 0xFF) / 255;\n}\n\nexport const glov_font_default_style = new GlovFontStyle();\n\nexport function style(font_style, fields) {\n  let ret = new GlovFontStyle();\n  let { color_vec4 } = ret;\n  if (font_style) {\n    for (let f in font_style) {\n      ret[f] = font_style[f];\n    }\n  }\n  for (let f in fields) {\n    ret[f] = fields[f];\n  }\n  ret.color_vec4 = color_vec4; // Restore\n  vec4ColorFromIntColor(ret.color_vec4, ret.color);\n  return ret;\n}\n\nexport function styleColored(font_style, color) {\n  return style(font_style, {\n    color\n  });\n}\n\nfunction colorAlpha(color, alpha) {\n  alpha = clamp(round((color & 0xFF) * alpha), 0, 255);\n  return color & 0xFFFFFF00 | alpha;\n}\n\nexport function styleAlpha(font_style, alpha) {\n  return style(font_style, {\n    color: colorAlpha((font_style || glov_font_default_style).color, alpha),\n    outline_color: colorAlpha((font_style || glov_font_default_style).outline_color, alpha),\n    glow_color: colorAlpha((font_style || glov_font_default_style).glow_color, alpha)\n  });\n}\n\nlet tech_params = null;\nlet tech_params_dirty = false;\nlet temp_color = null;\n\nfunction createTechniqueParameters() {\n  if (tech_params) {\n    return;\n  }\n\n  tech_params = {\n    param0: vec4(),\n    outlineColor: vec4(),\n    glowColor: vec4(),\n    glowParams: vec4(),\n    tex0: null\n  };\n  if (!temp_color) {\n    temp_color = vec4();\n  }\n}\n\nfunction techParamsSet(param, value) {\n  let tpv = tech_params[param];\n  // not dirty, if anything changes, we need a new object!\n  if (!tech_params_dirty) {\n    if (tpv[0] !== value[0] || tpv[1] !== value[1] || tpv[2] !== value[2] || tpv[3] !== value[3]) {\n      // clone\n      tech_params = {\n        param0: v4clone(tech_params.param0),\n        outlineColor: v4clone(tech_params.outlineColor),\n        glowColor: v4clone(tech_params.glowColor),\n        glowParams: v4clone(tech_params.glowParams)\n      };\n      tech_params_dirty = true;\n      tpv = tech_params[param];\n    } else {\n      // identical, do nothing\n      return;\n    }\n  }\n  if (tech_params_dirty) {\n    // just set\n    tpv[0] = value[0];\n    tpv[1] = value[1];\n    tpv[2] = value[2];\n    tpv[3] = value[3];\n    // return;\n  }\n}\n\nfunction techParamsGet() {\n  tech_params_dirty = false;\n  return tech_params;\n}\n\nfunction GlovFont(font_info, texture_name) {\n  assert(font_info.font_size !== 0); // Got lost somewhere\n\n  this.texture = textures.load({\n    url: `img/${texture_name}.png`,\n    filter_min: font_info.noFilter ? gl.NEAREST : gl.LINEAR,\n    filter_mag: font_info.noFilter ? gl.NEAREST : gl.LINEAR,\n    wrap_s: gl.CLAMP_TO_EDGE,\n    wrap_t: gl.CLAMP_TO_EDGE\n  });\n  this.textures = [this.texture];\n\n  this.font_info = font_info;\n  this.shader = font_shaders.font_aa;\n  this.tex_w = font_info.imageW;\n  this.tex_h = font_info.imageH;\n\n  // Calculate inverse scale\n  for (let ii = 0; ii < font_info.char_infos.length; ++ii) {\n    let char_info = font_info.char_infos[ii];\n    char_info.scale = 1 / (char_info.sc || 1);\n  }\n\n  // build lookup\n  this.char_infos = [];\n  for (let ii = 0; ii < font_info.char_infos.length; ++ii) {\n    let char_info = font_info.char_infos[ii];\n    this.char_infos[font_info.char_infos[ii].c] = char_info;\n    char_info.xpad = char_info.xpad || 0;\n    char_info.yoffs = char_info.yoffs || 0;\n  }\n  this.replacement_character = this.infoFromChar(0xFFFD);\n  if (!this.replacement_character) {\n    this.replacement_character = this.infoFromChar(63); // '?'\n  }\n\n  this.default_style = new GlovFontStyle();\n  this.applied_style = new GlovFontStyle();\n\n  createTechniqueParameters();\n}\n\n// General draw functions return width\n// Pass NULL for style to use default style\n// If the function takes a color, this overrides the color on the style\nGlovFont.prototype.drawSizedColor = function (style, x, y, z, size, color, text) {\n  return this.drawSized(styleColored(style, color), x, y, z, size, text);\n};\nGlovFont.prototype.drawSized = function (style, x, y, z, size, text) {\n  return this.drawScaled(style, x, y, z, size / this.font_info.font_size, size / this.font_info.font_size, text);\n};\n\nGlovFont.prototype.drawSizedAligned = function (style, _x, _y, z, size, align, w, h, text) {\n  let x_size = size;\n  let y_size = size;\n  let width = this.getStringWidth(style, x_size, text);\n  if (align & ALIGN.HFIT && width > w) {\n    let scale = w / width;\n    x_size *= scale;\n    width = w;\n    // Additionally, if we're really squishing things horizontally, shrink the font size\n    // and offset to be centered.\n    if (scale < 0.5) {\n      if ((align & ALIGN.VMASK) !== ALIGN.VCENTER && (align & ALIGN.VMASK) !== ALIGN.VBOTTOM) {\n        // Offset to be roughly centered in the original line bounds\n        _y += (y_size - y_size * scale * 2) / 2;\n      }\n      y_size *= scale * 2;\n    }\n  }\n  let height = y_size;\n  let x;\n  let y;\n  switch (align & ALIGN.HMASK) {\n    case ALIGN.HCENTER:\n      x = _x + (w - width) / 2;\n      if (this.font_info.noFilter) {\n        x |= 0; // ensure integral\n      }\n      break;\n    case ALIGN.HRIGHT:\n      x = _x + w - width;\n      break;\n    case ALIGN.HLEFT:\n      x = _x;\n      break;\n    default:\n      x = _x;\n  }\n  switch (align & ALIGN.VMASK) {\n    case ALIGN.VCENTER:\n      y = _y + (h - height) / 2;\n      if (this.font_info.noFilter) {\n        y |= 0; // ensure integral\n      }\n      break;\n    case ALIGN.VBOTTOM:\n      y = _y + h - height;\n      break;\n    case ALIGN.VTOP:\n      y = _y;\n      break;\n    default:\n      y = _y;\n  }\n\n  return this.drawScaled(style, x, y, z, x_size / this.font_info.font_size, y_size / this.font_info.font_size, text);\n};\n\n// returns height\nGlovFont.prototype.drawSizedColorWrapped = function (style, x, y, z, w, indent, size, color, text) {\n  return this.drawScaledWrapped(styleColored(style, color), x, y, z, w, indent, size / this.font_info.font_size, size / this.font_info.font_size, text);\n};\nGlovFont.prototype.drawSizedWrapped = function (style, x, y, z, w, indent, size, text) {\n  return this.drawScaledWrapped(style, x, y, z, w, indent, size / this.font_info.font_size, size / this.font_info.font_size, text);\n};\n\nGlovFont.prototype.wrapLines = function (w, indent, size, text, word_cb /*(x, int linenum, const char *word)*/) {\n  return this.wrapLinesScaled(w, indent, size / this.font_info.font_size, text, word_cb);\n};\n\nGlovFont.prototype.numLines = function (style, w, indent, size, text) {\n  this.applyStyle(style);\n  let numlines = 0;\n  function wordCallback(ignored, linenum, word) {\n    numlines = max(numlines, linenum);\n  }\n  this.wrapLines(w, indent, size, text, wordCallback);\n  return numlines + 1;\n};\n\nGlovFont.prototype.infoFromChar = function (c) {\n  let ret = this.char_infos[c];\n  if (ret) {\n    return ret;\n  }\n  if (c > 127) {\n    // no char info, and non-ascii, non-control code\n    return this.replacement_character;\n  }\n  return null;\n};\n\nGlovFont.prototype.getCharacterWidth = function (style, x_size, c) {\n  assert.equal(typeof c, 'number');\n  this.applyStyle(style);\n  let char_info = this.infoFromChar(c);\n  let xsc = x_size / this.font_info.font_size;\n  let x_advance = this.calcXAdvance(xsc);\n  if (char_info) {\n    return (char_info.w + char_info.xpad) * xsc * char_info.scale + x_advance;\n  }\n  return 0;\n};\n\nGlovFont.prototype.getStringWidth = function (style, x_size, text) {\n  this.applyStyle(style);\n  let ret = 0;\n  let xsc = x_size / this.font_info.font_size;\n  let x_advance = this.calcXAdvance(xsc);\n  for (let ii = 0; ii < text.length; ++ii) {\n    let c = text.charCodeAt(ii);\n    let char_info = this.infoFromChar(c);\n    if (!char_info) {\n      char_info = this.infoFromChar(13);\n    }\n    if (char_info) {\n      ret += (char_info.w + char_info.xpad) * xsc * char_info.scale + x_advance;\n    }\n  }\n  return ret;\n};\n\n// word_cb(x, int linenum, const char *word)\nGlovFont.prototype.wrapLinesScaled = function (w, indent, xsc, text, word_cb) {\n  let len = text.length;\n  let s = 0;\n  let word_start = 0;\n  let word_x0 = 0;\n  let x = word_x0;\n  let linenum = 0;\n  let space_info = this.infoFromChar(32); // ' '\n  let space_size = (space_info ? space_info.w + space_info.xpad : this.font_info.font_size) * xsc;\n  let hard_wrap = false;\n  let x_advance = this.calcXAdvance(xsc);\n\n  do {\n    let c = s < len ? text.charCodeAt(s) : 0;\n    let newx = x;\n    let char_w;\n    if (c === 9) {\n      // '\\t') {\n      let tabsize = xsc * this.font_info.font_size * 4;\n      newx = (floor(x / tabsize) + 1) * tabsize;\n      char_w = tabsize;\n    } else {\n      let char_info = this.infoFromChar(c);\n      if (!char_info) {\n        char_info = this.infoFromChar(10);\n      }\n      if (char_info) {\n        char_w = (char_info.w + char_info.xpad) * xsc * char_info.scale + x_advance;\n        newx = x + char_w;\n      }\n    }\n    if (newx >= w && hard_wrap) {\n      // flush the word so far!\n      if (word_cb) {\n        word_cb(word_x0, linenum, text.slice(word_start, s));\n      }\n      word_start = s;\n      word_x0 = indent;\n      x = word_x0 + char_w;\n      linenum++;\n    } else {\n      x = newx;\n    }\n    if (!(c === 32 /*' '*/ || c === 0 || c === 10 /*'\\n'*/)) {\n      s++;\n      c = s < len ? text.charCodeAt(s) : 0;\n    }\n    if (c === 32 /*' '*/ || c === 0 || c === 10 /*'\\n'*/) {\n        hard_wrap = false;\n        // draw word until s\n        if (x > w) {\n          // maybe wrap\n          let word_width = x - word_x0;\n          if (word_width > w - indent) {\n            // not going to fit, split it up!\n            hard_wrap = true;\n            // recover and restart at word start\n            s = word_start;\n            x = word_x0;\n            continue;\n          } else {\n            word_x0 = indent;\n            x = word_x0 + word_width;\n            linenum++;\n          }\n        }\n        if (word_cb) {\n          word_cb(word_x0, linenum, text.slice(word_start, s));\n        }\n        word_start = s + 1;\n        if (c === 10 /*'\\n'*/) {\n            x = indent;\n            linenum++;\n          } else {\n          x += space_size;\n        }\n        word_x0 = x;\n        if (c === 32 /*' '*/ || c === 10 /*'\\n'*/) {\n            s++; // advance past space\n          }\n      }\n  } while (s < len);\n  ++linenum;\n  return linenum;\n};\n\nGlovFont.prototype.drawScaledWrapped = function (style, x, y, z, w, indent, xsc, ysc, text) {\n  if (text === null || text === undefined) {\n    text = '(null)';\n  }\n  this.applyStyle(style);\n  this.last_width = 0;\n  let num_lines = this.wrapLinesScaled(w, indent, xsc, text, (xoffs, linenum, word) => {\n    let y2 = y + this.font_info.font_size * ysc * linenum;\n    let x2 = x + xoffs;\n    let word_w = this.drawScaled(style, x2, y2, z, xsc, ysc, word);\n    this.last_width = max(this.last_width, xoffs + word_w);\n  });\n  return num_lines * this.font_info.font_size * ysc;\n};\n\nGlovFont.prototype.calcXAdvance = function (xsc) {\n  // Assume called: applyStyle(style);\n\n  // scale all supplied values by this so that if we swap in a font with twice the resolution (and twice the spread)\n  //   things look almost identical, just crisper\n  let font_texel_scale = this.font_info.font_size / 32;\n  // As a compromise, -2 bias here seems to work well\n  let x_advance = xsc * font_texel_scale * max(this.applied_style.outline_width - 2, 0);\n  // As a compromise, there's a -3 bias in there, so it only kicks in under extreme circumstances\n  x_advance = max(x_advance, xsc * font_texel_scale * max(this.applied_style.glow_outer - this.applied_style.glow_xoffs - 3, 0));\n  return x_advance;\n};\n\n//////////////////////////////////////////////////////////////////////////\n// Main implementation\n\nGlovFont.prototype.drawScaled = function (style, _x, y, z, xsc, ysc, text) {\n  let x = _x;\n  assert(isFinite(x));\n  assert(isFinite(y));\n  assert(isFinite(z));\n  let font_info = this.font_info;\n  // Debug: show expect area of glyphs\n  // require('./ui.js').drawRect(_x, y,\n  //   _x + xsc * font_info.font_size * 20, y + ysc * font_info.font_size,\n  //   1000, [1, 0, 1, 0.5]);\n  y += (font_info.y_offset || 0) * ysc;\n  let texs = this.textures;\n  if (text === null || text === undefined) {\n    text = '(null)';\n  }\n  const len = text.length;\n  if (xsc === 0 || ysc === 0) {\n    return 0;\n  }\n\n  this.applyStyle(style);\n\n  const avg_scale_font = (xsc + ysc) * 0.5;\n  const camera_xscale = camera2d.data[4];\n  const camera_yscale = camera2d.data[5];\n  let avg_scale_combined = (xsc * camera_xscale + ysc * camera_yscale) * 0.5;\n  // avg_scale_combined *= glov_settings.render_scale;\n\n  // scale all supplied values by this so that if we swap in a font with twice the resolution (and twice the spread)\n  //   things look almost identical, just crisper\n  let x_advance = this.calcXAdvance(xsc);\n  let font_texel_scale = font_info.font_size / 32;\n  let tile_state = 0;\n\n  let applied_style = this.applied_style;\n\n  // Calculate anti-aliasing values\n  let delta_per_source_pixel = 0.5 / font_info.spread;\n  let delta_per_dest_pixel = delta_per_source_pixel / avg_scale_combined;\n  let value = vec4(1 / delta_per_dest_pixel, // AA Mult and Outline Mult\n  -0.5 / delta_per_dest_pixel + 0.5, // AA Add\n  // Outline Add\n  -0.5 / delta_per_dest_pixel + 0.5 + applied_style.outline_width * font_texel_scale * avg_scale_combined, 0 // Unused\n  );\n  if (value[2] > 0) {\n    value[2] = 0;\n  }\n  let padding1 = max(0, applied_style.outline_width * font_texel_scale * avg_scale_font);\n  let padding4 = vec4();\n  const outer_scaled = applied_style.glow_outer * font_texel_scale;\n  padding4[0] = max(outer_scaled * xsc - applied_style.glow_xoffs * font_texel_scale * xsc, padding1);\n  padding4[2] = max(outer_scaled * xsc + applied_style.glow_xoffs * font_texel_scale * xsc, padding1);\n  padding4[1] = max(outer_scaled * ysc - applied_style.glow_yoffs * font_texel_scale * ysc, padding1);\n  padding4[3] = max(outer_scaled * ysc + applied_style.glow_yoffs * font_texel_scale * ysc, padding1);\n\n  techParamsSet('param0', value);\n  let value2 = vec4(0, // filled later\n  0, // filled later\n  // Glow mult\n  1 / ((applied_style.glow_outer - applied_style.glow_inner) * delta_per_source_pixel * font_texel_scale), -(0.5 - applied_style.glow_outer * delta_per_source_pixel * font_texel_scale) / ((applied_style.glow_outer - applied_style.glow_inner) * delta_per_source_pixel * font_texel_scale));\n  if (value2[3] > 0) {\n    value2[3] = 0;\n  }\n\n  let padding_in_font_space = vec4();\n  v4scale(padding_in_font_space, padding4, 1 / avg_scale_font);\n  for (let ii = 0; ii < 4; ++ii) {\n    if (padding_in_font_space[ii] > font_info.spread) {\n      // Not enough buffer\n      let sc = font_info.spread / padding_in_font_space[ii];\n      padding4[ii] *= sc;\n      padding_in_font_space[ii] *= sc;\n    }\n  }\n\n  // Choose appropriate z advance so that character are drawn left to right (or RTL if the glow is on the other side)\n  const z_advance = applied_style.glow_xoffs < 0 ? -0.0001 : 0.0001;\n\n  // For non-1:1 aspect ration rendering, need to scale our coordinates' padding differently in each axis\n  let rel_x_scale = xsc / avg_scale_font;\n  let rel_y_scale = ysc / avg_scale_font;\n\n  for (let i = 0; i < len; i++) {\n    const c = text.charCodeAt(i);\n    if (c === 9) {\n      // '\\t'.charCodeAt(0)) {\n      let tabsize = xsc * font_info.font_size * 4;\n      x = (((x - _x) / tabsize | 0) + 1) * tabsize + _x;\n    } else {\n      let char_info = this.infoFromChar(c);\n      if (!char_info) {\n        char_info = this.infoFromChar(13);\n      }\n      if (char_info) {\n        let char_scale = char_info.scale;\n        let xsc2 = xsc * char_scale;\n        if (char_info.w) {\n          let ysc2 = ysc * char_scale;\n          let pad_scale = 1 / char_scale;\n          let tile_width = this.tex_w;\n          let tile_height = this.tex_h;\n          // Lazy update params here\n          if (char_scale !== tile_state) {\n            value2[0] = -applied_style.glow_xoffs * font_texel_scale * pad_scale / tile_width;\n            value2[1] = -applied_style.glow_yoffs * font_texel_scale * pad_scale / tile_height;\n            techParamsSet('glowParams', value2);\n          }\n\n          let u0 = (char_info.x0 - padding_in_font_space[0] * pad_scale) / tile_width;\n          let u1 = (char_info.x0 + char_info.w + padding_in_font_space[2] * pad_scale) / tile_width;\n          let v0 = (char_info.y0 - padding_in_font_space[1] * pad_scale) / tile_height;\n          let v1 = (char_info.y0 + char_info.h + padding_in_font_space[3] * pad_scale) / tile_height;\n\n          let w = char_info.w * xsc2 + (padding4[0] + padding4[2]) * rel_x_scale;\n          let h = char_info.h * ysc2 + (padding4[1] + padding4[3]) * rel_y_scale;\n\n          sprites.queueraw(texs, x - rel_x_scale * padding4[0], y - rel_y_scale * padding4[2] + char_info.yoffs * ysc2, z + z_advance * i, w, h, u0, v0, u1, v1, applied_style.color_vec4, this.shader, techParamsGet());\n\n          // require('./ui.js').drawRect(x - rel_x_scale * padding4[0],\n          //   y - rel_y_scale * padding4[2] + char_info.yoffs * ysc2,\n          //   w + x - rel_x_scale * padding4[0],\n          //   h + y - rel_y_scale * padding4[2] + char_info.yoffs * ysc2,\n          //   1000, [i & 1, (i & 2)>>1, (i & 4)>>2, 0.5]);\n        }\n\n        x += (char_info.w + char_info.xpad) * xsc2 + x_advance;\n      }\n    }\n  }\n  return x - _x;\n};\n\nGlovFont.prototype.determineShader = function () {\n  let outline = this.applied_style.outline_width && this.applied_style.outline_color & 0xff;\n  let glow = this.applied_style.glow_outer > 0 && this.applied_style.glow_color & 0xff;\n  if (outline) {\n    if (glow) {\n      this.shader = font_shaders.font_aa_outline_glow;\n    } else {\n      this.shader = font_shaders.font_aa_outline;\n    }\n  } else if (glow) {\n    this.shader = font_shaders.font_aa_glow;\n  } else {\n    this.shader = font_shaders.font_aa;\n  }\n};\n\nGlovFont.prototype.applyStyle = function (style) {\n  if (!style) {\n    style = this.default_style;\n  }\n  // outline\n  vec4ColorFromIntColor(temp_color, style.outline_color);\n  techParamsSet('outlineColor', temp_color);\n\n  // glow\n  vec4ColorFromIntColor(temp_color, style.glow_color);\n  techParamsSet('glowColor', temp_color);\n\n  // everything else\n  this.applied_style.outline_width = style.outline_width;\n  this.applied_style.outline_color = style.outline_color;\n  this.applied_style.glow_xoffs = style.glow_xoffs;\n  this.applied_style.glow_yoffs = style.glow_yoffs;\n  this.applied_style.glow_inner = style.glow_inner;\n  this.applied_style.glow_outer = style.glow_outer;\n  this.applied_style.glow_color = style.glow_color;\n  this.applied_style.color = style.color;\n  this.applied_style.color_vec4 = style.color_vec4;\n  this.applied_style.colorUR = style.colorUR;\n  this.applied_style.colorLR = style.colorLR;\n  this.applied_style.colorLL = style.colorLL;\n  this.applied_style.color_mode = style.color_mode;\n\n  if (this.applied_style.color_mode === COLOR_MODE.SINGLE) {\n    this.applied_style.colorUR = this.applied_style.colorLL = this.applied_style.colorLR = this.applied_style.color;\n  }\n\n  this.determineShader();\n};\n\n// Replicate constants and utility functions on all font instances as well\nGlovFont.prototype.COLOR_MODE = COLOR_MODE;\nGlovFont.prototype.ALIGN = ALIGN;\nGlovFont.prototype.style = style;\nGlovFont.prototype.styleAlpha = styleAlpha;\nGlovFont.prototype.styleColored = styleColored;\n\nfunction fontShadersInit() {\n  if (font_shaders.font_aa) {\n    return;\n  }\n  font_shaders.font_aa = shaders.create('glov/shaders/font_aa.fp');\n  font_shaders.font_aa_glow = shaders.create('glov/shaders/font_aa_glow.fp');\n  font_shaders.font_aa_outline = shaders.create('glov/shaders/font_aa_outline.fp');\n  font_shaders.font_aa_outline_glow = shaders.create('glov/shaders/font_aa_outline_glow.fp');\n}\n\nexport function create(...args) {\n  fontShadersInit();\n  return new GlovFont(...args);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint no-bitwise:off */\n\nconst assert = require('assert');\nconst engine = require('./engine.js');\nconst { ceil, max, min } = Math;\n\nexport const TRIANGLES = 4;\nexport const TRIANGLE_FAN = 6;\nexport const QUADS = 7;\n\nconst gl_byte_size = {\n  0x1400: 1, // GL_BYTE\n  0x1401: 1, // GL_UNSIGNED_BYTE\n  0x1402: 2, // GL_SHORT\n  0x1403: 2, // GL_UNSIGNED_SHORT\n  0x1406: 4 // GL_FLOAT\n};\n\n// let unit_buf;\n// let unit_buf_len = 0;\n\nlet bound_geom;\n\nlet bound_array_buf = null;\nlet bound_index_buf = null;\n\nlet quad_index_buf;\nlet quad_index_buf_len = 0;\n\nfunction deleteBuffer(handle) {\n  if (!handle) {\n    return;\n  }\n  if (bound_array_buf === handle) {\n    gl.bindBuffer(gl.ARRAY_BUFFER, null);\n    bound_array_buf = null;\n  }\n  if (bound_index_buf === handle) {\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n    bound_index_buf = null;\n  }\n  gl.deleteBuffer(handle);\n}\n\nlet attrib_enabled = 0;\nfunction enableVertexAttribArray(bits) {\n  if (bits === attrib_enabled) {\n    return;\n  }\n  let disable_mask = attrib_enabled & ~bits;\n  let enable_mask = ~attrib_enabled & bits;\n  attrib_enabled = bits;\n\n  if (disable_mask) {\n    let n = 0;\n    do {\n      if (disable_mask & 1) {\n        gl.disableVertexAttribArray(n);\n      }\n      n++;\n      disable_mask >>= 1;\n    } while (disable_mask);\n  }\n\n  if (enable_mask) {\n    let n = 0;\n    do {\n      if (enable_mask & 1) {\n        gl.enableVertexAttribArray(n);\n      }\n      n++;\n      enable_mask >>= 1;\n    } while (enable_mask);\n  }\n}\n\n// function bindUnitBuf(arr_idx, len) {\n//   if (len > unit_buf_len) {\n//     deleteBuffer(unit_buf);\n//     unit_buf = gl.createBuffer();\n//     unit_buf_len = max(ceil(unit_buf_len * 1.5), len);\n//     gl.bindBuffer(gl.ARRAY_BUFFER, unit_buf);\n//     bound_array_buf = unit_buf;\n//     let arr = new Uint8Array(unit_buf_len * 4);\n//     for (let ii = 0; ii < unit_buf_len * 4; ++ii) {\n//       arr[ii] = 255;\n//     }\n//     gl.bufferData(gl.ARRAY_BUFFER, arr, gl.STATIC_DRAW);\n//   } else {\n//     if (bound_array_buf !== unit_buf) {\n//       gl.bindBuffer(gl.ARRAY_BUFFER, unit_buf);\n//       bound_array_buf = unit_buf;\n//     }\n//   }\n//   gl.vertexAttribPointer(arr_idx, 4, gl.UNSIGNED_BYTE, true, 0, 0);\n// }\n\n// Verts should be ordered counter-clockwise from the upper left\nfunction getQuadIndexBuf(quad_count) {\n  assert(quad_count <= 16384);\n  // If not, need to split into multiple vertex and index buffers (fairly easy),\n  //   or use the OES_element_index_uint extension (trivial, but probably slower, maybe not supported on mobile?)\n  if (quad_count * 6 > quad_index_buf_len) {\n    if (!quad_index_buf) {\n      quad_index_buf = gl.createBuffer();\n    } else {\n      // freeing old one\n      engine.perf_state.gpu_mem.geom -= quad_index_buf_len * 2;\n    }\n    quad_index_buf_len = max(ceil(quad_index_buf_len * 1.5), quad_count * 6);\n    if (bound_index_buf !== quad_index_buf) {\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, quad_index_buf);\n      bound_index_buf = quad_index_buf;\n    }\n    let arr = new Uint16Array(quad_index_buf_len);\n    let vidx = 0;\n    for (let ii = 0; ii < quad_index_buf_len;) {\n      arr[ii++] = vidx + 1;\n      arr[ii++] = vidx + 3;\n      arr[ii++] = vidx++; // 0\n      arr[ii++] = vidx++; // 1\n      arr[ii++] = vidx++; // 2\n      arr[ii++] = vidx++; // 3\n    }\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, arr, gl.STATIC_DRAW);\n    engine.perf_state.gpu_mem.geom += quad_index_buf_len * 2;\n  }\n  return quad_index_buf;\n}\n\nexport function createIndices(idxs) {\n  let ret = {\n    ibo: gl.createBuffer(),\n    ibo_size: idxs.length\n  };\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ret.ibo);\n  bound_index_buf = ret.ibo;\n  gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, idxs, gl.STATIC_DRAW);\n  engine.perf_state.gpu_mem.geom += idxs.length * 2;\n  return ret;\n}\n\nfunction formatInfo(format) {\n  if (!format.info) {\n    let stride = 0;\n    let elem_count = 0;\n    let used_attribs = 0;\n    let common_byte_size = 0;\n    for (let ii = 0; ii < format.length; ++ii) {\n      let fmt = format[ii];\n      let sem = fmt[0];\n      let gltype = fmt[1];\n      let count = fmt[2];\n      used_attribs |= 1 << sem;\n      let byte_size = gl_byte_size[gltype];\n      assert(byte_size);\n      assert(!common_byte_size || byte_size === common_byte_size);\n      common_byte_size = byte_size;\n      fmt[3] = fmt[3] || false;\n      fmt[4] = byte_size;\n      stride += count * byte_size;\n      elem_count += count;\n    }\n    format.info = {\n      stride, elem_count, used_attribs, common_byte_size\n    };\n  }\n  return format.info;\n}\n\n// format is [shaders.semantic.foo, gl.FLOAT/UNSIGNED_BYTE/etc, count, normalized]\nfunction Geom(format, verts, idxs, mode) {\n  this.mode = mode || TRIANGLES;\n  this.format = format;\n  let info = this.format_info = formatInfo(format);\n  this.stride = info.stride;\n  this.used_attribs = info.used_attribs;\n\n  this.vert_count = verts.length / this.format_info.elem_count;\n  this.vert_gpu_mem = verts.length * this.format_info.common_byte_size;\n  if (verts.length) {\n    this.vbo = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vbo);\n    bound_array_buf = this.vbo;\n    gl.bufferData(gl.ARRAY_BUFFER, verts, gl.STATIC_DRAW);\n    engine.perf_state.gpu_mem.geom += this.vert_gpu_mem;\n  }\n  this.orig_mode = mode;\n  if (idxs) {\n    if (idxs.ibo) {\n      this.ibo = idxs.ibo;\n      this.ibo_owned = false;\n      this.ibo_size = idxs.ibo_size;\n    } else {\n      this.ibo = gl.createBuffer();\n      this.ibo_owned = true;\n      this.ibo_size = idxs.length;\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibo);\n      bound_index_buf = this.ibo;\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, idxs, gl.STATIC_DRAW);\n      engine.perf_state.gpu_mem.geom += idxs.length * 2;\n    }\n  } else if (mode === QUADS) {\n    assert.equal(this.vert_count % 4, 0);\n    let quad_count = this.vert_count / 4;\n    // PERFTODO: Use GL_QUADS_OES extension\n    this.ibo = getQuadIndexBuf(quad_count);\n    this.ibo_owned = false;\n    this.ibo_size = quad_count * 6;\n    this.mode = TRIANGLES;\n  } else if (mode === TRIANGLE_FAN) {\n    this.mode = TRIANGLE_FAN;\n  } else {\n    this.ibo = null;\n    this.ibo_owned = false;\n  }\n}\n\nGeom.prototype.updateSub = function (offset, verts) {\n  if (bound_array_buf !== this.vbo) {\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vbo);\n    bound_array_buf = this.vbo;\n  }\n  gl.bufferSubData(gl.ARRAY_BUFFER, offset, verts);\n};\n\nGeom.prototype.update = function (verts, num_verts) {\n  assert.equal(this.ibo_owned, false);\n  if (num_verts > this.vert_count) {\n    if (bound_geom === this) {\n      bound_geom = null;\n    }\n    engine.perf_state.gpu_mem.geom -= this.vert_gpu_mem;\n    deleteBuffer(this.vbo);\n    // Note: matching size, ignoring num_verts\n    this.vert_count = verts.length / this.format_info.elem_count;\n    this.vert_gpu_mem = verts.length * this.format_info.common_byte_size;\n    this.vbo = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vbo);\n    bound_array_buf = this.vbo;\n    gl.bufferData(gl.ARRAY_BUFFER, verts, gl.DYNAMIC_DRAW);\n    engine.perf_state.gpu_mem.geom += this.vert_gpu_mem;\n  } else {\n    // Fits\n    if (bound_array_buf !== this.vbo) {\n      gl.bindBuffer(gl.ARRAY_BUFFER, this.vbo);\n      bound_array_buf = this.vbo;\n    }\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, verts.subarray(0, num_verts * this.format_info.elem_count));\n    // gl.bufferData(gl.ARRAY_BUFFER, verts, gl.DYNAMIC_DRAW);\n  }\n  if (this.orig_mode === QUADS) {\n    let quad_count = num_verts / 4;\n    this.ibo = getQuadIndexBuf(quad_count);\n    this.ibo_size = quad_count * 6;\n  }\n};\n\nGeom.prototype.dispose = function () {\n  if (this.ibo_owned) {\n    deleteBuffer(this.ibo);\n  }\n  this.ibo = null;\n  deleteBuffer(this.vbo);\n  this.vbo = null;\n  engine.perf_state.gpu_mem.geom -= this.vert_gpu_mem;\n  this.vert_gpu_mem = 0;\n};\n\nlet bound_attribs = function () {\n  let r = [];\n  for (let ii = 0; ii < 16; ++ii) {\n    r.push({\n      vbo: null,\n      offset: 0\n    });\n  }\n  return r;\n}();\nGeom.prototype.bind = function () {\n  if (bound_geom !== this) {\n    bound_geom = this;\n    let vbo = this.vbo;\n\n    let offset = 0;\n    for (let ii = 0; ii < this.format.length; ++ii) {\n      let fmt = this.format[ii];\n      let count = fmt[2];\n      let byte_size = fmt[4];\n      if (bound_attribs[ii].vbo === vbo) {//  && bound_attribs[ii].offset = offset\n        // already bound\n      } else {\n        if (bound_array_buf !== vbo) {\n          gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\n          bound_array_buf = vbo;\n        }\n        let sem = fmt[0];\n        let gltype = fmt[1];\n        let normalized = fmt[3];\n        gl.vertexAttribPointer(sem, count, gltype, normalized, this.stride, offset);\n        bound_attribs[ii].vbo = bound_array_buf;\n        // bound_attribs[ii].offset = offset;\n      }\n      offset += count * byte_size;\n    }\n    // if (!used[1]) { // COLOR\n    //   used_attribs |= 1 << shader.semantics.COLOR;\n    //   bindUnitBuf(1, this.vert_count);\n    // }\n    enableVertexAttribArray(this.used_attribs);\n  }\n\n  if (this.ibo && bound_index_buf !== this.ibo) {\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibo);\n    bound_index_buf = this.ibo;\n  }\n};\nGeom.prototype.draw = function () {\n  this.bind();\n  if (this.ibo) {\n    gl.drawElements(this.mode, this.ibo_size, gl.UNSIGNED_SHORT, 0);\n  } else {\n    gl.drawArrays(this.mode, 0, this.vert_count);\n  }\n};\n\nfunction GeomMultiQuads(format, verts) {\n  let format_info = formatInfo(format);\n  let ec = format_info.elem_count;\n  let vert_count = verts.length / ec;\n  this.geoms = [];\n  for (let idx = 0; idx < vert_count; idx += 65536) {\n    let num_sub_verts = min(vert_count - idx, 65536);\n    let sub_data = new Uint8Array(verts.buffer, idx * ec, num_sub_verts * ec);\n    this.geoms.push(new Geom(format, sub_data, null, QUADS));\n  }\n}\nGeomMultiQuads.prototype.draw = function () {\n  for (let ii = 0; ii < this.geoms.length; ++ii) {\n    this.geoms[ii].draw();\n  }\n};\nGeomMultiQuads.prototype.dispose = function () {\n  for (let ii = 0; ii < this.geoms.length; ++ii) {\n    this.geoms[ii].dispose();\n  }\n  this.geoms = null;\n};\n\nexport function create(...args) {\n  return new Geom(...args);\n}\n\nexport function createQuads(format, verts) {\n  let format_info = formatInfo(format);\n  assert(verts instanceof Uint8Array); // only one handled by GeomMultiQuads for now\n  let vert_count = verts.length / format_info.elem_count;\n  if (vert_count > 65536) {\n    return new GeomMultiQuads(format, verts);\n  }\n  return new Geom(format, verts, null, QUADS);\n}\n\nexport function startup() {\n  // Nothing for now.\n}","/* eslint no-bitwise:off */\n// From https://stackoverflow.com/questions/8936984/uint8array-to-string-in-javascript\n\nlet charCache = new Array(128); // Preallocate the cache for the common single byte chars\nlet charFromCodePt = String.fromCodePoint || String.fromCharCode;\nlet result = [];\nexport function decode(array) {\n  let codePt;\n  let byte1;\n  let buffLen = array.length;\n\n  result.length = 0;\n\n  for (let i = 0; i < buffLen;) {\n    byte1 = array[i++];\n\n    if (byte1 <= 0x7F) {\n      codePt = byte1;\n    } else if (byte1 <= 0xDF) {\n      codePt = (byte1 & 0x1F) << 6 | array[i++] & 0x3F;\n    } else if (byte1 <= 0xEF) {\n      codePt = (byte1 & 0x0F) << 12 | (array[i++] & 0x3F) << 6 | array[i++] & 0x3F;\n    } else if (String.fromCodePoint) {\n      codePt = (byte1 & 0x07) << 18 | (array[i++] & 0x3F) << 12 | (array[i++] & 0x3F) << 6 | array[i++] & 0x3F;\n    } else {\n      codePt = 63; // Cannot convert four byte code points, so use \"?\" instead\n      i += 3;\n    }\n\n    result.push(charCache[codePt] || (charCache[codePt] = charFromCodePt(codePt)));\n  }\n\n  return result.join('');\n}","// Derived from (MIT Licensed) https://github.com/uber-web/loaders.gl/tree/master/modules/gltf\n\nconst TYPES = ['SCALAR', 'VEC2', 'VEC3', 'VEC4'];\n\nexport function getAccessorTypeFromSize(size) {\n  const type = TYPES[size - 1];\n  return type || TYPES[0];\n}\n\n// glTF ACCESSOR CONSTANTS\n\nexport const ATTRIBUTE_TYPE_TO_COMPONENTS = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16\n};\n\nexport const ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE = {\n  5120: 1,\n  5121: 1,\n  5122: 2,\n  5123: 2,\n  5125: 4,\n  5126: 4\n};\n\nexport const ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY = {\n  5120: Int8Array,\n  5121: Uint8Array,\n  5122: Int16Array,\n  5123: Uint16Array,\n  5125: Uint32Array,\n  5126: Float32Array\n};","// Derived from (MIT Licensed) https://github.com/uber-web/loaders.gl/tree/master/modules/gltf\n/* eslint-env browser */\n\nconst assert = require('assert');\n\n/* eslint-disable camelcase, max-statements */\nconst { unpackGLBBuffers } = require('./unpack-glb-buffers.js');\nconst { unpackBinaryJson } = require('./unpack-binary-json.js');\n\nfunction padTo4Bytes(byteLength) {\n  return byteLength + 3 & ~3; //eslint-disable-line no-bitwise\n}\n\nconst decode_utf8 = require('./decode-utf8.js');\n\nconst {\n  ATTRIBUTE_TYPE_TO_COMPONENTS,\n  ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE,\n  ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY\n} = require('./gltf-type-utils.js');\n\nconst MAGIC_glTF = 0x676c5446; // glTF in Big-Endian ASCII\n\nconst GLB_FILE_HEADER_SIZE = 12;\nconst GLB_CHUNK_HEADER_SIZE = 8;\n\nconst GLB_CHUNK_TYPE_JSON = 0x4e4f534a;\nconst GLB_CHUNK_TYPE_BIN = 0x004e4942;\n\nconst LE = true; // Binary GLTF is little endian.\nconst BE = false; // Magic needs to be written as BE\n\n// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#glb-file-format-specification\nfunction GLBParser() {\n  // Result\n  this.binaryByteOffset = null;\n  this.packedJson = null;\n  this.json = null;\n}\n\nfunction parseBinary(self) {\n  // GLB Header\n  const dataView = new DataView(self.glbArrayBuffer);\n  const magic1 = dataView.getUint32(0, BE); // Magic number (the ASCII string 'glTF').\n  const version = dataView.getUint32(4, LE); // Version 2 of binary glTF container format\n  const fileLength = dataView.getUint32(8, LE); // Total byte length of generated file\n\n  let valid = magic1 === MAGIC_glTF;\n  if (!valid) {\n    console.warn('Invalid GLB magic string');\n  }\n\n  assert(version === 2, `Invalid GLB version ${version}. Only .glb v2 supported`);\n  assert(fileLength > 20);\n\n  // Write the JSON chunk\n  const jsonChunkLength = dataView.getUint32(12, LE); // Byte length of json chunk\n  const jsonChunkFormat = dataView.getUint32(16, LE); // Chunk format as uint32\n\n  valid = jsonChunkFormat === GLB_CHUNK_TYPE_JSON || jsonChunkFormat === 0; // Back compat\n  assert(valid, `JSON chunk format ${jsonChunkFormat}`);\n\n  // Create a \"view\" of the binary encoded JSON data\n  const jsonChunkOffset = GLB_FILE_HEADER_SIZE + GLB_CHUNK_HEADER_SIZE; // First headers: 20 bytes\n  const jsonChunk = new Uint8Array(self.glbArrayBuffer, jsonChunkOffset, jsonChunkLength);\n\n  // Decode the JSON binary array into clear text\n  const jsonText = decode_utf8.decode(jsonChunk);\n\n  // Parse the JSON text into a JavaScript data structure\n  self.json = JSON.parse(jsonText);\n\n  // TODO - BIN chunk can be optional\n  const binaryChunkStart = jsonChunkOffset + padTo4Bytes(jsonChunkLength);\n  self.binaryByteOffset = binaryChunkStart + GLB_CHUNK_HEADER_SIZE;\n\n  const binChunkFormat = dataView.getUint32(binaryChunkStart + 4, LE); // Chunk format as uint32\n  valid = binChunkFormat === GLB_CHUNK_TYPE_BIN || binChunkFormat === 1; // Back compat\n  assert(valid, `BIN chunk format ${binChunkFormat}`);\n\n  return {\n    arrayBuffer: self.glbArrayBuffer,\n    binaryByteOffset: self.binaryByteOffset,\n    json: self.json\n  };\n}\n\nfunction parseInternal(self) {\n  const result = parseBinary(self);\n  self.packedJson = result.json;\n  self.unpackedBuffers = unpackGLBBuffers(self.glbArrayBuffer, self.json, self.binaryByteOffset);\n  self.json = unpackBinaryJson(self.json, self.unpackedBuffers);\n}\n\nGLBParser.prototype.parseSync = function (arrayBuffer) {\n  // Input\n  this.glbArrayBuffer = arrayBuffer;\n\n  // Only parse once\n  if (this.json === null && this.binaryByteOffset === null) {\n    parseInternal(this);\n  }\n  return this;\n};\n\n// Return the gltf JSON and the original arrayBuffer\nGLBParser.prototype.parse = function (arrayBuffer) {\n  return this.parseSync(arrayBuffer);\n};\n\n// Returns application JSON data stored in `key`\nGLBParser.prototype.getApplicationData = function (key) {\n  return this.json[key];\n};\n\n// Returns JSON envelope\nGLBParser.prototype.getJSON = function () {\n  return this.json;\n};\n\n// Return binary chunk\nGLBParser.prototype.getArrayBuffer = function () {\n  return this.glbArrayBuffer;\n};\n\n// Return index into binary chunk\nGLBParser.prototype.getBinaryByteOffset = function () {\n  return this.binaryByteOffset;\n};\n\n// Unpacks a bufferview into a new Uint8Array that is a view into the binary chunk\nGLBParser.prototype.getBufferView = function (glTFBufferView) {\n  const byteOffset = (glTFBufferView.byteOffset || 0) + this.binaryByteOffset;\n  return new Uint8Array(this.glbArrayBuffer, byteOffset, glTFBufferView.byteLength);\n};\n\n// Unpacks a glTF accessor into a new typed array that is a view into the binary chunk\nGLBParser.prototype.getBuffer = function (glTFAccessor) {\n  // Decode the glTF accessor format\n  const ArrayType = ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY[glTFAccessor.componentType];\n  const components = ATTRIBUTE_TYPE_TO_COMPONENTS[glTFAccessor.type];\n  const bytesPerComponent = ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE[glTFAccessor.componentType];\n  const length = glTFAccessor.count * components;\n  const byteLength = glTFAccessor.count * components * bytesPerComponent;\n\n  // Get the boundaries of the binary sub-chunk for this bufferView\n  const glTFBufferView = this.json.bufferViews[glTFAccessor.bufferView];\n  assert(byteLength >= 0 && glTFAccessor.byteOffset + byteLength <= glTFBufferView.byteLength);\n\n  const byteOffset = glTFBufferView.byteOffset + this.binaryByteOffset + glTFAccessor.byteOffset;\n  return new ArrayType(this.glbArrayBuffer, byteOffset, length);\n};\n\n// Unpacks an image into an HTML image\nGLBParser.prototype.getImageData = function (glTFImage) {\n  return {\n    typedArray: this.getBufferView(glTFImage.bufferView),\n    mimeType: glTFImage.mimeType || 'image/jpeg'\n  };\n};\n\nGLBParser.prototype.getImage = function (glTFImage) {\n  const arrayBufferView = this.getBufferView(glTFImage.bufferView);\n  const mimeType = glTFImage.mimeType || 'image/jpeg';\n  const blob = new Blob([arrayBufferView], { type: mimeType });\n  const urlCreator = window.URL || window.webkitURL;\n  const imageUrl = urlCreator.createObjectURL(blob);\n  const img = new Image();\n  img.src = imageUrl;\n  return img;\n};\n\n// GLBParser.prototype.getImageAsync = function (glTFImage) {\n//   return new Promise(resolve => {\n//     const arrayBufferView = this.getBufferView(glTFImage.bufferView);\n//     const mimeType = glTFImage.mimeType || 'image/jpeg';\n//     const blob = new Blob([arrayBufferView], {type: mimeType});\n//     const urlCreator = window.URL || window.webkitURL;\n//     const imageUrl = urlCreator.createObjectURL(blob);\n//     const img = new Image();\n//     img.onload = () => resolve(img);\n//     img.src = imageUrl;\n//   });\n// };\n\nmodule.exports = GLBParser;\nGLBParser.parse = function (data) {\n  let parser = new GLBParser();\n  return parser.parse(data);\n};","// Derived from (MIT Licensed) https://github.com/uber-web/loaders.gl/tree/master/modules/gltf\n\nfunction parseJSONPointer(value) {\n  if (typeof value === 'string') {\n    // Remove escape character\n    if (value.indexOf('##/') === 0) {\n      return value.slice(1);\n    }\n\n    let matches = value.match(/#\\/([a-z]+)\\/([0-9]+)/);\n    if (matches) {\n      const index = parseInt(matches[2], 10);\n      return [matches[1], index];\n    }\n\n    // Legacy: `$$$i`\n    matches = value.match(/\\$\\$\\$([0-9]+)/);\n    if (matches) {\n      const index = parseInt(matches[1], 10);\n      return ['accessors', index];\n    }\n  }\n\n  return null;\n}\n\nfunction decodeJSONPointer(object, buffers) {\n  const pointer = parseJSONPointer(object);\n  if (pointer) {\n    const field = pointer[0];\n    const index = pointer[1];\n    const buffer = buffers[field] && buffers[field][index];\n    if (buffer) {\n      return buffer;\n    }\n    console.error(`Invalid JSON pointer ${object}: #/${field}/${index}`);\n  }\n  return null;\n}\n\n// Recursively unpacks objects, replacing \"JSON pointers\" with typed arrays\nfunction unpackJsonArraysRecursive(json, topJson, buffers, options = {}) {\n  const object = json;\n\n  const buffer = decodeJSONPointer(object, buffers);\n  if (buffer) {\n    return buffer;\n  }\n\n  // Copy array\n  if (Array.isArray(object)) {\n    return object.map(element => unpackJsonArraysRecursive(element, topJson, buffers, options));\n  }\n\n  // Copy object\n  if (object !== null && typeof object === 'object') {\n    const newObject = {};\n    for (const key in object) {\n      newObject[key] = unpackJsonArraysRecursive(object[key], topJson, buffers, options);\n    }\n    return newObject;\n  }\n\n  return object;\n}\n\nexport function unpackBinaryJson(json, buffers, options = {}) {\n  return unpackJsonArraysRecursive(json, json, buffers, options);\n}","// Derived from (MIT Licensed) https://github.com/uber-web/loaders.gl/tree/master/modules/gltf\n\nconst assert = require('assert');\n\nconst {\n  ATTRIBUTE_TYPE_TO_COMPONENTS,\n  ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE,\n  ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY\n} = require('./gltf-type-utils.js');\n\n// Creates a new ArrayBuffer starting at the offset, containing all remaining bytes\n// TODO - should not be needed, see above\nfunction getArrayBufferAtOffset(arrayBuffer, byteOffset) {\n  const length = arrayBuffer.byteLength - byteOffset;\n  const binaryBuffer = new ArrayBuffer(length);\n  const sourceArray = new Uint8Array(arrayBuffer);\n  const binaryArray = new Uint8Array(binaryBuffer);\n  for (let i = 0; i < length; i++) {\n    binaryArray[i] = sourceArray[byteOffset + i];\n  }\n  return binaryBuffer;\n}\n\nfunction getArrayTypeAndLength(accessor, bufferView) {\n  const ArrayType = ATTRIBUTE_COMPONENT_TYPE_TO_ARRAY[accessor.componentType];\n  const components = ATTRIBUTE_TYPE_TO_COMPONENTS[accessor.type];\n  const bytesPerComponent = ATTRIBUTE_COMPONENT_TYPE_TO_BYTE_SIZE[accessor.componentType];\n  const length = accessor.count * components;\n  const byteLength = accessor.count * components * bytesPerComponent;\n  assert(byteLength >= 0 && byteLength <= bufferView.byteLength);\n  return { ArrayType, length, byteLength };\n}\n\nfunction unpackAccessors(arrayBuffer, bufferViews, json) {\n  // unpack accessors\n  const accessors = json.accessors || [];\n\n  const accessorBuffers = [];\n\n  for (let i = 0; i < accessors.length; ++i) {\n    const accessor = accessors[i];\n    assert(accessor);\n\n    const bufferView = bufferViews[accessor.bufferView];\n    // Draco encoded meshes don't have bufferView in accessor\n    if (bufferView) {\n      // Create a new typed array as a view into the combined buffer\n      const { ArrayType, length } = getArrayTypeAndLength(accessor, bufferView);\n      const array = new ArrayType(arrayBuffer, bufferView.byteOffset, length);\n      // Store the metadata on the array (e.g. needed to determine number of components per element)\n      array.accessor = accessor;\n      accessorBuffers.push(array);\n    }\n  }\n\n  return accessorBuffers;\n}\n\nfunction unpackImages(arrayBuffer, bufferViews, json) {\n  // unpack images\n  const images = json.images || [];\n\n  const imageBuffers = [];\n\n  for (let i = 0; i < images.length; ++i) {\n    const image = images[i];\n    assert(image);\n\n    if (image.bufferView === undefined) {\n      imageBuffers.push(null);\n      continue;\n    }\n\n    const bufferView = bufferViews[image.bufferView];\n    assert(bufferView);\n\n    // Create a new typed array as a view into the combined buffer\n    const array = new Uint8Array(arrayBuffer, bufferView.byteOffset, bufferView.byteLength);\n    // Store the metadata on the array (e.g. needed to determine number of components per element)\n    array.imate = image;\n    imageBuffers.push(array);\n  }\n\n  return imageBuffers;\n}\n\nexport function unpackGLBBuffers(arrayBuffer, json, binaryByteOffset) {\n  // TODO - really inefficient, should just use the offset into the original array buffer\n  if (binaryByteOffset) {\n    arrayBuffer = getArrayBufferAtOffset(arrayBuffer, binaryByteOffset);\n  }\n\n  const bufferViews = json.bufferViews || [];\n\n  for (let i = 0; i < bufferViews.length; ++i) {\n    const bufferView = bufferViews[i];\n    assert(bufferView.byteLength >= 0);\n  }\n\n  return {\n    // TODO: delete unpackAccessors and use buffer views only?\n    accessors: unpackAccessors(arrayBuffer, bufferViews, json),\n    images: unpackImages(arrayBuffer, bufferViews, json)\n  };\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\n// System for registering callbacks to run in event handlers on the next frame\n// Used to get around restrictions on APIs like pointer lock, fullscreen, or\n// screen orientation.\n\nconst assert = require('assert');\n\nlet cbs = {};\nexport function topOfFrame() {\n  cbs = {};\n}\n\nexport function on(type, code_or_pos, cb) {\n  let list = cbs[type] = cbs[type] || [];\n  if (typeof code_or_pos === 'number') {\n    list[code_or_pos] = cb;\n  } else {\n    list.push([code_or_pos, cb]);\n  }\n}\n\nexport function handle(type, event) {\n  let list = cbs[type];\n  if (!list) {\n    return;\n  }\n  switch (type) {\n    case 'keydown':\n    case 'keyup':\n      if (list[event.keyCode]) {\n        list[event.keyCode](type, event);\n      }\n      break;\n    case 'mouseup':\n    case 'mousedown':\n      {\n        let x = event.pageX;\n        let y = event.pageY;\n        let button = event.button;\n        for (let ii = 0; ii < list.length; ++ii) {\n          let elem = list[ii];\n          let pos = elem[0];\n          if (x >= pos.x && x < pos.x + pos.w && y >= pos.y && y < pos.y + pos.h && (pos.button < 0 || pos.button === button)) {\n            elem[1](type, event);\n            break;\n          }\n        }\n      }break;\n    default:\n      assert(false);\n  }\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n// Some code from Turbulenz: Copyright (c) 2012-2013 Turbulenz Limited\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* global navigator */\n\nconst assert = require('assert');\nconst camera2d = require('./camera2d.js');\nconst { cmd_parse } = require('./cmds.js');\nconst engine = require('./engine.js');\nconst in_event = require('./in_event.js');\nconst local_storage = require('./local_storage.js');\nconst { abs, max, min, sqrt } = Math;\nconst pointer_lock = require('./pointer_lock.js');\nconst { soundResume } = require('./sound.js');\nconst { vec2, v2add, v2copy, v2lengthSq, v2set, v2scale, v2sub } = require('./vmath.js');\n\nconst UP_EDGE = 0; // only for pads, which use === null as \"up\"\nconst UP = 0; // only for key/mouse\nconst DOWN = 1;\nconst DOWN_EDGE = 2; // only for pads\n\n// per-app overrideable options\nconst TOUCH_AS_MOUSE = true;\nlet map_analog_to_dpad = true;\n\nlet mouse_log = false;\n\nexport const ANY = -2;\nexport const POINTERLOCK = -1;\n\nexport let KEYS = {\n  BACKSPACE: 8,\n  TAB: 9,\n  ENTER: 13,\n  RETURN: 13,\n  SHIFT: 16,\n  CTRL: 17,\n  ALT: 18,\n  ESC: 27,\n  SPACE: 32,\n  PAGEUP: 33,\n  PAGEDOWN: 34,\n  END: 35,\n  HOME: 36,\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40,\n  INS: 45,\n  DEL: 46,\n  NUMPAD_DIVIDE: 111,\n  EQUALS: 187,\n  MINUS: 189,\n  SLASH: 191,\n  TILDE: 192\n};\n(function () {\n  for (let ii = 1; ii <= 12; ++ii) {\n    KEYS[`F${ii}`] = 111 + ii;\n  }\n  for (let ii = 48; ii <= 90; ++ii) {\n    // 0-9;A-Z\n    KEYS[String.fromCharCode(ii)] = ii;\n  }\n})();\nif (typeof Proxy === 'function') {\n  // Catch referencing keys that are not in our map\n  KEYS = new Proxy(KEYS, {\n    get: function (target, prop) {\n      let ret = target[prop];\n      assert(ret);\n      return ret;\n    }\n  });\n}\nexport const PAD = {\n  A: 0,\n  SELECT: 0, // GLOV name\n  B: 1,\n  CANCEL: 1, // GLOV name\n  X: 2,\n  Y: 3,\n  LB: 4,\n  LEFT_BUMPER: 4,\n  RB: 5,\n  RIGHT_BUMPER: 5,\n  LT: 6,\n  LEFT_TRIGGER: 6,\n  RT: 7,\n  RIGHT_TRIGGER: 7,\n  BACK: 8,\n  START: 9,\n  LEFT_STICK: 10,\n  RIGHT_STICK: 11,\n  UP: 12,\n  DOWN: 13,\n  LEFT: 14,\n  RIGHT: 15,\n  ANALOG_UP: 20,\n  ANALOG_LEFT: 21,\n  ANALOG_DOWN: 22,\n  ANALOG_RIGHT: 23\n};\n\nlet pad_to_touch;\n\nlet canvas;\nlet key_state_new = {};\nlet pad_states = []; // One map per gamepad to pad button states\nlet gamepad_data = []; // Other tracking data per gamepad\nlet mouse_pos = vec2(); // in DOM coordinates, not canvas or virtual\nlet last_mouse_pos = vec2();\nlet mouse_pos_is_touch = false;\nlet mouse_over_captured = false;\nlet mouse_down = [];\nlet mouse_wheel = 0;\nlet movement_questionable_frames = 0;\nconst MOVEMENT_QUESTIONABLE_FRAMES = 2; // Need at least 2\n\nlet input_eaten_kb = false;\nlet input_eaten_mouse = false;\n\nlet touches = {}; // `m${button}` or touch_id -> TouchData\n\nexport let touch_mode = local_storage.getJSON('touch_mode', false);\nexport let pad_mode = local_storage.getJSON('pad_mode', false);\n\ncmd_parse.registerValue('mouse_log', {\n  type: cmd_parse.TYPE_INT,\n  range: [0, 1],\n  get: () => mouse_log,\n  set: v => mouse_log = v\n});\n\nfunction eventTimestamp(event) {\n  if (event && event.timeStamp) {\n    // assert((event.timeStamp < 1e12) === (engine.hrtime < 1e12));\n    // Must both be high res times, or both not!\n    if (event.timeStamp < 1e12 !== engine.hrtime < 1e12) {\n      return engine.hrtime;\n    }\n    return event.timeStamp;\n  }\n  return engine.hrtime;\n}\n\nfunction TouchData(pos, touch, button, event) {\n  this.delta = vec2();\n  this.total = 0;\n  this.cur_pos = pos.slice(0);\n  this.start_pos = pos.slice(0);\n  this.touch = touch;\n  this.button = button;\n  this.start_time = Date.now();\n  this.dispatched = false;\n  this.dispatched_drag_over = false;\n  this.up_edge = 0;\n  this.down_edge = 0;\n  this.state = DOWN;\n  this.down_time = 0;\n  this.origin_time = eventTimestamp(event);\n}\nTouchData.prototype.down = function (event, is_edge) {\n  if (is_edge) {\n    this.down_edge++;\n  }\n  this.state = DOWN;\n  this.origin_time = eventTimestamp(event);\n};\n\nconst MIN_EVENT_TIME_DELTA = 0.01; // fractions of a millisecond\nfunction timeDelta(event, origin_time) {\n  let et = eventTimestamp(event);\n  // timestamps on events are often back in time relative to the last tick time\n  return max(et - origin_time, MIN_EVENT_TIME_DELTA);\n}\n\nfunction KeyData() {\n  this.down_edge = 0;\n  // this.down_start = 0;\n  this.origin_time = 0;\n  this.down_time = 0;\n  this.up_edge = 0;\n  this.state = UP;\n}\nKeyData.prototype.keyUp = function (event) {\n  ++this.up_edge;\n  this.down_time += timeDelta(event, this.origin_time);\n  this.state = UP;\n};\n\nfunction setMouseToMid() {\n  v2set(mouse_pos, engine.width * 0.5 / camera2d.domToCanvasRatio(), engine.height * 0.5 / camera2d.domToCanvasRatio());\n}\n\nexport function pointerLocked() {\n  return pointer_lock.isLocked();\n}\nlet pointerlock_touch_id = `m${POINTERLOCK}`;\n// only works reliably when called from an event handler\nexport function pointerLockEnter(when) {\n  pointer_lock.enter(when);\n}\nfunction onPointerLockEnter() {\n  if (touch_mode) {\n    return;\n  }\n  let touch_data = touches[pointerlock_touch_id];\n  setMouseToMid();\n  if (touch_data) {\n    v2copy(touch_data.start_pos, mouse_pos);\n    touch_data.state = DOWN;\n    touch_data.origin_time = engine.hrtime;\n  } else {\n    touch_data = touches[pointerlock_touch_id] = new TouchData(mouse_pos, false, POINTERLOCK, null);\n  }\n  movement_questionable_frames = MOVEMENT_QUESTIONABLE_FRAMES;\n}\nexport function pointerLockExit() {\n  let touch_data = touches[pointerlock_touch_id];\n  if (touch_data) {\n    v2copy(touch_data.cur_pos, mouse_pos);\n    // no UP_EDGE for this\n    touch_data.state = UP;\n  }\n  pointer_lock.exit();\n  movement_questionable_frames = MOVEMENT_QUESTIONABLE_FRAMES;\n}\n\nlet last_event;\nconst skip = { isTrusted: 1, sourceCapabilities: 1, path: 1, currentTarget: 1, view: 1 };\nfunction eventlog(event) {\n  if (event === last_event) {\n    return;\n  }\n  last_event = event;\n  let pairs = [];\n  for (let k in event) {\n    let v = event[k];\n    if (!v || typeof v === 'function' || k.toUpperCase() === k || skip[k]) {\n      continue;\n    }\n    pairs.push(`${k}:${v.id || v}`);\n  }\n  console.log(`${engine.global_frame_index} ${event.type} ${pointerLocked() ? 'ptrlck' : 'unlckd'} ${pairs.join(',')}`);\n}\n\nfunction letEventThrough(event) {\n  return event.target.tagName === 'INPUT' || String(event.target.className).indexOf('noglov') !== -1;\n}\n\nfunction ignored(event) {\n  // eventlog(event);\n  if (!letEventThrough(event)) {\n    event.preventDefault();\n    event.stopPropagation();\n  }\n}\n\nlet unload_protected = false;\nfunction beforeUnload(e) {\n  if (unload_protected) {\n    // Cancel the event\n    e.preventDefault();\n    // Chrome requires returnValue to be set\n    e.returnValue = 'Are you sure you want to quit?';\n  } else {\n    engine.releaseCanvas();\n  }\n}\nfunction protectUnload(enable) {\n  unload_protected = enable;\n}\n\nfunction onKeyUp(event) {\n  protectUnload(event.ctrlKey);\n  let code = event.keyCode;\n  if (!letEventThrough(event)) {\n    event.stopPropagation();\n    event.preventDefault();\n  }\n\n  if (code === KEYS.ESC && pointerLocked()) {\n    pointerLockExit();\n  }\n  // Letting through to our code regardless of no_stop, because we handle things like ESC in INPUT elements\n\n  let ks = key_state_new[code];\n  if (ks && ks.state === DOWN) {\n    ks.keyUp(event);\n  }\n\n  in_event.handle('keyup', event);\n}\n\nfunction onKeyDown(event) {\n  protectUnload(event.ctrlKey);\n  let code = event.keyCode;\n  let no_stop = letEventThrough(event) || code >= KEYS.F5 && code <= KEYS.F12 || // Chrome debug hotkeys\n  code === KEYS.I && (event.altKey && event.metaKey || event.ctrlKey && event.shiftKey); // Safari, alternate Chrome\n  if (!no_stop) {\n    event.stopPropagation();\n    event.preventDefault();\n  }\n  // console.log(`${event.code} ${event.keyCode}`);\n  soundResume();\n\n  // Letting through to our code regardless of no_stop, because we handle things like ESC in INPUT elements\n  let ks = key_state_new[code];\n  if (!ks) {\n    ks = key_state_new[code] = new KeyData();\n  }\n  if (ks.state !== DOWN) {\n    // not a repeat event\n    ++ks.down_edge;\n    ks.state = DOWN;\n    ks.origin_time = eventTimestamp(event);\n    // ks.down_start = ks.origin_time;\n\n    in_event.handle('keydown', event);\n  }\n}\n\nlet mouse_moved = false;\nlet temp_delta = vec2();\nlet last_abs_move = 0;\nlet last_abs_move_time = 0;\nfunction onMouseMove(event, no_stop) {\n  /// eventlog(event);\n  // Don't block mouse button 3, that's the Back button\n  if (!letEventThrough(event) && !no_stop && event.button !== 3) {\n    event.preventDefault();\n    event.stopPropagation();\n    if (touch_mode) {\n      local_storage.setJSON('touch_mode', false);\n      touch_mode = false;\n    }\n    if (pad_mode) {\n      local_storage.setJSON('pad_mode', false);\n      pad_mode = false;\n    }\n  }\n  mouse_moved = true;\n  // offsetX/layerX return position relative to text-entry boxes, not good!\n  // clientX/clientY do not handle weird scrolling that happens on iOS, but\n  //   should not affect mouse events (but maybe on Safari desktop?)\n  mouse_pos[0] = event.pageX;\n  mouse_pos[1] = event.pageY;\n  // if (event.offsetX !== undefined) {\n  //   mouse_pos[0] = event.offsetX;\n  //   mouse_pos[1] = event.offsetY;\n  // } else {\n  //   mouse_pos[0] = event.layerX;\n  //   mouse_pos[1] = event.layerY;\n  // }\n  mouse_pos_is_touch = false;\n\n  let any_movement = false;\n  if (pointerLocked()) {\n    setMouseToMid();\n    if (event.movementX || event.movementY) {\n      // Smooth out (ignore) large jumps in movement\n      // This is, I believe, just a bug with Chromium on Windows, as it repositions the hidden mouse cursor\n      let ts = event.timeStamp || Date.now();\n      let abs_move = abs(event.movementX) + abs(event.movementY);\n      if (abs_move > 200 && (abs_move > 3 * last_abs_move || ts - last_abs_move_time > 1000)) {\n        console.log(`Ignoring mousemove with sudden large delta: ${event.movementX},${event.movementY}`);\n      } else {\n        v2set(temp_delta, event.movementX || 0, event.movementY || 0);\n        any_movement = true;\n      }\n      last_abs_move = abs_move;\n      last_abs_move_time = ts;\n    }\n  } else {\n    v2sub(temp_delta, mouse_pos, last_mouse_pos);\n    if (temp_delta[0] || temp_delta[1]) {\n      any_movement = true;\n    }\n    v2copy(last_mouse_pos, mouse_pos);\n  }\n  if (any_movement && movement_questionable_frames && v2lengthSq(temp_delta) > 100 * 100) {\n    // giant movement right after entering or exiting pointer lock, ignore (Chrome bug)\n    // We get these unreasonable jumps in both movementXY and the other, presumably\n    // because pointerLocked() is slightly out of sync, though the large .movementX/Y\n    // is clearly erroneous.\n    any_movement = false;\n  }\n  if (any_movement) {\n    for (let button = POINTERLOCK; button < mouse_down.length; ++button) {\n      if (mouse_down[button] || button === POINTERLOCK && pointerLocked()) {\n        let touch_data = touches[`m${button}`];\n        if (touch_data) {\n          v2add(touch_data.delta, touch_data.delta, temp_delta);\n          touch_data.total += abs(temp_delta[0]) + abs(temp_delta[1]);\n          v2copy(touch_data.cur_pos, mouse_pos);\n        }\n      }\n    }\n  }\n}\n\nfunction onMouseDown(event) {\n  if (mouse_log) {\n    eventlog(event);\n  }\n  onMouseMove(event); // update mouse_pos\n  soundResume();\n  let no_click = letEventThrough(event);\n\n  let button = event.button;\n  mouse_down[button] = mouse_pos.slice(0);\n  let touch_id = `m${button}`;\n  if (touches[touch_id]) {\n    v2copy(touches[touch_id].start_pos, mouse_pos);\n  } else {\n    touches[touch_id] = new TouchData(mouse_pos, false, button, event);\n  }\n  touches[touch_id].down(event, !no_click);\n  if (!no_click) {\n    in_event.handle('mousedown', event);\n  }\n  //This solves input bug when game is running as iframe. E.g. Facebook Instant\n  if (window.focus) {\n    window.focus();\n  }\n}\n\nfunction onMouseUp(event) {\n  if (mouse_log) {\n    eventlog(event);\n  }\n  onMouseMove(event); // update mouse_pos\n  let no_click = letEventThrough(event);\n  let button = event.button;\n  if (mouse_down[button]) {\n    let touch_id = `m${button}`;\n    let touch_data = touches[touch_id];\n    if (touch_data) {\n      v2copy(touch_data.cur_pos, mouse_pos);\n      if (!no_click) {\n        touch_data.up_edge++;\n      }\n      touch_data.state = UP;\n      touch_data.down_time += timeDelta(event, touch_data.origin_time);\n    }\n    delete mouse_down[button];\n  }\n  if (!no_click) {\n    in_event.handle('mouseup', event);\n  }\n}\n\nfunction onWheel(event) {\n  onMouseMove(event, true);\n  let delta = -event.deltaY || event.wheelDelta || -event.detail;\n  if (delta > 0) {\n    mouse_wheel++;\n  } else if (delta < 0) {\n    mouse_wheel--;\n  }\n}\n\nlet touch_pos = vec2();\nlet released_touch_id = 0;\nfunction onTouchChange(event) {\n  // eventlog(event);\n  // Using .pageX/Y here because on iOS when a text entry is selected, it scrolls\n  // our canvas offscreen.  Should maybe have the canvas resize and use clientX\n  // instead, but this works well enough.\n  soundResume();\n  if (!touch_mode) {\n    local_storage.set('touch_mode', true);\n    touch_mode = true;\n  }\n  if (pad_mode) {\n    local_storage.set('pad_mode', true);\n    pad_mode = true;\n  }\n  if (event.cancelable !== false) {\n    event.preventDefault();\n  }\n  let ct = event.touches;\n  let seen = {};\n\n  let new_count = ct.length;\n  let old_count = new_count;\n  // Look for press and movement\n  for (let ii = 0; ii < new_count; ++ii) {\n    let touch = ct[ii];\n    let last_touch = touches[touch.identifier];\n    v2set(touch_pos, touch.pageX, touch.pageY);\n    if (!last_touch) {\n      last_touch = touches[touch.identifier] = new TouchData(touch_pos, true, 0, event);\n      last_touch.down(event, true);\n      --old_count;\n      in_event.handle('mousedown', touch);\n    } else {\n      v2sub(temp_delta, touch_pos, last_touch.cur_pos);\n      v2add(last_touch.delta, last_touch.delta, temp_delta);\n      last_touch.total += abs(temp_delta[0]) + abs(temp_delta[1]);\n      v2copy(last_touch.cur_pos, touch_pos);\n    }\n\n    seen[touch.identifier] = true;\n    if (TOUCH_AS_MOUSE && new_count === 1) {\n      // Single touch, treat as mouse movement\n      v2copy(mouse_pos, touch_pos);\n      mouse_pos_is_touch = true;\n    }\n  }\n  // Look for release, if releasing exactly one final touch\n  let released_touch;\n  let released_ids = [];\n  for (let id in touches) {\n    if (!seen[id]) {\n      let touch = touches[id];\n      if (touch.touch && touch.state === DOWN) {\n        ++old_count;\n        released_touch = touch;\n        released_ids.push(id);\n        in_event.handle('mouseup', { pageX: touch.cur_pos[0], pageY: touch.cur_pos[1] });\n        touch.up_edge++;\n        touch.state = UP;\n        touch.down_time += timeDelta(event, touch.origin_time);\n        touch.release = true;\n      }\n    }\n  }\n  for (let ii = 0; ii < released_ids.length; ++ii) {\n    let id = released_ids[ii];\n    let touch = touches[id];\n    // get new id, not overlapping with touch.identifier values,\n    // so that if we get a new touch event before the next tick, we still see the release, etc\n    let new_id = `r${++released_touch_id}`;\n    delete touches[id];\n    touches[new_id] = touch;\n  }\n  if (TOUCH_AS_MOUSE) {\n    if (old_count === 1 && new_count === 0) {\n      delete mouse_down[0];\n      v2copy(mouse_pos, released_touch.cur_pos);\n      mouse_pos_is_touch = true;\n    } else if (new_count === 1) {\n      let touch = ct[0];\n      if (!old_count) {\n        mouse_down[0] = vec2(touch.pageX, touch.pageY);\n      }\n      v2set(mouse_pos, touch.pageX, touch.pageY);\n      mouse_pos_is_touch = true;\n    } else if (new_count > 1) {\n      // multiple touches, release mouse_down without emitting click\n      delete mouse_down[0];\n    }\n  }\n}\n\nfunction onBlurOrFocus(evt) {\n  protectUnload(false);\n  for (let code in key_state_new) {\n    let ks = key_state_new[code];\n    if (ks.state === DOWN) {\n      ks.keyUp(evt);\n    }\n  }\n}\n\nlet ANALOG_MAP = {};\nfunction genAnalogMap() {\n  if (map_analog_to_dpad) {\n    ANALOG_MAP[PAD.LEFT] = PAD.ANALOG_LEFT;\n    ANALOG_MAP[PAD.RIGHT] = PAD.ANALOG_RIGHT;\n    ANALOG_MAP[PAD.UP] = PAD.ANALOG_UP;\n    ANALOG_MAP[PAD.DOWN] = PAD.ANALOG_DOWN;\n  }\n}\n\nexport function startup(_canvas, params) {\n  canvas = _canvas;\n  pointer_lock.startup(canvas, onPointerLockEnter);\n  if (params.map_analog_to_dpad !== undefined) {\n    map_analog_to_dpad = params.map_analog_to_dpad;\n  }\n  pad_to_touch = params.pad_to_touch;\n  genAnalogMap();\n\n  let passive_param = false;\n  try {\n    let opts = Object.defineProperty({}, 'passive', {\n      get: function () {\n        passive_param = { passive: false };\n        return false;\n      }\n    });\n    window.addEventListener('test', null, opts);\n    window.removeEventListener('test', null, opts);\n  } catch (e) {\n    passive_param = false;\n  }\n\n  window.addEventListener('keydown', onKeyDown, false);\n  window.addEventListener('keyup', onKeyUp, false);\n\n  window.addEventListener('click', ignored, false);\n  window.addEventListener('contextmenu', ignored, false);\n  window.addEventListener('mousemove', onMouseMove, false);\n  window.addEventListener('mousedown', onMouseDown, false);\n  window.addEventListener('mouseup', onMouseUp, false);\n  if (window.WheelEvent) {\n    window.addEventListener('wheel', onWheel, passive_param);\n  } else {\n    window.addEventListener('DOMMouseScroll', onWheel, false);\n    window.addEventListener('mousewheel', onWheel, false);\n  }\n\n  window.addEventListener('blur', onBlurOrFocus, false);\n  window.addEventListener('focus', onBlurOrFocus, false);\n\n  canvas.addEventListener('touchstart', onTouchChange, passive_param);\n  canvas.addEventListener('touchmove', onTouchChange, passive_param);\n  canvas.addEventListener('touchend', onTouchChange, passive_param);\n  canvas.addEventListener('touchcancel', onTouchChange, passive_param);\n\n  // For iOS, this is needed in test_fullscreen, but not here, for some reason\n  //window.addEventListener('gesturestart', ignored, false);\n\n  window.addEventListener('beforeunload', beforeUnload, false);\n}\n\nconst DEADZONE = 0.26;\nconst DEADZONE_SQ = DEADZONE * DEADZONE;\nconst NUM_STICKS = 2;\nconst PAD_THRESHOLD = 0.25; // for turning analog motion into digital events\n\nfunction getGamepadData(idx) {\n  let gpd = gamepad_data[idx];\n  if (!gpd) {\n    gpd = gamepad_data[idx] = {\n      id: idx,\n      timestamp: 0,\n      sticks: new Array(NUM_STICKS)\n    };\n    for (let ii = 0; ii < NUM_STICKS; ++ii) {\n      gpd.sticks[ii] = vec2();\n    }\n    pad_states[idx] = {};\n  }\n  return gpd;\n}\n\nfunction updatePadState(gpd, ps, b, padcode) {\n  if (b && !ps[padcode]) {\n    ps[padcode] = DOWN_EDGE;\n    if (!pad_mode) {\n      local_storage.setJSON('pad_mode', true);\n      pad_mode = true;\n    }\n    if (padcode === pad_to_touch) {\n      let touch_id = `g${gpd.id}`;\n      if (touches[touch_id]) {\n        setMouseToMid();\n        v2copy(touches[touch_id].start_pos, mouse_pos);\n      } else {\n        touches[touch_id] = new TouchData(mouse_pos, false, 0, null);\n      }\n      touches[touch_id].down(null, true);\n    }\n  } else if (!b && ps[padcode]) {\n    ps[padcode] = UP_EDGE;\n    if (padcode === pad_to_touch) {\n      let touch_id = `g${gpd.id}`;\n      let touch_data = touches[touch_id];\n      if (touch_data) {\n        setMouseToMid();\n        v2copy(touch_data.cur_pos, mouse_pos);\n        touch_data.up_edge++;\n        touch_data.state = UP;\n        touch_data.down_time += max(engine.hrtime - touch_data.origin_time, MIN_EVENT_TIME_DELTA);\n      }\n    }\n  }\n}\n\nfunction gamepadUpdate() {\n  let gamepads = navigator.gamepads || navigator.webkitGamepads || navigator.getGamepads && navigator.getGamepads() || navigator.webkitGetGamepads && navigator.webkitGetGamepads();\n\n  if (gamepads) {\n    let numGamePads = gamepads.length;\n    for (let ii = 0; ii < numGamePads; ii++) {\n      let gamepad = gamepads[ii];\n      if (!gamepad) {\n        continue;\n      }\n      let gpd = getGamepadData(ii);\n      let ps = pad_states[ii];\n      // Update button states\n      if (gpd.timestamp < gamepad.timestamp) {\n        let buttons = gamepad.buttons;\n        gpd.timestamp = gamepad.timestamp;\n\n        let numButtons = buttons.length;\n        for (let n = 0; n < numButtons; n++) {\n          let value = buttons[n];\n          if (typeof value === 'object') {\n            value = value.value;\n          }\n          value = value > 0.5;\n          updatePadState(gpd, ps, value, n);\n        }\n      }\n\n      // Update axes states\n      let axes = gamepad.axes;\n      if (axes.length >= NUM_STICKS * 2) {\n        for (let n = 0; n < NUM_STICKS; ++n) {\n          let pair = gpd.sticks[n];\n          v2set(pair, axes[n * 2], -axes[n * 2 + 1]);\n          let magnitude = v2lengthSq(pair);\n          if (magnitude > DEADZONE_SQ) {\n            magnitude = sqrt(magnitude);\n\n            // Normalize lX and lY\n            v2scale(pair, pair, 1 / magnitude);\n\n            // Clip the magnitude at its max possible value\n            magnitude = min(magnitude, 1);\n\n            // Adjust magnitude relative to the end of the dead zone\n            magnitude = (magnitude - DEADZONE) / (1 - DEADZONE);\n\n            v2scale(pair, pair, magnitude);\n          } else {\n            v2set(pair, 0, 0);\n          }\n\n          // Apply \"movement\" to drag events\n          if (n <= 1 && pad_to_touch !== undefined) {\n            let touch_data = touches[`g${gpd.id}`];\n            if (touch_data) {\n              v2scale(temp_delta, pair, engine.this_frame_time);\n              v2add(touch_data.delta, touch_data.delta, temp_delta);\n              touch_data.total += abs(temp_delta[0]) + abs(temp_delta[1]);\n              setMouseToMid();\n              v2copy(touch_data.cur_pos, mouse_pos);\n            }\n          }\n        }\n\n        // Calculate virtual directional buttons\n        updatePadState(gpd, ps, gpd.sticks[0][0] < -PAD_THRESHOLD, PAD.ANALOG_LEFT);\n        updatePadState(gpd, ps, gpd.sticks[0][0] > PAD_THRESHOLD, PAD.ANALOG_RIGHT);\n        updatePadState(gpd, ps, gpd.sticks[0][1] < -PAD_THRESHOLD, PAD.ANALOG_DOWN);\n        updatePadState(gpd, ps, gpd.sticks[0][1] > PAD_THRESHOLD, PAD.ANALOG_UP);\n      }\n    }\n  }\n}\n\nexport function tickInput() {\n  // browser frame has occurred since the call to endFrame(),\n  // we should now have `touches` and `key_state` populated with edge events\n  if (movement_questionable_frames) {\n    --movement_questionable_frames;\n  }\n\n  // update timing of key down states\n  let hrtime = engine.hrtime;\n  for (let code in key_state_new) {\n    let ks = key_state_new[code];\n    if (ks.state === DOWN) {\n      ks.down_time += max(hrtime - ks.origin_time, MIN_EVENT_TIME_DELTA);\n      // assert(hrtime >= ks.origin_time); - should be true, but often isn't\n      ks.origin_time = hrtime;\n    }\n  }\n\n  for (let touch_id in touches) {\n    let touch_data = touches[touch_id];\n    if (touch_data.state === DOWN) {\n      touch_data.down_time += max(hrtime - touch_data.origin_time, MIN_EVENT_TIME_DELTA);\n      // assert(hrtime >= touch_data.origin_time); - should be true, but often isn't\n      touch_data.origin_time = hrtime;\n    }\n  }\n\n  mouse_over_captured = false;\n  gamepadUpdate();\n  in_event.topOfFrame();\n  if (touches[pointerlock_touch_id] && !pointerLocked()) {\n    pointerLockExit();\n  }\n}\n\nfunction endFrameTickMap(map) {\n  Object.keys(map).forEach(keycode => {\n    switch (map[keycode]) {\n      case DOWN_EDGE:\n        map[keycode] = DOWN;\n        break;\n      case UP_EDGE:\n        delete map[keycode];\n        break;\n      default:\n    }\n  });\n}\nexport function endFrame(skip_mouse) {\n  for (let code in key_state_new) {\n    let ks = key_state_new[code];\n    if (ks.state === UP) {\n      key_state_new[code] = null;\n      delete key_state_new[code];\n    } else {\n      ks.up_edge = 0;\n      ks.down_edge = 0;\n      ks.down_time = 0;\n    }\n  }\n\n  pad_states.forEach(endFrameTickMap);\n  if (!skip_mouse) {\n    for (let touch_id in touches) {\n      let touch_data = touches[touch_id];\n      if (touch_data.state === UP) {\n        // Manually null out touches[touch_id] - some Chrome optimizer bug causes\n        // callers to later get this old value (instead of the newly added on with\n        // the same ID) unless we null it out (then they seem to get the new one).\n        touches[touch_id] = null;\n        delete touches[touch_id];\n      } else {\n        touch_data.delta[0] = touch_data.delta[1] = 0;\n        touch_data.dispatched = false;\n        touch_data.dispatched_drag_over = false;\n        touch_data.up_edge = 0;\n        touch_data.down_edge = 0;\n        touch_data.down_time = 0;\n      }\n    }\n    mouse_wheel = 0;\n    input_eaten_mouse = false;\n  }\n  input_eaten_kb = false;\n  mouse_moved = false;\n}\n\nexport function eatAllInput(skip_mouse) {\n  // destroy touches, remove all down and up edges\n  endFrame(skip_mouse);\n  if (!skip_mouse) {\n    mouse_over_captured = true;\n    input_eaten_mouse = true;\n  }\n  input_eaten_kb = true;\n}\n\nexport function eatAllKeyboardInput() {\n  eatAllInput(true);\n}\n\n// returns position mapped to current camera view\nexport function mousePos(dst) {\n  dst = dst || vec2();\n  camera2d.domToVirtual(dst, mouse_pos);\n  return dst;\n}\n\nexport function mouseMoved() {\n  return mouse_moved;\n}\n\nexport function mouseWheel() {\n  let ret = mouse_wheel;\n  mouse_wheel = 0;\n  return ret;\n}\n\nfunction mousePosParam(param) {\n  param = param || {};\n  return {\n    x: param.x === undefined ? camera2d.x0Real() : param.x,\n    y: param.y === undefined ? camera2d.y0Real() : param.y,\n    w: param.w === undefined ? camera2d.wReal() : param.w,\n    h: param.h === undefined ? camera2d.hReal() : param.h,\n    button: param.button === undefined ? ANY : param.button\n  };\n}\n\nlet check_pos = vec2();\nfunction checkPos(pos, param) {\n  camera2d.domToVirtual(check_pos, pos);\n  return check_pos[0] >= param.x && (param.w === Infinity || check_pos[0] < param.x + param.w) && check_pos[1] >= param.y && (param.h === Infinity || check_pos[1] < param.y + param.h);\n}\n\nexport function mouseOver(param) {\n  if (mouse_over_captured || pointerLocked()) {\n    return false;\n  }\n  param = param || {};\n  let pos_param = mousePosParam(param);\n\n  // eat mouse up/down/drag events\n  if (!param.peek) {\n    for (let id in touches) {\n      let touch = touches[id];\n      if (checkPos(touch.cur_pos, pos_param)) {\n        touch.down_edge = 0;\n        touch.up_edge = 0;\n        if (!param || !param.drag_target) {\n          touch.dispatched = true;\n        }\n      }\n    }\n  }\n\n  if (checkPos(mouse_pos, pos_param)) {\n    if (!param.peek) {\n      mouse_over_captured = true;\n    }\n    return true;\n  }\n  return false;\n}\n\nexport function mouseDown(button) {\n  if (button === ANY) {\n    return mouseDown(0) || mouseDown(2);\n  }\n  button = button || 0;\n  return !input_eaten_mouse && mouse_down[button];\n}\n\nexport function mousePosIsTouch() {\n  return mouse_pos_is_touch;\n}\n\nexport function isTouchDown(param) {\n  if (input_eaten_mouse) {\n    return false;\n  }\n  let pos_param = mousePosParam(param);\n  for (let id in touches) {\n    let touch = touches[id];\n    if (checkPos(touch.cur_pos, pos_param)) {\n      return check_pos.slice(0);\n    }\n  }\n  return false;\n}\n\nexport function numTouches() {\n  return Object.keys(touches).length;\n}\n\nexport function keyDown(keycode) {\n  if (input_eaten_kb) {\n    return 0;\n  }\n  let ks = key_state_new[keycode];\n  if (!ks) {\n    return 0;\n  }\n  if (ks.state === DOWN) {\n    assert(ks.down_time); // Will fire if we call keyDown() before tickInput()\n  }\n  return ks.down_time;\n}\nexport function keyDownEdge(keycode, opts) {\n  if (opts && opts.in_event_cb && !input_eaten_kb) {\n    in_event.on('keydown', keycode, opts.in_event_cb);\n  }\n\n  let ks = key_state_new[keycode];\n  if (!ks) {\n    return 0;\n  }\n  let r = ks.down_edge;\n  ks.down_edge = 0;\n  return r;\n}\nexport function keyUpEdge(keycode, opts) {\n  if (opts && opts.in_event_cb && !input_eaten_kb) {\n    in_event.on('keyup', keycode, opts.in_event_cb);\n  }\n\n  let ks = key_state_new[keycode];\n  if (!ks) {\n    return 0;\n  }\n  let r = ks.up_edge;\n  ks.up_edge = 0;\n  return r;\n}\n\nexport function padGetAxes(out, stickindex, padindex) {\n  assert(stickindex >= 0 && stickindex < NUM_STICKS);\n  if (padindex === undefined) {\n    let sub = vec2();\n    v2set(out, 0, 0);\n    for (let ii = 0; ii < gamepad_data.length; ++ii) {\n      padGetAxes(sub, stickindex, ii);\n      v2add(out, out, sub);\n    }\n    return;\n  }\n  let sticks = getGamepadData(padindex).sticks;\n  v2copy(out, sticks[stickindex]);\n}\n\nfunction padButtonDownInternal(gpd, ps, padcode) {\n  if (ps[padcode]) {\n    return engine.this_frame_time;\n  }\n  return 0;\n}\nfunction padButtonDownEdgeInternal(gpd, ps, padcode) {\n  if (ps[padcode] === DOWN_EDGE) {\n    ps[padcode] = DOWN;\n    return engine.this_frame_time;\n  }\n  return 0;\n}\nfunction padButtonUpEdgeInternal(gpd, ps, padcode) {\n  if (ps[padcode] === UP_EDGE) {\n    delete ps[padcode];\n    return engine.this_frame_time;\n  }\n  return 0;\n}\n\nfunction padButtonShared(fn, padcode, padindex) {\n  assert(padcode !== undefined);\n  let r = 0;\n  // Handle calling without a specific pad index\n  if (padindex === undefined) {\n    for (let ii = 0; ii < pad_states.length; ++ii) {\n      r += padButtonShared(fn, padcode, ii);\n    }\n    return r;\n  }\n\n  if (input_eaten_mouse) {\n    return 0;\n  }\n  let gpd = gamepad_data[padindex];\n  if (!gpd) {\n    return 0;\n  }\n  let ps = pad_states[padindex];\n\n  r += ANALOG_MAP[padcode] && fn(gpd, ps, ANALOG_MAP[padcode]) || 0;\n  r += fn(gpd, ps, padcode);\n  return r;\n}\nexport function padButtonDown(padcode, padindex) {\n  return padButtonShared(padButtonDownInternal, padcode, padindex);\n}\nexport function padButtonDownEdge(padcode, padindex) {\n  return padButtonShared(padButtonDownEdgeInternal, padcode, padindex);\n}\nexport function padButtonUpEdge(padcode, padindex) {\n  return padButtonShared(padButtonUpEdgeInternal, padcode, padindex);\n}\n\nlet start_pos = vec2();\nlet cur_pos = vec2();\nlet delta = vec2();\n\nexport function mouseUpEdge(param) {\n  param = param || {};\n  let pos_param = mousePosParam(param);\n  let button = pos_param.button;\n  let max_click_dist = param.max_dist || 50; // TODO: relative to camera distance?\n\n  for (let touch_id in touches) {\n    let touch_data = touches[touch_id];\n    if (!touch_data.up_edge || !(button === ANY || button === touch_data.button) || touch_data.total > max_click_dist) {\n      continue;\n    }\n    if (checkPos(touch_data.cur_pos, pos_param)) {\n      if (!param.peek) {\n        touch_data.up_edge = 0;\n      }\n      return {\n        button: touch_data.button,\n        pos: check_pos.slice(0),\n        start_time: touch_data.start_time\n      };\n    }\n  }\n\n  if (param.in_event_cb && !input_eaten_mouse && !mouse_over_captured) {\n    // TODO: Maybe need to also pass along earlier exclusions?  Working okay for now though.\n    if (!param.phys) {\n      param.phys = {};\n    }\n    param.phys.button = typeof param.in_event_button === 'number' ? param.in_event_button : button;\n    camera2d.virtualToDomPosParam(param.phys, pos_param);\n    in_event.on('mouseup', param.phys, param.in_event_cb);\n  }\n  return false;\n}\nexports.click = mouseUpEdge;\n\nexport function mouseDownEdge(param) {\n  param = param || {};\n  let pos_param = mousePosParam(param);\n  let button = pos_param.button;\n\n  for (let touch_id in touches) {\n    let touch_data = touches[touch_id];\n    if (!touch_data.down_edge || !(button === ANY || button === touch_data.button)) {\n      continue;\n    }\n    if (checkPos(touch_data.cur_pos, pos_param)) {\n      if (!param.peek) {\n        touch_data.down_edge = 0;\n      }\n      return {\n        button: touch_data.button,\n        pos: check_pos.slice(0),\n        start_time: touch_data.start_time\n      };\n    }\n  }\n\n  if (param.in_event_cb && !input_eaten_mouse && !mouse_over_captured) {\n    // TODO: Maybe need to also pass along earlier exclusions?  Working okay for now though.\n    if (!param.phys) {\n      param.phys = {};\n    }\n    param.phys.button = button;\n    camera2d.virtualToDomPosParam(param.phys, pos_param);\n    in_event.on('mousedown', param.phys, param.in_event_cb);\n  }\n  return false;\n}\n\n// Completely consume any clicks or drags coming from a mouse down event in this\n// area - used to catch focus leaving an edit box without wanting to do what\n// a click would normally do.\nexport function mouseConsumeClicks(param) {\n  param = param || {};\n  let pos_param = mousePosParam(param);\n  let button = pos_param.button;\n  for (let touch_id in touches) {\n    let touch_data = touches[touch_id];\n    if (!(button === ANY || button === touch_data.button)) {\n      continue;\n    }\n    if (checkPos(touch_data.start_pos, pos_param)) {\n      touch_data.down_edge = 0;\n      // Set start pos so that it will not pass checkPos\n      touch_data.start_pos[0] = touch_data.start_pos[1] = Infinity;\n      // Set .total so that mouseUpEdge will not detect it as a click\n      touch_data.total = Infinity;\n    }\n  }\n}\n\nexport function drag(param) {\n  param = param || {};\n  let pos_param = mousePosParam(param);\n  let button = pos_param.button;\n  let min_dist = param.min_dist || 0;\n\n  for (let touch_id in touches) {\n    let touch_data = touches[touch_id];\n    if (!(button === ANY || button === touch_data.button) || touch_data.dispatched) {\n      continue;\n    }\n    if (checkPos(touch_data.start_pos, pos_param)) {\n      camera2d.domDeltaToVirtual(delta, [touch_data.total / 2, touch_data.total / 2]);\n      let total = delta[0] + delta[1];\n      if (total < min_dist) {\n        continue;\n      }\n      if (!param.peek) {\n        touch_data.dispatched = true;\n      }\n      let is_down_edge = touch_data.down_edge;\n      if (param.eat_clicks) {\n        touch_data.down_edge = touch_data.up_edge = 0;\n      }\n      if (param.payload) {\n        touch_data.drag_payload = param.payload;\n      }\n      camera2d.domToVirtual(start_pos, touch_data.start_pos);\n      camera2d.domToVirtual(cur_pos, touch_data.cur_pos);\n      camera2d.domDeltaToVirtual(delta, touch_data.delta);\n      return {\n        cur_pos,\n        start_pos,\n        delta, // this frame's delta\n        total, // total (linear) distance dragged\n        button: touch_data.button,\n        touch: touch_data.touch,\n        start_time: touch_data.start_time,\n        is_down_edge,\n        down_time: touch_data.down_time\n      };\n    }\n  }\n  return null;\n}\n\n// a lot like drag(), refactor to share more?\nexport function longPress(param) {\n  param = param || {};\n  let pos_param = mousePosParam(param);\n  let button = pos_param.button;\n  let max_dist = param.max_dist || 0;\n  let min_time = param.min_time || 500;\n\n  for (let touch_id in touches) {\n    let touch_data = touches[touch_id];\n    if (!(button === ANY || button === touch_data.button) || touch_data.long_press_dispatched) {\n      continue;\n    }\n    if (checkPos(touch_data.start_pos, pos_param)) {\n      camera2d.domDeltaToVirtual(delta, [touch_data.total / 2, touch_data.total / 2]);\n      let total = delta[0] + delta[1];\n      if (total > max_dist) {\n        continue;\n      }\n      let time = Date.now() - touch_data.start_time;\n      if (time < min_time) {\n        continue;\n      }\n      if (!param.peek) {\n        // ? touch_data.dispatched = true;\n        touch_data.long_press_dispatched = true;\n      }\n      let is_down_edge = touch_data.down_edge;\n      if (param.eat_clicks) {\n        touch_data.down_edge = touch_data.up_edge = 0;\n      }\n      camera2d.domToVirtual(start_pos, touch_data.start_pos);\n      camera2d.domToVirtual(cur_pos, touch_data.cur_pos);\n      camera2d.domDeltaToVirtual(delta, touch_data.delta);\n      return {\n        long_press: true,\n        cur_pos,\n        start_pos,\n        delta, // this frame's delta\n        total, // total (linear) distance dragged\n        button: touch_data.button,\n        touch: touch_data.touch,\n        start_time: touch_data.start_time,\n        is_down_edge,\n        down_time: touch_data.down_time\n      };\n    }\n  }\n  return null;\n}\n\nexport function dragDrop(param) {\n  param = param || {};\n  let pos_param = mousePosParam(param);\n  let button = pos_param.button;\n\n  for (let touch_id in touches) {\n    let touch_data = touches[touch_id];\n    // Maybe touch_data.dispatched_drag_over instead/as well?\n    if (!(button === ANY || button === touch_data.button) || touch_data.dispatched || !touch_data.drag_payload) {\n      continue;\n    }\n    if (!touch_data.up_edge) {\n      continue;\n    }\n    if (checkPos(touch_data.cur_pos, pos_param)) {\n      if (!param.peek) {\n        // Maybe touch_data.dispatched_drag_over as well?\n        touch_data.dispatched = true;\n      }\n      return { drag_payload: touch_data.drag_payload };\n    }\n  }\n  return null;\n}\n\nexport function dragOver(param) {\n  param = param || {};\n  let pos_param = mousePosParam(param);\n  let button = pos_param.button;\n\n  for (let touch_id in touches) {\n    let touch_data = touches[touch_id];\n    if (!(button === ANY || button === touch_data.button) || touch_data.dispatched || touch_data.dispatched_drag_over || // Maybe not .dispatched?\n    !touch_data.drag_payload) {\n      continue;\n    }\n    if (touch_data.state !== DOWN) {\n      continue;\n    }\n    if (checkPos(touch_data.cur_pos, pos_param)) {\n      // Separate 'dispatched' for dragOver (target) and drag (source) - they both need one dispatch per frame\n      if (!param.peek) {\n        touch_data.dispatched_drag_over = true;\n      }\n      camera2d.domToVirtual(cur_pos, touch_data.cur_pos);\n      return {\n        cur_pos,\n        drag_payload: touch_data.drag_payload\n      };\n    }\n  }\n  return null;\n}","// Portions Copyright 2020 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst engine = require('./engine.js');\nconst camera2d = require('./camera2d.js');\nconst in_event = require('./in_event.js');\nconst input = require('./input.js');\nconst ui = require('./ui.js');\n\nlet state_cache = {};\nlet good_url = /https?:\\/\\//;\n\n// Create an invisible A elem in the DOM so we get all of the good browsery\n// behavior for a link area.\nexport function link(param) {\n  let { x, y, w, h, url, internal, allow_modal } = param;\n  if (!url.match(good_url)) {\n    url = `${document.location.protocol}//${url}`;\n  }\n  let key = `${x}_${y}`;\n  let state = state_cache[key];\n  if (!state) {\n    state = state_cache[key] = { clicked: false };\n  }\n  let elem = ui.getElem(allow_modal, state.elem);\n  state.frame = engine.global_frame_index;\n  if (elem !== state.elem) {\n    state.elem = elem;\n    if (elem) {\n      // new DOM element, initialize\n      elem.textContent = '';\n      let a_elem = document.createElement('a');\n      a_elem.setAttribute('draggable', false);\n      a_elem.textContent = ' ';\n      a_elem.className = 'glovui_link noglov';\n      a_elem.setAttribute('target', '_blank');\n      a_elem.setAttribute('href', url);\n      state.url = url;\n      if (internal) {\n        a_elem.onclick = function (ev) {\n          ev.preventDefault();\n          state.clicked = true;\n          in_event.handle('mouseup', ev);\n        };\n      }\n      elem.appendChild(a_elem);\n      state.a_elem = a_elem;\n    }\n  }\n  if (elem) {\n    if (url !== state.url) {\n      state.a_elem.setAttribute('href', url);\n      state.url = url;\n    }\n\n    let pos = camera2d.htmlPos(x, y);\n    elem.style.left = `${pos[0]}%`;\n    elem.style.top = `${pos[1]}%`;\n    let size = camera2d.htmlSize(w, h);\n    elem.style.width = `${size[0]}%`;\n    elem.style.height = `${size[1]}%`;\n  }\n  let clicked = state.clicked;\n  state.clicked = false;\n  return clicked;\n}\n\nexport function linkText(param) {\n  let { style_link, style_link_hover, x, y, z, font_size, text } = param;\n  // Also: any parameter to link(), e.g. url\n  let w = ui.font.getStringWidth(style_link, font_size, text);\n  let h = font_size;\n  let mouseover = input.mouseOver({ x, y, w, h, peek: true }) && !input.mousePosIsTouch();\n  let style = mouseover ? style_link_hover : style_link;\n  ui.font.drawSized(style, x, y, z, font_size, text);\n  let underline_w = 1;\n  ui.drawLine(x, y + h - underline_w, x + w, y + h - underline_w, z - 0.5, underline_w, 0.99, style.color_vec4);\n  param.w = w;\n  param.h = h;\n  return link(param);\n}\n\nexport function linkTick() {\n  for (let key in state_cache) {\n    let state = state_cache[key];\n    if (state.frame !== engine.global_frame_index - 1) {\n      delete state_cache[key];\n    }\n  }\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint-env browser */\n\nexports.storage_prefix = 'demo';\n\nlet lsd = function () {\n  try {\n    localStorage.test = 'test';\n    return localStorage;\n  } catch (e) {\n    return {};\n  }\n}();\nexport function get(key) {\n  key = `${exports.storage_prefix}_${key}`;\n  let ret = lsd[key];\n  if (ret === 'undefined') {\n    ret = undefined;\n  }\n  return ret;\n}\n\nexport function set(key, value) {\n  key = `${exports.storage_prefix}_${key}`;\n  if (value === undefined || value === null) {\n    delete lsd[key];\n  } else {\n    lsd[key] = value;\n  }\n}\n\nexport function setJSON(key, value) {\n  set(key, JSON.stringify(value));\n}\n\nexport function getJSON(key, def) {\n  let value = get(key);\n  if (value === undefined) {\n    return def;\n  }\n  try {\n    return JSON.parse(value);\n  } catch (e) {\n    // ignore\n  }\n  return def;\n}\n\nexport function clearAll(key_prefix) {\n  let prefix = new RegExp(`^${exports.storage_prefix}_${key_prefix || ''}`, 'u');\n  for (let key in lsd) {\n    if (key.match(prefix)) {\n      delete lsd[key];\n    }\n  }\n}\n\nexport function exportAll() {\n  let obj = {};\n  let prefix = new RegExp(`^${exports.storage_prefix}_(.*)`, 'u');\n  for (let key in lsd) {\n    let m = key.match(prefix);\n    if (m) {\n      let v = lsd[key];\n      if (v && v !== 'undefined') {\n        obj[m[1]] = v;\n      }\n    }\n  }\n  return JSON.stringify(obj);\n}\n\nexport function importAll(serialized) {\n  let obj = JSON.parse(serialized);\n  clearAll();\n  for (let key in obj) {\n    set(key, obj[key]);\n  }\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n// Some code from Turbulenz: Copyright (c) 2012-2013 Turbulenz Limited\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nexport function mat43() {\n  let r = new Float32Array(12);\n  r[0] = r[4] = r[8] = 1;\n  return r;\n}\n\nexport function m43identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  out[9] = 0;\n  out[10] = 0;\n  out[11] = 0;\n}\n\nexport function m43mul(out, a, b) {\n  let a0 = a[0];\n  let a1 = a[1];\n  let a2 = a[2];\n  let a3 = a[3];\n  let a4 = a[4];\n  let a5 = a[5];\n  let a6 = a[6];\n  let a7 = a[7];\n  let a8 = a[8];\n  let a9 = a[9];\n  let a10 = a[10];\n  let a11 = a[11];\n\n  let b0 = b[0];\n  let b1 = b[1];\n  let b2 = b[2];\n  let b3 = b[3];\n  let b4 = b[4];\n  let b5 = b[5];\n  let b6 = b[6];\n  let b7 = b[7];\n  let b8 = b[8];\n\n  out[0] = b0 * a0 + b3 * a1 + b6 * a2;\n  out[1] = b1 * a0 + b4 * a1 + b7 * a2;\n  out[2] = b2 * a0 + b5 * a1 + b8 * a2;\n  out[3] = b0 * a3 + b3 * a4 + b6 * a5;\n  out[4] = b1 * a3 + b4 * a4 + b7 * a5;\n  out[5] = b2 * a3 + b5 * a4 + b8 * a5;\n  out[6] = b0 * a6 + b3 * a7 + b6 * a8;\n  out[7] = b1 * a6 + b4 * a7 + b7 * a8;\n  out[8] = b2 * a6 + b5 * a7 + b8 * a8;\n  out[9] = b0 * a9 + b3 * a10 + b6 * a11 + b[9];\n  out[10] = b1 * a9 + b4 * a10 + b7 * a11 + b[10];\n  out[11] = b2 * a9 + b5 * a10 + b8 * a11 + b[11];\n\n  return out;\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint-env browser */\n\n/*\n  Convert models to GLB with:\n  node_modules\\.bin\\gltf-pipeline.cmd -t -i src/client/models/box.gltf -o src/client/models/box.glb\n  // The -t tells it not to embed the textures, but just leave the URIs\n */\n\nconst assert = require('assert');\n\nconst geom = require('./geom.js');\nconst glb_parser = require('./glb/parser.js');\nconst { ATTRIBUTE_TYPE_TO_COMPONENTS } = require('./glb/gltf-type-utils.js');\nconst renderer = require('./engine.js');\nconst shaders = require('./shaders.js');\nconst textures = require('./textures.js');\nconst { vec4 } = require('./vmath.js');\n\nexport let load_count = 0;\n\nlet box_glb = 'glTF\\x02\\0\\0\\0\\xCC\\b\\0\\0h\\x05\\0\\0JSON{\"asset\":{\"generator\":\"COLLADA2GLTF\",\"version\":\"2.0\"},\"scene\":0,\"scenes\":[{\"nodes\":[0]}],\"nodes\":[{\"children\":[1],\"matrix\":[1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]},{\"mesh\":0}],\"meshes\":[{\"primitives\":[{\"attributes\":{\"NORMAL\":1,\"POSITION\":2,\"TEXCOORD_0\":3},\"indices\":0,\"mode\":4,\"material\":0}],\"name\":\"Mesh\"}],\"accessors\":[{\"bufferView\":0,\"byteOffset\":0,\"componentType\":5123,\"count\":36,\"max\":[23],\"min\":[0],\"type\":\"SCALAR\"},{\"bufferView\":1,\"byteOffset\":0,\"componentType\":5126,\"count\":24,\"max\":[1,1,1],\"min\":[-1,-1,-1],\"type\":\"VEC3\"},{\"bufferView\":1,\"byteOffset\":288,\"componentType\":5126,\"count\":24,\"max\":[0.5,0.5,0.5],\"min\":[-0.5,-0.5,-0.5],\"type\":\"VEC3\"},{\"bufferView\":2,\"byteOffset\":0,\"componentType\":5126,\"count\":24,\"max\":[6,1],\"min\":[0,0],\"type\":\"VEC2\"}],\"materials\":[{\"pbrMetallicRoughness\":{\"baseColorTexture\":{\"index\":0,\"texCoord\":0},\"metallicFactor\":0,\"baseColorFactor\":[1,1,1,1],\"roughnessFactor\":1},\"name\":\"Texture\",\"emissiveFactor\":[0,0,0],\"alphaMode\":\"OPAQUE\",\"doubleSided\":false}],\"textures\":[{\"sampler\":0,\"source\":0}],\"samplers\":[{\"magFilter\":9729,\"minFilter\":9986,\"wrapS\":10497,\"wrapT\":10497}],\"bufferViews\":[{\"buffer\":0,\"byteOffset\":0,\"byteLength\":72,\"target\":34963},{\"buffer\":0,\"byteOffset\":72,\"byteLength\":576,\"byteStride\":12,\"target\":34962},{\"buffer\":0,\"byteOffset\":648,\"byteLength\":192,\"byteStride\":8,\"target\":34962}],\"buffers\":[{\"name\":\"box_textured\",\"byteLength\":840}]}H\\x03\\0\\0BIN\\0\\0\\0\\x01\\0\\x02\\0\\x03\\0\\x02\\0\\x01\\0\\x04\\0\\x05\\0\\x06\\0\\x07\\0\\x06\\0\\x05\\0\\b\\0\\t\\0\\n\\0\\x0B\\0\\n\\0\\t\\0\\f\\0\\r\\0\\x0E\\0\\x0F\\0\\x0E\\0\\r\\0\\x10\\0\\x11\\0\\x12\\0\\x13\\0\\x12\\0\\x11\\0\\x14\\0\\x15\\0\\x16\\0\\x17\\0\\x16\\0\\x15\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\x80\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\0\\xBF\\0\\0\\0?\\0\\0\\0?\\0\\0\\0\\xBF\\0\\0\\xC0@\\0\\0\\0\\0\\0\\0\\xA0@\\0\\0\\0\\0\\0\\0\\xC0@\\xFE\\xFF\\x7F?\\0\\0\\xA0@\\xFE\\xFF\\x7F?\\0\\0\\x80@\\0\\0\\0\\0\\0\\0\\xA0@\\0\\0\\0\\0\\0\\0\\x80@\\0\\0\\x80?\\0\\0\\xA0@\\0\\0\\x80?\\0\\0\\0@\\0\\0\\0\\0\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0@\\0\\0\\x80?\\0\\0\\x80?\\0\\0\\x80?\\0\\0@@\\0\\0\\0\\0\\0\\0\\x80@\\0\\0\\0\\0\\0\\0@@\\0\\0\\x80?\\0\\0\\x80@\\0\\0\\x80?\\0\\0@@\\0\\0\\0\\0\\0\\0\\0@\\0\\0\\0\\0\\0\\0@@\\0\\0\\x80?\\0\\0\\0@\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\xFE\\xFF\\x7F?\\0\\0\\x80?\\0\\0\\0\\0\\0\\0\\x80?\\xFE\\xFF\\x7F?';\n{\n  let arr = new Uint8Array(box_glb.length);\n  for (let ii = 0; ii < box_glb.length; ++ii) {\n    arr[ii] = box_glb.charCodeAt(ii);\n  }\n  box_glb = arr.buffer;\n}\n\nexport let models = {};\n\nexport let default_vshader;\nexport let default_fshader;\n\nfunction initShaders() {\n  default_vshader = shaders.create('glov/shaders/default.vp');\n  default_fshader = shaders.create('glov/shaders/default.fp');\n}\n\nfunction Model(url) {\n  this.url = url;\n  let idx = url.lastIndexOf('/');\n  if (idx !== -1) {\n    this.base_url = url.slice(0, idx + 1);\n  } else {\n    this.base_url = '';\n  }\n}\n\nModel.prototype.load = function () {\n  ++load_count;\n  let xhr = new XMLHttpRequest();\n  xhr.open('GET', this.url, true);\n  xhr.responseType = 'arraybuffer';\n  xhr.onload = () => {\n    --load_count;\n    try {\n      let array_buffer = xhr.response; // Note: not xhr.responseText\n      if ((xhr.status === 200 || xhr.status === 0) && array_buffer) {\n        this.parse(array_buffer);\n      }\n    } catch (e) {\n      window.onerror('Model loading error', 'models.js', 0, 0, e);\n    }\n  };\n  xhr.send(null);\n};\n\nconst skip_attr = {\n  'TANGENT': true\n};\n\nModel.prototype.parse = function (glb_data) {\n  let glb = glb_parser.parse(glb_data);\n  if (!glb) {\n    return;\n  }\n  // Make Geoms for each primitives within each mesh\n  let glb_json = glb.getJSON();\n  let objs = [];\n  for (let ii = 0; ii < glb_json.meshes.length; ++ii) {\n    let mesh = glb_json.meshes[ii];\n    for (let jj = 0; jj < mesh.primitives.length; ++jj) {\n      let primitives = mesh.primitives[jj];\n      let material = glb_json.materials[primitives.material];\n      let texture = null;\n      if (material) {\n        // Just grabbing the base color texture, nothing else\n        let bct = (material.pbrMetallicRoughness || {}).baseColorTexture || {};\n        let texture_def = glb_json.textures && glb_json.textures[bct.index] || {};\n        let sampler_def = glb_json.samplers && glb_json.samplers[texture_def.sampler] || {};\n        let image = glb_json.images && glb_json.images[texture_def.source] || {};\n        if (image.uri) {\n          let params = {\n            url: `${this.base_url}${image.uri}`,\n            filter_mag: sampler_def.magFilter,\n            filter_min: sampler_def.minFilter,\n            wrap_s: sampler_def.wrapS,\n            wrap_t: sampler_def.wrapT\n          };\n          texture = textures.load(params);\n        }\n      }\n      let format = [];\n      let buffers = [];\n      let bidx = [];\n      let total_size = 0;\n      let vert_count = 0;\n      for (let attr in primitives.attributes) {\n        if (skip_attr[attr]) {\n          continue;\n        }\n        assert(shaders.semantic[attr] !== undefined);\n        let accessor = glb_json.accessors[primitives.attributes[attr]];\n        assert.equal(accessor.componentType, 5126); // F32\n        let geom_format = gl.FLOAT;\n        let geom_count = ATTRIBUTE_TYPE_TO_COMPONENTS[accessor.type];\n        assert(geom_count);\n        let my_vert_count = accessor.count /* / geom_count*/;\n        if (!vert_count) {\n          vert_count = my_vert_count;\n        } else {\n          assert.equal(vert_count, my_vert_count);\n        }\n        format.push([shaders.semantic[attr], geom_format, geom_count]);\n        let buffer = glb.getBuffer(accessor);\n        buffers.push(buffer);\n        bidx.push(0);\n        total_size += buffer.length;\n      }\n      // Interleave\n      let verts = new Float32Array(total_size);\n      let idx = 0;\n      for (let vert = 0; vert < vert_count; ++vert) {\n        for (let attr = 0; attr < format.length; ++attr) {\n          for (let kk = 0; kk < format[attr][2]; ++kk) {\n            verts[idx++] = buffers[attr][bidx[attr]++];\n          }\n        }\n      }\n      // Get indices\n      let accessor = glb_json.accessors[primitives.indices];\n      assert(accessor); // must be an indexed primitive set\n      assert.equal(accessor.type, 'SCALAR');\n      let idxs = glb.getBuffer(accessor);\n      if (accessor.componentType === 5125) {\n        // Uint32\n        assert(vert_count < 65536); // Fits in 16-bits\n        // Just convert to 16-bit\n        idxs = new Uint16Array(idxs);\n      } else {\n        assert.equal(accessor.componentType, 5123); // Uint16\n      }\n      objs.push({\n        geom: geom.create(format, verts, idxs, primitives.mode),\n        texture\n      });\n    }\n  }\n  // TODO: Something with nodes to tie together and position the meshes\n  this.data = {\n    objs\n    // glb, - Don't keep this, release it and any unreferenced data/buffers\n  };\n};\n\nModel.prototype.draw = function (mat) {\n  renderer.updateMatrices(mat); // before setting shader\n  shaders.bind(default_vshader, default_fshader, {\n    color: vec4(1, 1, 1, 1)\n  });\n  let objs = this.data.objs;\n  for (let ii = 0; ii < objs.length; ++ii) {\n    let obj = objs[ii];\n    if (obj.texture) {\n      textures.bind(0, obj.texture);\n    }\n    obj.geom.draw();\n  }\n};\n\n// Just draw the geometry, without any other binding\nModel.prototype.drawGeom = function () {\n  let objs = this.data.objs;\n  for (let ii = 0; ii < objs.length; ++ii) {\n    let obj = objs[ii];\n    obj.geom.draw();\n  }\n};\n\nexport function load(url) {\n  if (models[url]) {\n    return models[url];\n  }\n  let model = models[url] = new Model(url);\n  model.data = models.box.data; // stub until loaded\n  model.load();\n  return model;\n}\n\nexport function startup() {\n  initShaders();\n  let model_box = models.box = new Model('box');\n  model_box.parse(box_glb);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst { filewatchStartup } = require('./filewatch.js');\nconst packet = require('../../common/packet.js');\nconst subscription_manager = require('./subscription_manager.js');\nconst WSClient = require('./wsclient.js').WSClient;\nconst wscommon = require('../../common/wscommon.js');\n\nlet client;\nlet subs;\n\nexport function init(params) {\n  params = params || {};\n  if (params.pver) {\n    wscommon.PROTOCOL_VERSION = params.pver;\n  }\n  if (String(document.location).match(/^https?:\\/\\/localhost/)) {\n    console.log('PacketDebug: ON');\n    packet.default_flags |= packet.PACKET_DEBUG;\n  }\n  client = new WSClient(params.path);\n  subs = subscription_manager.create(client);\n  subs.auto_create_user = Boolean(params.auto_create_user);\n  window.subs = subs; // for debugging\n  exports.subs = subs;\n  exports.client = client;\n  filewatchStartup(client);\n\n  if (params.engine) {\n    params.engine.addTickFunc(dt => {\n      subs.tick(dt);\n    });\n  }\n}\n\nconst build_timestamp_string = new Date(Number(BUILD_TIMESTAMP)).toISOString().replace('T', ' ').slice(0, -8);\nexport function buildString() {\n  return build_timestamp_string;\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\n//////////////////////////////////////////////////////////////////////////\n// Particle System Spec\n\n/*\n// Definitions\n// value = number or\n// value = [base, add_max] -> generates a number in the range [base, base + add_max)\nlet def_fire = {\n  particles: {\n    fire: {\n      blend: 'additive',\n      texture: 'fire.png',\n      color: [1,1,1,1], // multiplied by animation track, default 1,1,1,1, can be omitted\n      color_track: [ // just values, NOT random range\n        { t: 0.0, v: [1,0.4,0.4,1] },\n        { t: 0.7, v: [1,0,0,1] },\n        { t: 0.9, v: [0.2,0,0,1] },\n        { t: 1.0, v: [0,0,0,1] },\n      ],\n      size: [[32,16], [32,16]], // multiplied by animation track\n      size_track: [ // just values, NOT random range\n        { t: 0.0, v: [1,1] },\n        { t: 0.4, v: [0.5,0.5] },\n        { t: 0.7, v: [1,1] },\n        { t: 1.0, v: [1.5,1.5] },\n      ],\n      accel: [0,0],\n      rot: [0,360], // degrees\n      rot_vel: [10,2], // degrees per second\n      lifespan: [450,0], // milliseconds\n      kill_time_accel: 5,\n    },\n  },\n  emitters: {\n    fire: {\n      particle: 'fire',\n      // Random ranges affect each emitted particle:\n      pos: [[0,28], [0,28]],\n      vel: [0,0],\n      emit_rate: [60,20], // emissions per second\n      // Random ranges only calculated upon instantiation:\n      emit_time: [0,Infinity],\n      emit_initial: 10,\n    },\n  },\n  system_lifespan: Infinity, // must be manually killed\n};\n\n// Usage\nlet system = glov_engine.glov_particles.createSystem(def_fire, [50, 50, Z.PARTICLES]);\nsystem.updatePos(75, 75);\nsystem.killSoft(); // stops emitting and speeds up particles by kill_time_accel\nsystem.killHard(); // immediately stops drawing\n\n*/\n\n//////////////////////////////////////////////////////////////////////////\n// Implementation\n\nconst assert = require('assert');\nconst sprites = require('./sprites.js');\nconst textures = require('./textures.js');\nconst { vec2, v2copy, v2lerp, v2mul } = require('./vmath.js');\nconst { vec3, vec4, v3add, v4copy, v4lerp, v4mul } = require('./vmath.js');\n\nconst blend_map = {\n  alpha: sprites.BLEND_ALPHA,\n  additive: sprites.BLEND_ADDITIVE\n};\n\nexport function preloadParticleData(particle_data) {\n  // Preload all referenced particle textures\n  for (let key in particle_data.defs) {\n    let def = particle_data.defs[key];\n    for (let part_name in def.particles) {\n      let part_def = def.particles[part_name];\n      textures.load({ url: `img/${part_def.texture}.png` });\n    }\n  }\n}\n\n// Expect all values to be a pair of [base, add_max]\nfunction normalizeValue(v) {\n  if (v instanceof Float32Array && v.length >= 2) {\n    return v;\n  } else if (typeof v === 'number') {\n    return vec2(v, 0);\n  } else if (Array.isArray(v) || v instanceof Float32Array) {\n    // already an array, convert to Vec2\n    return vec2(v[0] || 0, v[1] || 0);\n  } else {\n    return assert(false);\n  }\n}\n\nfunction normalizeValueVec(vec, length) {\n  assert(length);\n  assert(Array.isArray(vec));\n  let ret = new Array(length);\n  for (let ii = 0; ii < length; ++ii) {\n    ret[ii] = normalizeValue(vec[ii]);\n  }\n  return ret;\n}\n\nfunction normalizeParticle(def, particle_manager) {\n  if (!def.normalized) {\n    let norm = def.normalized = {\n      blend: blend_map[def.blend] || sprites.BLEND_ALPHA,\n      texture: textures.load({ url: def.texture ? `img/${def.texture}.png` : 'img/glov/util_circle.png' }),\n      color: normalizeValueVec(def.color || [1, 1, 1, 1], 4),\n      color_track: null,\n      size: normalizeValueVec(def.size || [1, 1], 2),\n      size_track: null,\n      accel: normalizeValueVec(def.accel || [0, 0, 0], 3),\n      rot: normalizeValue(def.rot || 0),\n      rot_vel: normalizeValue(def.rot || 0),\n      lifespan: normalizeValue(def.lifespan || 1000),\n      kill_time_accel: normalizeValue(def.kill_time_accel || 1)\n    };\n    assert(norm.kill_time_accel[0] >= 1); // cannot slow down on kill!\n    if (def.color_track && def.color_track.length) {\n      assert(def.color_track.length > 1);\n      norm.color_track = [];\n      for (let ii = 0; ii < def.color_track.length; ++ii) {\n        let e = def.color_track[ii];\n        assert(typeof e.t === 'number');\n        let arr = new Float32Array(5);\n        arr[0] = e.v[0];\n        arr[1] = e.v[1];\n        arr[2] = e.v[2];\n        arr[3] = e.v[3];\n        arr[4] = e.t;\n        norm.color_track.push(arr);\n      }\n    }\n    if (def.size_track && def.size_track.length) {\n      assert(def.size_track.length > 1);\n      norm.size_track = [];\n      for (let ii = 0; ii < def.size_track.length; ++ii) {\n        let e = def.size_track[ii];\n        assert(typeof e.t === 'number');\n        let arr = new Float32Array(3);\n        arr[0] = e.v[0];\n        arr[1] = e.v[1];\n        arr[2] = e.t;\n        norm.size_track.push(arr);\n      }\n    }\n  }\n  return def.normalized;\n}\n\nfunction findParticle(particles, name) {\n  assert(particles[name] !== undefined);\n  return particles[name];\n}\n\nfunction normalizeEmitter(def, part_map) {\n  if (!def.normalized) {\n    def.normalized = {\n      part_idx: findParticle(part_map, def.particle),\n      pos: normalizeValueVec(def.pos || [0, 0, 0], 3),\n      vel: normalizeValueVec(def.vel || [0, 0, 0], 3),\n      emit_rate: normalizeValue(def.emit_rate || 10),\n      emit_time: normalizeValueVec(def.emit_time || [0, Infinity], 2),\n      emit_initial: normalizeValue(def.emit_initial || 1)\n    };\n    // convert particles per second to ms per emission\n    let min = def.normalized.emit_rate[0];\n    let max = def.normalized.emit_rate[0] + def.normalized.emit_rate[1];\n    def.normalized.emit_rate[0] = 1000 / max;\n    def.normalized.emit_rate[1] = 1000 / min;\n    assert(def.normalized.emit_rate[0] > 1); // Not more than 1000 per second, that's ridic'.\n  }\n  return def.normalized;\n}\n\nfunction normalizeDef(def, particle_manager) {\n  if (!def.normalized) {\n    let norm = def.normalized = {\n      system_lifespan: normalizeValue(def.system_lifespan || Infinity),\n      particles: [],\n      emitters: []\n    };\n    let part_map = {};\n    for (let key in def.particles) {\n      part_map[key] = norm.particles.length;\n      norm.particles.push(normalizeParticle(def.particles[key], particle_manager));\n    }\n    for (let key in def.emitters) {\n      norm.emitters.push(normalizeEmitter(def.emitters[key], part_map));\n    }\n  }\n  return def.normalized;\n}\n\nfunction instValue(v) {\n  return v[0] + Math.random() * v[1];\n}\nfunction instValueVec(v) {\n  let ret = new Float32Array(v.length);\n  for (let ii = 0; ii < v.length; ++ii) {\n    ret[ii] = instValue(v[ii]);\n  }\n  return ret;\n}\n\nlet temp_color = vec4();\nlet temp_color2 = vec4();\nlet temp_size = vec2();\nlet temp_size2 = vec2();\n// let temp_pos = v3allocZero();\n\nclass ParticleSystem {\n  constructor(parent, def_in, pos) {\n    assert(pos.length === 3);\n    this.parent = parent;\n    this.def = normalizeDef(def_in, parent);\n    this.system_lifespan = instValue(this.def.system_lifespan);\n    assert(this.system_lifespan > 0);\n    this.age = 0;\n    this.kill_hard = false;\n    this.kill_soft = false;\n    this.pos = vec3(pos[0], pos[1], pos[2]);\n    this.part_sets = [];\n    for (let ii = 0; ii < this.def.particles.length; ++ii) {\n      let def = this.def.particles[ii];\n      let part_set = {\n        def,\n        parts: []\n      };\n      this.part_sets.push(part_set);\n    }\n    this.emitters = [];\n    // Instantiate emitters\n    for (let ii = 0; ii < this.def.emitters.length; ++ii) {\n      let def = this.def.emitters[ii];\n      let emitter = {\n        def,\n        emit_time: instValueVec(def.emit_time),\n        countdown: 0,\n        started: false,\n        stopped: false\n      };\n      this.emitters.push(emitter);\n    }\n    // do initial tick for things that have an emit_time[0] of 0 and have an emit_initial\n    this.tick(0);\n  }\n\n  tickParticle(part, dt) {\n    // eslint-disable-line class-methods-use-this\n    let def = part.def;\n    part.age += dt;\n    let age_norm = part.age / part.lifespan;\n    if (age_norm >= 1) {\n      return true;\n    }\n\n    // Pos, vel - incrementally computed\n    let dts = dt / 1000;\n    part.pos[0] += part.vel[0] * dts;\n    part.pos[1] += part.vel[1] * dts;\n    part.pos[2] += part.vel[2] * dts;\n    part.vel[0] += part.accel[0] * dts;\n    part.vel[1] += part.accel[1] * dts;\n    part.vel[2] += part.accel[2] * dts;\n\n    // Color, size, rot - explicitly computed\n    v4copy(temp_color, part.color, temp_color);\n    if (def.color_track) {\n      if (age_norm < def.color_track[0][4]) {\n        v4mul(temp_color, temp_color, def.color_track[0]);\n      } else if (age_norm >= def.color_track[def.color_track.length - 1][4]) {\n        v4mul(temp_color, temp_color, def.color_track[def.color_track.length - 1]);\n      } else {\n        for (let ii = 0; ii < def.color_track.length - 1; ++ii) {\n          if (age_norm >= def.color_track[ii][4] && age_norm < def.color_track[ii + 1][4]) {\n            let weight = (age_norm - def.color_track[ii][4]) / (def.color_track[ii + 1][4] - def.color_track[ii][4]);\n            v4lerp(temp_color2, weight, def.color_track[ii], def.color_track[ii + 1]);\n            v4mul(temp_color, temp_color, temp_color2);\n            break;\n          }\n        }\n      }\n    }\n\n    v2copy(temp_size, part.size);\n    if (def.size_track) {\n      if (age_norm < def.size_track[0][4]) {\n        v2mul(temp_size, temp_size, def.size_track[0]);\n      } else if (age_norm >= def.size_track[def.size_track.length - 1][4]) {\n        v2mul(temp_size, temp_size, def.size_track[def.size_track.length - 1]);\n      } else {\n        for (let ii = 0; ii < def.size_track.length - 1; ++ii) {\n          if (age_norm >= def.size_track[ii][4] && age_norm < def.size_track[ii + 1][4]) {\n            let weight = (age_norm - def.size_track[ii][4]) / (def.size_track[ii + 1][4] - def.size_track[ii][4]);\n            v2lerp(temp_size2, weight, def.size_track[ii], def.size_track[ii + 1]);\n            v2mul(temp_size, temp_size, temp_size2);\n            break;\n          }\n        }\n      }\n    }\n\n    // TODO: let rot = part.rot + part.age * part.rot_vel;\n\n    // TODO: draw using:\n    //   rot\n    let w = part.size[0];\n    let h = part.size[1];\n    let x = part.pos[0] - w / 2;\n    let y = part.pos[1] - h / 2;\n    let z = part.pos[2];\n    sprites.queueraw4([def.texture], x, y, x, y + h, x + w, y + h, x + w, y, z, 0, 0, 1, 1, temp_color, null, null, def.blend);\n\n    return false;\n  }\n\n  tickPartSet(dt_orig, part_set) {\n    //let def = part_set.def;\n    let parts = part_set.parts;\n    for (let ii = parts.length - 1; ii >= 0; --ii) {\n      let part = parts[ii];\n      let dt = this.kill_soft ? dt_orig * part.kill_time_accel : dt_orig;\n      if (this.tickParticle(part, dt)) {\n        parts[ii] = parts[parts.length - 1];\n        parts.pop();\n      }\n    }\n  }\n\n  emitParticle(init_dt, emitter) {\n    let emitter_def = emitter.def;\n    let part_set = this.part_sets[emitter_def.part_idx];\n    let def = part_set.def;\n    let pos = instValueVec(emitter_def.pos, 3);\n    v3add(pos, pos, this.pos);\n    // PERFTODO: Make the whole Particle just a data[] Float32Array\n    let part = {\n      def,\n      pos,\n      color: instValueVec(def.color, 4),\n      size: instValueVec(def.size, 4),\n      vel: instValueVec(emitter_def.vel, 3),\n      accel: instValueVec(def.accel, 3),\n      rot: instValue(def.rot),\n      rot_vel: instValue(def.rot_vel),\n      lifespan: instValue(def.lifespan),\n      kill_time_accel: instValue(def.kill_time_accel),\n      age: 0\n    };\n    if (!this.tickParticle(part, init_dt)) {\n      part_set.parts.push(part);\n    }\n  }\n\n  tickEmitter(dt, emitter) {\n    let def = emitter.def;\n    // check for initial emission\n    if (!emitter.started && this.age >= emitter.emit_time[0]) {\n      emitter.started = true;\n      // ignore time before we started emitting\n      dt = this.age - emitter.emit_time[0];\n      let num = instValue(def.emit_initial);\n      for (let ii = 0; ii < num; ++ii) {\n        this.emitParticle(dt, emitter);\n      }\n      emitter.countdown = instValue(def.emit_rate);\n    }\n    if (emitter.started && !emitter.stopped) {\n      // should we stop?\n      let remaining_dt = dt;\n      let emit_dt = dt;\n      if (this.age >= emitter.emit_time[1]) {\n        emitter.stopped = true;\n        // Do not emit during time after we stopped\n        emit_dt -= this.age - emitter.emit_time[1];\n      }\n      // Emit dt's worth of particles\n      while (emit_dt >= emitter.countdown) {\n        emit_dt -= emitter.countdown;\n        remaining_dt -= emitter.countdown;\n        emitter.countdown = instValue(def.emit_rate);\n        this.emitParticle(remaining_dt, emitter);\n      }\n      emitter.countdown -= emit_dt;\n    }\n  }\n\n  tick(dt) {\n    if (this.kill_hard) {\n      return true;\n    }\n    // tick existing particles\n    for (let ii = this.part_sets.length - 1; ii >= 0; --ii) {\n      this.tickPartSet(dt, this.part_sets[ii]);\n    }\n    // advance time and spawn new ones (with partial ticks)\n    this.age += dt;\n    for (let ii = 0; ii < this.emitters.length; ++ii) {\n      this.tickEmitter(dt, this.emitters[ii]);\n    }\n\n    return this.age >= this.system_lifespan; // kill if past lifespan\n  }\n}\n\nclass ParticleManager {\n  constructor() {\n    this.systems = [];\n  }\n\n  createSystem(def, pos) {\n    let system = new ParticleSystem(this, def, pos);\n    this.systems.push(system);\n    return system;\n  }\n\n  tick(dt) {\n    for (let ii = this.systems.length - 1; ii >= 0; --ii) {\n      if (this.systems[ii].tick(dt)) {\n        this.systems[ii] = this.systems[this.systems.length - 1];\n        this.systems.pop();\n      }\n    }\n  }\n}\n\nexport function create(...args) {\n  return new ParticleManager(...args);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst camera2d = require('./camera2d.js');\nconst { cmd_parse } = require('./cmds.js');\nconst engine = require('./engine.js');\nconst glov_font = require('./font.js');\nconst input = require('./input.js');\nconst { max } = Math;\nconst settings = require('./settings.js');\nconst ui = require('./ui.js');\nconst { vec4, v3copy } = require('./vmath.js');\n\nlet metrics = [];\n\nconst METRIC_PAD = 2;\n\nlet bg_default = vec4(0, 0, 0, 0.5);\nlet bg_mouse_over = vec4(0, 0, 0, 0.75);\nlet bg_fade = vec4();\n\n// referenced in engine.js\nsettings.register({\n  show_metrics: {\n    default_value: 1,\n    type: cmd_parse.TYPE_INT,\n    range: [0, 1]\n  },\n  show_fps: {\n    label: 'Show FPS',\n    default_value: 1,\n    type: cmd_parse.TYPE_INT,\n    range: [0, 3]\n  },\n  fps_graph: {\n    label: 'FPS Graph',\n    default_value: 0,\n    type: cmd_parse.TYPE_INT,\n    range: [0, 1]\n  }\n});\n\nlet fps_style = glov_font.style({\n  outline_width: 2, outline_color: 0x00000080,\n  color: 0xFFFFFFff\n});\n\nexport function addMetric(metric) {\n  if (metric.show_graph) {\n    metric.num_lines = metric.colors.length;\n    metric.history_size = metric.data.history.length / metric.num_lines;\n  }\n  metric.num_labels = Object.keys(metric.labels).length;\n  if (metric.interactable === undefined) {\n    metric.interactable = metric.num_labels > 1 || metric.show_graph;\n  }\n  metrics.push(metric);\n}\n\nfunction showMetric(y, metric) {\n  let font = engine.font;\n  let pad = METRIC_PAD;\n  let METRIC_VALUE_WIDTH = ui.font_height * 2.5;\n  let x = camera2d.x1Real() - METRIC_VALUE_WIDTH - pad;\n  let y0 = y;\n  y += pad;\n  let line_height = ui.font_height;\n  let max_label_w = 0;\n  let max_labels = settings[metric.show_stat];\n  let drew_any = false;\n  let alpha = 1;\n  for (let label in metric.labels) {\n    let value = metric.labels[label]();\n    if (value) {\n      let style = fps_style;\n      if (value.alpha) {\n        alpha = value.alpha;\n        value = value.value;\n        style = glov_font.styleAlpha(fps_style, alpha);\n      }\n      let label_w = font.drawSizedAligned(style, x, y, Z.FPSMETER + 1, line_height, glov_font.ALIGN.HRIGHT, 0, 0, label);\n      max_label_w = max(max_label_w, label_w);\n      font.drawSizedAligned(style, x, y, Z.FPSMETER + 1, line_height, glov_font.ALIGN.HFIT, METRIC_VALUE_WIDTH, 0, value);\n      y += line_height;\n      drew_any = true;\n    }\n    if (! --max_labels) {\n      break;\n    }\n  }\n  let w = METRIC_VALUE_WIDTH + max_label_w + METRIC_PAD;\n  x -= max_label_w + METRIC_PAD;\n\n  if (!drew_any) {\n    return y - pad;\n  }\n\n  y += pad;\n  let bg = bg_default;\n  let pos_param = {\n    x: x - pad,\n    y: y0,\n    w: w + pad * 2,\n    h: y - y0\n  };\n  if (metric.interactable) {\n    if (input.mouseUpEdge(pos_param)) {\n      if (metric.num_labels > 1 && settings[metric.show_stat] <= 1) {\n        settings.set(metric.show_stat, metric.num_labels);\n      } else if (metric.show_graph && !settings[metric.show_graph]) {\n        settings.set(metric.show_graph, 1);\n      } else {\n        if (metric.show_graph) {\n          settings.set(metric.show_graph, 0);\n        }\n        settings.set(metric.show_stat, 1);\n      }\n    }\n    if (input.mouseOver(pos_param)) {\n      bg = bg_mouse_over;\n    }\n  }\n  if (alpha !== 1) {\n    bg_fade[3] = bg[3] * alpha;\n    bg = v3copy(bg_fade, bg);\n  }\n  ui.drawRect(pos_param.x, pos_param.y, pos_param.x + pos_param.w, y, Z.FPSMETER, bg);\n  return y;\n}\n\nfunction showMetricGraph(y, metric) {\n  const small = engine.game_height < 300;\n  const LINE_WIDTH = small ? 1 : 3;\n  const LINE_PAD = small ? 0 : 1;\n  const LINE_HEIGHT = small ? 64 : 128;\n  const NUM_LINES = metric.history_size - 1;\n  let w = (LINE_WIDTH + LINE_PAD) * NUM_LINES;\n  let x = camera2d.x1Real() - w;\n  let h = LINE_HEIGHT + LINE_PAD * 2;\n  let z = Z.FPSMETER;\n  ui.drawRect(x, y - h, x + w, y, z++, bg_default);\n  x += LINE_PAD;\n  y -= LINE_PAD;\n  let history_index = metric.data.index;\n  let line_scale = LINE_HEIGHT / metric.line_scale_top;\n  for (let ii = 0; ii < NUM_LINES; ii++) {\n    let line_index = (ii + history_index + 1) % metric.history_size * metric.num_lines;\n    let data = metric.data.history;\n    let bar_max = 0;\n    for (let jj = 0; jj < metric.num_lines; jj++) {\n      let line_jj = data[line_index + jj];\n      let bar_min;\n      if (metric.bars_stack) {\n        bar_min = bar_max;\n        bar_max += line_jj;\n      } else {\n        // bars overlap, figure out how big this bar should be relative to next smallest\n        let lesser = 0;\n        for (let kk = 0; kk < metric.num_lines; kk++) {\n          if (kk === jj) {\n            continue;\n          }\n          let line_kk = data[line_index + kk];\n          if ((line_kk < line_jj || line_kk === line_jj && kk < jj) && line_kk > lesser) {\n            lesser = line_kk;\n          }\n        }\n        bar_min = lesser;\n        bar_max = line_jj;\n      }\n      let color = metric.colors[jj];\n      ui.drawRect(x, y - bar_max * line_scale, x + LINE_WIDTH, y - bar_min * line_scale, z, color);\n    }\n    x += LINE_WIDTH + LINE_PAD;\n  }\n  z += NUM_LINES;\n  y -= LINE_HEIGHT + LINE_PAD;\n  return y;\n}\n\nexport function draw() {\n  camera2d.setAspectFixed(engine.game_width, engine.game_height);\n  let y = camera2d.y0Real();\n  let y_graph = camera2d.y1Real();\n  for (let ii = 0; ii < metrics.length; ++ii) {\n    let metric = metrics[ii];\n    if (settings[metric.show_stat]) {\n      y = showMetric(y, metric);\n      y += METRIC_PAD;\n    }\n    if (settings[metric.show_graph]) {\n      y_graph = showMetricGraph(y_graph, metric);\n      y_graph -= METRIC_PAD;\n    }\n  }\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nlet user_want_locked = false;\nlet elem;\nlet on_ptr_lock;\n\nexport function isLocked() {\n  return user_want_locked; // Either it's locked, or there's an async attempt to lock it outstanding\n}\n\nfunction pointerLog(msg) {\n  console.log(`PointerLock: ${msg}`); // TODO: Disable this after things settle\n}\n\nexport function exit() {\n  pointerLog('Lock exit requested');\n  user_want_locked = false;\n  document.exitPointerLock();\n}\n\nexport function enter(when) {\n  user_want_locked = true;\n  on_ptr_lock();\n  pointerLog(`Trying pointer lock in response to ${when}`);\n  elem.requestPointerLock();\n}\n\nfunction onPointerLockChange() {\n  if (document.pointerLockElement || document.mozPointerLockElement || document.webkitPointerLockElement) {\n    pointerLog('Lock successful');\n    if (!user_want_locked) {\n      pointerLog('User canceled lock');\n      document.exitPointerLock();\n    }\n  } else {\n    if (user_want_locked) {\n      pointerLog('Lock lost');\n      user_want_locked = false;\n    }\n  }\n}\n\nfunction onPointerLockError(e) {\n  pointerLog('Error');\n  user_want_locked = false;\n}\n\nexport function startup(_elem, _on_ptr_lock) {\n  elem = _elem;\n  on_ptr_lock = _on_ptr_lock;\n\n  elem.requestPointerLock = elem.requestPointerLock || elem.mozRequestPointerLock || elem.webkitRequestPointerLock || function () {/* nop */};\n  document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock || document.webkitExitPointerLock || function () {/* nop */};\n\n  document.addEventListener('pointerlockchange', onPointerLockChange, false);\n  document.addEventListener('mozpointerlockchange', onPointerLockChange, false);\n  document.addEventListener('webkitpointerlockchange', onPointerLockChange, false);\n\n  document.addEventListener('pointerlockerror', onPointerLockError, false);\n  document.addEventListener('mozpointerlockerror', onPointerLockError, false);\n  document.addEventListener('webkitpointerlockerror', onPointerLockError, false);\n}","/* eslint no-extend-native:off,no-var:off,func-style:off,no-invalid-this:off */\n\n// TypedArray.slice - not supported on IE, some older Safari\nif (!Uint8Array.prototype.slice) {\n  Object.defineProperty(Uint8Array.prototype, 'slice', {\n    value: function (begin, end) {\n      // PERFTODO: If we use this on any significant audience, this can be likely\n      // way faster by not making a temporary Array in the middle\n      return new Uint8Array(Array.prototype.slice.call(this, begin, end));\n    }\n  });\n  Object.defineProperty(Int8Array.prototype, 'slice', {\n    value: function (begin, end) {\n      return new Int8Array(Array.prototype.slice.call(this, begin, end));\n    }\n  });\n  Object.defineProperty(Int32Array.prototype, 'slice', {\n    value: function (begin, end) {\n      return new Int32Array(Array.prototype.slice.call(this, begin, end));\n    }\n  });\n  Object.defineProperty(Float32Array.prototype, 'slice', {\n    value: function (begin, end) {\n      return new Float32Array(Array.prototype.slice.call(this, begin, end));\n    }\n  });\n}\n\nif (!Int32Array.prototype.join) {\n  Object.defineProperty(Int32Array.prototype, 'join', {\n    value: function (delim) {\n      return Array.prototype.join.call(this, delim);\n    }\n  });\n}\n\nif (!Uint8Array.prototype.fill) {\n  var fill = function (value, begin, end) {\n    if (end === undefined) {\n      end = this.length;\n    }\n    for (var ii = begin || 0; ii < end; ++ii) {\n      this[ii] = value;\n    }\n    return this;\n  };\n  Object.defineProperty(Uint8Array.prototype, 'fill', {\n    value: fill\n  });\n  Object.defineProperty(Int16Array.prototype, 'fill', {\n    value: fill\n  });\n  Object.defineProperty(Int32Array.prototype, 'fill', {\n    value: fill\n  });\n  Object.defineProperty(Uint32Array.prototype, 'fill', {\n    value: fill\n  });\n}\n\nif (!Int16Array.prototype.sort) {\n  var cmpDefault = function (a, b) {\n    return a - b;\n  };\n  var sort = function (cmp) {\n    Array.prototype.sort.call(this, cmp || cmpDefault);\n  };\n  Object.defineProperty(Int16Array.prototype, 'sort', {\n    value: sort\n  });\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst { titleCase } = require('../../common/util.js');\nconst { cmd_parse } = require('./cmds.js');\n\nexports.true = true; // for perf.js\n\nexport function get(key) {\n  return exports[key];\n}\n\nexport function set(key, value) {\n  if (exports[key] !== value) {\n    cmd_parse.handle(null, `${key} ${value}`, null); // uses default cmd_parse handler\n  }\n}\n\nexport function register(defs) {\n  Object.keys(defs).forEach(function (key) {\n    let def = defs[key];\n    exports[key] = def.default_value;\n    cmd_parse.registerValue(key, {\n      type: def.type,\n      label: def.label || titleCase(key.replace(/_/g, ' ')),\n      range: def.range,\n      get: () => exports[key],\n      set: v => exports[key] = v,\n      store: true,\n      ver: def.ver,\n      help: def.help,\n      usage: def.usage\n    });\n  });\n}\n\nregister({\n  show_metrics: {\n    default_value: 1,\n    type: cmd_parse.TYPE_INT,\n    range: [0, 1]\n  },\n  max_fps: {\n    label: 'Max FPS',\n    default_value: 0,\n    type: cmd_parse.TYPE_FLOAT\n  }\n});","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst assert = require('assert');\nconst engine = require('./engine.js');\nconst { filewatchOn } = require('./filewatch.js');\nconst { matchAll } = require('../../common/util.js');\nconst { texturesUnloadDynamic } = require('./textures.js');\nconst { webFSGetFile } = require('./webfs.js');\n\nlet last_id = 0;\n\nlet bound_prog = null;\n\nexport const semantic = {\n  'ATTR0': 0,\n  'POSITION': 0,\n  'ATTR1': 1,\n  'COLOR': 1,\n  'COLOR_0': 1,\n  'ATTR2': 2,\n  'TEXCOORD': 2,\n  'TEXCOORD_0': 2,\n  'ATTR3': 3,\n  'NORMAL': 3,\n  'ATTR4': 4,\n  'TEXCOORD_1': 4\n};\n\nexport let globals;\nlet defines;\n\nlet error_fp;\nlet error_vp;\n\nlet shaders = [];\n\nconst vp_attr_regex = /attribute [^ ]+ ([^ ;]+);/g;\nconst uniform_regex = /uniform (?:(?:low|medium|high)p )?((?:(?:vec|mat)\\d(?:x\\d)?|float) [^ ;]+);/g;\nconst sampler_regex = /uniform sampler(?:2D|Cube) ([^ ;]+);/g;\nconst include_regex = /\\n#include \"([^\"]+)\"/g;\n\nconst type_size = {\n  float: 1,\n  vec2: 2 * 1,\n  vec3: 3 * 1,\n  vec4: 4 * 1,\n  mat3: 3 * 3,\n  mat4: 4 * 4\n};\n\nlet includes = {};\n\nfunction loadInclude(key) {\n  let text = webFSGetFile(includes[key].filename, 'text');\n  includes[key].text = `\\n// from include \"${key}\":\\n${text}\\n`;\n}\n\nexport function addInclude(key, filename) {\n  assert(!includes[key]);\n  includes[key] = { filename };\n  loadInclude(key);\n}\n\nlet report_queued = false;\nlet shader_errors;\nfunction reportShaderError(err) {\n  function doReport() {\n    assert(false, `Shader error(s):\\n    ${shader_errors.join('\\n    ')}`);\n    shader_errors = null;\n  }\n  if (!report_queued) {\n    setTimeout(doReport, 1000);\n    report_queued = true;\n    shader_errors = [];\n  }\n  shader_errors.push(err);\n}\n\nfunction parseIncludes(text) {\n  let supplied_uniforms = {};\n  text.replace(uniform_regex, function (str, key) {\n    supplied_uniforms[key] = true;\n  });\n  text = text.replace(include_regex, function (str, filename) {\n    let replacement = includes[filename];\n    if (!replacement) {\n      console.error(`Could not evaluate ${str}`);\n      return str;\n    }\n    replacement = replacement.text;\n    // Remove duplicate uniforms\n    replacement = replacement.replace(uniform_regex, function (str2, key) {\n      if (supplied_uniforms[key]) {\n        return `// [removed ${key}]`;\n      }\n      supplied_uniforms[key] = true;\n      return str2;\n    });\n    return replacement;\n  });\n  return text;\n}\n\nconst webgl2_header = ['#version 300 es', '#define WEBGL2'].join('\\n');\nconst webgl2_header_fp = [webgl2_header, '#define varying in', 'out lowp vec4 fragColor;', '#define gl_FragColor fragColor', '#define texture2D texture', '#define textureCube texture', ''].join('\\n');\nconst webgl2_header_vp = [webgl2_header, '#define varying out', '#define attribute in', ''].join('\\n');\n\nfunction Shader(params) {\n  let { filename } = params;\n  assert.equal(typeof filename, 'string');\n  let type = filename.endsWith('.fp') ? gl.FRAGMENT_SHADER : filename.endsWith('.vp') ? gl.VERTEX_SHADER : 0;\n  assert(type);\n  this.type = type;\n  this.filename = filename;\n  this.shader = gl.createShader(type);\n  this.id = ++last_id;\n  if (type === gl.VERTEX_SHADER) {\n    this.programs = {};\n  }\n  shaders.push(this);\n  this.compile();\n}\n\nShader.prototype.compile = function () {\n  let { type, filename } = this;\n  let header = '';\n  let text = webFSGetFile(filename, 'text');\n  if (engine.webgl2 && text.indexOf('#pragma WebGL2') !== -1) {\n    header = type === gl.VERTEX_SHADER ? webgl2_header_vp : webgl2_header_fp;\n  }\n  text = `${header}${defines}${text}`;\n  text = parseIncludes(text);\n  text = text.replace(/#pragma WebGL2?/g, '');\n  if (type === gl.VERTEX_SHADER) {\n    this.attributes = matchAll(text, vp_attr_regex);\n    // Ensure they are known names so we can give them indices\n    // Add to semantic[] above as needed\n    this.attributes.forEach(v => assert(semantic[v] !== undefined));\n  } else {\n    this.samplers = matchAll(text, sampler_regex);\n    // Ensure all samplers end in a unique number\n    let found = [];\n    this.samplers.forEach(v => {\n      let num = Number(v.slice(-1));\n      assert(!isNaN(num));\n      assert(!found[num]);\n      found[num] = true;\n    });\n  }\n  this.uniforms = matchAll(text, uniform_regex);\n  // Ensure a known type\n  this.uniforms.forEach(v => {\n    let type_name = v.split(' ')[0];\n    assert(type_size[type_name]);\n  });\n  gl.shaderSource(this.shader, text);\n  gl.compileShader(this.shader);\n\n  if (!gl.getShaderParameter(this.shader, gl.COMPILE_STATUS)) {\n    let error_text = gl.getShaderInfoLog(this.shader);\n    if (error_text) {\n      // sometimes null on iOS\n      error_text = error_text.replace(/\\0/g, '').trim();\n    }\n    console.error(`Error compiling ${filename}: ${error_text}`);\n    reportShaderError(`${filename}: ${error_text}`);\n    // eslint-disable-next-line newline-per-chained-call\n    console.log(text.split('\\n').map((line, idx) => `${idx + 1}: ${line}`).join('\\n'));\n  }\n};\n\nexport function create(filename) {\n  if (typeof filename === 'object') {\n    return new Shader(filename);\n  }\n  return new Shader({ filename });\n}\n\nfunction uniformSetValue(unif) {\n  switch (unif.width) {// eslint-disable-line default-case\n    case 1:\n      gl.uniform1fv(unif.location, unif.value);\n      break;\n    case 2:\n      gl.uniform2fv(unif.location, unif.value);\n      break;\n    case 3:\n      gl.uniform3fv(unif.location, unif.value);\n      break;\n    case 4:\n      gl.uniform4fv(unif.location, unif.value);\n      break;\n    case 9:\n      gl.uniformMatrix3fv(unif.location, false, unif.value);\n      break;\n    case 16:\n      gl.uniformMatrix4fv(unif.location, false, unif.value);\n      break;\n  }\n}\n\nfunction link(vp, fp) {\n  let prog = vp.programs[fp.id] = {\n    handle: gl.createProgram(),\n    uniforms: null\n  };\n  gl.attachShader(prog.handle, vp.shader);\n  gl.attachShader(prog.handle, fp.shader);\n  // call this for all relevant semantic\n  for (let ii = 0; ii < vp.attributes.length; ++ii) {\n    gl.bindAttribLocation(prog.handle, semantic[vp.attributes[ii]], vp.attributes[ii]);\n  }\n  gl.linkProgram(prog.handle);\n\n  prog.valid = gl.getProgramParameter(prog.handle, gl.LINK_STATUS);\n  if (!prog.valid) {\n    reportShaderError(`Shader link error (${vp.filename} & ${fp.filename}): ${gl.getProgramInfoLog(prog.handle)}`);\n    console.error(`Shader link error: ${gl.getProgramInfoLog(prog.handle)}`);\n  }\n\n  gl.useProgram(prog.handle);\n  bound_prog = prog;\n\n  let uniforms = vp.uniforms.slice(0);\n  for (let ii = 0; ii < fp.uniforms.length; ++ii) {\n    let name = fp.uniforms[ii];\n    if (uniforms.indexOf(name) === -1) {\n      uniforms.push(name);\n    }\n  }\n  prog.uniforms = uniforms.map(v => {\n    v = v.split(' ');\n    let type = v[0];\n    let name = v[1];\n    let count = 1;\n    let m = name.match(/([^[]+)\\[(\\d+)\\]/);\n    if (m) {\n      name = m[1];\n      count = Number(m[2]);\n    }\n    let location = gl.getUniformLocation(prog.handle, name);\n    if (location === null) {\n      // Not in either shader, (commented out?), remove (via filter below)\n      return null;\n    }\n    let width = type_size[type];\n    let size = width * count;\n    let glob = globals[name];\n    let value = new Float32Array(size);\n    // set initial value\n    let unif = {\n      name,\n      size,\n      width,\n      count,\n      value,\n      location,\n      glob\n    };\n    uniformSetValue(unif);\n    return unif;\n  }).filter(v => v);\n\n  for (let ii = 0; ii < fp.samplers.length; ++ii) {\n    let name = fp.samplers[ii];\n    let num = Number(name.slice(-1));\n    let location = gl.getUniformLocation(prog.handle, name);\n    if (location !== null) {\n      gl.uniform1i(location, num);\n    }\n  }\n  return prog;\n}\n\nexport function bind(vp, fp, params) {\n  let prog = vp.programs[fp.id];\n  if (!prog) {\n    prog = link(vp, fp);\n  }\n  if (!prog.valid) {\n    prog = link(vp, error_fp);\n    if (!prog.valid) {\n      prog = link(error_vp, error_fp);\n    }\n    vp.programs[fp.id] = prog;\n  }\n  if (prog !== bound_prog) {\n    bound_prog = prog;\n    gl.useProgram(prog.handle);\n  }\n  for (let ii = 0; ii < prog.uniforms.length; ++ii) {\n    let unif = prog.uniforms[ii];\n    let value = params[unif.name] || unif.glob;\n    if (!value) {\n      continue;\n    }\n    let diff = false;\n    for (let jj = 0; jj < unif.size; ++jj) {\n      if (value[jj] !== unif.value[jj]) {\n        diff = true;\n        break;\n      }\n    }\n    if (diff) {\n      for (let jj = 0; jj < unif.size; ++jj) {\n        unif.value[jj] = value[jj];\n      }\n      uniformSetValue(unif);\n    }\n  }\n}\n\nconst reserved = { WEBGL2: 1 };\nexport function addReservedDefine(key) {\n  reserved[key] = 1;\n}\nlet internal_defines = {};\nfunction applyDefines() {\n  defines = Object.keys(engine.defines).filter(v => !reserved[v]).concat(Object.keys(internal_defines)).map(v => `#define ${v}\\n`).join('');\n}\n\nfunction shaderReload() {\n  if (shaders.length) {\n    window.debugmsg('', true);\n    gl.useProgram(null);\n    for (let ii = 0; ii < shaders.length; ++ii) {\n      let programs = shaders[ii].programs;\n      if (programs) {\n        for (let id in programs) {\n          gl.deleteProgram(programs[id].handle);\n        }\n        shaders[ii].programs = {};\n      }\n    }\n    for (let ii = 0; ii < shaders.length; ++ii) {\n      shaders[ii].compile();\n    }\n    texturesUnloadDynamic();\n  }\n}\n\nexport function handleDefinesChanged() {\n  applyDefines();\n  shaderReload();\n}\n\nexport function setInternalDefines(new_values) {\n  for (let key in new_values) {\n    if (new_values[key]) {\n      internal_defines[key] = new_values[key];\n    } else {\n      delete internal_defines[key];\n    }\n  }\n  handleDefinesChanged();\n}\n\nfunction onShaderChange(filename) {\n  for (let key in includes) {\n    loadInclude(key);\n  }\n  shaderReload();\n}\n\nexport function startup(_globals) {\n  applyDefines();\n  globals = _globals;\n\n  error_fp = create('glov/shaders/error.fp');\n  error_vp = create('glov/shaders/error.vp');\n\n  filewatchOn('.fp', onShaderChange);\n  filewatchOn('.vp', onShaderChange);\n}\n\nexport function addGlobal(key, vec) {\n  assert(!globals[key]);\n  globals[key] = vec;\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint callback-return:off */\n\nexport const FADE_DEFAULT = 0;\nexport const FADE_OUT = 1;\nexport const FADE_IN = 2;\nexport const FADE = FADE_OUT + FADE_IN;\n\nconst assert = require('assert');\nconst { cmd_parse } = require('./cmds.js');\nconst { filewatchOn } = require('./filewatch.js');\nconst { Howl, Howler } = require('@jimbly/howler/src/howler.core.js');\nconst { abs, floor, max, min, random } = Math;\nconst settings = require('./settings.js');\nconst urlhash = require('./urlhash.js');\nconst { defaults, ridx } = require('../../common/util.js');\n\nconst DEFAULT_FADE_RATE = 0.001;\n\nlet sounds = {};\nlet num_loading = 0;\n\n// Howler.usingWebAudio = false; // Disable WebAudio for testing HTML5 fallbacks\n\nconst default_params = {\n  ext_list: ['mp3', 'wav'], // (recommended) try loading .mp3 versions first, then fallback to .wav\n  //  also covers all browsers: ['webm', 'mp3']\n  fade_rate: DEFAULT_FADE_RATE\n};\nlet sound_params;\n\nlet last_played = {};\nlet global_timer = 0;\nlet fades = [];\nlet music;\n\nsettings.register({\n  volume: {\n    default_value: 1,\n    type: cmd_parse.TYPE_FLOAT,\n    range: [0, 1]\n  }\n});\n\nsettings.register({\n  sound: {\n    default_value: 1,\n    type: cmd_parse.TYPE_INT,\n    range: [0, 1]\n  }\n});\n\nsettings.register({\n  music: {\n    default_value: 1,\n    type: cmd_parse.TYPE_INT,\n    range: [0, 1]\n  }\n});\n\nexport function soundLoad(base, opts, cb) {\n  opts = opts || {};\n  if (Array.isArray(base)) {\n    assert(!cb);\n    for (let ii = 0; ii < base.length; ++ii) {\n      soundLoad(base[ii], opts);\n    }\n    return;\n  }\n  let key = base;\n  if (sounds[key]) {\n    if (cb) {\n      cb();\n    }\n    return;\n  }\n  let m = base.match(/^(.*)\\.(mp3|ogg|wav|webm)$/u);\n  let preferred_ext;\n  if (m) {\n    base = m[1];\n    preferred_ext = m[2];\n  }\n  let src = `sounds/${base}`;\n  let srcs = [];\n  let suffix = '';\n  if (opts.for_reload) {\n    suffix = `?rl=${Date.now()}`;\n  }\n  if (preferred_ext) {\n    srcs.push(`${urlhash.getURLBase()}${src}.${preferred_ext}${suffix}`);\n  }\n  for (let ii = 0; ii < sound_params.ext_list.length; ++ii) {\n    let ext = sound_params.ext_list[ii];\n    if (ext !== preferred_ext) {\n      srcs.push(`${urlhash.getURLBase()}${src}.${ext}${suffix}`);\n    }\n  }\n  // Try loading desired sound types one at a time.\n  // Cannot rely on Howler's built-in support for this because it only continues\n  //   through the list on *some* load errors, not all :(.\n  function tryLoad(idx) {\n    if (idx === srcs.length) {\n      console.error(`Error loading sound ${base}: All fallbacks exhausted, giving up`);\n      if (cb) {\n        cb('Error loading sound');\n      }\n      return;\n    }\n    ++num_loading;\n    let once = false;\n    let sound = new Howl({\n      src: srcs.slice(idx),\n      html5: Boolean(opts.streaming),\n      loop: Boolean(opts.loop),\n      volume: 0,\n      onload: function () {\n        if (!once) {\n          --num_loading;\n          once = true;\n          sound.glov_load_opts = opts;\n          sounds[key] = sound;\n          if (cb) {\n            cb(null);\n          }\n        }\n      },\n      onloaderror: function (id, err, extra) {\n        if (idx === srcs.length - 1) {\n          console.error(`Error loading sound ${srcs[idx]}: ${err}`);\n        } else {\n          console.log(`Error loading sound ${srcs[idx]}: ${err}, trying fallback...`);\n        }\n        if (!once) {\n          --num_loading;\n          once = true;\n          tryLoad(idx + 1);\n        }\n      }\n    });\n  }\n  tryLoad(0);\n}\n\nfunction soundReload(filename) {\n  let sound_name = filename.match(/^sounds\\/([^.]+)\\.\\w+$/);\n  sound_name = sound_name && sound_name[1];\n  if (!sound_name) {\n    return;\n  }\n  if (!sounds[sound_name]) {\n    console.log(`Reload trigged for non-existent sound: ${filename}`);\n    return;\n  }\n  let opts = sounds[sound_name].glov_load_opts;\n  opts.for_reload = true;\n  delete sounds[sound_name];\n  soundLoad(sound_name, opts);\n}\n\nexport function soundStartup(params) {\n  sound_params = defaults(params || {}, default_params);\n\n  // Music\n  music = []; // 0 is current, 1 is previous (fading out)\n  for (let ii = 0; ii < 2; ++ii) {\n    music.push({\n      sound: null,\n      id: 0,\n      current_volume: 0,\n      target_volume: 0,\n      sys_volume: 0,\n      need_play: false\n    });\n  }\n  filewatchOn('.mp3', soundReload);\n  filewatchOn('.ogg', soundReload);\n  filewatchOn('.wav', soundReload);\n  filewatchOn('.webm', soundReload);\n}\n\nexport function soundResume() {\n  // Handled internally by Howler, leaving hooks in for now, though\n  // Maybe more reliable than `Howler.safeToPlay`...\n}\n\nexport function soundResumed() {\n  return !Howler.noAudio && Howler.safeToPlay;\n}\n\nexport function soundTick(dt) {\n  global_timer += dt;\n  if (!soundResumed()) {\n    return;\n  }\n  // Do music fading\n  // Cannot rely on Howler's fading because starting a fade when one is in progress\n  //   messes things up, as well causes snaps in volume :(\n  let max_fade = dt * sound_params.fade_rate;\n  for (let ii = 0; ii < music.length; ++ii) {\n    let mus = music[ii];\n    if (!mus.sound) {\n      continue;\n    }\n    let target = settings.music ? mus.target_volume : 0;\n    if (mus.current_volume !== target) {\n      let delta = target - mus.current_volume;\n      let fade_amt = min(abs(delta), max_fade);\n      if (delta < 0) {\n        mus.current_volume = max(target, mus.current_volume - fade_amt);\n      } else {\n        mus.current_volume = min(target, mus.current_volume + fade_amt);\n      }\n      if (!mus.target_volume && !mus.current_volume) {\n        if (!mus.need_play) {\n          mus.sound.stop(mus.id);\n        }\n        mus.sound = null;\n      }\n    }\n    if (mus.sound) {\n      let sys_volume = mus.current_volume * settings.volume;\n      if (mus.need_play) {\n        mus.need_play = false;\n        mus.id = mus.sound.play();\n        mus.sys_volume = -1;\n      }\n      if (mus.sys_volume !== sys_volume) {\n        mus.sound.volume(sys_volume, mus.id);\n        mus.sys_volume = sys_volume;\n      }\n    }\n  }\n\n  for (let ii = fades.length - 1; ii >= 0; --ii) {\n    let fade = fades[ii];\n    fade.volume = max(0, fade.volume - max_fade);\n    fade.sound.volume(fade.volume * settings.volume, fade.id);\n    if (!fade.volume) {\n      fade.sound.stop(fade.id);\n      ridx(fades, ii);\n    }\n  }\n}\n\nexport function soundPlay(soundname, volume, as_music) {\n  volume = volume || 1;\n  if (!as_music && !settings.sound || as_music && !settings.music) {\n    return null;\n  }\n  if (!soundResumed()) {\n    return null;\n  }\n  if (Array.isArray(soundname)) {\n    soundname = soundname[floor(random() * soundname.length)];\n  }\n  let sound = sounds[soundname];\n  if (!sound) {\n    return null;\n  }\n  let last_played_time = last_played[soundname] || -9e9;\n  if (global_timer - last_played_time < 45) {\n    return null;\n  }\n\n  let id = sound.play(undefined, volume * settings.volume);\n  // sound.volume(volume * settings.volume, id);\n  last_played[soundname] = global_timer;\n  return {\n    stop: sound.stop.bind(sound, id),\n    playing: sound.playing.bind(sound, id), // not reliable if it hasn't started yet? :(\n    fadeOut: time => {\n      fades.push({\n        volume,\n        sound,\n        id,\n        time\n      });\n    }\n  };\n}\n\nexport function soundPlayMusic(soundname, volume, transition) {\n  if (!settings.music) {\n    return;\n  }\n  if (volume === undefined) {\n    volume = 1;\n  }\n  transition = transition || FADE_DEFAULT;\n  soundLoad(soundname, { streaming: true, loop: true }, err => {\n    assert(!err);\n    let sound = sounds[soundname];\n    assert(sound);\n    if (music[0].sound === sound) {\n      // Same sound, just adjust volume, if required\n      music[0].target_volume = volume;\n      if (!transition) {\n        if (!volume) {\n          sound.stop(music[0].id);\n          music[0].sound = null;\n        } else {\n          let sys_volume = music[0].sys_volume = volume * settings.volume;\n          sound.volume(sys_volume, music[0].id);\n        }\n      }\n      return;\n    }\n    // fade out previous music, if any\n    if (music[0].current_volume) {\n      if (transition & FADE_OUT) {\n        // swap to position 1, start fadeout\n        let temp = music[1];\n        music[1] = music[0];\n        music[0] = temp;\n        music[1].target_volume = 0;\n      }\n    }\n    if (music[0].sound) {\n      music[0].sound.stop(music[0].id);\n    }\n    music[0].sound = sound;\n    music[0].target_volume = volume;\n    let start_vol = transition & FADE_IN ? 0 : volume;\n    music[0].current_volume = start_vol;\n    if (soundResumed()) {\n      let sys_volume = start_vol * settings.volume;\n      music[0].id = sound.play(undefined, sys_volume);\n      // sound.volume(sys_volume, music[0].id);\n      music[0].sys_volume = sys_volume;\n      music[0].need_play = false;\n    } else {\n      music[0].need_play = true;\n    }\n  });\n}\n\nexport function soundLoading() {\n  return num_loading;\n}","const assert = require('assert');\nconst engine = require('./engine.js');\nconst { floor, min, random } = Math;\nconst settings = require('./settings.js');\nconst { soundLoad, soundPlay, soundResumed } = require('./sound.js');\nconst { ridx } = require('../../common/util.js');\n\nconst DEFAULT_PERIOD = 30000;\nconst DEFAULT_PERIOD_NOISE = 15000;\nconst DEFAULT_ADD_DELAY = 5000; // how long to wait between adding another track\nlet inherit_props = ['min_intensity', 'odds', 'period', 'period_noise', 'add_delay'];\nconst volume = 1;\nfunction SoundScape(params) {\n  let { base_path, layers } = params;\n  this.intensity = 0;\n  this.tags = {};\n  function preload(layer, parent) {\n    let { files, tags } = layer;\n    for (let ii = 0; ii < files.length; ++ii) {\n      files[ii] = `${base_path}${files[ii]}`;\n      soundLoad(files[ii], { streaming: true });\n    }\n    if (parent) {\n      for (let ii = 0; ii < inherit_props.length; ++ii) {\n        let key = inherit_props[ii];\n        if (layer[key] === undefined) {\n          layer[key] = parent[key];\n        }\n      }\n    }\n    if (layer.max) {\n      layer.odds = [0];\n      for (let ii = 0; ii < layer.max; ++ii) {\n        layer.odds.push(1);\n      }\n    }\n    layer.odds_total = 0;\n    if (layer.odds) {\n      for (let ii = 0; ii < layer.odds.length; ++ii) {\n        layer.odds_total += layer.odds[ii];\n      }\n    }\n    layer.add_delay = layer.add_delay || DEFAULT_ADD_DELAY;\n    layer.period = layer.period || DEFAULT_PERIOD;\n    layer.period_noise = layer.period_noise || DEFAULT_PERIOD_NOISE;\n    for (let tag in tags) {\n      preload(tags[tag], layer);\n    }\n  }\n  this.layer_state = {};\n  let now = engine.global_timer;\n  for (let key in layers) {\n    preload(layers[key]);\n    this.layer_state[key] = {\n      active: [],\n      rel_intensity: random(),\n      // when we last started a new track playing\n      last_add: 0,\n      // change: when to change `rel_intensity`\n      change: now + layers[key].period + random() * layers[key].period_noise\n    };\n  }\n  this.layer_data = layers;\n}\nSoundScape.prototype.getTag = function (tag) {\n  return this.tags[tag];\n};\nSoundScape.prototype.setTag = function (tag, value) {\n  this.tags[tag] = value;\n};\nSoundScape.prototype.setIntensity = function (value) {\n  this.intensity = value;\n};\nSoundScape.prototype.getLayer = function (key) {\n  let layer = this.layer_data[key];\n  let ret = layer;\n  let priority = 0;\n  for (let tag in layer.tags) {\n    if (!this.tags[tag]) {\n      continue;\n    }\n    let taglayer = layer.tags[tag];\n    if (taglayer.priority > priority) {\n      ret = taglayer;\n      priority = taglayer.priority;\n    }\n  }\n  return ret;\n};\nfunction stop(active_list, idx) {\n  let to_remove = active_list[idx];\n  ridx(active_list, idx);\n  to_remove.sound.fadeOut();\n}\nSoundScape.prototype.tick = function () {\n  let now = engine.global_timer;\n  let { intensity, layer_state } = this;\n  for (let key in layer_state) {\n    let data = this.getLayer(key);\n    let { files, add_delay } = data;\n    let state = layer_state[key];\n    if (now > state.change) {\n      state.change = now + data.period + random() * data.period_noise;\n      state.rel_intensity = random();\n    }\n    let wanted = 0;\n    if (intensity > data.min_intensity && data.odds_total) {\n      let v = state.rel_intensity * data.odds_total;\n      wanted = 0;\n      do {\n        v -= data.odds[wanted];\n        if (v < 0) {\n          break;\n        }\n        wanted++;\n      } while (wanted < data.odds.length - 1);\n    }\n    wanted = min(wanted, files.length);\n    if (!settings.music || !soundResumed()) {\n      wanted = 0;\n    }\n    // Ensure active sounds are in the current file list\n    let active_files = {};\n    for (let ii = state.active.length - 1; ii >= 0; --ii) {\n      let active_sound = state.active[ii];\n      let { file, sound, start } = active_sound;\n      if (files.indexOf(file) === -1 && sound.playing()) {\n        stop(state.active, ii);\n      } else if (!sound.playing() && now - start > 1000) {\n        ridx(state.active, ii);\n      } else {\n        active_files[file] = true;\n      }\n    }\n    // Stop any extras\n    while (state.active.length > wanted) {\n      let idx = floor(random() * state.active.length);\n      stop(state.active, idx);\n      // Allow immediate adds\n      state.last_add = 0;\n    }\n    // Start new to match\n    state.add_blocked = false;\n    while (state.active.length < wanted) {\n      if (state.last_add && now - state.last_add < add_delay) {\n        state.add_blocked = true;\n        break;\n      }\n      let valid_files = files.filter(a => !active_files[a]);\n      assert(valid_files.length);\n      let idx = floor(random() * valid_files.length);\n      let file = valid_files[idx];\n      let sound = soundPlay(file, volume, true);\n      if (!sound) {\n        // still loading?\n        --wanted;\n        continue;\n      }\n      state.last_add = now;\n      state.active.push({\n        file,\n        sound,\n        start: now\n      });\n    }\n  }\n};\n\nSoundScape.prototype.debug = function () {\n  let { layer_state } = this;\n  let ret = [];\n  for (let key in layer_state) {\n    let state = layer_state[key];\n    let data = this.getLayer(key);\n    let { active, rel_intensity } = state;\n    if (active.length || this.intensity > data.min_intensity) {\n      ret.push(`Layer ${key} (${rel_intensity.toFixed(2)})${state.add_blocked ? ' (waiting)' : ''}:`);\n    }\n    for (let ii = 0; ii < active.length; ++ii) {\n      let active_sound = active[ii];\n      ret.push(`  ${active_sound.file}`);\n    }\n  }\n  return ret;\n};\n\nexport function create(params) {\n  return new SoundScape(params);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n// Some code from Turbulenz: Copyright (c) 2012-2013 Turbulenz Limited\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst assert = require('assert');\nconst camera2d = require('./camera2d.js');\nconst engine = require('./engine.js');\nconst geom = require('./geom.js');\nconst { cos, max, min, round, sin } = Math;\nconst textures = require('./textures.js');\nconst shaders = require('./shaders.js');\nconst { nextHighestPowerOfTwo } = require('../../common/util.js');\nconst { vec2, vec4 } = require('./vmath.js');\n\nexport const BLEND_ALPHA = 0;\nexport const BLEND_ADDITIVE = 1;\n\nlet sprite_vshader;\nlet sprite_fshader;\nlet sprite_dual_fshader;\nlet clip_space = vec4();\nlet sprite_shader_params = {\n  clip_space\n};\nlet last_uid = 0;\n\nlet sprite_queue = [];\n\nlet sprite_freelist = [];\n\nlet sprite_queue_stack = null;\nexport function spriteQueuePush() {\n  assert(!sprite_queue_stack);\n  sprite_queue_stack = sprite_queue;\n  sprite_queue = [];\n}\nexport function spriteQueuePop() {\n  assert(sprite_queue_stack);\n  assert(!sprite_queue.length);\n  sprite_queue = sprite_queue_stack;\n  sprite_queue_stack = null;\n}\n\nfunction SpriteData() {\n  // x1 y1 x2 y2 x3 y3 x4 y4 - vertices [0,8)\n  // cr cg cb ca u1 v1 u2 v2 - normalized color + texture [8,16)\n  // data for GL queuing\n  this.data = new Float32Array(16);\n  // data for sorting/binding/etc\n  this.texs = null;\n  this.shader = null;\n  this.shader_params = null;\n  this.x = 0;\n  this.y = 0;\n  this.z = 0;\n  this.blend = 0; // BLEND_ALPHA\n  this.uid = 0;\n}\n\nfunction spriteDataAlloc() {\n  if (sprite_freelist.length) {\n    return sprite_freelist.pop();\n  }\n  return new SpriteData();\n}\n\nfunction cmpSprite(a, b) {\n  if (a.z !== b.z) {\n    return a.z - b.z;\n  }\n  if (a.y !== b.y) {\n    return a.y - b.y;\n  }\n  if (a.x !== b.x) {\n    return a.x - b.x;\n  }\n  return a.uid - b.uid;\n}\n\nexport function queuefn(z, fn) {\n  assert(isFinite(z));\n  sprite_queue.push({\n    fn,\n    x: 0,\n    y: 0,\n    z,\n    uid: ++last_uid\n  });\n}\n\n// coordinates must be in counter-clockwise winding order\nexport function queueraw4(texs, x0, y0, x1, y1, x2, y2, x3, y3, z, u0, v0, u1, v1, color, shader, shader_params, blend) {\n  assert(isFinite(z));\n  let elem = spriteDataAlloc();\n  let data = elem.data;\n  // x1 y1 x2 y2 x3 y3 x4 y4 - vertices [0,8)\n  // cr cg cb ca u1 v1 u2 v2 - normalized color + texture [8,16)\n  // Minor perf improvement: convert by clip_space here (still just a single MAD\n  //   if pre-calculated in the camera) and remove it from the shader.\n  data[0] = (x0 - camera2d.data[0]) * camera2d.data[4];\n  data[1] = (y0 - camera2d.data[1]) * camera2d.data[5];\n  data[2] = (x1 - camera2d.data[0]) * camera2d.data[4];\n  data[3] = (y1 - camera2d.data[1]) * camera2d.data[5];\n  data[4] = (x2 - camera2d.data[0]) * camera2d.data[4];\n  data[5] = (y2 - camera2d.data[1]) * camera2d.data[5];\n  data[6] = (x3 - camera2d.data[0]) * camera2d.data[4];\n  data[7] = (y3 - camera2d.data[1]) * camera2d.data[5];\n  data[8] = color[0];\n  data[9] = color[1];\n  data[10] = color[2];\n  data[11] = color[3];\n  data[12] = u0;\n  data[13] = v0;\n  data[14] = u1;\n  data[15] = v1;\n\n  elem.texs = texs;\n  elem.x = data[0];\n  elem.y = data[1];\n  elem.z = z;\n  elem.shader = shader || null;\n  if (shader_params) {\n    shader_params.clip_space = sprite_shader_params.clip_space;\n    elem.shader_params = shader_params;\n  } else {\n    elem.shader_params = null;\n  }\n  elem.blend = blend || 0; // BLEND_ALPHA\n  //elem.bucket = bucket || this.default_bucket;\n  //elem.tech_params = tech_params || null;\n  elem.uid = ++last_uid;\n  sprite_queue.push(elem);\n  return elem;\n}\n\nexport function queueraw(texs, x, y, z, w, h, u0, v0, u1, v1, color, shader, shader_params, blend) {\n  return queueraw4(texs, x, y, x, y + h, x + w, y + h, x + w, y, z, u0, v0, u1, v1, color, shader, shader_params, blend);\n}\n\nexport function queuesprite(sprite, x, y, z, w, h, rot, uvs, color, shader, shader_params, nozoom, pixel_perfect) {\n  assert(isFinite(z));\n  let elem = spriteDataAlloc();\n  elem.texs = sprite.texs;\n  x = (x - camera2d.data[0]) * camera2d.data[4];\n  y = (y - camera2d.data[1]) * camera2d.data[5];\n  elem.z = z;\n  w *= camera2d.data[4];\n  h *= camera2d.data[5];\n  if (pixel_perfect) {\n    x |= 0;\n    y |= 0;\n    w |= 0;\n    h |= 0;\n  }\n  elem.x = x;\n  elem.y = y;\n  color = color || sprite.color;\n  let data = elem.data;\n  if (!rot) {\n    let x1 = x - sprite.origin[0] * w;\n    let y1 = y - sprite.origin[1] * h;\n    let x2 = x1 + w;\n    let y2 = y1 + h;\n    data[0] = x1;\n    data[1] = y1;\n    data[2] = x1;\n    data[3] = y2;\n    data[4] = x2;\n    data[5] = y2;\n    data[6] = x2;\n    data[7] = y1;\n  } else {\n    let dx = sprite.origin[0] * w;\n    let dy = sprite.origin[1] * h;\n\n    let cosr = cos(rot);\n    let sinr = sin(rot);\n\n    let x1 = x - cosr * dx + sinr * dy;\n    let y1 = y - sinr * dx - cosr * dy;\n    let ch = cosr * h;\n    let cw = cosr * w;\n    let sh = sinr * h;\n    let sw = sinr * w;\n\n    data[0] = x1;\n    data[1] = y1;\n    data[2] = x1 - sh;\n    data[3] = y1 + ch;\n    data[4] = x1 + cw - sh;\n    data[5] = y1 + sw + ch;\n    data[6] = x1 + cw;\n    data[7] = y1 + sw;\n  }\n\n  data[8] = color[0];\n  data[9] = color[1];\n  data[10] = color[2];\n  data[11] = color[3];\n\n  let ubias = 0;\n  let vbias = 0;\n  let tex = elem.texs[0];\n  if (!nozoom && !tex.nozoom) {\n    // Bias the texture coordinates depending on the minification/magnification\n    //   level so we do not get pixels from neighboring frames bleeding in\n    // Use min here (was max in libGlov), to solve tooltip edges being wrong in strict pixely\n    // Use max here to solve box buttons not lining up, but instead using nozoom in drawBox/drawHBox,\n    //   but, that only works for magnification - need the max here for minification!\n    let zoom_level = max((uvs[2] - uvs[0]) * tex.width / w, (uvs[3] - uvs[1]) * tex.height / h); // in texels per pixel\n    if (zoom_level < 1) {\n      // magnification\n      if (tex.filter_mag === gl.LINEAR) {\n        // Need to bias by half a texel, so we're doing absolutely no blending with the neighboring texel\n        ubias = vbias = 0.5;\n      } else if (tex.filter_mag === gl.NEAREST && engine.antialias) {\n        // When antialiasing is on, even nearest sampling samples from adjacent texels, do slight bias\n        // Want to bias by one *pixel's* worth\n        ubias = vbias = zoom_level / 2;\n      }\n    } else if (zoom_level > 1) {\n      // minification\n      // need to apply this bias even with nearest filtering, not exactly sure why\n      let mipped_texels = zoom_level / 2;\n      ubias = vbias = 0.5 + mipped_texels;\n    }\n    if (uvs[0] > uvs[2]) {\n      ubias *= -1;\n    }\n    if (uvs[1] > uvs[3]) {\n      vbias *= -1;\n    }\n  }\n\n  data[12] = uvs[0] + ubias / tex.width;\n  data[13] = uvs[1] + vbias / tex.height;\n  data[14] = uvs[2] - ubias / tex.width;\n  data[15] = uvs[3] - vbias / tex.height;\n\n  elem.uid = ++last_uid;\n  elem.shader = shader || null;\n  elem.blend = 0; // BLEND_ALPHA\n\n  if (shader_params) {\n    shader_params.clip_space = sprite_shader_params.clip_space;\n    elem.shader_params = shader_params;\n  } else {\n    elem.shader_params = null;\n  }\n  sprite_queue.push(elem);\n}\n\nexport function clip(z_start, z_end, x, y, w, h) {\n  let xy = vec2();\n  camera2d.virtualToCanvas(xy, [x, y]);\n  let wh = vec2();\n  camera2d.virtualToCanvas(wh, [x + w, y + h]);\n  xy[0] = round(xy[0]);\n  xy[1] = round(xy[1]);\n  wh[0] = round(wh[0]) - xy[0];\n  wh[1] = round(wh[1]) - xy[1];\n\n  // let gd_w = engine.render_width || engine.width;\n  let gd_h = engine.render_height || engine.height;\n  let scissor = [xy[0], gd_h - (xy[1] + wh[1]), wh[0], wh[1]];\n  queuefn(z_start - 0.01, () => {\n    gl.enable(gl.SCISSOR_TEST);\n    gl.scissor(scissor[0], scissor[1], scissor[2], scissor[3]);\n  });\n  queuefn(z_end - 0.01, () => {\n    gl.disable(gl.SCISSOR_TEST);\n  });\n}\n\nfunction diffTextures(texsa, texsb) {\n  if (texsa.length !== texsb.length) {\n    return true;\n  }\n  for (let ii = 0; ii < texsa.length; ++ii) {\n    if (texsa[ii] !== texsb[ii]) {\n      return true;\n    }\n  }\n  return false;\n}\n\nlet batch_state;\nlet sprite_geom;\nlet sprite_buffer; // Float32Array with 8 entries per vert\nlet sprite_buffer_len = 0; // in verts\nlet sprite_buffer_batch_start = 0;\nlet sprite_buffer_idx = 0; // in verts\nlet last_blend_mode;\nlet last_bound_shader;\nconst MAX_VERT_COUNT = 65536;\nlet batches = [];\n\nfunction commit() {\n  if (sprite_buffer_idx === sprite_buffer_batch_start) {\n    return;\n  }\n  batches.push({\n    state: batch_state,\n    start: sprite_buffer_batch_start,\n    end: sprite_buffer_idx\n  });\n  sprite_buffer_batch_start = sprite_buffer_idx;\n}\n\nfunction commitAndFlush() {\n  commit();\n  if (!batches.length) {\n    return;\n  }\n  assert(sprite_buffer_idx);\n  sprite_geom.update(sprite_buffer, sprite_buffer_idx);\n  sprite_geom.bind();\n\n  for (let ii = 0; ii < batches.length; ++ii) {\n    let batch = batches[ii];\n    let { state, start, end } = batch;\n    if (last_bound_shader !== state.shader || state.shader_params) {\n      shaders.bind(sprite_vshader, state.shader || sprite_fshader, state.shader_params || sprite_shader_params);\n      last_bound_shader = state.shader;\n    }\n    if (last_blend_mode !== state.blend) {\n      last_blend_mode = state.blend;\n      if (last_blend_mode === BLEND_ADDITIVE) {\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\n      } else {\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n      }\n    }\n    textures.bindArray(state.texs);\n    gl.drawElements(sprite_geom.mode, (end - start) * 3 / 2, gl.UNSIGNED_SHORT, start * 3);\n  }\n\n  batches.length = 0;\n  sprite_buffer_idx = 0;\n  sprite_buffer_batch_start = 0;\n}\n\nfunction bufferSpriteData(data) {\n  let index = sprite_buffer_idx * 8;\n  sprite_buffer_idx += 4;\n\n  let c1 = data[8];\n  let c2 = data[9];\n  let c3 = data[10];\n  let c4 = data[11];\n  let u1 = data[12];\n  let v1 = data[13];\n  let u2 = data[14];\n  let v2 = data[15];\n\n  sprite_buffer[index] = data[0];\n  sprite_buffer[index + 1] = data[1];\n  sprite_buffer[index + 2] = c1;\n  sprite_buffer[index + 3] = c2;\n  sprite_buffer[index + 4] = c3;\n  sprite_buffer[index + 5] = c4;\n  sprite_buffer[index + 6] = u1;\n  sprite_buffer[index + 7] = v1;\n\n  sprite_buffer[index + 8] = data[2];\n  sprite_buffer[index + 9] = data[3];\n  sprite_buffer[index + 10] = c1;\n  sprite_buffer[index + 11] = c2;\n  sprite_buffer[index + 12] = c3;\n  sprite_buffer[index + 13] = c4;\n  sprite_buffer[index + 14] = u1;\n  sprite_buffer[index + 15] = v2;\n\n  sprite_buffer[index + 16] = data[4];\n  sprite_buffer[index + 17] = data[5];\n  sprite_buffer[index + 18] = c1;\n  sprite_buffer[index + 19] = c2;\n  sprite_buffer[index + 20] = c3;\n  sprite_buffer[index + 21] = c4;\n  sprite_buffer[index + 22] = u2;\n  sprite_buffer[index + 23] = v2;\n\n  sprite_buffer[index + 24] = data[6];\n  sprite_buffer[index + 25] = data[7];\n  sprite_buffer[index + 26] = c1;\n  sprite_buffer[index + 27] = c2;\n  sprite_buffer[index + 28] = c3;\n  sprite_buffer[index + 29] = c4;\n  sprite_buffer[index + 30] = u2;\n  sprite_buffer[index + 31] = v1;\n}\n\nexport function draw() {\n  if (!sprite_queue.length) {\n    return;\n  }\n  gl.disable(gl.DEPTH_TEST);\n  gl.depthMask(false);\n  gl.enable(gl.BLEND);\n\n  clip_space[0] = 2 / engine.viewport[2];\n  clip_space[1] = -2 / engine.viewport[3];\n\n  last_blend_mode = -1;\n  last_bound_shader = -1;\n\n  if (!sprite_geom) {\n    sprite_geom = geom.create([[shaders.semantic.POSITION, gl.FLOAT, 2, false], [shaders.semantic.COLOR, gl.FLOAT, 4, false], [shaders.semantic.TEXCOORD, gl.FLOAT, 2, false]], [], null, geom.QUADS);\n    sprite_buffer = new Float32Array(1024);\n    sprite_buffer_len = sprite_buffer.length / 8;\n  }\n\n  sprite_queue.sort(cmpSprite);\n\n  batch_state = null;\n  assert.equal(sprite_buffer_idx, 0);\n  assert.equal(sprite_buffer_batch_start, 0);\n  assert.equal(batches.length, 0);\n  for (let ii = 0; ii < sprite_queue.length; ++ii) {\n    let elem = sprite_queue[ii];\n    if (elem.fn) {\n      commitAndFlush();\n      batch_state = null;\n      last_bound_shader = -1;\n      elem.fn();\n    } else {\n      if (!batch_state || diffTextures(elem.texs, batch_state.texs) || elem.shader !== batch_state.shader || elem.shader_params !== batch_state.shader_params || elem.blend !== batch_state.blend) {\n        commit();\n        batch_state = elem;\n      }\n      if (sprite_buffer_idx + 4 > sprite_buffer_len) {\n        commitAndFlush();\n        // batch_state left alone\n        if (sprite_buffer_len !== MAX_VERT_COUNT) {\n          let new_length = min(sprite_buffer_len * 1.25 + 3 & ~3, MAX_VERT_COUNT); // eslint-disable-line no-bitwise\n          sprite_buffer_len = new_length;\n          sprite_buffer = new Float32Array(new_length * 8);\n        }\n      }\n\n      bufferSpriteData(elem.data);\n      sprite_freelist.push(elem);\n    }\n  }\n  commitAndFlush();\n\n  sprite_queue.length = 0;\n  if (last_blend_mode !== BLEND_ALPHA) {\n    // always reset to this\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n  }\n}\n\nexport function buildRects(ws, hs) {\n  let rects = [];\n  let total_w = 0;\n  for (let ii = 0; ii < ws.length; ++ii) {\n    total_w += ws[ii];\n  }\n  let total_h = 0;\n  for (let ii = 0; ii < hs.length; ++ii) {\n    total_h += hs[ii];\n  }\n  let tex_w = nextHighestPowerOfTwo(total_w);\n  let tex_h = nextHighestPowerOfTwo(total_h);\n  let wh = [];\n  for (let ii = 0; ii < ws.length; ++ii) {\n    wh.push(ws[ii] / total_h);\n  }\n  let hw = [];\n  for (let ii = 0; ii < hs.length; ++ii) {\n    hw.push(hs[ii] / total_w);\n  }\n  let aspect = [];\n  let non_square = false;\n  let y = 0;\n  for (let jj = 0; jj < hs.length; ++jj) {\n    let x = 0;\n    for (let ii = 0; ii < ws.length; ++ii) {\n      let r = vec4(x / tex_w, y / tex_h, (x + ws[ii]) / tex_w, (y + hs[jj]) / tex_h);\n      rects.push(r);\n      let asp = ws[ii] / hs[jj];\n      if (asp !== 1) {\n        non_square = true;\n      }\n      aspect.push(asp);\n      x += ws[ii];\n    }\n    y += hs[jj];\n  }\n  return {\n    widths: ws,\n    heights: hs,\n    wh,\n    hw,\n    rects,\n    aspect: non_square ? aspect : null,\n    total_w,\n    total_h\n  };\n}\n\nfunction Sprite(params) {\n  if (params.texs) {\n    this.texs = params.texs;\n  } else {\n    this.texs = [];\n    if (params.tex) {\n      this.texs.push(params.tex);\n    } else if (params.layers) {\n      assert(params.name);\n      this.texs = [];\n      for (let ii = 0; ii < params.layers; ++ii) {\n        this.texs.push(textures.load({\n          url: `img/${params.name}_${ii}.png`,\n          filter_min: params.filter_min,\n          filter_mag: params.filter_mag,\n          wrap_s: params.wrap_s,\n          wrap_t: params.wrap_t\n        }));\n      }\n    } else if (params.name) {\n      this.texs.push(textures.load({\n        url: `img/${params.name}.png`,\n        filter_min: params.filter_min,\n        filter_mag: params.filter_mag,\n        wrap_s: params.wrap_s,\n        wrap_t: params.wrap_t\n      }));\n    } else {\n      assert(params.url);\n      this.texs.push(textures.load(params));\n    }\n  }\n\n  this.origin = params.origin || vec2(0, 0); // [0,1] range\n  this.size = params.size || vec2(1, 1);\n  this.color = params.color || vec4(1, 1, 1, 1);\n  this.uvs = params.uvs || vec4(0, 0, 1, 1);\n  if (!params.uvs) {\n    // Fix up non-power-of-two textures\n    this.texs[0].onLoad(tex => {\n      this.uvs[2] = tex.src_width / tex.width;\n      this.uvs[3] = tex.src_height / tex.height;\n    });\n  }\n\n  if (params.ws) {\n    this.uidata = buildRects(params.ws, params.hs);\n  }\n  this.shader = params.shader || null;\n}\n\n// params:\n//   required: x, y\n//   optional: z, w, h, uvs, color, nozoom, pixel_perfect\nSprite.prototype.draw = function (params) {\n  if (params.w === 0 || params.h === 0) {\n    return;\n  }\n  let w = (params.w || 1) * this.size[0];\n  let h = (params.h || 1) * this.size[1];\n  let uvs = typeof params.frame === 'number' ? this.uidata.rects[params.frame] : params.uvs || this.uvs;\n  queuesprite(this, params.x, params.y, params.z || Z.UI, w, h, params.rot, uvs, params.color || this.color, params.shader || this.shader, params.shader_params, params.nozoom, params.pixel_perfect);\n};\n\nSprite.prototype.drawDualTint = function (params) {\n  params.shader = sprite_dual_fshader;\n  params.shader_params = {\n    color1: params.color1\n  };\n  this.draw(params);\n};\n\nexport function create(params) {\n  return new Sprite(params);\n}\n\nexport function startup() {\n  clip_space[2] = -1;\n  clip_space[3] = 1;\n  sprite_vshader = shaders.create('glov/shaders/sprite.vp');\n  sprite_fshader = shaders.create('glov/shaders/sprite.fp');\n  sprite_dual_fshader = shaders.create('glov/shaders/sprite_dual.fp');\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst assert = require('assert');\nconst { cmd_parse } = require('./cmds.js');\nconst dot_prop = require('dot-prop');\nconst EventEmitter = require('../../common/tiny-events.js');\nconst local_storage = require('./local_storage.js');\nconst md5 = require('../../common/md5.js');\nconst { isPacket } = require('../../common/packet.js');\nconst util = require('../../common/util.js');\n\n// relevant events:\n//   .on('channel_data', cb(data [, mod_key, mod_value]));\n\nfunction ClientChannelWorker(subs, channel_id) {\n  EventEmitter.call(this);\n  this.subs = subs;\n  this.channel_id = channel_id;\n  this.subscriptions = 0;\n  this.subscribe_failed = false;\n  this.got_subscribe = false;\n  this.handlers = {};\n  this.data = {};\n  this.onMsg('channel_data', this.handleChannelData.bind(this));\n  this.onMsg('apply_channel_data', this.handleApplyChannelData.bind(this));\n}\nutil.inherits(ClientChannelWorker, EventEmitter);\n\n// cb(data)\nClientChannelWorker.prototype.onSubscribe = function (cb) {\n  assert(this.subscriptions || this.autosubscribed);\n  this.on('subscribe', cb);\n  if (this.got_subscribe) {\n    cb(this.data); // eslint-disable-line callback-return\n  }\n};\n\n// cb(data)\nClientChannelWorker.prototype.onceSubscribe = function (cb) {\n  assert(this.subscriptions || this.autosubscribed);\n  if (this.got_subscribe) {\n    cb(this.data); // eslint-disable-line callback-return\n  } else {\n    this.once('subscribe', cb);\n  }\n};\n\nClientChannelWorker.prototype.handleChannelData = function (data, resp_func) {\n  console.log(`got channel_data(${this.channel_id}):  ${JSON.stringify(data)}`);\n  this.data = data;\n  this.emit('channel_data', this.data);\n  this.got_subscribe = true;\n  this.emit('subscribe', this.data);\n\n  // Get command list upon first connect\n  let channel_type = this.channel_id.split('.')[0];\n  let cmd_list = this.subs.cmds_list_by_worker;\n  if (!cmd_list[channel_type]) {\n    cmd_list[channel_type] = {};\n    this.send('cmdparse', 'cmd_list', {}, function (err, resp) {\n      if (err) {\n        // already unsubscribed?\n        console.error(`Error getting cmd_list for ${channel_type}`);\n        delete cmd_list[channel_type];\n      } else if (resp.found) {\n        cmd_list[channel_type] = resp;\n        cmd_parse.addServerCommands(resp.resp);\n      }\n    });\n  }\n\n  resp_func();\n};\n\nClientChannelWorker.prototype.handleApplyChannelData = function (data, resp_func) {\n  // already logged in handleChannelMessage\n  // if (!data.q) {\n  //   console.log(`got channel data mod: ${JSON.stringify(data)}`);\n  // }\n  if (data.value === undefined) {\n    dot_prop.delete(this.data, data.key);\n  } else {\n    dot_prop.set(this.data, data.key, data.value);\n  }\n  this.emit('channel_data', this.data, data.key, data.value);\n  resp_func();\n};\n\nClientChannelWorker.prototype.getChannelData = function (key, default_value) {\n  return dot_prop.get(this.data, key, default_value);\n};\n\nClientChannelWorker.prototype.setChannelData = function (key, value, skip_predict, resp_func) {\n  if (!skip_predict) {\n    dot_prop.set(this.data, key, value);\n  }\n  let q = value && value.q || undefined;\n  let pak = this.subs.client.wsPak('set_channel_data');\n  pak.writeAnsiString(this.channel_id);\n  pak.writeBool(q);\n  pak.writeAnsiString(key);\n  pak.writeJSON(value);\n  pak.send(resp_func);\n};\n\nClientChannelWorker.prototype.removeMsgHandler = function (msg, cb) {\n  assert(this.handlers[msg] === cb);\n  delete this.handlers[msg];\n};\n\nClientChannelWorker.prototype.onMsg = function (msg, cb) {\n  assert(!this.handlers[msg] || this.handlers[msg] === cb);\n  this.handlers[msg] = cb;\n};\n\nClientChannelWorker.prototype.pak = function (msg) {\n  let pak = this.subs.client.wsPak('channel_msg');\n  pak.writeAnsiString(this.channel_id);\n  pak.writeAnsiString(msg);\n  // pak.writeInt(flags);\n  return pak;\n};\n\nClientChannelWorker.prototype.send = function (msg, data, opts, resp_func) {\n  assert(typeof opts !== 'function');\n  this.subs.client.send('channel_msg', {\n    channel_id: this.channel_id,\n    msg, data,\n    broadcast: opts && opts.broadcast || undefined,\n    silent_error: opts && opts.silent_error ? 1 : undefined\n  }, resp_func);\n};\n\nfunction SubscriptionManager(client) {\n  EventEmitter.call(this);\n  this.client = client;\n  this.channels = {};\n  this.logged_in = false;\n  this.login_credentials = null;\n  this.logged_in_username = null;\n  this.was_logged_in = false;\n  this.logging_in = false;\n  this.logging_out = false;\n  this.auto_create_user = false;\n  this.cmds_list_by_worker = {};\n\n  this.first_connect = true;\n  this.server_time = 0;\n  this.server_time_interp = 0;\n  client.onMsg('connect', this.handleConnect.bind(this));\n  client.onMsg('channel_msg', this.handleChannelMessage.bind(this));\n  client.onMsg('server_time', this.handleServerTime.bind(this));\n  client.onMsg('admin_msg', this.handleAdminMsg.bind(this));\n}\nutil.inherits(SubscriptionManager, EventEmitter);\n\nSubscriptionManager.prototype.onceConnected = function (cb) {\n  if (this.client.connected) {\n    return void cb();\n  }\n  this.once('connect', cb);\n};\n\nSubscriptionManager.prototype.handleAdminMsg = function (data) {\n  console.error(data);\n  this.emit('admin_msg', data);\n};\n\nSubscriptionManager.prototype.handleConnect = function () {\n  let reconnect = false;\n  if (this.first_connect) {\n    this.first_connect = false;\n  } else {\n    reconnect = true;\n  }\n\n  if (!this.client.connected || this.client.socket.readyState !== 1) {\n    // WebSocket.OPEN\n    // we got disconnected while trying to log in, we'll retry after reconnection\n    return;\n  }\n\n  let subs = this;\n  function resub() {\n    // (re-)subscribe to all channels\n    for (let channel_id in subs.channels) {\n      let channel = subs.channels[channel_id];\n      if (channel.subscriptions) {\n        subs.client.send('subscribe', channel_id, function (err) {\n          if (err) {\n            channel.subscribe_failed = true;\n            console.error(`Error subscribing to ${channel_id}: ${err}`);\n            channel.emit('subscribe_fail', err);\n          }\n        });\n      }\n    }\n    subs.emit('connect', reconnect);\n  }\n\n  if (this.was_logged_in) {\n    // Try to re-connect to existing login\n    this.loginInternal(this.login_credentials, function (err) {\n      if (err && err === 'ERR_DISCONNECTED') {\n        // we got disconnected while trying to log in, we'll retry after reconnection\n      } else if (err) {\n        // Error logging in upon re-connection, no good way to handle this?\n        // TODO: Show some message to the user and prompt them to refresh?  Stay in \"disconnected\" state?\n        assert(false);\n      } else {\n        resub();\n      }\n    });\n  } else {\n    // Try auto-login\n    if (local_storage.get('name') && local_storage.get('password')) {\n      this.login(local_storage.get('name'), local_storage.get('password'), function () {\n        // ignore error on auto-login\n      });\n    }\n\n    resub();\n  }\n};\n\nSubscriptionManager.prototype.handleChannelMessage = function (pak, resp_func) {\n  assert(isPacket(pak));\n  let channel_id = pak.readAnsiString();\n  let msg = pak.readAnsiString();\n  let is_packet = pak.readBool();\n  let data = is_packet ? pak : pak.readJSON();\n  if (!data || !data.q) {\n    let debug_msg;\n    if (!is_packet) {\n      debug_msg = JSON.stringify(data);\n    } else if (typeof data.contents === 'function') {\n      debug_msg = data.contents();\n    } else {\n      debug_msg = '(pak)';\n    }\n    console.log(`got channel_msg(${channel_id}) ${msg}: ${debug_msg}`);\n  }\n  let channel = this.getChannel(channel_id);\n  if (!channel.handlers[msg]) {\n    console.error(`no handler for channel_msg(${channel_id}) ${msg}: ${JSON.stringify(data)}`);\n    return;\n  }\n  channel.handlers[msg](data, resp_func);\n};\n\nSubscriptionManager.prototype.handleServerTime = function (pak) {\n  this.server_time = pak.readInt();\n  if (this.server_time < this.server_time_interp && this.server_time > this.server_time_interp - 250) {\n    // slight time travel backwards, this one packet must have been delayed,\n    // since we once got a packet quicker. Just ignore this, interpolate from\n    // where we were before\n    // TODO: If the server had a short stall (less than 250ms) we might be\n    // ahead from now on!  Slowly interp back to the specified time\n    // (run speed at 90% until it matches?, same thing for catching up to\n    // small jumps ahead)\n  } else {\n    this.server_time_interp = this.server_time;\n  }\n};\n\nSubscriptionManager.prototype.getServerTime = function () {\n  // Interpolated server time as of start of last tick\n  return this.server_time_interp;\n};\n\nSubscriptionManager.prototype.tick = function (dt) {\n  this.server_time_interp += dt;\n};\n\nSubscriptionManager.prototype.subscribe = function (channel_id) {\n  this.getChannel(channel_id, true);\n};\n\nSubscriptionManager.prototype.getChannel = function (channel_id, do_subscribe) {\n  let channel = this.channels[channel_id];\n  if (!channel) {\n    channel = this.channels[channel_id] = new ClientChannelWorker(this, channel_id);\n  }\n  if (do_subscribe) {\n    channel.subscriptions++;\n    if (this.client.connected && channel.subscriptions === 1) {\n      channel.subscribe_failed = false;\n      this.client.send('subscribe', channel_id, function (err) {\n        if (err) {\n          channel.subscribe_failed = true;\n          console.error(`Error subscribing to ${channel_id}: ${err}`);\n          channel.emit('subscribe_fail', err);\n        }\n      });\n    }\n  }\n  return channel;\n};\n\nSubscriptionManager.prototype.getUserId = function () {\n  return this.loggedIn();\n};\n\nSubscriptionManager.prototype.getMyUserChannel = function () {\n  let user_id = this.loggedIn();\n  if (!user_id) {\n    return null;\n  }\n  let channel = this.getChannel(`user.${user_id}`);\n  if (!this.logging_out) {\n    channel.autosubscribed = true;\n  }\n  return channel;\n};\n\nSubscriptionManager.prototype.unsubscribe = function (channel_id) {\n  let channel = this.channels[channel_id];\n  assert(channel);\n  assert(channel.subscriptions);\n  channel.subscriptions--;\n  if (!channel.subscriptions) {\n    channel.got_subscribe = false;\n  }\n  if (this.client.connected && !channel.subscriptions && !channel.subscribe_failed) {\n    this.client.send('unsubscribe', channel_id);\n  }\n};\n\nSubscriptionManager.prototype.onLogin = function (cb) {\n  this.getMyUserChannel();\n  this.on('login', cb);\n  if (this.logged_in) {\n    return void cb();\n  }\n};\n\nSubscriptionManager.prototype.loggedIn = function () {\n  return this.logged_in ? this.logged_in_username || 'missing_name' : false;\n};\n\nSubscriptionManager.prototype.handleLoginResponse = function (resp_func, err, resp) {\n  this.logging_in = false;\n  if (!err) {\n    this.logged_in_username = resp.user_id;\n    this.logged_in_display_name = resp.display_name;\n    this.logged_in = true;\n    this.was_logged_in = true;\n    this.getMyUserChannel();\n    this.emit('login');\n  } else {\n    this.emit('login_fail', err);\n  }\n  resp_func(err);\n};\n\nSubscriptionManager.prototype.loginInternal = function (login_credentials, resp_func) {\n  if (this.logging_in) {\n    return void resp_func('Login already in progress');\n  }\n  this.logging_in = true;\n  this.logged_in = false;\n  this.client.send('login', {\n    user_id: login_credentials.user_id,\n    password: md5(this.client.secret + login_credentials.password)\n  }, this.handleLoginResponse.bind(this, resp_func));\n};\n\nSubscriptionManager.prototype.userCreateInternal = function (params, resp_func) {\n  if (this.logging_in) {\n    return resp_func('Login already in progress');\n  }\n  this.logging_in = true;\n  this.logged_in = false;\n  return this.client.send('user_create', params, this.handleLoginResponse.bind(this, resp_func));\n};\n\nfunction hashedPassword(user_id, password) {\n  if (password.split('$$')[0] === 'prehashed') {\n    password = password.split('$$')[1];\n  } else {\n    password = md5(md5(user_id.toLowerCase()) + password);\n  }\n  return password;\n}\n\nSubscriptionManager.prototype.login = function (username, password, resp_func) {\n  username = (username || '').trim();\n  if (!username) {\n    return resp_func('Missing username');\n  }\n  password = (password || '').trim();\n  if (!password) {\n    return resp_func('Missing password');\n  }\n  let hashed_password = hashedPassword(username, password);\n  if (hashed_password !== password) {\n    local_storage.set('password', `prehashed$$${hashed_password}`);\n  }\n  this.login_credentials = { user_id: username, password: hashed_password };\n  if (!this.auto_create_user) {\n    // Just return result directly\n    return this.loginInternal(this.login_credentials, resp_func);\n  }\n  return this.loginInternal(this.login_credentials, (err, data) => {\n    if (!err || err !== 'ERR_USER_NOT_FOUND') {\n      return void resp_func(err, data);\n    }\n    // user not found, auto-create\n    this.userCreate({\n      user_id: username,\n      password,\n      password_confirm: password,\n      email: 'autocreate@glovjs.org'\n    }, resp_func);\n  });\n};\n\nSubscriptionManager.prototype.userCreate = function (params, resp_func) {\n  params.user_id = (params.user_id || '').trim();\n  if (!params.user_id) {\n    return resp_func('Missing username');\n  }\n  params.password = (params.password || '').trim();\n  if (!params.password) {\n    return resp_func('Missing password');\n  }\n  params.password_confirm = (params.password_confirm || '').trim();\n  if (!this.auto_create_user && !params.password_confirm) {\n    return resp_func('Missing password confirmation');\n  }\n  params.email = (params.email || '').trim();\n  if (!this.auto_create_user && !params.email) {\n    return resp_func('Missing email');\n  }\n  params.display_name = (params.display_name || '').trim();\n  let hashed_password = hashedPassword(params.user_id, params.password);\n  if (hashed_password !== params.password) {\n    local_storage.set('password', `prehashed$$${hashed_password}`);\n  }\n  let hashed_password_confirm = hashedPassword(params.user_id, params.password_confirm);\n  if (hashed_password !== hashed_password_confirm) {\n    return resp_func('Passwords do not match');\n  }\n  this.login_credentials = { user_id: params.user_id, password: hashed_password };\n  return this.userCreateInternal({\n    display_name: params.display_name || params.user_id,\n    user_id: params.user_id,\n    email: params.email,\n    password: hashed_password\n  }, resp_func);\n};\n\nSubscriptionManager.prototype.logout = function () {\n  assert(this.logged_in);\n  assert(!this.logging_in);\n  assert(!this.logging_out);\n  // Don't know how to gracefully handle logging out with subscriptions currently, assert we have none\n  for (let channel_id in this.channels) {\n    let channel = this.channels[channel_id];\n    assert(!channel.subscriptions, `Remaining active subscription for ${channel_id}`);\n    if (channel.autosubscribed) {\n      channel.autosubscribed = false;\n    }\n  }\n\n  this.logging_out = true;\n  this.client.send('logout', null, err => {\n    this.logging_out = false;\n    if (!err) {\n      local_storage.set('password', undefined);\n      this.logged_in = false;\n      this.logged_in_username = null;\n      this.was_logged_in = false;\n      this.login_credentials = null;\n      this.emit('logout');\n    }\n  });\n};\n\nSubscriptionManager.prototype.sendCmdParse = function (command, resp_func) {\n  let self = this;\n  let channel_ids = Object.keys(self.channels);\n  let idx = 0;\n  let last_error = 'Unknown command';\n  function tryNext() {\n    let channel_id;\n    let channel;\n    do {\n      channel_id = channel_ids[idx++];\n      channel = self.channels[channel_id];\n    } while (channel_id && (!channel || !(channel.subscriptions || channel.autosubscribed)));\n    if (!channel_id) {\n      return resp_func(last_error);\n    }\n    return channel.send('cmdparse', command, { silent_error: 1 }, function (err, resp) {\n      if (err || resp && resp.found) {\n        return resp_func(err, resp ? resp.resp : null);\n      }\n      // otherwise, was not found\n      if (resp && resp.err) {\n        last_error = resp.err;\n      }\n      return self.onceConnected(tryNext);\n    });\n  }\n  self.onceConnected(tryNext);\n};\n\nexport function create(client) {\n  return new SubscriptionManager(client);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint-env browser */\n\nconst assert = require('assert');\nconst engine = require('./engine.js');\nconst { filewatchOn } = require('./filewatch.js');\nconst local_storage = require('./local_storage.js');\nconst urlhash = require('./urlhash.js');\nconst { callEach, isPowerOfTwo, nextHighestPowerOfTwo, ridx } = require('../../common/util.js');\n\nconst TEX_UNLOAD_TIME = 5 * 60 * 1000; // for textures loaded (each frame) with auto_unload: true\n\nexport let textures = {};\nexport let load_count = 0;\nlet aniso = 4;\nlet max_aniso = 0;\nlet aniso_enum;\n\nlet default_filter_min;\nlet default_filter_mag;\n\nconst cube_faces = [{ target: 'TEXTURE_CUBE_MAP_NEGATIVE_X', pos: [0, 1] }, { target: 'TEXTURE_CUBE_MAP_POSITIVE_X', pos: [0, 0] }, { target: 'TEXTURE_CUBE_MAP_NEGATIVE_Y', pos: [1, 0] }, { target: 'TEXTURE_CUBE_MAP_POSITIVE_Y', pos: [1, 1] }, { target: 'TEXTURE_CUBE_MAP_NEGATIVE_Z', pos: [2, 0] }, { target: 'TEXTURE_CUBE_MAP_POSITIVE_Z', pos: [2, 1] }];\n\nexport const format = {\n  R8: { count: 1 },\n  RGB8: { count: 3 },\n  RGBA8: { count: 4 }\n};\n\nexport function defaultFilters(min, mag) {\n  default_filter_min = min;\n  default_filter_mag = mag;\n}\n\nlet bound_unit = null;\nlet bound_tex = [];\n\nlet handle_loading;\nlet handle_error;\n\nlet global_timer;\n\nfunction setUnit(unit) {\n  if (unit !== bound_unit) {\n    gl.activeTexture(gl.TEXTURE0 + unit);\n    bound_unit = unit;\n  }\n}\n\nfunction bindHandle(unit, target, handle) {\n  if (bound_tex[unit] !== handle) {\n    setUnit(unit);\n    gl.bindTexture(target, handle);\n    bound_tex[unit] = handle;\n  }\n}\n\nfunction unbindAll(target) {\n  for (let unit = 0; unit < bound_tex.length; ++unit) {\n    setUnit(unit);\n    gl.bindTexture(target, target === gl.TEXTURE_2D ? handle_loading : null);\n    bound_tex[unit] = null;\n  }\n}\n\nexport function bind(unit, tex) {\n  tex.last_use = global_timer;\n  // May or may not change the unit\n  bindHandle(unit, tex.target, tex.eff_handle);\n}\n\n// hot path inlined for perf\nexport function bindArray(texs) {\n  for (let ii = 0; ii < texs.length; ++ii) {\n    let tex = texs[ii];\n    tex.last_use = global_timer;\n    let handle = tex.eff_handle;\n    if (bound_tex[ii] !== handle) {\n      if (ii !== bound_unit) {\n        gl.activeTexture(gl.TEXTURE0 + ii);\n        bound_unit = ii;\n      }\n      gl.bindTexture(tex.target, handle);\n      bound_tex[ii] = handle;\n    }\n  }\n}\n\nexport function isArrayBound(texs) {\n  for (let ii = 0; ii < texs.length; ++ii) {\n    let tex = texs[ii];\n    let handle = tex.eff_handle;\n    if (bound_tex[ii] !== handle) {\n      return false;\n    }\n  }\n  return true;\n}\n\nlet auto_unload_textures = [];\n\nfunction Texture(params) {\n  this.name = params.name;\n  this.loaded = false;\n  this.load_fail = false;\n  this.target = params.target || gl.TEXTURE_2D;\n  this.is_array = this.target === gl.TEXTURE_2D_ARRAY;\n  this.is_cube = this.target === gl.TEXTURE_CUBE_MAP;\n  this.handle = gl.createTexture();\n  this.eff_handle = handle_loading;\n  this.setSamplerState(params);\n  this.src_width = this.src_height = 1;\n  this.width = this.height = 1;\n  this.nozoom = params.nozoom || false;\n  this.on_load = [];\n  this.gpu_mem = 0;\n  this.soft_error = params.soft_error || false;\n  this.last_use = global_timer;\n  this.auto_unload = params.auto_unload || false;\n  if (this.auto_unload) {\n    auto_unload_textures.push(this);\n  }\n\n  this.format = params.format || format.RGBA8;\n\n  if (params.data) {\n    let err = this.updateData(params.width, params.height, params.data);\n    assert(!err, err);\n  } else {\n    // texture is not valid, do not leave bound\n    unbindAll(this.target);\n    if (params.url) {\n      this.url = params.url;\n      this.loadURL(params.url);\n    }\n  }\n}\n\nTexture.prototype.updateGPUMem = function () {\n  let new_size = this.width * this.height * this.format.count;\n  if (this.mipmaps) {\n    new_size *= 1.5;\n  }\n  let diff = new_size - this.gpu_mem;\n  engine.perf_state.gpu_mem.tex += diff;\n  this.gpu_mem = diff;\n};\n\nTexture.prototype.setSamplerState = function (params) {\n  let target = this.target;\n  setUnit(0);\n  bound_tex[0] = null; // Force a re-bind, no matter what\n  bindHandle(0, target, this.handle);\n\n  this.filter_min = params.filter_min || default_filter_min;\n  this.filter_mag = params.filter_mag || default_filter_mag;\n  gl.texParameteri(target, gl.TEXTURE_MIN_FILTER, this.filter_min);\n  gl.texParameteri(target, gl.TEXTURE_MAG_FILTER, this.filter_mag);\n  this.wrap_s = params.wrap_s || gl.REPEAT;\n  this.wrap_t = params.wrap_t || gl.REPEAT;\n  gl.texParameteri(target, gl.TEXTURE_WRAP_S, this.wrap_s);\n  gl.texParameteri(target, gl.TEXTURE_WRAP_T, this.wrap_t);\n\n  this.mipmaps = this.filter_min >= 0x2700 && this.filter_min <= 0x2703; // Probably gl.LINEAR_MIPMAP_LINEAR\n\n  if (max_aniso) {\n    if (this.mipmaps && params.filter_mag !== gl.NEAREST) {\n      gl.texParameterf(gl.TEXTURE_2D, aniso_enum, aniso);\n    } else {\n      gl.texParameterf(gl.TEXTURE_2D, aniso_enum, 1);\n    }\n  }\n};\n\nTexture.prototype.updateData = function updateData(w, h, data) {\n  assert(!this.destroyed);\n  setUnit(0);\n  bound_tex[0] = null; // Force a re-bind, no matter what\n  bindHandle(0, this.target, this.handle);\n  this.last_use = global_timer;\n  this.src_width = w;\n  this.src_height = h;\n  this.width = w;\n  this.height = h;\n  gl.getError(); // clear the error flag if there is one\n  // Resize NP2 if this is not being used for a texture array, and it is not explicitly allowed (non-mipmapped, wrapped)\n  let np2 = (!isPowerOfTwo(w) || !isPowerOfTwo(h)) && !this.is_array && !this.is_cube && !(!this.mipmaps && this.wrap_s === gl.CLAMP_TO_EDGE && this.wrap_t === gl.CLAMP_TO_EDGE);\n  if (np2) {\n    this.width = nextHighestPowerOfTwo(w);\n    this.height = nextHighestPowerOfTwo(h);\n    gl.texImage2D(this.target, 0, this.format.internal_type, this.width, this.height, 0, this.format.internal_type, this.format.gl_type, null);\n  }\n  if (data instanceof Uint8Array) {\n    assert(data.length >= w * h * this.format.count);\n    assert(!this.is_cube);\n    if (this.is_array) {\n      let num_images = h / w; // assume square\n      gl.texImage3D(this.target, 0, this.format.internal_type, w, w, num_images, 0, this.format.internal_type, this.format.gl_type, data);\n    } else if (np2) {\n      // Could do multiple upload thing like below, but smarter, but we really shouldn't be doing this for\n      // in-process generated images!\n      gl.texSubImage2D(this.target, 0, 0, 0, w, h, this.format.internal_type, this.format.gl_type, data);\n    } else {\n      gl.texImage2D(this.target, 0, this.format.internal_type, w, h, 0, this.format.internal_type, this.format.gl_type, data);\n    }\n  } else {\n    assert(data.width); // instanceof Image fails with ublock AdBlocker; also, this is either an Image or Canvas\n    if (this.is_cube) {\n      assert.equal(w * 2, h * 3);\n      let tex_size = h / 2;\n      let canvas = document.createElement('canvas');\n      canvas.width = tex_size;\n      canvas.height = tex_size;\n      let ctx = canvas.getContext('2d');\n      for (let ii = 0; ii < cube_faces.length; ++ii) {\n        let face = cube_faces[ii];\n        ctx.drawImage(data, face.pos[0] * tex_size, face.pos[1] * tex_size, tex_size, tex_size, 0, 0, tex_size, tex_size);\n        gl.texImage2D(gl[face.target], 0, this.format.internal_type, this.format.internal_type, this.format.gl_type, canvas);\n      }\n    } else if (this.is_array) {\n      let num_images = h / w;\n      gl.texImage3D(this.target, 0, this.format.internal_type, w, w, num_images, 0, this.format.internal_type, this.format.gl_type, data);\n\n      if (gl.getError()) {\n        // Fix for Samsung devices (Chris's and Galaxy S8 on CrossBrowserTesting)\n        // Try drawing to canvas first\n        let canvas = document.createElement('canvas');\n        canvas.width = w;\n        canvas.height = h;\n        let ctx = canvas.getContext('2d');\n        ctx.drawImage(data, 0, 0);\n        gl.texImage3D(this.target, 0, this.format.internal_type, w, w, num_images, 0, this.format.internal_type, this.format.gl_type, canvas);\n      }\n    } else if (np2) {\n      // Pad up to power of two\n      // Duplicate right and bottom pixel row by sending image 3 times\n      if (w !== this.width) {\n        gl.texSubImage2D(this.target, 0, 1, 0, this.format.internal_type, this.format.gl_type, data);\n      }\n      if (h !== this.height) {\n        gl.texSubImage2D(this.target, 0, 0, 1, this.format.internal_type, this.format.gl_type, data);\n      }\n      gl.texSubImage2D(this.target, 0, 0, 0, this.format.internal_type, this.format.gl_type, data);\n    } else {\n      gl.texImage2D(this.target, 0, this.format.internal_type, this.format.internal_type, this.format.gl_type, data);\n    }\n  }\n  let gl_err = gl.getError();\n  if (gl_err) {\n    return gl_err;\n  }\n  if (this.mipmaps) {\n    gl.generateMipmap(this.target);\n    assert(!gl.getError());\n  }\n  this.updateGPUMem();\n  this.eff_handle = this.handle;\n  this.loaded = true;\n\n  callEach(this.on_load, this.on_load = null, this);\n\n  return 0;\n};\n\nTexture.prototype.onLoad = function (cb) {\n  if (this.loaded) {\n    cb(this); // eslint-disable-line callback-return\n  } else {\n    this.on_load.push(cb);\n  }\n};\n\nlet texture_base_url = '';\nexport function getExternalTextureURL(url) {\n  if (!url.match(/^.{2,7}:/)) {\n    url = `${texture_base_url || urlhash.getURLBase()}${url}`;\n  }\n  return url;\n}\nexport function setExternalTextureBaseURL(base_url) {\n  texture_base_url = base_url;\n}\n\nconst TEX_RETRY_COUNT = 4;\nTexture.prototype.loadURL = function loadURL(url, filter) {\n  let tex = this;\n  assert(!tex.destroyed);\n\n  // When our browser's location has been changed from 'site.com/foo/' to\n  //  'site.com/foo/bar/7' our relative image URLs are still relative to the\n  //  base.  Maybe should set some meta tag to do this instead?\n  if (!url.match(/^.{2,7}:/)) {\n    url = `${urlhash.getURLBase()}${url}`;\n  }\n\n  function tryLoad(next) {\n    let did_next = false;\n    function done(img) {\n      if (!did_next) {\n        did_next = true;\n        return void next(img);\n      }\n    }\n\n    let img = new Image();\n    img.onload = function () {\n      done(img);\n    };\n    function fail() {\n      done(null);\n    }\n    img.onerror = fail;\n    img.crossOrigin = 'anonymous';\n    img.src = url;\n  }\n\n  ++load_count;\n  let retries = 0;\n  function handleLoad(img) {\n    let err_details = '';\n    if (img) {\n      tex.format = format.RGBA8;\n      if (filter) {\n        img = filter(tex, img);\n      }\n      let err = tex.updateData(img.width, img.height, img);\n      if (err) {\n        err_details = `: GLError(${err})`;\n        // Samsung TV gets 1282 on texture arrays\n        // Samsung Galaxy S6 gets 1281 on texture arrays\n        if (tex.is_array && (String(err) === '1282' || String(err) === '1281') && engine.webgl2 && !engine.DEBUG) {\n          local_storage.setJSON('webgl2_disable', {\n            ua: navigator.userAgent,\n            ts: Date.now()\n          });\n          console.error(`Error loading array texture \"${url}\"${err_details}, reloading without WebGL2..`);\n          engine.reloadSafe();\n          return;\n        }\n        retries = TEX_RETRY_COUNT; // do not retry this\n      } else {\n        --load_count;\n        return;\n      }\n    }\n    let err = `Error loading texture \"${url}\"${err_details}`;\n    retries++;\n    if (retries > TEX_RETRY_COUNT) {\n      --load_count;\n      tex.eff_handle = handle_error;\n      tex.load_fail = true;\n      console.error(`${err}${err_details ? '' : ', retries failed'}`);\n      if (tex.soft_error) {\n        tex.err = 'Load failed';\n      } else {\n        assert(false, err);\n      }\n      return;\n    }\n    console.error(`${err}, retrying... `);\n    setTimeout(tryLoad.bind(null, handleLoad), 100 * retries * retries);\n  }\n  tryLoad(handleLoad);\n};\n\nTexture.prototype.copyTexImage = function (x, y, w, h) {\n  assert(!this.destroyed);\n  assert(w && h);\n  bindHandle(0, this.target, this.handle);\n  gl.copyTexImage2D(this.target, 0, gl.RGB, x, y, w, h, 0);\n  this.last_use = global_timer;\n  this.src_width = this.width = w;\n  this.src_height = this.height = h;\n  this.updateGPUMem();\n};\n\nTexture.prototype.destroy = function () {\n  if (this.destroyed) {\n    return;\n  }\n  assert(this.name);\n  let auto_unload = this.auto_unload;\n  if (auto_unload) {\n    this.auto_unload = null;\n    let idx = auto_unload_textures.indexOf(this);\n    assert(idx !== -1);\n    ridx(auto_unload_textures, idx);\n  }\n  delete textures[this.name];\n  unbindAll(this.target);\n  gl.deleteTexture(this.handle);\n  this.width = this.height = 0;\n  this.updateGPUMem();\n  this.destroyed = true;\n  if (typeof auto_unload === 'function') {\n    auto_unload();\n  }\n};\n\nfunction create(params) {\n  assert(params.name);\n  let texture = new Texture(params);\n  textures[params.name] = texture;\n  return texture;\n}\n\nlet last_temporary_id = 0;\nexport function createForCapture(unique_name, auto_unload) {\n  let name = unique_name || `screen_temporary_tex_${++last_temporary_id}`;\n  assert(!textures[name]);\n  let texture = create({\n    filter_min: gl.NEAREST,\n    filter_mag: gl.NEAREST,\n    wrap_s: gl.CLAMP_TO_EDGE,\n    wrap_t: gl.CLAMP_TO_EDGE,\n    format: format.RGB8,\n    name,\n    auto_unload\n  });\n  texture.loaded = true;\n  texture.eff_handle = texture.handle;\n  return texture;\n}\n\nexport function load(params) {\n  let key = params.name = params.name || params.url;\n  assert(key);\n  let tex = textures[key];\n  if (!tex) {\n    tex = create(params);\n  }\n  tex.last_use = global_timer;\n  return tex;\n}\n\nexport function cname(key) {\n  let idx = key.lastIndexOf('/');\n  if (idx !== -1) {\n    key = key.slice(idx + 1);\n  }\n  idx = key.indexOf('.');\n  if (idx !== -1) {\n    key = key.slice(0, idx);\n  }\n  return key.toLowerCase();\n}\nexport function findTexForReplacement(search_key) {\n  search_key = cname(search_key);\n  for (let key in textures) {\n    let compare_key = cname(key);\n    if (compare_key === search_key) {\n      return textures[key];\n    }\n  }\n  return null;\n}\n\nlet tick_next_tex = 0;\nexport function texturesTick() {\n  global_timer = engine.global_timer;\n  let len = auto_unload_textures.length;\n  if (!len) {\n    return;\n  }\n  if (tick_next_tex >= len) {\n    tick_next_tex = 0;\n  }\n  let tex = auto_unload_textures[tick_next_tex];\n  if (tex.last_use < global_timer - TEX_UNLOAD_TIME) {\n    console.log(`Unloading texture ${tex.name}`);\n    tex.destroy();\n  } else {\n    ++tick_next_tex;\n  }\n}\n\nexport function texturesUnloadDynamic() {\n  while (auto_unload_textures.length) {\n    auto_unload_textures[0].destroy();\n  }\n}\n\nfunction textureReload(filename) {\n  let tex = textures[filename];\n  if (tex && tex.url) {\n    tex.loadURL(`${tex.url}?rl=${Date.now()}`);\n  }\n}\n\nexport function startup() {\n\n  default_filter_min = gl.LINEAR_MIPMAP_LINEAR;\n  default_filter_mag = gl.LINEAR;\n\n  format.R8.internal_type = gl.LUMINANCE;\n  format.R8.gl_type = gl.UNSIGNED_BYTE;\n  format.RGB8.internal_type = gl.RGB;\n  format.RGB8.gl_type = gl.UNSIGNED_BYTE;\n  format.RGBA8.internal_type = gl.RGBA;\n  format.RGBA8.gl_type = gl.UNSIGNED_BYTE;\n\n  let ext_anisotropic = gl.getExtension('EXT_texture_filter_anisotropic') || gl.getExtension('MOZ_EXT_texture_filter_anisotropic') || gl.getExtension('WEBKIT_EXT_texture_filter_anisotropic');\n  if (ext_anisotropic) {\n    aniso_enum = ext_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT;\n    aniso = max_aniso = gl.getParameter(ext_anisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT);\n  }\n\n  handle_error = load({\n    name: 'error',\n    width: 2, height: 2,\n    nozoom: true,\n    format: format.RGBA8,\n    filter_mag: gl.NEAREST,\n    data: new Uint8Array([255, 20, 147, 255, 255, 0, 0, 255, 255, 255, 255, 255, 255, 20, 147, 255])\n  }).handle;\n\n  handle_loading = load({\n    name: 'loading',\n    width: 2, height: 2,\n    nozoom: true,\n    format: format.RGBA8,\n    data: new Uint8Array([127, 127, 127, 255, 0, 0, 0, 255, 64, 64, 64, 255, 127, 127, 127, 255])\n  }).handle;\n\n  load({\n    name: 'white',\n    width: 2, height: 2,\n    nozoom: true,\n    format: format.RGBA8,\n    data: new Uint8Array([255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255])\n  });\n\n  load({\n    name: 'invisible',\n    width: 2, height: 2,\n    nozoom: true,\n    format: format.RGBA8,\n    data: new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])\n  });\n\n  filewatchOn('.png', textureReload);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst assert = require('assert');\nconst camera2d = require('./camera2d.js');\nconst glov_engine = require('./engine.js');\nconst { floor, min, pow, random } = Math;\nconst sprites = require('./sprites.js');\nconst shaders = require('./shaders.js');\nconst textures = require('./textures.js');\nconst glov_ui = require('./ui.js');\nconst { easeOut } = require('../../common/util.js');\nconst { unit_vec, vec4 } = require('./vmath.js');\n\nlet transitions = [];\n\nexport const IMMEDIATE = 'immediate';\n\nexport const REMOVE = 'remove';\nexport const CONTINUE = 'continue';\n\nconst shader_data = {\n  transition_pixelate: {\n    fp: 'glov/shaders/transition_pixelate.fp'\n  }\n};\n\nfunction getShader(key) {\n  let elem = shader_data[key];\n  if (!elem.shader) {\n    elem.shader = shaders.create(elem.fp);\n  }\n  return elem.shader;\n}\n\nclass GlovTransition {\n  constructor(z, func) {\n    this.z = z;\n    this.capture = null;\n    this.func = func;\n    this.accum_time = 0;\n  }\n}\n\nfunction transitionCapture(trans) {\n  assert(!trans.capture);\n  trans.capture = textures.createForCapture();\n  glov_engine.captureFramebuffer(trans.capture);\n}\n\nexport function queue(z, fn) {\n  let immediate = false;\n  if (z === IMMEDIATE) {\n    immediate = true;\n    z = Z.TRANSITION_FINAL;\n  }\n\n  for (let ii = 0; ii < transitions.length; ++ii) {\n    let trans = transitions[ii];\n    if (trans.z === z) {\n      // same Z\n      assert(trans.capture);\n      if (!trans.capture) {\n        // two transitions at the same Z on one frame!  ignore second\n        return false;\n      }\n    }\n  }\n  let trans = new GlovTransition(z, fn);\n  transitions.push(trans);\n\n  if (immediate) {\n    transitionCapture(trans);\n  }\n  return true;\n}\n\nfunction destroyTexture(tex) {\n  tex.destroy();\n}\n\nexport function render(dt) {\n  dt = min(dt, 100); // debug: clamp frame times\n  for (let trans_idx = 0; trans_idx < transitions.length; ++trans_idx) {\n    let trans = transitions[trans_idx];\n    trans.accum_time += dt;\n    if (!trans.capture) {\n      // queue up a capture past the specified Z, so transitions rendering at that Z (plus a handful) get captured\n      sprites.queuefn(trans.z + Z.TRANSITION_RANGE, transitionCapture.bind(null, trans));\n    } else if (trans.capture) {\n      // call the function and give them the Z\n      // If not the last one, want it to end now!\n      let force_end = trans_idx < transitions.length - 1;\n      let ret = trans.func(trans.z, trans.capture, trans.accum_time, force_end);\n      if (ret === REMOVE) {\n        setTimeout(destroyTexture.bind(null, trans.capture), 0);\n        transitions.splice(trans_idx, 1);\n        trans_idx--;\n      }\n    }\n  }\n}\n\nexport function active() {\n  return transitions.length;\n}\n\nfunction glovTransitionFadeFunc(fade_time, z, initial, ms_since_start, force_end) {\n  let progress = min(ms_since_start / fade_time, 1);\n  let alpha = 1 - easeOut(progress, 2);\n  let color = vec4(1, 1, 1, alpha);\n  camera2d.setNormalized();\n  sprites.queueraw4([initial], 0, 0, 0, 1, 1, 1, 1, 0, z, 0, 1, 1, 0, color);\n\n  if (force_end || progress === 1) {\n    return REMOVE;\n  }\n  return CONTINUE;\n}\n\n/*\n  // Doesn't work because we need more than just 2 UV values in the queue call\nfunction glovTransitionWipeFunc(wipe_time, wipe_angle, z, tex, ms_since_start, force_end) {\n  let progress = min(ms_since_start / wipe_time, 1);\n\n  camera2d.setNormalized();\n\n  let uvs = [[0,1], [1,0]];\n\n  let points = [{}, {}, {}, {}];\n  for (let ii = 0; ii < 4; ii++) {\n    let x = (ii === 1 || ii === 2) ? 1 : 0;\n    let y = (ii >= 2) ? 1 : 0;\n    points[ii].x = x;\n    points[ii].y = y;\n  }\n\n  while (wipe_angle > PI) {\n    wipe_angle -= (2 * PI);\n  }\n  while (wipe_angle < -PI) {\n    wipe_angle += (2 * PI);\n  }\n\n  // TODO: if anyone ever uses this, change 0 degrees to be up, not right, to match other things?\n  if (wipe_angle >= -PI_4 && wipe_angle <= PI_4) {\n    // horizontal wipe from left to right\n    let x0 = progress * 2; // rightmost x\n    let x1 = x0 - sin(abs(wipe_angle)) / SQRT1_2; // leftmost x\n    if (wipe_angle < 0) {\n      points[0].x = x1;\n      points[3].x = x0;\n    } else {\n      points[0].x = x0;\n      points[3].x = x1;\n    }\n    points[1].x = points[2].x = 2;\n  } else if (wipe_angle >= PI_2 + PI_4 || wipe_angle <= -PI_2 - PI_4) {\n    // horizontal wipe from right to left\n    let x0 = 1 - progress * 2; // leftmost x\n    let x1 = x0 + sin(abs(wipe_angle)) / SQRT1_2; // rightmost x,\n    if (wipe_angle < 0) {\n      points[1].x = x1;\n      points[2].x = x0;\n    } else {\n      points[1].x = x0;\n      points[2].x = x1;\n    }\n    points[0].x = points[3].x = -1;\n  } else if (wipe_angle > PI_4 && wipe_angle <= PI_2 + PI_4) {\n    // vertical wipe, top to bottom\n    let y0 = progress * 2; // bottommost y\n    let offs = cos(wipe_angle) / SQRT1_2;\n    let y1 = y0 - abs(offs); // topmost y,\n    if (offs > 0) {\n      points[0].y = y0;\n      points[1].y = y1;\n    } else {\n      points[0].y = y1;\n      points[1].y = y0;\n    }\n    points[2].y = points[3].y = 2;\n  } else {\n    // vertical wipe, bottom to top\n    let y0 = 1 - progress * 2; // topmost y\n    let offs = cos(wipe_angle) / SQRT1_2;\n    let y1 = y0 + abs(offs); // bottommost y,\n    if (offs > 0) {\n      points[2].y = y1;\n      points[3].y = y0;\n    } else {\n      points[2].y = y0;\n      points[3].y = y1;\n    }\n    points[0].y = points[1].y = -1;\n  }\n  // interp UVs based on points\n  points[0].u = lerp(points[0].x, uvs[0][0], uvs[1][0]);\n  points[1].u = lerp(points[1].x, uvs[0][0], uvs[1][0]);\n  points[2].u = lerp(points[2].x, uvs[0][0], uvs[1][0]);\n  points[3].u = lerp(points[3].x, uvs[0][0], uvs[1][0]);\n  points[0].v = lerp(points[0].y, uvs[0][1], uvs[1][1]);\n  points[1].v = lerp(points[1].y, uvs[0][1], uvs[1][1]);\n  points[2].v = lerp(points[2].y, uvs[0][1], uvs[1][1]);\n  points[3].v = lerp(points[3].y, uvs[0][1], uvs[1][1]);\n\n  sprites.queueraw4([tex],\n    points[0].x, points[0].y, points[3].x, points[3].y,\n    points[2].x, points[2].y, points[1].x, points[1].y,\n    z,\n    points[0].u, points[0].v, points[2].u, points[2].v,\n    unit_vec, 'alpha_nearest');\n\n  if (force_end || progress === 1) {\n    return REMOVE;\n  }\n  return CONTINUE;\n}\n\n*/\n\nfunction glovTransitionSplitScreenFunc(time, border_width, slide_window, z, tex, ms_since_start, force_end) {\n  let border_color = vec4(1, 1, 1, 1);\n  let progress = easeOut(min(ms_since_start / time, 1), 2);\n  camera2d.setNormalized();\n\n  let uvs = [[0, 1], [1, 0]];\n\n  let xoffs = progress;\n  let v_half = uvs[0][1] + (uvs[1][1] - uvs[0][1]) / 2;\n  if (slide_window) {\n    // slide window\n    sprites.queueraw([tex], 0, 0, z, 1 - xoffs, 1 / 2, 0, uvs[0][1], uvs[1][0] * (1 - progress), v_half, unit_vec);\n    sprites.queueraw([tex], 0 + xoffs, 1 / 2, z, 1 - xoffs, 1 / 2, uvs[1][0] * progress, v_half, uvs[1][0], uvs[1][1], unit_vec);\n  } else {\n    // slide image\n    sprites.queueraw([tex], 0 - xoffs, 0, z, 1, 1 / 2, uvs[0][0], uvs[0][1], uvs[1][0], v_half, unit_vec);\n    sprites.queueraw([tex], 0 + xoffs, 1 / 2, z, 1, 1 / 2, uvs[0][0], v_half, uvs[1][0], uvs[1][1], unit_vec);\n  }\n  let border_grow_progress = min(progress * 4, 1);\n  border_color[3] = border_grow_progress;\n  border_width *= border_grow_progress;\n  // TODO: Would look better if the horizontal border grew from the middle out, so the overlapping bit is identical\n  // on both sides\n  glov_ui.drawRect(0, 0.5 - border_width, 1 - xoffs, 0.5, z + 1, border_color);\n  glov_ui.drawRect(1 - xoffs - border_width, 0, 1 - xoffs, 0.5, z + 1, border_color);\n  glov_ui.drawRect(xoffs, 0.5, 1, 0.5 + border_width, z + 1, border_color);\n  glov_ui.drawRect(xoffs, 0.5, xoffs + border_width, 1, z + 1, border_color);\n\n  if (force_end || progress === 1) {\n    return REMOVE;\n  }\n  return CONTINUE;\n}\n\nconst render_scale = 1;\nlet transition_pixelate_texture;\n\nfunction transitionPixelateCapture() {\n  if (!transition_pixelate_texture) {\n    transition_pixelate_texture = textures.createForCapture();\n  }\n  glov_engine.captureFramebuffer(transition_pixelate_texture);\n}\n\nfunction glovTransitionPixelateFunc(time, z, tex, ms_since_start, force_end) {\n  //ms_since_start %= time;\n  //let viewport = glov_engine.graphics_device.getViewport();\n  //let gd_width = viewport[2];\n  let gd_width = glov_engine.width;\n  let progress = min(ms_since_start / time, 1);\n  camera2d.setNormalized();\n\n  if (progress > 0.5) {\n    sprites.queuefn(z, transitionPixelateCapture);\n    if (transition_pixelate_texture) {\n      tex = transition_pixelate_texture;\n    }\n  }\n\n  let partial_progress = (progress > 0.5 ? 1 - progress : progress) * 2;\n  // Use power of two scalings, but then scale relative to a 1024px virtual screen, so the biggest\n  //  pixel is about the same percentage of the screen regardless of resolution.\n  let pixel_scale = pow(2, floor(partial_progress * 8.9)) / 1024 * gd_width * render_scale;\n\n  let param0 = vec4(tex.width / pixel_scale, tex.height / pixel_scale, pixel_scale / tex.width, pixel_scale / tex.height);\n  let param1 = vec4(0.5 / tex.width, 0.5 / tex.height, (tex.texSizeX - 1) / tex.width, (tex.texSizeY - 1) / tex.height);\n\n  sprites.queueraw([tex], 0, 0, z + 1, 1, 1, 0, 1, 1, 0, unit_vec, getShader('transition_pixelate'), {\n    param0,\n    param1\n  });\n\n  if (force_end || progress === 1) {\n    if (transition_pixelate_texture) {\n      setTimeout(destroyTexture.bind(null, transition_pixelate_texture), 0);\n    }\n    transition_pixelate_texture = null;\n    return REMOVE;\n  }\n  return CONTINUE;\n}\n\nexport function fade(fade_time) {\n  return glovTransitionFadeFunc.bind(null, fade_time);\n}\n\n// export function wipe(wipe_time, wipe_angle) {\n//   return glovTransitionWipeFunc.bind(null, wipe_time, wipe_angle);\n// }\n\n// border_width in camera-relative size\nexport function splitScreen(time, border_width, slide_window) {\n  border_width /= camera2d.w(); // convert to normalized units\n  return glovTransitionSplitScreenFunc.bind(null, time, border_width, slide_window);\n}\n\nexport function pixelate(fade_time) {\n  return glovTransitionPixelateFunc.bind(null, fade_time);\n}\n\n// export function logoZoom(time, logo) {\n//   return glovTransitionLogoZoomFunc.bind(null, time, logo);\n// }\n\nexport function randomTransition(fade_time_scale) {\n  fade_time_scale = fade_time_scale || 1;\n  let idx = floor(random() * 3);\n  switch (idx) {\n    case 0:\n      return fade(500 * fade_time_scale);\n    case 1:\n      return splitScreen(250 * fade_time_scale, 2, false);\n    case 2:\n      return pixelate(750 * fade_time_scale);\n    // case 3:\n    //   return wipe(250 * fade_time_scale, random() * 2 * PI);\n    // case 4:\n    //   if (!logo) {\n    //     GlovTextureLoadOptions options;\n    //     options.clamp_s = options.clamp_t = true;\n    //     logo = GlovTextures::loadtex(\"data/SampleLogoTransition.png\", &options);\n    //   }\n    //   glovTransitionQueue(Z_TRANSITION_FINAL, glovTransitionLogoZoom(500, logo));\n    //   break;\n    default:\n      assert(0);\n  }\n  return null;\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint no-underscore-dangle:off */\n\nwindow.Z = window.Z || {};\nZ.BORDERS = Z.BORDERS || 90;\nZ.UI = Z.UI || 100;\nZ.MODAL = Z.MODAL || 1000;\nZ.TOOLTIP = Z.TOOLTIP || 2000;\nZ.DEBUG = Z.DEBUG || 9800;\n\n// very high, but can still add integers\nZ.TRANSITION_FINAL = Z.TRANSITION_FINAL || 9900;\n// how much Z range can be used for rendering transitions - the capture happens at z + Z_TRANSITION_RANGE\nZ.TRANSITION_RANGE = Z.TRANSITION_RANGE || 10;\n\nZ.FPSMETER = Z.FPSMETER || 10000;\n\nconst assert = require('assert');\nconst camera2d = require('./camera2d.js');\nconst glov_edit_box = require('./edit_box.js');\nconst effects = require('./effects.js');\nconst glov_engine = require('./engine.js');\nconst glov_font = require('./font.js');\nconst glov_input = require('./input.js');\nconst { linkTick } = require('./link.js');\nconst { abs, max, min, round, sqrt } = Math;\nconst { soundLoad, soundPlay } = require('./sound.js');\nconst glov_sprites = require('./sprites.js');\nconst textures = require('./textures.js');\nconst { clamp, clone, lerp, merge } = require('../../common/util.js');\nconst { mat43, m43identity, m43mul } = require('./mat43.js');\nconst { vec2, vec4, v4scale } = require('./vmath.js');\n\nconst MODAL_DARKEN = 0.75;\nlet KEYS;\nlet PAD;\n\nconst menu_fade_params_default = {\n  blur: [0.125, 0.865],\n  saturation: [0.5, 0.1],\n  brightness: [1, 1 - MODAL_DARKEN],\n  fallback_darken: vec4(0, 0, 0, MODAL_DARKEN),\n  z: Z.MODAL\n};\n\nexport function focuslog(...args) {\n  // console.log(`focuslog(${glov_engine.global_frame_index}): `, ...args);\n}\n\nexport function makeColorSet(color) {\n  let ret = {\n    regular: vec4(),\n    rollover: vec4(),\n    down: vec4(),\n    disabled: vec4()\n  };\n  v4scale(ret.regular, color, 1);\n  v4scale(ret.rollover, color, 0.8); // because we do not have specific graphics\n  v4scale(ret.down, color, 0.7);\n  v4scale(ret.disabled, color, 0.4);\n  for (let field in ret) {\n    ret[field][3] = color[3];\n  }\n  return ret;\n}\n\nfunction doBlurEffect(factor, params) {\n  factor = lerp(factor, params.blur[0], params.blur[1]);\n  if (factor) {\n    effects.applyGaussianBlur({\n      source: glov_engine.captureFramebuffer(),\n      blur: factor\n      // min_size: 128,\n    });\n  }\n}\n\nlet desaturate_xform = mat43();\nlet desaturate_tmp = mat43();\nfunction doDesaturateEffect(factor, params) {\n  let saturation = lerp(factor, params.saturation[0], params.saturation[1]);\n  let brightness = lerp(factor, params.brightness[0], params.brightness[1]);\n  if (saturation === 1 && brightness === 1) {\n    return;\n  }\n  m43identity(desaturate_xform);\n\n  effects.saturationMatrix(desaturate_tmp, saturation);\n  m43mul(desaturate_xform, desaturate_xform, desaturate_tmp);\n\n  effects.brightnessScaleMatrix(desaturate_tmp, brightness);\n  m43mul(desaturate_xform, desaturate_xform, desaturate_tmp);\n\n  // if ((hue % (Math.PI * 2)) !== 0) {\n  //   effects.hueMatrix(tmp, hue);\n  //   m43mul(xform, xform, tmp);\n  // }\n  // if (contrast !== 1) {\n  //   effects.contrastMatrix(tmp, contrast);\n  //   m43mul(xform, xform, tmp);\n  // }\n  // if (brightness !== 0) {\n  //   effects.brightnessMatrix(tmp, brightness);\n  //   m43mul(xform, xform, tmp);\n  // }\n  // if (additiveRGB[0] !== 0 || additiveRGB[1] !== 0 || additiveRGB[2] !== 0) {\n  //   effects.additiveMatrix(tmp, additiveRGB);\n  //   m43mul(xform, xform, tmp);\n  // }\n  // if (grayscale) {\n  //   effects.grayScaleMatrix(tmp);\n  //   m43mul(xform, xform, tmp);\n  // }\n  // if (negative) {\n  //   effects.negativeMatrix(tmp);\n  //   m43mul(xform, xform, tmp);\n  // }\n  // if (sepia) {\n  //   effects.sepiaMatrix(tmp);\n  //   m43mul(xform, xform, tmp);\n  // }\n  effects.applyColorMatrix({\n    colorMatrix: desaturate_xform,\n    source: glov_engine.captureFramebuffer()\n  });\n}\n\n// overrideable default parameters\nexport let button_height = 32;\nexport let font_height = 24;\nexport let button_width = 200;\nexport let modal_button_width = 100;\nexport let button_img_size = button_height;\nexport let modal_width = 600;\nexport let modal_y0 = 200;\nexport let modal_title_scale = 1.2;\nexport let modal_pad = 16;\nexport let panel_pixel_scale = 32 / 13; // button_height / button pixel resolution\nexport let tooltip_panel_pixel_scale = panel_pixel_scale;\nexport let tooltip_width = 400;\nexport let tooltip_pad = 8;\n\nexport let font_style_focused = glov_font.style(null, {\n  color: 0x000000ff,\n  outline_width: 2,\n  outline_color: 0xFFFFFFff\n});\nexport let font_style_normal = glov_font.styleColored(null, 0x000000ff);\n\nexport let font;\nexport let sprites = {};\n\nexport let color_button = makeColorSet([1, 1, 1, 1]);\nexport let color_panel = vec4(1, 1, 0.75, 1);\nexport let modal_font_style = glov_font.styleColored(null, 0x000000ff);\n\nlet sounds = {};\nexport let button_mouseover = false; // for callers to poll the very last button\nexport let button_focused = false; // for callers to poll the very last button\nexport let button_click = null; // on click, for callers to poll which mouse button, etc\nexport let touch_changed_focus = false; // did a touch even this frame change focus?\n// For tracking global mouseover state\nlet last_frame_button_mouseover = false;\nlet frame_button_mouseover = false;\n\nlet modal_dialog = null;\nlet modal_stealing_focus = false;\nexport let menu_up = false; // Boolean to be set by app to impact behavior, similar to a modal\nlet menu_fade_params = merge({}, menu_fade_params_default);\nlet menu_up_time = 0;\n\nexports.this_frame_edit_boxes = [];\nlet last_frame_edit_boxes = [];\nlet dom_elems = [];\nlet dom_elems_issued = 0;\n\n// for modal dialogs\nlet button_keys;\n\nlet focused_last_frame;\nlet focused_this_frame;\nlet focused_key_not;\nlet focused_key;\nlet focused_key_prev1;\nlet focused_key_prev2;\n\nlet pad_focus_left;\nlet pad_focus_right;\n\nexport function loadUISprite(name, ws, hs, overrides, only_override) {\n  let override = overrides && overrides[name];\n  if (override === null) {\n    // skip it, assume not used\n  } else if (override) {\n    sprites[name] = glov_sprites.create({\n      name: override[0],\n      ws: override[1],\n      hs: override[2]\n    });\n  } else if (!only_override) {\n    sprites[name] = glov_sprites.create({\n      name: `ui/${name}`,\n      ws,\n      hs\n    });\n  }\n}\n\nexport function startup(param) {\n  font = param.font;\n  let overrides = param.ui_sprites;\n  KEYS = glov_input.KEYS;\n  PAD = glov_input.PAD;\n  if (param.pad_focus_dpad) {\n    pad_focus_left = PAD.LEFT;\n    pad_focus_right = PAD.RIGHT;\n  } else {\n    pad_focus_left = PAD.LEFT_BUMPER;\n    pad_focus_right = PAD.RIGHT_BUMPER;\n  }\n\n  loadUISprite('button', [4, 5, 4], [13], overrides);\n  sprites.button_regular = sprites.button;\n  loadUISprite('button_rollover', [4, 5, 4], [13], overrides, true);\n  loadUISprite('button_down', [4, 5, 4], [13], overrides);\n  loadUISprite('button_disabled', [4, 5, 4], [13], overrides);\n  loadUISprite('panel', [3, 2, 3], [3, 10, 3], overrides);\n  loadUISprite('menu_entry', [4, 5, 4], [13], overrides);\n  loadUISprite('menu_selected', [4, 5, 4], [13], overrides);\n  loadUISprite('menu_down', [4, 5, 4], [13], overrides);\n  loadUISprite('menu_header', [4, 5, 12], [13], overrides);\n  loadUISprite('slider', [6, 2, 6], [13], overrides);\n  // loadUISprite('slider_notch', [3], [13], overrides);\n  loadUISprite('slider_handle', [9], [13], overrides);\n\n  sprites.white = glov_sprites.create({ url: 'white' });\n\n  button_keys = {\n    ok: { key: [KEYS.O], pad: [PAD.X] },\n    cancel: { key: [KEYS.ESC], pad: [PAD.B, PAD.Y] }\n  };\n  button_keys.yes = clone(button_keys.ok);\n  button_keys.yes.key.push(KEYS.Y);\n  button_keys.no = clone(button_keys.cancel);\n  button_keys.no.key.push(KEYS.N);\n}\n\nlet dynamic_text_elem;\nlet per_frame_dom_alloc = [0, 0, 0, 0, 0, 0, 0];\nexport function getElem(allow_modal, last_elem) {\n  if (modal_dialog && !allow_modal) {\n    return null;\n  }\n  if (dom_elems_issued >= dom_elems.length || !last_elem) {\n    let elem = document.createElement('div');\n    if (glov_engine.DEBUG && !glov_engine.resizing()) {\n      per_frame_dom_alloc[glov_engine.global_frame_index % per_frame_dom_alloc.length] = 1;\n      let sum = 0;\n      for (let ii = 0; ii < per_frame_dom_alloc.length; ++ii) {\n        sum += per_frame_dom_alloc[ii];\n      }\n      assert(sum < per_frame_dom_alloc.length);\n    }\n    elem.setAttribute('class', 'glovui_dynamic');\n    if (!dynamic_text_elem) {\n      dynamic_text_elem = document.getElementById('dynamic_text');\n    }\n    dynamic_text_elem.appendChild(elem);\n    dom_elems.push(elem);\n    last_elem = elem;\n  }\n  if (dom_elems[dom_elems_issued] !== last_elem) {\n    for (let ii = dom_elems_issued + 1; ii < dom_elems.length; ++ii) {\n      if (dom_elems[ii] === last_elem) {\n        dom_elems[ii] = dom_elems[dom_elems_issued];\n        dom_elems[dom_elems_issued] = last_elem;\n      }\n    }\n  }\n  let elem = dom_elems[dom_elems_issued];\n  dom_elems_issued++;\n  return elem;\n}\n\nexport function bindSounds(_sounds) {\n  sounds = _sounds;\n  for (let key in sounds) {\n    soundLoad(sounds[key]);\n  }\n}\n\nexport function drawHBox(coords, s, color) {\n  let uidata = s.uidata;\n  let ws = [uidata.wh[0] * coords.h, 0, uidata.wh[2] * coords.h];\n  let x = coords.x;\n  ws[1] = max(0, coords.w - ws[0] - ws[2]);\n  for (let ii = 0; ii < ws.length; ++ii) {\n    let my_w = ws[ii];\n    s.draw({\n      x,\n      y: coords.y,\n      z: coords.z,\n      color,\n      w: my_w,\n      h: coords.h,\n      uvs: uidata.rects[ii]\n      // nozoom: true, // nozoom since different parts of the box get zoomed differently\n    });\n    x += my_w;\n  }\n}\n\nexport function drawVBox(coords, s, color) {\n  let uidata = s.uidata;\n  let hs = [uidata.hw[0] * coords.w, 0, uidata.hw[2] * coords.w];\n  let y = coords.y;\n  hs[1] = max(0, coords.h - hs[0] - hs[2]);\n  for (let ii = 0; ii < hs.length; ++ii) {\n    let my_h = hs[ii];\n    s.draw({\n      x: coords.x,\n      y,\n      z: coords.z,\n      color,\n      w: coords.w,\n      h: my_h,\n      uvs: uidata.rects[ii]\n      // nozoom: true, // nozoom since different parts of the box get zoomed differently\n    });\n    y += my_h;\n  }\n}\n\nexport function drawBox(coords, s, pixel_scale, color) {\n  let uidata = s.uidata;\n  let scale = pixel_scale;\n  let ws = [uidata.widths[0] * scale, 0, uidata.widths[2] * scale];\n  ws[1] = max(0, coords.w - ws[0] - ws[2]);\n  let hs = [uidata.heights[0] * scale, 0, uidata.heights[2] * scale];\n  hs[1] = max(0, coords.h - hs[0] - hs[2]);\n  let x = coords.x;\n  for (let ii = 0; ii < ws.length; ++ii) {\n    let my_w = ws[ii];\n    if (my_w) {\n      let y = coords.y;\n      for (let jj = 0; jj < hs.length; ++jj) {\n        let my_h = hs[jj];\n        if (my_h) {\n          s.draw({\n            x, y, z: coords.z,\n            color,\n            w: my_w,\n            h: my_h,\n            uvs: uidata.rects[jj * 3 + ii],\n            nozoom: true // nozoom since different parts of the box get zoomed differently\n          });\n          y += my_h;\n        }\n      }\n      x += my_w;\n    }\n  }\n}\n\nexport function playUISound(name, volume) {\n  if (name === 'select') {\n    name = 'button_click';\n  }\n  if (sounds[name]) {\n    soundPlay(sounds[name], volume);\n  }\n}\n\nexport function setMouseOver(key, quiet) {\n  if (last_frame_button_mouseover !== key && frame_button_mouseover !== key && !quiet) {\n    playUISound('rollover');\n  }\n  frame_button_mouseover = key;\n  button_mouseover = true;\n}\n\nexport function focusSteal(key) {\n  if (key !== focused_key) {\n    focuslog('focusSteal ', key);\n  }\n  focused_this_frame = true;\n  focused_key = key;\n}\n\nexport function focusCanvas() {\n  focusSteal('canvas');\n}\n\nexport function isFocusedPeek(key) {\n  return focused_key === key;\n}\nexport function isFocused(key) {\n  if (key !== focused_key_prev2) {\n    focused_key_prev1 = focused_key_prev2;\n    focused_key_prev2 = key;\n  }\n  if (key === focused_key || key !== focused_key_not && !focused_this_frame && !focused_last_frame) {\n    if (key !== focused_key) {\n      focuslog('isFocused->focusSteal');\n    }\n    focusSteal(key);\n    return true;\n  }\n  return false;\n}\n\nexport function focusNext(key) {\n  focuslog('focusNext ', key);\n  playUISound('rollover');\n  focused_key = null;\n  focused_last_frame = focused_this_frame = false;\n  focused_key_not = key;\n  // Eat input events so a pair of keys (e.g. SDLK_DOWN and SDLK_CONTROLLER_DOWN)\n  // don't get consumed by two separate widgets\n  glov_input.eatAllInput();\n}\n\nexport function focusPrev(key) {\n  focuslog('focusPrev ', key);\n  playUISound('rollover');\n  if (key === focused_key_prev2) {\n    focusSteal(focused_key_prev1);\n  } else {\n    focusSteal(focused_key_prev2);\n  }\n  glov_input.eatAllInput();\n}\n\nexport function focusCheck(key) {\n  if (modal_stealing_focus) {\n    // hidden by modal, etc\n    return false;\n  }\n  // Returns true even if focusing previous element, since for this frame, we are still effectively focused!\n  let focused = isFocused(key);\n  if (focused) {\n    if (glov_input.keyDownEdge(KEYS.TAB)) {\n      if (glov_input.keyDown(KEYS.SHIFT)) {\n        focusPrev(key);\n      } else {\n        focusNext(key);\n        focused = false;\n      }\n    }\n    if (glov_input.padButtonDownEdge(pad_focus_right)) {\n      focusNext(key);\n      focused = false;\n    }\n    if (glov_input.padButtonDownEdge(pad_focus_left)) {\n      focusPrev(key);\n    }\n  }\n  return focused;\n}\n\nexport function panel(param) {\n  assert(typeof param.x === 'number');\n  assert(typeof param.y === 'number');\n  assert(typeof param.w === 'number');\n  assert(typeof param.h === 'number');\n  param.z = param.z || Z.UI - 1;\n  let color = param.color || color_panel;\n  drawBox(param, sprites.panel, param.pixel_scale || panel_pixel_scale, color);\n  glov_input.click(param);\n  glov_input.mouseOver(param);\n}\n\nexport function drawTooltip(param) {\n  assert(typeof param.x === 'number');\n  assert(typeof param.y === 'number');\n  assert(typeof param.tooltip === 'string');\n\n  let tooltip_w = param.tooltip_width || tooltip_width;\n  let x = param.x;\n  if (x + tooltip_w > camera2d.x1()) {\n    x = camera2d.x1() - tooltip_w;\n  }\n  let z = param.z || Z.TOOLTIP;\n  let tooltip_y0 = param.y;\n  let eff_tooltip_pad = param.tooltip_pad || tooltip_pad;\n  let w = tooltip_w - eff_tooltip_pad * 2;\n  if (param.tooltip_above) {\n    tooltip_y0 -= font_height * font.numLines(modal_font_style, w, 0, font_height, param.tooltip) + eff_tooltip_pad * 2;\n  }\n  let y = tooltip_y0 + eff_tooltip_pad;\n  y += font.drawSizedWrapped(modal_font_style, x + eff_tooltip_pad, y, z + 1, w, 0, font_height, param.tooltip);\n  y += eff_tooltip_pad;\n  let pixel_scale = param.pixel_scale || tooltip_panel_pixel_scale;\n\n  panel({\n    x,\n    y: tooltip_y0,\n    z,\n    w: tooltip_w,\n    h: y - tooltip_y0,\n    pixel_scale\n  });\n}\n\n// eslint-disable-next-line complexity\nexport function buttonShared(param) {\n  let state = 'regular';\n  let ret = false;\n  if (param.draw_only) {\n    return { ret, state };\n  }\n  let key = param.key || `${param.x}_${param.y}`;\n  let rollover_quiet = param.rollover_quiet;\n  let focused = !param.disabled && !param.no_focus && focusCheck(key);\n  let key_opts = param.in_event_cb ? { in_event_cb: param.in_event_cb } : null;\n  button_mouseover = false;\n  if (param.disabled) {\n    glov_input.mouseOver(param); // Still eat mouse events\n    state = 'disabled';\n  } else if (param.drag_target && (ret = glov_input.dragDrop(param))) {\n    console.log('dragDrop');\n    if (!param.no_touch_mouseover || !glov_input.mousePosIsTouch()) {\n      setMouseOver(key, rollover_quiet);\n    }\n    if (!param.no_focus) {\n      focusSteal(key);\n      focused = true;\n    }\n  } else if ((button_click = glov_input.click(param)) || param.long_press && (button_click = glov_input.longPress(param))) {\n    if (!param.no_touch_mouseover || !glov_input.mousePosIsTouch()) {\n      setMouseOver(key, rollover_quiet);\n    }\n    if (param.touch_twice && glov_input.mousePosIsTouch() && !focused) {\n      // Just focus, show tooltip\n      touch_changed_focus = true;\n    } else {\n      ret = true;\n    }\n    if (!param.no_focus) {\n      focusSteal(key);\n      focused = true;\n    }\n  } else if (param.drag_target && glov_input.dragOver(param)) {\n    // Set this even if param.no_touch_mouse_over is set\n    setMouseOver(key, rollover_quiet);\n    state = glov_input.mouseDown() ? 'down' : 'rollover';\n  } else if (param.drag_over && glov_input.dragOver(param)) {\n    // do nothing\n  } else if (glov_input.mouseOver(param)) {\n    if (param.no_touch_mouseover && glov_input.mousePosIsTouch()) {\n      // do not set mouseover\n    } else if (param.touch_twice && !focused && glov_input.mousePosIsTouch()) {\n      // do not set mouseover\n    } else {\n      setMouseOver(key, rollover_quiet);\n      state = glov_input.mouseDown() ? 'down' : 'rollover';\n    }\n  }\n  button_focused = focused;\n  if (focused) {\n    if (glov_input.keyDownEdge(KEYS.SPACE, key_opts) || glov_input.keyDownEdge(KEYS.RETURN, key_opts) || glov_input.padButtonDownEdge(PAD.A)) {\n      ret = true;\n    }\n  }\n  if (ret) {\n    state = 'down';\n    playUISound('button_click');\n  }\n  if (button_mouseover && param.tooltip) {\n    drawTooltip({\n      x: param.x,\n      y: param.tooltip_above ? param.y - 2 : param.y + param.h + 2,\n      tooltip_above: param.tooltip_above,\n      tooltip: param.tooltip,\n      tooltip_width: param.tooltip_width\n    });\n  }\n  param.z += param.z_bias && param.z_bias[state] || 0;\n  return { ret, state, focused };\n}\n\nexport let button_last_color;\nexport function buttonTextDraw(param, state, focused) {\n  let colors = param.colors || color_button;\n  let color = button_last_color = colors[state];\n  let base_name = param.base_name || 'button';\n  let sprite_name = `${base_name}_${state}`;\n  let sprite = sprites[sprite_name];\n  // Note: was if (sprite) color = colors.regular for specific-sprite matches\n  if (!sprite) {\n    sprite = sprites[base_name];\n  }\n\n  drawHBox(param, sprite, color);\n  let hpad = min(param.font_height * 0.25, param.w * 0.1);\n  font.drawSizedAligned(focused ? font_style_focused : font_style_normal, param.x + hpad, param.y, param.z + 0.1,\n  // eslint-disable-next-line no-bitwise\n  param.font_height, glov_font.ALIGN.HCENTERFIT | glov_font.ALIGN.VCENTER, param.w - hpad * 2, param.h, param.text);\n}\n\nexport function buttonText(param) {\n  // required params\n  assert(typeof param.x === 'number');\n  assert(typeof param.y === 'number');\n  assert(typeof param.text === 'string');\n  // optional params\n  param.z = param.z || Z.UI;\n  param.w = param.w || button_width;\n  param.h = param.h || button_height;\n  param.font_height = param.font_height || font_height;\n\n  let { ret, state, focused } = buttonShared(param);\n  buttonTextDraw(param, state, focused);\n  return ret;\n}\n\nexport function buttonImage(param) {\n  // required params\n  assert(typeof param.x === 'number');\n  assert(typeof param.y === 'number');\n  assert(param.img && param.img.draw); // should be a sprite\n  // optional params\n  param.z = param.z || Z.UI;\n  param.w = param.w || button_img_size;\n  param.h = param.h || param.w || button_img_size;\n  param.shrink = param.shrink || 0.75;\n  //param.img_rect; null -> full image\n  let uvs = param.img_rect;\n  if (typeof param.frame === 'number') {\n    uvs = param.img.uidata.rects[param.frame];\n  }\n\n  let { ret, state } = buttonShared(param);\n  let colors = param.colors || color_button;\n  let color = button_last_color = colors[state];\n  if (!param.no_bg) {\n    let base_name = param.base_name || 'button';\n    let sprite_name = `${base_name}_${state}`;\n    let sprite = sprites[sprite_name];\n    if (!sprite) {\n      sprite = sprites[base_name];\n    }\n\n    drawHBox(param, sprite, color);\n  }\n  let img_origin = param.img.origin;\n  let img_w = param.img.size[0];\n  let img_h = param.img.size[1];\n  let aspect = img_w / img_h;\n  if (typeof param.frame === 'number') {\n    aspect = param.img.uidata.aspect ? param.img.uidata.aspect[param.frame] : 1;\n  }\n  let largest_w_horiz = param.w * param.shrink;\n  let largest_w_vert = param.h * param.shrink * aspect;\n  img_w = min(largest_w_horiz, largest_w_vert);\n  img_h = img_w / aspect;\n  let pad_top = (param.h - img_h) / 2;\n  let draw_param = {\n    x: param.x + (param.left_align ? pad_top : (param.w - img_w) / 2) + img_origin[0] * img_w,\n    y: param.y + pad_top + img_origin[1] * img_h,\n    z: param.z + 0.1,\n    color: param.color1 && param.color ? param.color : color, // use explicit tint if doing dual-tinting\n    color1: param.color1,\n    w: img_w / param.img.size[0],\n    h: img_h / param.img.size[1],\n    uvs,\n    rot: param.rotation\n  };\n  if (param.flip) {\n    let { x, w } = draw_param;\n    draw_param.x = x + w;\n    draw_param.w = -w;\n  }\n  if (param.color1) {\n    param.img.drawDualTint(draw_param);\n  } else {\n    param.img.draw(draw_param);\n  }\n  return ret;\n}\n\nexport function print(style, x, y, z, text) {\n  return font.drawSized(style, x, y, z, font_height, text);\n}\n\n// Note: modal dialogs not really compatible with HTML overlay on top of the canvas!\nexport function modalDialog(param) {\n  assert(!param.title || typeof param.title === 'string');\n  assert(!param.text || typeof param.text === 'string');\n  assert(!param.buttons || typeof param.buttons === 'object');\n  // assert(Object.keys(param.buttons).length);\n\n  modal_dialog = param;\n}\n\nexport function modalDialogClear() {\n  modal_dialog = null;\n}\n\nlet dom_requirement = vec2(24, 24);\nlet virtual_size = vec2();\nfunction modalDialogRun() {\n  camera2d.domDeltaToVirtual(virtual_size, dom_requirement);\n  let fullscreen_mode = false;\n  let eff_font_height = modal_dialog.font_height || font_height;\n  let eff_button_height = button_height;\n  let pad = modal_pad;\n  let vpad = modal_pad * 0.5;\n  let general_scale = 1;\n  if (virtual_size[0] > 0.1 * camera2d.h() && camera2d.w() > camera2d.h() * 2) {\n    // If a 24-pt font is more than 10% of the camera height, we're probably super-wide-screen\n    // on a mobile device due to keyboard being visible\n    fullscreen_mode = true;\n    eff_button_height = eff_font_height;\n    vpad = pad = 4;\n\n    let old_h = camera2d.h();\n    camera2d.push();\n    camera2d.setAspectFixed2(1, eff_font_height * (modal_title_scale + 2) + pad * 4.5);\n    general_scale = camera2d.h() / old_h;\n  }\n\n  let { buttons, click_anywhere } = modal_dialog;\n  let keys = Object.keys(buttons || {});\n\n  const game_width = camera2d.x1() - camera2d.x0();\n  const eff_modal_width = fullscreen_mode ? game_width : modal_dialog.width || modal_width;\n  let eff_button_width = modal_dialog.button_width || modal_button_width;\n  let max_total_button_width = eff_modal_width * 2 / 3;\n  eff_button_width = min(eff_button_width, max_total_button_width / keys.length);\n  const text_w = eff_modal_width - pad * 2;\n  const x0 = camera2d.x0() + round((game_width - eff_modal_width) / 2);\n  let x = x0 + pad;\n  const y0 = fullscreen_mode ? 0 : modal_dialog.y0 || modal_y0;\n  let y = y0 + pad;\n\n  if (glov_input.pointerLocked()) {\n    glov_input.pointerLockExit();\n  }\n\n  if (modal_dialog.title) {\n    if (fullscreen_mode) {\n      font.drawSizedAligned(modal_font_style, x, y, Z.MODAL, eff_font_height * modal_title_scale, glov_font.ALIGN.HFIT, text_w, 0, modal_dialog.title);\n      y += eff_font_height * modal_title_scale;\n    } else {\n      y += font.drawSizedWrapped(modal_font_style, x, y, Z.MODAL, text_w, 0, eff_font_height * modal_title_scale, modal_dialog.title);\n    }\n    y += round(vpad * 1.5);\n  }\n\n  if (modal_dialog.text) {\n    if (fullscreen_mode) {\n      font.drawSizedAligned(modal_font_style, x, y, Z.MODAL, eff_font_height, glov_font.ALIGN.HFIT, text_w, 0, modal_dialog.text);\n      y += eff_font_height;\n    } else {\n      y += font.drawSizedWrapped(modal_font_style, x, y, Z.MODAL, text_w, 0, eff_font_height, modal_dialog.text);\n    }\n    y += vpad;\n  }\n\n  let tick_key;\n  if (modal_dialog.tick) {\n    let avail_width = eff_modal_width - pad * 2;\n    if (fullscreen_mode) {\n      avail_width -= (pad + eff_button_width) * keys.length;\n    }\n    let param = {\n      x, y,\n      modal_width: eff_modal_width,\n      avail_width,\n      font_height: eff_font_height,\n      fullscreen_mode\n    };\n    tick_key = modal_dialog.tick(param);\n    y = param.y;\n  }\n\n  x = x0 + eff_modal_width - (pad + eff_button_width) * keys.length;\n  for (let ii = 0; ii < keys.length; ++ii) {\n    let key = keys[ii];\n    let eff_button_keys = button_keys[key.toLowerCase()];\n    let pressed = 0;\n    if (eff_button_keys) {\n      for (let jj = 0; jj < eff_button_keys.key.length; ++jj) {\n        pressed += glov_input.keyDownEdge(eff_button_keys.key[jj]);\n        if (eff_button_keys.key[jj] === tick_key) {\n          pressed++;\n        }\n      }\n      for (let jj = 0; jj < eff_button_keys.pad.length; ++jj) {\n        pressed += glov_input.padButtonDownEdge(eff_button_keys.pad[jj]);\n      }\n    }\n    if (click_anywhere && ii === 0 && glov_input.click()) {\n      ++pressed;\n    }\n    if (pressed) {\n      playUISound('button_click');\n    }\n    if (buttonText({\n      x: x,\n      y,\n      z: Z.MODAL,\n      w: eff_button_width,\n      h: eff_button_height,\n      text: key\n    }) || pressed) {\n      modal_dialog = null;\n      if (buttons[key]) {\n        buttons[key]();\n      }\n    }\n    x += pad + eff_button_width;\n  }\n  y += eff_button_height;\n  y += vpad + pad;\n  panel({\n    x: x0,\n    y: y0,\n    z: Z.MODAL - 1,\n    w: eff_modal_width,\n    h: (fullscreen_mode ? camera2d.y1() : y) - y0,\n    pixel_scale: panel_pixel_scale * general_scale\n  });\n\n  glov_input.eatAllInput();\n  modal_stealing_focus = true;\n  if (fullscreen_mode) {\n    camera2d.pop();\n  }\n}\n\nexport function modalTextEntry(param) {\n  let eb = glov_edit_box.create({\n    allow_modal: true,\n    initial_focus: true,\n    spellcheck: false,\n    initial_select: true,\n    text: param.edit_text,\n    max_len: param.max_len\n  });\n  let buttons = {};\n  for (let key in param.buttons) {\n    let val = param.buttons[key];\n    if (typeof val === 'function') {\n      val = function (old_fn) {\n        return function () {\n          old_fn(eb.getText());\n        };\n      }(val);\n    }\n    buttons[key] = val;\n  }\n  param.buttons = buttons;\n  param.text = `${param.text || ''}`;\n  let old_tick = param.tick;\n  param.tick = function (params) {\n    let eb_ret = eb.run({\n      x: params.x,\n      y: params.y,\n      w: params.avail_width || param.edit_w,\n      font_height: params.font_height\n    });\n    if (!params.fullscreen_mode) {\n      params.y += params.font_height + modal_pad;\n    }\n    let ret;\n    if (eb_ret === eb.SUBMIT) {\n      ret = KEYS.O; // Do OK, Yes\n    } else if (eb_ret === eb.CANCEL) {\n      ret = KEYS.ESC; // Do Cancel, No\n    }\n    if (old_tick) {\n      ret = old_tick(params) || ret;\n    }\n    return ret;\n  };\n  modalDialog(param);\n}\n\nexport function createEditBox(param) {\n  return glov_edit_box.create(param);\n}\n\nconst color_slider_handle = vec4(1, 1, 1, 1);\nconst color_slider_handle_grab = vec4(0.5, 0.5, 0.5, 1);\nconst color_slider_handle_over = vec4(0.75, 0.75, 0.75, 1);\nexport let slider_dragging = false; // for caller polling\n// Returns new value\nexport function slider(value, param) {\n  // required params\n  assert(typeof param.x === 'number');\n  assert(typeof param.y === 'number');\n  assert(param.min < param.max); // also must be numbers\n  // optional params\n  param.z = param.z || Z.UI;\n  param.w = param.w || button_width;\n  param.h = param.h || button_height;\n  let disabled = param.disabled || false;\n\n  slider_dragging = false;\n\n  drawHBox(param, sprites.slider, param.color);\n\n  let xoffs = round(sprites.slider.uidata.wh[0] * param.h / 2);\n  let draggable_width = param.w - xoffs * 2;\n\n  // Draw notches - would also need to quantize the values below\n  // if (!slider->no_notches) {\n  //   float space_for_notches = width - xoffs * 4;\n  //   int num_notches = max - 1;\n  //   float notch_w = tile_scale * glov_ui_slider_notch->GetTileWidth();\n  //   float notch_h = tile_scale * glov_ui_slider_notch->GetTileHeight();\n  //   float max_notches = space_for_notches / (notch_w + 2);\n  //   int notch_inc = 1;\n  //   if (num_notches > max_notches)\n  //     notch_inc = ceil(num_notches / floor(max_notches));\n\n  //   for (int ii = 1; ii*notch_inc <= num_notches; ii++) {\n  //     float notch_x_mid = x + xoffs + draggable_width * ii * notch_inc / (float)max;\n  //     if (notch_x_mid - notch_w/2 < x + xoffs * 2)\n  //       continue;\n  //     if (notch_x_mid + notch_w/2 > x + width - xoffs * 2)\n  //       continue;\n  //     glov_ui_slider_notch->DrawStretchedColor(notch_x_mid - notch_w / 2, y + yoffs,\n  //       z + 0.25, notch_w, notch_h, 0, color);\n  //   }\n  // }\n\n  // Handle\n  let drag = !disabled && glov_input.drag(param);\n  let grabbed = Boolean(drag);\n  let click = glov_input.click(param);\n  if (click) {\n    grabbed = false;\n    // update pos\n    value = (click.pos[0] - (param.x + xoffs)) / draggable_width;\n    value = param.min + (param.max - param.min) * clamp(value, 0, 1);\n    playUISound('button_click');\n  } else if (grabbed) {\n    // update pos\n    value = (drag.cur_pos[0] - (param.x + xoffs)) / draggable_width;\n    value = param.min + (param.max - param.min) * clamp(value, 0, 1);\n    // Eat all mouseovers while dragging\n    glov_input.mouseOver();\n    slider_dragging = true;\n  }\n  let rollover = !disabled && glov_input.mouseOver(param);\n  let handle_center_pos = param.x + xoffs + draggable_width * (value - param.min) / (param.max - param.min);\n  let handle_h = param.h;\n  let handle_w = sprites.slider_handle.uidata.wh[0] * handle_h;\n  let handle_x = handle_center_pos - handle_w / 2;\n  let handle_y = param.y + param.h / 2 - handle_h / 2;\n  let handle_color = color_slider_handle;\n  if (grabbed) {\n    handle_color = color_slider_handle_grab;\n  } else if (rollover) {\n    handle_color = color_slider_handle_over;\n  }\n\n  sprites.slider_handle.draw({\n    x: handle_x,\n    y: handle_y,\n    z: param.z + 0.1,\n    w: handle_w,\n    h: handle_h,\n    color: handle_color,\n    frame: 0\n  });\n\n  return value;\n}\n\nlet pp_bad_frames = 0;\n\nexport function tickUI(dt) {\n  last_frame_button_mouseover = frame_button_mouseover;\n  frame_button_mouseover = false;\n  focused_last_frame = focused_this_frame;\n  focused_this_frame = false;\n  focused_key_not = null;\n  modal_stealing_focus = false;\n  touch_changed_focus = false;\n  per_frame_dom_alloc[glov_engine.global_frame_index % per_frame_dom_alloc.length] = 0;\n\n  last_frame_edit_boxes = exports.this_frame_edit_boxes;\n  exports.this_frame_edit_boxes = [];\n  linkTick();\n\n  dom_elems_issued = 0;\n\n  let pp_this_frame = false;\n  if (modal_dialog || menu_up) {\n    let params = menu_fade_params;\n    if (!menu_up) {\n      // Modals get defaults\n      params = menu_fade_params_default;\n    }\n    menu_up_time += dt;\n    // Effects during modal dialogs\n    let factor = min(menu_up_time / 500, 1);\n    if (glov_engine.postprocessing && !glov_engine.defines.NOPP) {\n      glov_sprites.queuefn(params.z - 2, doBlurEffect.bind(null, factor, params));\n      glov_sprites.queuefn(params.z - 1, doDesaturateEffect.bind(null, factor, params));\n      pp_this_frame = true;\n    } else {\n      // Or, just darken\n      sprites.white.draw({\n        x: camera2d.x0Real(),\n        y: camera2d.y0Real(),\n        z: params.z - 2,\n        color: params.fallback_darken,\n        w: camera2d.wReal(),\n        h: camera2d.hReal()\n      });\n    }\n  } else {\n    menu_up_time = 0;\n  }\n  menu_up = false;\n\n  if (!glov_engine.is_loading && glov_engine.getFrameDtActual() > 50 && pp_this_frame) {\n    pp_bad_frames = (pp_bad_frames || 0) + 1;\n    if (pp_bad_frames >= 3) {\n      // 3 in a row, disable superfluous postprocessing\n      glov_engine.postprocessingAllow(false);\n    }\n  } else if (pp_bad_frames) {\n    pp_bad_frames = 0;\n  }\n\n  if (modal_dialog) {\n    modalDialogRun();\n  }\n}\n\nexport function endFrame() {\n  if (glov_input.click({\n    x: -Infinity, y: -Infinity,\n    w: Infinity, h: Infinity\n  })) {\n    focusSteal('canvas');\n  }\n\n  for (let ii = 0; ii < last_frame_edit_boxes.length; ++ii) {\n    let edit_box = last_frame_edit_boxes[ii];\n    let idx = exports.this_frame_edit_boxes.indexOf(edit_box);\n    if (idx === -1) {\n      edit_box.unrun();\n    }\n  }\n\n  while (dom_elems_issued < dom_elems.length) {\n    let elem = dom_elems.pop();\n    dynamic_text_elem.removeChild(elem);\n  }\n}\n\nexport function menuUp(param) {\n  merge(menu_fade_params, menu_fade_params_default);\n  if (param) {\n    merge(menu_fade_params, param);\n  }\n  menu_up = true;\n  modal_stealing_focus = true;\n  glov_input.eatAllInput();\n}\n\nfunction copyTextToClipboard(text) {\n  let textArea = document.createElement('textarea');\n  textArea.style.position = 'fixed';\n  textArea.style.top = 0;\n  textArea.style.left = 0;\n  textArea.style.width = '2em';\n  textArea.style.height = '2em';\n  textArea.style.border = 'none';\n  textArea.style.outline = 'none';\n  textArea.style.boxShadow = 'none';\n  textArea.style.background = 'transparent';\n  textArea.value = text;\n\n  document.body.appendChild(textArea);\n  textArea.focus();\n  textArea.select();\n\n  let ret = false;\n  try {\n    ret = document.execCommand('copy');\n  } catch (err) {\n    // do nothing\n  }\n\n  document.body.removeChild(textArea);\n  return ret;\n}\n\nexport function provideUserString(title, thing, str) {\n  let copy_success = copyTextToClipboard(str);\n  modalTextEntry({\n    edit_w: 400,\n    edit_text: str,\n    title,\n    text: copy_success ? `${thing} copied to clipboard!` : 'Copy to clipboard FAILED, please copy from below\\n',\n    buttons: {\n      OK: null\n    }\n  });\n}\n\nexport function drawRect(x0, y0, x1, y1, z, color) {\n  let mx = min(x0, x1);\n  let my = min(y0, y1);\n  let Mx = max(x0, x1);\n  let My = max(y0, y1);\n  sprites.white.draw({\n    x: mx,\n    y: my,\n    z,\n    color,\n    w: Mx - mx,\n    h: My - my\n  });\n}\n\nfunction spreadTechParams(spread) {\n  // spread=0 -> 1\n  // spread=0.5 -> 2\n  // spread=0.75 -> 4\n  // spread=1 -> large enough to AA\n  spread = min(max(spread, 0), 0.99);\n\n  let tech_params = {\n    param0: vec4(0, 0, 0, 0)\n  };\n\n  tech_params.param0[0] = 1 / (1 - spread);\n  tech_params.param0[1] = -0.5 * tech_params.param0[0] + 0.5;\n  return tech_params;\n}\n\nfunction drawCircleInternal(sprite, x, y, z, r, spread, tu1, tv1, tu2, tv2, color) {\n  let x0 = x - r * 2 + r * 4 * tu1;\n  let x1 = x - r * 2 + r * 4 * tu2;\n  let y0 = y - r * 2 + r * 4 * tv1;\n  let y1 = y - r * 2 + r * 4 * tv2;\n  glov_sprites.queueraw(sprite.texs, x0, y0, z, x1 - x0, y1 - y0, tu1, tv1, tu2, tv2, color, glov_font.font_shaders.font_aa, spreadTechParams(spread));\n}\n\nexport function drawCircle(x, y, z, r, spread, color) {\n  if (!sprites.circle) {\n    const CIRCLE_SIZE = 32;\n    let data = new Uint8Array(CIRCLE_SIZE * CIRCLE_SIZE);\n    let midp = (CIRCLE_SIZE - 1) / 2;\n    for (let i = 0; i < CIRCLE_SIZE; i++) {\n      for (let j = 0; j < CIRCLE_SIZE; j++) {\n        let d = sqrt((i - midp) * (i - midp) + (j - midp) * (j - midp)) / midp;\n        let v = clamp(1 - d, 0, 1);\n        data[i + j * CIRCLE_SIZE] = v * 255;\n      }\n    }\n    sprites.circle = glov_sprites.create({\n      url: 'circle',\n      width: CIRCLE_SIZE, height: CIRCLE_SIZE,\n      format: textures.format.R8,\n      data,\n      filter_min: gl.LINEAR,\n      filter_max: gl.LINEAR,\n      wrap_s: gl.CLAMP_TO_EDGE,\n      wrap_t: gl.CLAMP_TO_EDGE,\n      origin: vec2(0.5, 0.5)\n    });\n  }\n  drawCircleInternal(sprites.circle, x, y, z, r, spread, 0, 0, 1, 1, color);\n}\n\nexport function drawHollowCircle(x, y, z, r, spread, color) {\n  if (!sprites.hollow_circle) {\n    const CIRCLE_SIZE = 128;\n    const LINE_W = 2;\n    let data = new Uint8Array(CIRCLE_SIZE * CIRCLE_SIZE);\n    let midp = (CIRCLE_SIZE - 1) / 2;\n    for (let i = 0; i < CIRCLE_SIZE; i++) {\n      for (let j = 0; j < CIRCLE_SIZE; j++) {\n        let d = sqrt((i - midp) * (i - midp) + (j - midp) * (j - midp)) / midp;\n        let v = clamp(1 - d, 0, 1);\n        if (v > 0.5) {\n          v = 1 - v;\n        }\n        v += LINE_W / CIRCLE_SIZE;\n        data[i + j * CIRCLE_SIZE] = v * 255;\n      }\n    }\n    sprites.hollow_circle = glov_sprites.create({\n      url: 'hollow_circle',\n      width: CIRCLE_SIZE, height: CIRCLE_SIZE,\n      format: textures.format.R8,\n      data,\n      filter_min: gl.LINEAR,\n      filter_max: gl.LINEAR,\n      wrap_s: gl.CLAMP_TO_EDGE,\n      wrap_t: gl.CLAMP_TO_EDGE,\n      origin: vec2(0.5, 0.5)\n    });\n  }\n  drawCircleInternal(sprites.hollow_circle, x, y, z, r, spread, 0, 0, 1, 1, color);\n}\n\nexport function drawLine(x0, y0, x1, y1, z, w, spread, color) {\n  if (!sprites.line) {\n    const LINE_SIZE = 32;\n    let data = new Uint8Array(LINE_SIZE * LINE_SIZE);\n    let midp = (LINE_SIZE - 1) / 2;\n    for (let i = 0; i < LINE_SIZE; i++) {\n      for (let j = 0; j < LINE_SIZE; j++) {\n        let d = abs((i - midp) / midp);\n        let v = clamp(1 - d, 0, 1);\n        data[i + j * LINE_SIZE] = v * 255;\n      }\n    }\n    sprites.line = glov_sprites.create({\n      url: 'line',\n      width: LINE_SIZE, height: LINE_SIZE,\n      format: textures.format.R8,\n      data,\n      filter_min: gl.LINEAR,\n      filter_max: gl.LINEAR,\n      wrap_s: gl.CLAMP_TO_EDGE,\n      wrap_t: gl.CLAMP_TO_EDGE,\n      origin: vec2(0.5, 0.5)\n    });\n  }\n\n  let dx = x1 - x0;\n  let dy = y1 - y0;\n  let length = Math.sqrt(dx * dx + dy * dy);\n  dx /= length;\n  dy /= length;\n  let tangx = -dy * w;\n  let tangy = dx * w;\n\n  glov_sprites.queueraw4(sprites.line.texs, x0 + tangx, y0 + tangy, x1 + tangx, y1 + tangy, x1 - tangx, y1 - tangy, x0 - tangx, y0 - tangy, z, 0, 0, 1, 1, color, glov_font.font_shaders.font_aa, spreadTechParams(spread));\n}\n\nexport function drawCone(x0, y0, x1, y1, z, w0, w1, spread, color) {\n  if (!sprites.cone) {\n    const CONE_SIZE = 32;\n    let data = new Uint8Array(CONE_SIZE * CONE_SIZE);\n    let midp = (CONE_SIZE - 1) / 2;\n    for (let i = 0; i < CONE_SIZE; i++) {\n      for (let j = 0; j < CONE_SIZE; j++) {\n        let dx = 0;\n        let dy = 0;\n        let d = 0;\n        if (i > midp) {\n          dx = (i - midp) / midp;\n          dy = abs(j - midp) / midp;\n          let dCircle = sqrt(dx * dx + dy * dy);\n          d = dx * dCircle;\n        }\n        let v = clamp(1 - d, 0, 1);\n        data[i + j * CONE_SIZE] = v * 255;\n      }\n    }\n    sprites.cone = glov_sprites.create({\n      url: 'cone',\n      width: CONE_SIZE, height: CONE_SIZE,\n      format: textures.format.R8,\n      data,\n      filter_min: gl.LINEAR,\n      filter_max: gl.LINEAR,\n      wrap_s: gl.CLAMP_TO_EDGE,\n      wrap_t: gl.CLAMP_TO_EDGE,\n      origin: vec2(0.5, 0.5)\n    });\n  }\n  let dx = x1 - x0;\n  let dy = y1 - y0;\n  let length = Math.sqrt(dx * dx + dy * dy);\n  dx /= length;\n  dy /= length;\n  let tangx = -dy;\n  let tangy = dx;\n  glov_sprites.queueraw4(sprites.cone.texs, x0 - tangx * w0, y0 - tangy * w0, x0 + tangx * w0, y0 + tangy * w0, x1 + tangx * w1, y1 + tangy * w1, x1 - tangx * w1, y1 - tangy * w1, z, 0, 0, 1, 1, color, glov_font.font_shaders.font_aa, spreadTechParams(spread));\n}\n\nexport function scaleSizes(scale) {\n  button_height = round(32 * scale);\n  font_height = round(24 * scale);\n  button_width = round(200 * scale);\n  button_img_size = button_height;\n  modal_button_width = round(button_width / 2);\n  modal_width = round(600 * scale);\n  modal_y0 = round(200 * scale);\n  modal_title_scale = 1.2;\n  modal_pad = round(16 * scale);\n  tooltip_width = round(400 * scale);\n  tooltip_pad = round(8 * scale);\n  panel_pixel_scale = button_height / 13; // button_height / panel pixel resolution\n  tooltip_panel_pixel_scale = panel_pixel_scale;\n}\n\nexport function setModalSizes(_modal_button_width, width, y0, title_scale, pad) {\n  modal_button_width = _modal_button_width || round(button_width / 2);\n  modal_width = width || 600;\n  modal_y0 = y0 || 200;\n  modal_title_scale = title_scale || 1.2;\n  modal_pad = pad || modal_pad;\n}\n\nexport function setFontHeight(_font_height) {\n  font_height = _font_height;\n}\n\nexport function setTooltipWidth(_tooltip_width, _tooltip_panel_pixel_scale) {\n  tooltip_width = _tooltip_width;\n  tooltip_panel_pixel_scale = _tooltip_panel_pixel_scale;\n  tooltip_pad = modal_pad / 2 * _tooltip_panel_pixel_scale;\n}\n\nscaleSizes(1);","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\n/*\n  API usage:\n  engine.defines = urlhash.register({\n    key: 'D',\n    type: SET,\n  });\n  urlhash.register({\n    key: 'pos',\n    // type: TYPE_STRING,\n    change: (newvalue) => {},\n    title: (value) => 'string',\n    def: '1,2',\n    hides: { otherfield: true },\n    push: true, // do a pushState instead of replaceState when this changes\n    hide_values: { foo: true }, // do not add to URL if values is in the provided set\n  });\n  urlhash.set('pos', '3,4');\n  urlhash.get('pos')\n\n  urlhash.route('w/:w')     // use URLs like foo.com/w/1   instead of foo.com/?w=1\n  urlhash.route('w/:w/:wg')  // use URLs like foo.com/w/1/2 instead of foo.com/?w=1&wg=2\n\n  // Called whenever the URL state is pushed, even if to exactly the same URL (e.g. on link click)\n  urlhash.onChange(cb)\n*/\n\nconst assert = require('assert');\nconst { callEach } = require('../../common/util.js');\n\nconst HISTORY_UPDATE_TIME = 1000;\n\nexport let TYPE_SET = 'set';\nexport let TYPE_STRING = 'string';\n\nlet params = {};\n\nlet title_suffix = '';\n\nlet url_base = (document.location.href || '').match(/^[^#?]+/)[0];\n//Removes index.html et all\nurl_base = url_base.replace(/[^/]*$/, '');\nlet on_change = [];\n\nexport function getURLBase() {\n  return url_base;\n}\n\nexport function onChange(cb) {\n  on_change.push(cb);\n}\n\nfunction cmpNumKeys(a, b) {\n  let d = b.keys.length - a.keys.length;\n  if (d) {\n    return d;\n  }\n  // otherwise alphabetical for stability\n  for (let ii = 0; ii < a.keys.length; ++ii) {\n    if (a.keys[ii] < b.keys[ii]) {\n      return -1;\n    } else if (a.keys[ii] > b.keys[ii]) {\n      return 1;\n    }\n  }\n  assert(false); // two routes with identical keys\n  return 0;\n}\n\nconst route_param_regex = /:(\\w+)/g;\nlet routes = [];\nexport function route(route_string) {\n  let keys = [];\n  // foo/:key/:bar => foo/([^/&?]+)/([^/&?]+)\n  let base = route_string.replace(route_param_regex, function (ignored, match) {\n    keys.push(match);\n    return '([^/&?]+)';\n  });\n  let regex = new RegExp(`^${base}(?:$|\\\\?)`);\n  let new_route = {\n    route_string,\n    regex,\n    keys\n  };\n  for (let ii = 0; ii < keys.length; ++ii) {\n    let opts = params[keys[ii]];\n    // Must have already registered these keys\n    assert(opts);\n    opts.routes = opts.routes || [];\n    opts.routes.push(new_route);\n  }\n  routes.push(new_route);\n  routes.sort(cmpNumKeys);\n}\n\nfunction queryString() {\n  let href = String(document.location);\n  return href.slice(url_base.length);\n}\n\nconst regex_value = /[^\\w]\\w+=([^&]+)/;\nfunction getValue(query_string, opts) {\n  if (opts.routes) {\n    for (let ii = 0; ii < opts.routes.length; ++ii) {\n      let r = opts.routes[ii];\n      let m = query_string.match(r.regex);\n      if (m) {\n        let idx = r.keys.indexOf(opts.key);\n        return m[1 + idx];\n      }\n    }\n  }\n  let m = query_string.match(opts.regex) || [];\n  if (opts.type === TYPE_SET) {\n    let r = {};\n    for (let ii = 0; ii < m.length; ++ii) {\n      let m2 = m[ii].match(regex_value);\n      assert(m2);\n      r[m2[1]] = 1;\n    }\n    return r;\n  } else {\n    return m[1] || opts.def;\n  }\n}\n\nlet last_history_str = null; // always re-set it on the first update\n\nfunction goInternal(query_string) {\n  // with the '?'\n  // Update all values, except those hidden by what is currently in the query string\n  let hidden = {};\n  for (let key in params) {\n    let opts = params[key];\n    if (opts.hides) {\n      if (getValue(query_string, opts)) {\n        for (let otherkey in opts.hides) {\n          hidden[otherkey] = 1;\n        }\n      }\n    }\n  }\n\n  let dirty = {};\n  for (let key in params) {\n    if (hidden[key]) {\n      continue;\n    }\n    let opts = params[key];\n    let new_value = getValue(query_string, opts);\n    if (opts.type === TYPE_SET) {\n      for (let v in new_value) {\n        if (!opts.value[v]) {\n          opts.value[v] = 1;\n          dirty[key] = true;\n        }\n      }\n      for (let v in opts.value) {\n        if (!new_value[v]) {\n          delete opts.value[v];\n          dirty[key] = true;\n        }\n      }\n    } else {\n      if (new_value !== opts.value) {\n        dirty[key] = true;\n        opts.value = new_value;\n      }\n    }\n  }\n\n  // Call all change callbacks\n  for (let key in dirty) {\n    let opts = params[key];\n    if (opts.change) {\n      opts.change(opts.value);\n    }\n  }\n  callEach(on_change);\n}\n\nlet eff_title;\nfunction toString() {\n  eff_title = '';\n  let values = [];\n  let hidden = {};\n  for (let key in params) {\n    let opts = params[key];\n    if (opts.hides && opts.value) {\n      for (let otherkey in opts.hides) {\n        hidden[otherkey] = 1;\n      }\n    }\n  }\n  let root_value = '';\n  outer: // eslint-disable-line no-labels\n  for (let ii = 0; ii < routes.length; ++ii) {\n    let r = routes[ii];\n    let route_title = '';\n    for (let jj = 0; jj < r.keys.length; ++jj) {\n      let key = r.keys[jj];\n      if (hidden[key]) {\n        continue outer; // eslint-disable-line no-labels\n      }\n      let opts = params[key];\n      if (opts.hide_values[opts.value]) {\n        continue outer; // eslint-disable-line no-labels\n      }\n      // has a value, is not hidden, continue\n      if (!route_title && opts.title) {\n        route_title = opts.title(opts.value);\n      }\n    }\n    // route is good!\n    root_value = r.route_string.replace(route_param_regex, function (ignored, key) {\n      hidden[key] = true;\n      return String(params[key].value);\n    });\n    if (!eff_title && route_title) {\n      eff_title = route_title;\n    }\n    break;\n  }\n  for (let key in params) {\n    if (hidden[key]) {\n      continue;\n    }\n    let opts = params[key];\n    if (opts.type === TYPE_SET) {\n      for (let v in opts.value) {\n        values.push(`${key}=${v}`);\n      }\n    } else {\n      if (!opts.hide_values[opts.value]) {\n        values.push(`${key}=${opts.value}`);\n        if (!eff_title && opts.title) {\n          eff_title = opts.title(opts.value);\n        }\n      }\n    }\n  }\n  if (title_suffix) {\n    if (eff_title) {\n      eff_title = `${eff_title} | ${title_suffix}`;\n    } else {\n      eff_title = title_suffix;\n    }\n  }\n  return `${root_value}${values.length ? '?' : ''}${values.join('&')}`;\n}\n\nexport function refreshTitle() {\n  toString();\n  if (eff_title && eff_title !== document.title) {\n    document.title = eff_title;\n  }\n}\n\nfunction periodicRefreshTitle() {\n  refreshTitle();\n  setTimeout(periodicRefreshTitle, 1000);\n}\n\nfunction onPopState() {\n  let query_string = queryString();\n  last_history_str = query_string;\n  goInternal(query_string);\n  refreshTitle();\n}\n\nlet on_url_change;\nexport function onURLChange(cb) {\n  on_url_change = cb;\n}\n\nlet last_history_set_time = 0;\nlet scheduled = false;\nlet need_push_state = false;\nfunction updateHistory(new_need_push_state) {\n  let new_str = toString();\n  if (last_history_str === new_str) {\n    return;\n  }\n  need_push_state = need_push_state || new_need_push_state;\n  last_history_str = new_str;\n  if (scheduled) {\n    // already queued up\n    return;\n  }\n  let delay = HISTORY_UPDATE_TIME;\n  if (Date.now() - last_history_set_time > HISTORY_UPDATE_TIME) {\n    // Been awhile, apply \"instantly\" (but still wait until next tick to ensure\n    //   any other immediate changes are registered)\n    delay = 1;\n  }\n  scheduled = true;\n  setTimeout(function () {\n    scheduled = false;\n    last_history_set_time = Date.now();\n    if (need_push_state) {\n      need_push_state = false;\n      window.history.pushState(undefined, eff_title, `${url_base}${last_history_str}`);\n    } else {\n      window.history.replaceState(undefined, eff_title, `${url_base}${last_history_str}`);\n    }\n    if (eff_title) {\n      document.title = eff_title;\n    }\n    if (on_url_change) {\n      on_url_change();\n    }\n    //window.history.replaceState(undefined, eff_title, `#${last_history_str}`);\n  }, delay);\n}\n\n// Optional startup\nexport function startup(param) {\n  assert(!title_suffix);\n  title_suffix = param.title_suffix;\n\n  // Refresh the current URL, it might be in the non-rooted format\n  updateHistory(false);\n\n  if (title_suffix) {\n    refreshTitle();\n    setTimeout(periodicRefreshTitle, 1000);\n  }\n}\n\nexport function register(opts) {\n  assert(opts.key);\n  assert(!params[opts.key]);\n  opts.type = opts.type || TYPE_STRING;\n  let regex_search = `(?:[^\\\\w])${opts.key}=([^&]+)`;\n  let regex_type = '';\n  if (opts.type === TYPE_SET) {\n    regex_type = 'g';\n  } else {\n    opts.def = opts.def || '';\n    opts.hide_values = opts.hide_values || {};\n    opts.hide_values[opts.def] = true;\n  }\n  opts.regex = new RegExp(regex_search, regex_type);\n  params[opts.key] = opts;\n  // Get initial value\n  opts.value = getValue(queryString(), opts);\n  let ret = opts.value;\n  if (opts.type === TYPE_SET && typeof Proxy === 'function') {\n    // Auto-apply changes to URL if someone modifies the proxy\n    ret = new Proxy(opts.value, {\n      set: function (target, prop, value) {\n        if (value) {\n          target[prop] = 1;\n        } else {\n          delete target[prop];\n        }\n        updateHistory();\n        return true;\n      }\n    });\n  }\n\n  if (!window.onpopstate) {\n    window.onpopstate = onPopState;\n  }\n\n  return ret;\n}\n\nexport function set(key, value, value2) {\n  let opts = params[key];\n  assert(opts);\n  if (opts.type === TYPE_SET) {\n    if (Boolean(opts.value[value]) !== Boolean(value2)) {\n      opts.value[value] = value2 ? 1 : 0;\n      updateHistory(opts.push);\n    }\n  } else {\n    if (opts.value !== value) {\n      opts.value = value;\n      updateHistory(opts.push);\n    }\n  }\n}\n\nexport function get(key) {\n  let opts = params[key];\n  assert(opts);\n  return opts.value;\n}\n\nexport function go(query_string) {\n  // with the '?'\n  goInternal(query_string);\n  updateHistory(true);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint no-bitwise:off */\n\n// Vector math functions required by the rest of the engine taken piecemeal from\n// gl-matrix and related, as well as some generic math utilities\nexports.mat3 = require('gl-mat3/create');\nexports.mat4 = require('gl-mat4/create');\n\nconst { abs, max, min, floor, round, sqrt } = Math;\n\nexport function vec1(v) {\n  return new Float32Array([v]);\n}\n\nexport function vec2(a, b) {\n  let r = new Float32Array(2);\n  if (a || b) {\n    r[0] = a;\n    r[1] = b;\n  }\n  return r;\n}\n\nexport function vec3(a, b, c) {\n  let r = new Float32Array(3);\n  if (a || b || c) {\n    r[0] = a;\n    r[1] = b;\n    r[2] = c;\n  }\n  return r;\n}\n\nexport function vec4(a, b, c, d) {\n  let r = new Float32Array(4);\n  if (a || b || c || d) {\n    r[0] = a;\n    r[1] = b;\n    r[2] = c;\n    r[3] = d;\n  }\n  return r;\n}\n\nexport const unit_vec = vec4(1, 1, 1, 1);\nexport const half_vec = vec4(0.5, 0.5, 0.5, 0.5);\nexport const zero_vec = vec4();\nexport const identity_mat3 = exports.mat3();\nexport const identity_mat4 = exports.mat4();\nexport const xaxis = vec4(1, 0, 0, 0);\nexport const yaxis = vec4(0, 1, 0, 0);\nexport const zaxis = vec4(0, 0, 1, 0);\n\nexport function v2abs(out, a) {\n  out[0] = abs(a[0]);\n  out[1] = abs(a[1]);\n  return out;\n}\n\nexport function v2add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n\nexport function v2addScale(out, a, b, s) {\n  out[0] = a[0] + b[0] * s;\n  out[1] = a[1] + b[1] * s;\n  return out;\n}\n\nexport function v2copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n\nexport function v2distSq(a, b) {\n  return (a[0] - b[0]) * (a[0] - b[0]) + (a[1] - b[1]) * (a[1] - b[1]);\n}\n\nexport function v2div(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n\nexport function v2floor(out, a) {\n  out[0] = floor(a[0]);\n  out[1] = floor(a[1]);\n  return out;\n}\n\nexport function v2lengthSq(a) {\n  return a[0] * a[0] + a[1] * a[1];\n}\n\nexport function v2lerp(out, t, a, b) {\n  let it = 1 - t;\n  out[0] = it * a[0] + t * b[0];\n  out[1] = it * a[1] + t * b[1];\n  return out;\n}\n\nexport function v2mul(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n\nexport function v2normalize(out, a) {\n  let len = a[0] * a[0] + a[1] * a[1];\n  if (len > 0) {\n    len = 1 / sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n  }\n  return out;\n}\n\nexport function v2same(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n\nexport function v2scale(out, a, s) {\n  out[0] = a[0] * s;\n  out[1] = a[1] * s;\n  return out;\n}\n\nexport function v2set(out, a, b) {\n  out[0] = a;\n  out[1] = b;\n  return out;\n}\n\nexport function v2sub(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n\nexport function v3add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\nexport function v3iAdd(a, b) {\n  a[0] += b[0];\n  a[1] += b[1];\n  a[2] += b[2];\n  return a;\n}\n\nexport function v3addScale(out, a, b, s) {\n  out[0] = a[0] + b[0] * s;\n  out[1] = a[1] + b[1] * s;\n  out[2] = a[2] + b[2] * s;\n  return out;\n}\n\nexport function v3copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\nexport function v3cross(out, a, b) {\n  let a0 = a[0];\n  let a1 = a[1];\n  let a2 = a[2];\n  let b0 = b[0];\n  let b1 = b[1];\n  let b2 = b[2];\n  out[0] = a1 * b2 - a2 * b1;\n  out[1] = a2 * b0 - a0 * b2;\n  out[2] = a0 * b1 - a1 * b0;\n  return out;\n}\n\n// determinant of the matrix made by (columns?) [a, b, c];\nexport function v3determinant(a, b, c) {\n  // let a00 = a[0];\n  // let a01 = a[1];\n  // let a02 = a[2];\n  // let a10 = b[0];\n  // let a11 = b[1];\n  // let a12 = b[2];\n  // let a20 = c[0];\n  // let a21 = c[2];\n  // let a22 = c[2];\n  let a00 = a[0];\n  let a01 = b[0];\n  let a02 = c[0];\n  let a10 = a[1];\n  let a11 = b[1];\n  let a12 = c[1];\n  let a20 = a[2];\n  let a21 = b[2];\n  let a22 = c[2];\n\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n\nexport function v3dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\nexport function v3distSq(a, b) {\n  return (a[0] - b[0]) * (a[0] - b[0]) + (a[1] - b[1]) * (a[1] - b[1]) + (a[2] - b[2]) * (a[2] - b[2]);\n}\n\nexport function v3div(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n\nexport function v3iFloor(a) {\n  a[0] = floor(a[0]);\n  a[1] = floor(a[1]);\n  a[2] = floor(a[2]);\n  return a;\n}\n\nexport function v3floor(out, a) {\n  out[0] = floor(a[0]);\n  out[1] = floor(a[1]);\n  out[2] = floor(a[2]);\n  return out;\n}\n\nexport function v3lengthSq(a) {\n  return a[0] * a[0] + a[1] * a[1] + a[2] * a[2];\n}\n\nexport function v3lerp(out, t, a, b) {\n  let it = 1 - t;\n  out[0] = it * a[0] + t * b[0];\n  out[1] = it * a[1] + t * b[1];\n  out[2] = it * a[2] + t * b[2];\n  return out;\n}\n\nexport function v3iMax(a, b) {\n  a[0] = max(a[0], b[0]);\n  a[1] = max(a[1], b[1]);\n  a[2] = max(a[2], b[2]);\n  return a;\n}\n\nexport function v3iMin(a, b) {\n  a[0] = min(a[0], b[0]);\n  a[1] = min(a[1], b[1]);\n  a[2] = min(a[2], b[2]);\n  return a;\n}\n\nexport function v3mul(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n\nexport function v3mulMat4(out, a, m) {\n  let x = a[0];\n  let y = a[1];\n  let z = a[2];\n  out[0] = x * m[0] + y * m[4] + z * m[8];\n  out[1] = x * m[1] + y * m[5] + z * m[9];\n  out[2] = x * m[2] + y * m[6] + z * m[10];\n  return out;\n}\n\nexport function v3normalize(out, a) {\n  let len = a[0] * a[0] + a[1] * a[1] + a[2] * a[2];\n  if (len > 0) {\n    len = 1 / sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n    out[2] = a[2] * len;\n  }\n  return out;\n}\n\nexport function v3iNormalize(a) {\n  let len = a[0] * a[0] + a[1] * a[1] + a[2] * a[2];\n  if (len > 0) {\n    len = 1 / sqrt(len);\n    a[0] *= len;\n    a[1] *= len;\n    a[2] *= len;\n  }\n  return a;\n}\n\n// Treats `a` as vec3 input with w assumed to be 1\n// out[0]/[1] have had perspective divide and converted to normalized 0-1 range\n// out[2] is distance\nexport function v3perspectiveProject(out, a, m) {\n  let x = a[0];\n  let y = a[1];\n  let z = a[2];\n  let w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  let invw = 0.5 / (w || 0.00001);\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) * invw + 0.5;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) * -invw + 0.5;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14];\n  return out;\n}\n\nexport function v3round(out, a) {\n  out[0] = round(a[0]);\n  out[1] = round(a[1]);\n  out[2] = round(a[2]);\n  return out;\n}\n\nexport function v3same(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n\nexport function v3scale(out, a, s) {\n  out[0] = a[0] * s;\n  out[1] = a[1] * s;\n  out[2] = a[2] * s;\n  return out;\n}\n\nexport function v3set(out, a, b, c) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  return out;\n}\n\nexport function v3sub(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n\nexport function v3iSub(a, b) {\n  a[0] -= b[0];\n  a[1] -= b[1];\n  a[2] -= b[2];\n  return a;\n}\n\nexport function v3zero(out) {\n  out[0] = out[1] = out[2] = 0;\n  return out;\n}\n\nexport function v4add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n\nexport function v4clone(a) {\n  return a.slice(0);\n}\n\nexport function v4copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\nexport function v4lerp(out, t, a, b) {\n  let it = 1 - t;\n  out[0] = it * a[0] + t * b[0];\n  out[1] = it * a[1] + t * b[1];\n  out[2] = it * a[2] + t * b[2];\n  out[3] = it * a[3] + t * b[3];\n  return out;\n}\n\nexport function v4mul(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n\nexport function v4mulAdd(out, a, b, c) {\n  out[0] = a[0] * b[0] + c[0];\n  out[1] = a[1] * b[1] + c[1];\n  out[2] = a[2] * b[2] + c[2];\n  out[3] = a[3] * b[3] + c[3];\n  return out;\n}\n\nexport function v4same(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n\nexport function v4scale(out, a, s) {\n  out[0] = a[0] * s;\n  out[1] = a[1] * s;\n  out[2] = a[2] * s;\n  out[3] = a[3] * s;\n  return out;\n}\n\nexport function v4set(out, a, b, c, d) {\n  out[0] = a;\n  out[1] = b;\n  out[2] = c;\n  out[3] = d;\n  return out;\n}\n\nexport function v4zero(out) {\n  out[0] = out[1] = out[2] = out[3] = 0;\n  return out;\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst { floor } = Math;\n\nlet offs = 0;\nfunction now() {\n  return Date.now() + offs;\n}\nmodule.exports = exports = now;\nexports.now = now;\nexports.sync = function (server_time) {\n  offs = server_time - Date.now();\n};\nexports.seconds = function () {\n  // Seconds since Jan 1st, 2020\n  return floor(now() / 1000) - 1577836800;\n};","const assert = require('assert');\nconst { filewatchOn, filewatchTriggerChange } = require('./filewatch.js');\nconst urlhash = require('./urlhash.js');\n\nlet fs = window.glov_webfs = window.glov_webfs || {};\nlet decoded = {};\nlet used = {};\n// export function webFSReady() {\n//   // TODO: async ready state?\n// }\n\nfunction decode(data) {\n  let len = data[0];\n  let str = data[1];\n  let u8 = new Uint8Array(len);\n  let idxo = 0;\n  let idxi = 0;\n  while (idxo < len) {\n    let byte = str.charCodeAt(idxi++);\n    if (byte === 126) {\n      byte = 0;\n    } else if (byte === 27) {\n      byte = str.charCodeAt(idxi++);\n    }\n    u8[idxo++] = byte;\n  }\n  assert.equal(idxi, str.length);\n  assert.equal(idxo, len);\n  return u8;\n}\n\nexport function webFSGetFile(filename, encoding) {\n  let ret = decoded[filename];\n  if (ret) {\n    return ret;\n  }\n  used[filename] = true;\n  let data = fs[filename];\n  assert(data, `Error loading file: ${filename}`);\n  if (encoding === 'text') {\n    ret = data[1];\n  } else {\n    ret = decode(data);\n  }\n  decoded[filename] = ret;\n  return ret;\n}\n\nexport function webFSExists(filename) {\n  return Boolean(fs[filename]);\n}\n\n// Don't report on files we know are loaded dynamically, and are small\nconst report_ignore_regex = /\\.(fp|vp)$/;\nexport function webFSReportUnused() {\n  let tot_size = 0;\n  for (let filename in fs) {\n    if (!used[filename] && !filename.match(report_ignore_regex)) {\n      console.warn(`WebFS file bundled but unreferenced: ${filename}`);\n      tot_size += fs[filename][0];\n    }\n  }\n  if (tot_size) {\n    console.warn(`WebFS wasting ${tot_size} bytes`);\n  }\n}\n\nfunction webFSReload() {\n  window.glov_webfs = {};\n  let scriptTag = document.createElement('script');\n  scriptTag.src = `${urlhash.getURLBase()}fsdata.js?rl=${Date.now()}`;\n  scriptTag.onload = function () {\n    if (window.glov_webfs) {\n      let old_fs = fs;\n      fs = window.glov_webfs;\n      decoded = {};\n      used = {};\n      for (let key in fs) {\n        let old_value = old_fs[key];\n        let new_value = fs[key];\n        for (let ii = 0; ii < new_value.length; ++ii) {\n          if (!old_value || new_value[ii] !== old_value[ii]) {\n            filewatchTriggerChange(key);\n            break;\n          }\n        }\n      }\n    }\n  };\n  document.getElementsByTagName('head')[0].appendChild(scriptTag);\n}\n\nfilewatchOn('fsdata.js', webFSReload);","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* global WebSocket, XMLHttpRequest */\n\nconst ack = require('../../common/ack.js');\nconst { ackInitReceiver } = ack;\nconst assert = require('assert');\nconst { min } = Math;\nconst urlhash = require('./urlhash.js');\nconst walltime = require('./walltime.js');\nconst wscommon = require('../../common/wscommon.js');\nconst { wsHandleMessage } = wscommon;\n\n// let net_time = 0;\n// export function getNetTime() {\n//   let r = net_time;\n//   net_time = 0;\n//   return r;\n// }\n\nexport function WSClient(path) {\n  this.id = null;\n  this.handlers = {};\n  this.socket = null;\n  this.connected = false;\n  this.disconnected = false;\n  this.retry_scheduled = false;\n  this.retry_count = 0;\n  this.disconnect_time = Date.now();\n  this.last_receive_time = Date.now();\n  this.last_send_time = Date.now();\n  this.auto_path = !path;\n  ackInitReceiver(this);\n\n  if (this.auto_path) {\n\n    path = document.location.toString().match(/^[^#?]+/)[0]; // remove search and anchor\n\n\n    if (path.slice(-1) !== '/') {\n      // /file.html or /path/file.html or /path\n      let idx = path.lastIndexOf('/');\n      if (idx !== -1) {\n        let filename = path.slice(idx + 1);\n        if (filename.indexOf('.') !== -1) {\n          path = path.slice(0, idx + 1);\n        } else {\n          path += '/';\n        }\n      } else {\n        path += '/';\n      }\n    }\n    path = path.replace(/^http/, 'ws');\n    this.path = `${path}ws`;\n  } else {\n    this.path = path;\n  }\n\n  if (path.match(/:\\d+\\//)) {\n    // has port, don't try anything fancy\n    this.path2 = this.path;\n  } else if (path.match(/^ws:/)) {\n    // no port, try wss:// if this fails\n    // Should fix Comcast injection issue\n    this.path2 = this.path.replace(/^ws:/, 'wss:');\n  } else {\n    // Using wss:// some browsers will not allow connecting to ws://, so don't even try\n    this.path2 = this.path;\n  }\n\n  this.connect(false);\n\n  this.onMsg('cack', this.onConnectAck.bind(this));\n  this.onMsg('app_ver', this.onAppVer.bind(this));\n  this.onMsg('error', this.onError.bind(this));\n}\n\nWSClient.prototype.timeSinceDisconnect = function () {\n  return Date.now() - this.disconnect_time;\n};\n\nWSClient.prototype.onAppVer = function (ver) {\n  if (ver !== BUILD_TIMESTAMP) {\n    if (this.on_app_ver_mismatch) {\n      this.on_app_ver_mismatch();\n    } else {\n      if (this.auto_path) {\n        console.error(`App version mismatch (server: ${ver}, client: ${BUILD_TIMESTAMP}), reloading`);\n        if (window.reloadSafe) {\n          window.reloadSafe();\n        } else {\n          document.location.reload();\n        }\n      } else {\n        console.warn(`App version mismatch (server: ${ver}, client: ${BUILD_TIMESTAMP}), ignoring`);\n      }\n    }\n  }\n};\n\nWSClient.prototype.onConnectAck = function (data, resp_func) {\n  let client = this;\n  walltime.sync(data.time);\n  client.connected = true;\n  client.disconnected = false;\n  client.id = data.id;\n  client.secret = data.secret;\n  if (data.app_ver) {\n    client.onAppVer(data.app_ver);\n  }\n  // Fire user-level connect handler as well\n  assert(client.handlers.connect);\n  client.handlers.connect(client, {\n    client_id: client.id\n  });\n  resp_func();\n};\n\nWSClient.prototype.wsPak = function (msg) {\n  return wscommon.wsPak(msg, null, this);\n};\n\nWSClient.prototype.send = function (msg, data, resp_func) {\n  wscommon.sendMessage.call(this, msg, data, resp_func);\n};\n\nWSClient.prototype.onError = function (e) {\n  console.error(e);\n  throw e;\n};\n\n// cb(client, data, resp_func)\nWSClient.prototype.onMsg = function (msg, cb) {\n  assert.ok(!this.handlers[msg]);\n  this.handlers[msg] = function wrappedCallback(client, data, resp_func) {\n    // Client interface does not need a client passed to it!\n    return cb(data, resp_func);\n  };\n};\n\nWSClient.prototype.checkForNewAppVersion = function () {\n  if (this.app_ver_check_in_progress) {\n    return;\n  }\n  this.app_ver_check_in_progress = true;\n  let xhr = new XMLHttpRequest();\n  xhr.open('GET', `${urlhash.getURLBase()}app.ver.json`, true);\n  // xhr.responseType = 'json'; // causes un-catchable, un-reported errors\n  xhr.onload = () => {\n    this.app_ver_check_in_progress = false;\n    let text;\n    try {\n      text = xhr.responseText;\n      let obj = JSON.parse(text);\n      if (obj && obj.ver) {\n        this.onAppVer(obj.ver);\n      }\n    } catch (e) {\n      console.error('Received invalid response when checking app version:', text || '<empty response>');\n      // Probably internal server error or such as the server is restart, try again momentarily\n      // This is not triggered on connection errors, only if we got a (non-parseable) response from the server\n      if (!this.delayed_recheck) {\n        this.delayed_recheck = true;\n        setTimeout(() => {\n          this.delayed_recheck = false;\n          this.checkForNewAppVersion();\n        }, 1000);\n      }\n    }\n  };\n  xhr.onerror = () => {\n    this.app_ver_check_in_progress = false;\n  };\n  xhr.send(null);\n};\n\nWSClient.prototype.retryConnection = function () {\n  let client = this;\n  assert(!client.socket);\n  assert(!client.retry_scheduled);\n  client.retry_scheduled = true;\n  ++client.retry_count;\n  this.checkForNewAppVersion();\n  setTimeout(function () {\n    assert(client.retry_scheduled);\n    assert(!client.socket);\n    client.retry_scheduled = false;\n    client.connect(true);\n  }, min(client.retry_count * client.retry_count * 100, 15000));\n};\n\nWSClient.prototype.connect = function (for_reconnect) {\n  let client = this;\n\n  let path = `${client.retry_count % 2 ? client.path2 : client.path}?pver=${wscommon.PROTOCOL_VERSION}${for_reconnect && client.id && client.secret ? `&reconnect=${client.id}&secret=${client.secret}` : ''}`;\n  let socket = new WebSocket(path);\n  socket.binaryType = 'arraybuffer';\n  client.socket = socket;\n\n  // Protect callbacks from ever firing if we've already disconnected this socket\n  //   from the WSClient\n  function guard(fn) {\n    return function (...args) {\n      if (client.socket !== socket) {\n        return;\n      }\n      fn(...args);\n    };\n  }\n\n  function abort(skip_close) {\n    client.socket = null;\n    if (client.connected) {\n      client.disconnect_time = Date.now();\n      client.disconnected = true;\n    }\n    client.connected = false;\n    if (!skip_close) {\n      try {\n        socket.close();\n      } catch (e) {\n        // ignore\n      }\n    }\n    ack.failAll(client);\n  }\n\n  function retry(skip_close) {\n    abort(skip_close);\n    client.retryConnection();\n  }\n\n  // Local state, for this one connection\n  let connected = false;\n  client.socket.addEventListener('error', guard(function (err) {\n    if (!connected) {\n      console.log('WebSocket error during initial connection, retrying...', err);\n      retry();\n    } else {\n      console.error('WebSocket error', err);\n      // Disconnect and reconnect here, is this a terminal error? Probably not, we'll get a 'close' event if it is?\n      // We some error occasionally on iOS, not sure what error, but it auto-reconnects fine, so let's\n      // not do a throw\n      // client.onError(err);\n    }\n  }));\n\n  client.socket.addEventListener('message', guard(function (message) {\n    // net_time -= Date.now();\n    assert(message.data instanceof ArrayBuffer);\n    wsHandleMessage(client, new Uint8Array(message.data));\n    // net_time += Date.now();\n  }));\n\n  client.socket.addEventListener('open', guard(function () {\n    console.log('WebSocket open');\n    connected = true;\n    // reset retry count so next retry is fast if we get disconnected\n    client.retry_count = 0;\n  }));\n\n  client.socket.addEventListener('close', guard(function () {\n    console.log('WebSocket close, retrying connection...');\n    retry(true);\n  }));\n\n  let doPing = guard(function () {\n    if (Date.now() - client.last_send_time > wscommon.PING_TIME && client.connected && client.socket.readyState === 1) {\n      client.send('ping');\n    }\n    setTimeout(doPing, wscommon.PING_TIME);\n  });\n  setTimeout(doPing, wscommon.PING_TIME);\n\n  // For debugging reconnect handling\n  // setTimeout(function () {\n  //   if (connected) {\n  //     socket.close();\n  //   }\n  // }, 5000);\n};","module.exports={\"font_size\":8,\"imageW\":128,\"imageH\":128,\"spread\":2,\"noFilter\":1,\"channels\":1,\"char_infos\":[{\"c\":32,\"x0\":61,\"y0\":63,\"xpad\":4,\"w\":0,\"h\":0},{\"c\":33,\"x0\":92,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":1,\"h\":5},{\"c\":34,\"x0\":16,\"y0\":63,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":2},{\"c\":35,\"x0\":98,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":36,\"x0\":38,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":6},{\"c\":37,\"x0\":108,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":38,\"x0\":118,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":39,\"x0\":24,\"y0\":63,\"yoffs\":1,\"xpad\":1,\"w\":1,\"h\":2},{\"c\":40,\"x0\":2,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":2,\"h\":5},{\"c\":41,\"x0\":9,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":2,\"h\":5},{\"c\":42,\"x0\":109,\"y0\":54,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":3},{\"c\":43,\"x0\":117,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":3,\"h\":3},{\"c\":44,\"x0\":30,\"y0\":63,\"yoffs\":5,\"xpad\":1,\"w\":2,\"h\":2},{\"c\":45,\"x0\":67,\"y0\":63,\"yoffs\":3,\"xpad\":1,\"w\":3,\"h\":1},{\"c\":46,\"x0\":75,\"y0\":63,\"yoffs\":5,\"xpad\":1,\"w\":1,\"h\":1},{\"c\":47,\"x0\":16,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":48,\"x0\":26,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":49,\"x0\":35,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":2,\"h\":5},{\"c\":50,\"x0\":42,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":51,\"x0\":51,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":52,\"x0\":60,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":53,\"x0\":69,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":54,\"x0\":78,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":55,\"x0\":87,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":56,\"x0\":96,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":57,\"x0\":105,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":58,\"x0\":2,\"y0\":63,\"yoffs\":2,\"xpad\":1,\"w\":1,\"h\":3},{\"c\":59,\"x0\":115,\"y0\":44,\"yoffs\":2,\"xpad\":1,\"w\":1,\"h\":4},{\"c\":60,\"x0\":114,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":61,\"x0\":8,\"y0\":63,\"yoffs\":2,\"xpad\":1,\"w\":3,\"h\":3},{\"c\":62,\"x0\":122,\"y0\":14,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":63,\"x0\":2,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":64,\"x0\":11,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":65,\"x0\":21,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":66,\"x0\":30,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":67,\"x0\":39,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":68,\"x0\":47,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":69,\"x0\":56,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":70,\"x0\":64,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":71,\"x0\":72,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":72,\"x0\":81,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":73,\"x0\":90,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":74,\"x0\":98,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":75,\"x0\":107,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":76,\"x0\":116,\"y0\":24,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":77,\"x0\":2,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":78,\"x0\":12,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":79,\"x0\":21,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":80,\"x0\":30,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":81,\"x0\":47,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":6},{\"c\":82,\"x0\":39,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":83,\"x0\":48,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":84,\"x0\":57,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":85,\"x0\":65,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":86,\"x0\":74,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":87,\"x0\":83,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":88,\"x0\":93,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":89,\"x0\":102,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":90,\"x0\":111,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":91,\"x0\":119,\"y0\":34,\"yoffs\":1,\"xpad\":1,\"w\":2,\"h\":5},{\"c\":92,\"x0\":2,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":93,\"x0\":12,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":2,\"h\":5},{\"c\":94,\"x0\":37,\"y0\":63,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":2},{\"c\":95,\"x0\":81,\"y0\":63,\"yoffs\":5,\"xpad\":1,\"w\":4,\"h\":1},{\"c\":96,\"x0\":45,\"y0\":63,\"yoffs\":1,\"xpad\":1,\"w\":2,\"h\":2},{\"c\":97,\"x0\":121,\"y0\":44,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":4},{\"c\":98,\"x0\":19,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":99,\"x0\":2,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":3,\"h\":4},{\"c\":100,\"x0\":28,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":101,\"x0\":10,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":4},{\"c\":102,\"x0\":37,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":103,\"x0\":56,\"y0\":2,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":6},{\"c\":104,\"x0\":45,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":105,\"x0\":54,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":1,\"h\":5},{\"c\":106,\"x0\":2,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":2,\"h\":7},{\"c\":107,\"x0\":60,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":5},{\"c\":108,\"x0\":69,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":1,\"h\":5},{\"c\":109,\"x0\":19,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":5,\"h\":4},{\"c\":110,\"x0\":29,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":4},{\"c\":111,\"x0\":38,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":4},{\"c\":112,\"x0\":65,\"y0\":2,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":6},{\"c\":113,\"x0\":74,\"y0\":2,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":6},{\"c\":114,\"x0\":47,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":3,\"h\":4},{\"c\":115,\"x0\":55,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":4},{\"c\":116,\"x0\":75,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":117,\"x0\":64,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":4},{\"c\":118,\"x0\":73,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":4},{\"c\":119,\"x0\":82,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":5,\"h\":4},{\"c\":120,\"x0\":92,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":3,\"h\":4},{\"c\":121,\"x0\":83,\"y0\":2,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":6},{\"c\":122,\"x0\":100,\"y0\":54,\"yoffs\":2,\"xpad\":1,\"w\":4,\"h\":4},{\"c\":123,\"x0\":83,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":124,\"x0\":91,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":1,\"h\":5},{\"c\":125,\"x0\":97,\"y0\":44,\"yoffs\":1,\"xpad\":1,\"w\":3,\"h\":5},{\"c\":126,\"x0\":52,\"y0\":63,\"yoffs\":1,\"xpad\":1,\"w\":4,\"h\":2},{\"c\":160,\"x0\":90,\"y0\":63,\"xpad\":3,\"w\":1,\"h\":1},{\"c\":65533,\"x0\":105,\"y0\":44,\"yoffs\":2,\"xpad\":1,\"w\":5,\"h\":5},{\"c\":128263,\"x0\":9,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":10,\"h\":7},{\"c\":128264,\"x0\":24,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":9,\"h\":7}]}\n","module.exports={\"font_size\":16,\"imageW\":1024,\"imageH\":64,\"spread\":2,\"noFilter\":1,\"channels\":1,\"char_infos\":[{\"c\":32,\"x0\":172,\"y0\":21,\"xpad\":8,\"w\":0,\"h\":0},{\"c\":33,\"x0\":137,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":2,\"h\":10},{\"c\":34,\"x0\":81,\"y0\":21,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":4},{\"c\":35,\"x0\":144,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":10,\"h\":10},{\"c\":36,\"x0\":59,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":12},{\"c\":37,\"x0\":159,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":10,\"h\":10},{\"c\":38,\"x0\":174,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":10,\"h\":10},{\"c\":39,\"x0\":92,\"y0\":21,\"yoffs\":3,\"xpad\":2,\"w\":2,\"h\":4},{\"c\":40,\"x0\":189,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":4,\"h\":10},{\"c\":41,\"x0\":198,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":4,\"h\":10},{\"c\":42,\"x0\":41,\"y0\":21,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":6},{\"c\":43,\"x0\":52,\"y0\":21,\"yoffs\":5,\"xpad\":2,\"w\":6,\"h\":6},{\"c\":44,\"x0\":99,\"y0\":21,\"yoffs\":11,\"xpad\":2,\"w\":4,\"h\":4},{\"c\":45,\"x0\":141,\"y0\":21,\"yoffs\":7,\"xpad\":2,\"w\":6,\"h\":2},{\"c\":46,\"x0\":152,\"y0\":21,\"yoffs\":11,\"xpad\":2,\"w\":2,\"h\":2},{\"c\":47,\"x0\":207,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":10,\"h\":10},{\"c\":48,\"x0\":222,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":49,\"x0\":235,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":4,\"h\":10},{\"c\":50,\"x0\":244,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":51,\"x0\":257,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":52,\"x0\":270,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":53,\"x0\":283,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":54,\"x0\":296,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":55,\"x0\":309,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":56,\"x0\":322,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":57,\"x0\":335,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":58,\"x0\":63,\"y0\":21,\"yoffs\":5,\"xpad\":2,\"w\":2,\"h\":6},{\"c\":59,\"x0\":877,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":2,\"h\":8},{\"c\":60,\"x0\":348,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":61,\"x0\":70,\"y0\":21,\"yoffs\":5,\"xpad\":2,\"w\":6,\"h\":6},{\"c\":62,\"x0\":359,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":63,\"x0\":370,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":64,\"x0\":383,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":10,\"h\":10},{\"c\":65,\"x0\":398,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":66,\"x0\":411,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":67,\"x0\":424,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":68,\"x0\":435,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":69,\"x0\":448,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":70,\"x0\":459,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":71,\"x0\":470,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":72,\"x0\":483,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":73,\"x0\":496,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":74,\"x0\":507,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":75,\"x0\":520,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":76,\"x0\":533,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":77,\"x0\":544,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":10,\"h\":10},{\"c\":78,\"x0\":559,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":79,\"x0\":572,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":80,\"x0\":585,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":81,\"x0\":72,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":12},{\"c\":82,\"x0\":598,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":83,\"x0\":611,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":84,\"x0\":624,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":85,\"x0\":635,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":86,\"x0\":648,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":87,\"x0\":661,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":10,\"h\":10},{\"c\":88,\"x0\":676,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":89,\"x0\":689,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":90,\"x0\":702,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":91,\"x0\":713,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":4,\"h\":10},{\"c\":92,\"x0\":722,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":10,\"h\":10},{\"c\":93,\"x0\":737,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":4,\"h\":10},{\"c\":94,\"x0\":108,\"y0\":21,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":4},{\"c\":95,\"x0\":159,\"y0\":21,\"yoffs\":11,\"xpad\":2,\"w\":8,\"h\":2},{\"c\":96,\"x0\":119,\"y0\":21,\"yoffs\":3,\"xpad\":2,\"w\":4,\"h\":4},{\"c\":97,\"x0\":884,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":8},{\"c\":98,\"x0\":746,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":99,\"x0\":897,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":6,\"h\":8},{\"c\":100,\"x0\":759,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":101,\"x0\":908,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":8},{\"c\":102,\"x0\":772,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":103,\"x0\":85,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":12},{\"c\":104,\"x0\":783,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":105,\"x0\":796,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":2,\"h\":10},{\"c\":106,\"x0\":2,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":4,\"h\":14},{\"c\":107,\"x0\":803,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":10},{\"c\":108,\"x0\":816,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":2,\"h\":10},{\"c\":109,\"x0\":921,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":10,\"h\":8},{\"c\":110,\"x0\":936,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":8},{\"c\":111,\"x0\":949,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":8},{\"c\":112,\"x0\":98,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":12},{\"c\":113,\"x0\":111,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":12},{\"c\":114,\"x0\":962,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":6,\"h\":8},{\"c\":115,\"x0\":973,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":8},{\"c\":116,\"x0\":823,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":117,\"x0\":986,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":8},{\"c\":118,\"x0\":999,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":8},{\"c\":119,\"x0\":2,\"y0\":21,\"yoffs\":5,\"xpad\":2,\"w\":10,\"h\":8},{\"c\":120,\"x0\":17,\"y0\":21,\"yoffs\":5,\"xpad\":2,\"w\":6,\"h\":8},{\"c\":121,\"x0\":124,\"y0\":2,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":12},{\"c\":122,\"x0\":28,\"y0\":21,\"yoffs\":5,\"xpad\":2,\"w\":8,\"h\":8},{\"c\":123,\"x0\":834,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":124,\"x0\":845,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":2,\"h\":10},{\"c\":125,\"x0\":852,\"y0\":2,\"yoffs\":3,\"xpad\":2,\"w\":6,\"h\":10},{\"c\":126,\"x0\":128,\"y0\":21,\"yoffs\":3,\"xpad\":2,\"w\":8,\"h\":4},{\"c\":160,\"x0\":178,\"y0\":21,\"xpad\":7,\"w\":1,\"h\":1},{\"c\":65533,\"x0\":863,\"y0\":2,\"yoffs\":3,\"xpad\":1,\"w\":9,\"h\":10},{\"c\":128263,\"x0\":11,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":19,\"h\":14},{\"c\":128264,\"x0\":35,\"y0\":2,\"yoffs\":1,\"xpad\":1,\"w\":19,\"h\":14}]}\n","module.exports={\"font_size\":32,\"imageW\":1024,\"imageH\":512,\"spread\":8,\"channels\":1,\"char_infos\":[{\"c\":13,\"x0\":307,\"y0\":381,\"w\":1,\"h\":1},{\"c\":32,\"x0\":325,\"y0\":381,\"xpad\":6.10156,\"w\":1,\"h\":1},{\"c\":33,\"x0\":436,\"y0\":230,\"yoffs\":4,\"xpad\":1.13281,\"w\":6,\"h\":22},{\"c\":34,\"x0\":879,\"y0\":347,\"yoffs\":4,\"w\":10,\"h\":8},{\"c\":35,\"x0\":673,\"y0\":309,\"yoffs\":10,\"w\":16,\"h\":17},{\"c\":36,\"x0\":215,\"y0\":8,\"yoffs\":1,\"xpad\":1.32031,\"w\":15,\"h\":29},{\"c\":37,\"x0\":933,\"y0\":148,\"yoffs\":4,\"xpad\":0.773438,\"w\":26,\"h\":23},{\"c\":38,\"x0\":976,\"y0\":148,\"yoffs\":4,\"xpad\":0.570313,\"w\":20,\"h\":23},{\"c\":39,\"x0\":906,\"y0\":347,\"yoffs\":4,\"w\":5,\"h\":8},{\"c\":40,\"x0\":8,\"y0\":190,\"yoffs\":5,\"w\":8,\"h\":23},{\"c\":41,\"x0\":33,\"y0\":190,\"yoffs\":5,\"xpad\":0.890625,\"w\":7,\"h\":23},{\"c\":42,\"x0\":645,\"y0\":347,\"yoffs\":2,\"w\":11,\"h\":11},{\"c\":43,\"x0\":706,\"y0\":309,\"yoffs\":9,\"xpad\":0.414063,\"w\":15,\"h\":17},{\"c\":44,\"x0\":928,\"y0\":347,\"yoffs\":22,\"w\":5,\"h\":8},{\"c\":45,\"x0\":252,\"y0\":381,\"yoffs\":16,\"w\":9,\"h\":3},{\"c\":46,\"x0\":156,\"y0\":381,\"yoffs\":22,\"w\":5,\"h\":4},{\"c\":47,\"x0\":57,\"y0\":190,\"yoffs\":4,\"w\":13,\"h\":23},{\"c\":48,\"x0\":459,\"y0\":230,\"yoffs\":5,\"xpad\":0.671875,\"w\":17,\"h\":22},{\"c\":49,\"x0\":402,\"y0\":270,\"yoffs\":5,\"xpad\":5.67188,\"w\":12,\"h\":21},{\"c\":50,\"x0\":431,\"y0\":270,\"yoffs\":5,\"xpad\":1.67188,\"w\":16,\"h\":21},{\"c\":51,\"x0\":493,\"y0\":230,\"yoffs\":5,\"xpad\":1.67188,\"w\":16,\"h\":22},{\"c\":52,\"x0\":464,\"y0\":270,\"yoffs\":5,\"xpad\":0.671875,\"w\":17,\"h\":21},{\"c\":53,\"x0\":526,\"y0\":230,\"yoffs\":5,\"xpad\":1.67188,\"w\":16,\"h\":22},{\"c\":54,\"x0\":559,\"y0\":230,\"yoffs\":5,\"xpad\":0.671875,\"w\":17,\"h\":22},{\"c\":55,\"x0\":498,\"y0\":270,\"yoffs\":5,\"xpad\":1.67188,\"w\":16,\"h\":21},{\"c\":56,\"x0\":593,\"y0\":230,\"yoffs\":5,\"xpad\":0.671875,\"w\":17,\"h\":22},{\"c\":57,\"x0\":627,\"y0\":230,\"yoffs\":5,\"xpad\":0.671875,\"w\":17,\"h\":22},{\"c\":58,\"x0\":401,\"y0\":347,\"yoffs\":12,\"w\":5,\"h\":14},{\"c\":59,\"x0\":651,\"y0\":309,\"yoffs\":12,\"w\":5,\"h\":18},{\"c\":60,\"x0\":867,\"y0\":103,\"yoffs\":4,\"w\":12,\"h\":25},{\"c\":61,\"x0\":847,\"y0\":347,\"yoffs\":14,\"w\":15,\"h\":9},{\"c\":62,\"x0\":896,\"y0\":103,\"yoffs\":4,\"w\":12,\"h\":25},{\"c\":63,\"x0\":661,\"y0\":230,\"yoffs\":4,\"xpad\":0.195313,\"w\":12,\"h\":22},{\"c\":64,\"x0\":87,\"y0\":190,\"yoffs\":7,\"xpad\":1.21094,\"w\":23,\"h\":23},{\"c\":65,\"x0\":531,\"y0\":270,\"yoffs\":5,\"w\":19,\"h\":21},{\"c\":66,\"x0\":567,\"y0\":270,\"yoffs\":5,\"xpad\":0.882813,\"w\":18,\"h\":21},{\"c\":67,\"x0\":690,\"y0\":230,\"yoffs\":5,\"xpad\":0.945313,\"w\":17,\"h\":22},{\"c\":68,\"x0\":602,\"y0\":270,\"yoffs\":5,\"xpad\":1.01563,\"w\":20,\"h\":21},{\"c\":69,\"x0\":639,\"y0\":270,\"yoffs\":5,\"xpad\":0.617188,\"w\":16,\"h\":21},{\"c\":70,\"x0\":672,\"y0\":270,\"yoffs\":5,\"w\":15,\"h\":21},{\"c\":71,\"x0\":724,\"y0\":230,\"yoffs\":5,\"xpad\":1.75,\"w\":18,\"h\":22},{\"c\":72,\"x0\":704,\"y0\":270,\"yoffs\":5,\"xpad\":2.53906,\"w\":18,\"h\":21},{\"c\":73,\"x0\":739,\"y0\":270,\"yoffs\":5,\"xpad\":2.54688,\"w\":6,\"h\":21},{\"c\":74,\"x0\":759,\"y0\":230,\"yoffs\":5,\"xpad\":2.75781,\"w\":6,\"h\":22},{\"c\":75,\"x0\":762,\"y0\":270,\"yoffs\":5,\"w\":19,\"h\":21},{\"c\":76,\"x0\":798,\"y0\":270,\"yoffs\":5,\"w\":16,\"h\":21},{\"c\":77,\"x0\":831,\"y0\":270,\"yoffs\":5,\"xpad\":2.27344,\"w\":21,\"h\":21},{\"c\":78,\"x0\":869,\"y0\":270,\"yoffs\":5,\"xpad\":2.74219,\"w\":19,\"h\":21},{\"c\":79,\"x0\":127,\"y0\":190,\"yoffs\":4,\"xpad\":1.22656,\"w\":21,\"h\":23},{\"c\":80,\"x0\":905,\"y0\":270,\"yoffs\":5,\"xpad\":0.828125,\"w\":17,\"h\":21},{\"c\":81,\"x0\":165,\"y0\":190,\"yoffs\":4,\"xpad\":1.22656,\"w\":21,\"h\":23},{\"c\":82,\"x0\":939,\"y0\":270,\"yoffs\":5,\"w\":19,\"h\":21},{\"c\":83,\"x0\":203,\"y0\":190,\"yoffs\":4,\"xpad\":1.32031,\"w\":15,\"h\":23},{\"c\":84,\"x0\":975,\"y0\":270,\"yoffs\":5,\"w\":17,\"h\":21},{\"c\":85,\"x0\":782,\"y0\":230,\"yoffs\":5,\"xpad\":2.04688,\"w\":19,\"h\":22},{\"c\":86,\"x0\":8,\"y0\":309,\"yoffs\":5,\"w\":19,\"h\":21},{\"c\":87,\"x0\":44,\"y0\":309,\"yoffs\":5,\"w\":30,\"h\":21},{\"c\":88,\"x0\":818,\"y0\":230,\"yoffs\":5,\"w\":20,\"h\":22},{\"c\":89,\"x0\":91,\"y0\":309,\"yoffs\":5,\"w\":18,\"h\":21},{\"c\":90,\"x0\":126,\"y0\":309,\"yoffs\":5,\"xpad\":0.226563,\"w\":17,\"h\":21},{\"c\":91,\"x0\":925,\"y0\":103,\"yoffs\":4,\"w\":9,\"h\":25},{\"c\":92,\"x0\":235,\"y0\":190,\"yoffs\":4,\"w\":13,\"h\":23},{\"c\":93,\"x0\":951,\"y0\":103,\"yoffs\":4,\"xpad\":1.70313,\"w\":7,\"h\":25},{\"c\":94,\"x0\":950,\"y0\":347,\"yoffs\":14,\"xpad\":0.1875,\"w\":13,\"h\":8},{\"c\":95,\"x0\":278,\"y0\":381,\"yoffs\":23,\"xpad\":0.4375,\"w\":12,\"h\":3},{\"c\":96,\"x0\":57,\"y0\":381,\"yoffs\":3,\"w\":6,\"h\":6},{\"c\":97,\"x0\":738,\"y0\":309,\"yoffs\":10,\"xpad\":1.29688,\"w\":14,\"h\":17},{\"c\":98,\"x0\":265,\"y0\":190,\"yoffs\":4,\"xpad\":0.890625,\"w\":16,\"h\":23},{\"c\":99,\"x0\":769,\"y0\":309,\"yoffs\":10,\"xpad\":0.273438,\"w\":14,\"h\":17},{\"c\":100,\"x0\":298,\"y0\":190,\"yoffs\":4,\"xpad\":2.07031,\"w\":15,\"h\":23},{\"c\":101,\"x0\":800,\"y0\":309,\"yoffs\":10,\"xpad\":1.04688,\"w\":15,\"h\":17},{\"c\":102,\"x0\":855,\"y0\":230,\"yoffs\":4,\"w\":10,\"h\":22},{\"c\":103,\"x0\":330,\"y0\":190,\"yoffs\":10,\"xpad\":2.07031,\"w\":15,\"h\":23},{\"c\":104,\"x0\":882,\"y0\":230,\"yoffs\":4,\"xpad\":1.10156,\"w\":16,\"h\":22},{\"c\":105,\"x0\":160,\"y0\":309,\"yoffs\":5,\"xpad\":1.34375,\"w\":6,\"h\":21},{\"c\":106,\"x0\":78,\"y0\":57,\"yoffs\":5,\"xpad\":1.07031,\"w\":7,\"h\":28},{\"c\":107,\"x0\":915,\"y0\":230,\"yoffs\":4,\"xpad\":0.171875,\"w\":15,\"h\":22},{\"c\":108,\"x0\":947,\"y0\":230,\"yoffs\":4,\"xpad\":1.46875,\"w\":6,\"h\":22},{\"c\":109,\"x0\":50,\"y0\":347,\"yoffs\":10,\"xpad\":1.14063,\"w\":25,\"h\":16},{\"c\":110,\"x0\":92,\"y0\":347,\"yoffs\":10,\"xpad\":2.03906,\"w\":15,\"h\":16},{\"c\":111,\"x0\":832,\"y0\":309,\"yoffs\":10,\"xpad\":0.828125,\"w\":16,\"h\":17},{\"c\":112,\"x0\":362,\"y0\":190,\"yoffs\":10,\"xpad\":0.890625,\"w\":16,\"h\":23},{\"c\":113,\"x0\":395,\"y0\":190,\"yoffs\":10,\"xpad\":2.07031,\"w\":15,\"h\":23},{\"c\":114,\"x0\":184,\"y0\":347,\"yoffs\":11,\"xpad\":0.203125,\"w\":10,\"h\":15},{\"c\":115,\"x0\":865,\"y0\":309,\"yoffs\":10,\"xpad\":0.28125,\"w\":13,\"h\":17},{\"c\":116,\"x0\":587,\"y0\":309,\"yoffs\":7,\"xpad\":0.234375,\"w\":10,\"h\":20},{\"c\":117,\"x0\":124,\"y0\":347,\"yoffs\":11,\"xpad\":1.64844,\"w\":15,\"h\":16},{\"c\":118,\"x0\":211,\"y0\":347,\"yoffs\":11,\"w\":15,\"h\":15},{\"c\":119,\"x0\":243,\"y0\":347,\"yoffs\":11,\"w\":23,\"h\":15},{\"c\":120,\"x0\":283,\"y0\":347,\"yoffs\":11,\"w\":16,\"h\":15},{\"c\":121,\"x0\":970,\"y0\":230,\"yoffs\":11,\"w\":15,\"h\":22},{\"c\":122,\"x0\":316,\"y0\":347,\"yoffs\":11,\"xpad\":0.851563,\"w\":13,\"h\":15},{\"c\":123,\"x0\":1002,\"y0\":230,\"yoffs\":6,\"w\":9,\"h\":22},{\"c\":124,\"x0\":8,\"y0\":8,\"w\":7,\"h\":32},{\"c\":125,\"x0\":8,\"y0\":270,\"yoffs\":6,\"xpad\":0.460938,\"w\":8,\"h\":22},{\"c\":126,\"x0\":127,\"y0\":381,\"yoffs\":16,\"xpad\":0.3125,\"w\":12,\"h\":5},{\"c\":144,\"x0\":980,\"y0\":347,\"yoffs\":-5,\"w\":14,\"h\":8},{\"c\":160,\"x0\":343,\"y0\":381,\"xpad\":6.10156,\"w\":1,\"h\":1},{\"c\":161,\"x0\":33,\"y0\":270,\"yoffs\":4,\"xpad\":1.13281,\"w\":6,\"h\":22},{\"c\":162,\"x0\":427,\"y0\":190,\"yoffs\":7,\"xpad\":0.273438,\"w\":14,\"h\":23},{\"c\":163,\"x0\":183,\"y0\":309,\"yoffs\":5,\"xpad\":0.304688,\"w\":14,\"h\":21},{\"c\":164,\"x0\":614,\"y0\":309,\"yoffs\":9,\"xpad\":0.328125,\"w\":20,\"h\":20},{\"c\":165,\"x0\":214,\"y0\":309,\"yoffs\":5,\"w\":18,\"h\":21},{\"c\":166,\"x0\":458,\"y0\":190,\"yoffs\":4,\"xpad\":2.10156,\"w\":6,\"h\":23},{\"c\":167,\"x0\":102,\"y0\":57,\"yoffs\":2,\"xpad\":1.25,\"w\":17,\"h\":28},{\"c\":168,\"x0\":178,\"y0\":381,\"yoffs\":4,\"xpad\":0.453125,\"w\":9,\"h\":4},{\"c\":169,\"x0\":481,\"y0\":190,\"yoffs\":4,\"xpad\":0.625,\"w\":25,\"h\":23},{\"c\":170,\"x0\":551,\"y0\":347,\"yoffs\":4,\"xpad\":0.296875,\"w\":10,\"h\":12},{\"c\":171,\"x0\":673,\"y0\":347,\"yoffs\":13,\"xpad\":0.140625,\"w\":11,\"h\":11},{\"c\":172,\"x0\":729,\"y0\":347,\"yoffs\":13,\"xpad\":0.382813,\"w\":15,\"h\":10},{\"c\":173,\"x0\":361,\"y0\":381,\"xpad\":2.94531,\"w\":1,\"h\":1},{\"c\":174,\"x0\":249,\"y0\":309,\"yoffs\":1,\"xpad\":0.3125,\"w\":22,\"h\":21},{\"c\":175,\"x0\":204,\"y0\":381,\"yoffs\":4,\"w\":9,\"h\":4},{\"c\":176,\"x0\":32,\"y0\":381,\"yoffs\":4,\"w\":8,\"h\":7},{\"c\":177,\"x0\":895,\"y0\":309,\"yoffs\":9,\"w\":14,\"h\":17},{\"c\":178,\"x0\":423,\"y0\":347,\"yoffs\":2,\"xpad\":0.890625,\"w\":11,\"h\":14},{\"c\":179,\"x0\":156,\"y0\":347,\"yoffs\":2,\"xpad\":1.52344,\"w\":11,\"h\":16},{\"c\":180,\"x0\":80,\"y0\":381,\"yoffs\":3,\"w\":6,\"h\":6},{\"c\":181,\"x0\":56,\"y0\":270,\"yoffs\":11,\"xpad\":1.85938,\"w\":15,\"h\":22},{\"c\":182,\"x0\":288,\"y0\":309,\"yoffs\":5,\"xpad\":0.5,\"w\":26,\"h\":21},{\"c\":183,\"x0\":230,\"y0\":381,\"yoffs\":16,\"w\":5,\"h\":4},{\"c\":184,\"x0\":8,\"y0\":381,\"yoffs\":25,\"xpad\":0.0703125,\"w\":7,\"h\":8},{\"c\":185,\"x0\":451,\"y0\":347,\"yoffs\":2,\"xpad\":0.6875,\"w\":10,\"h\":14},{\"c\":186,\"x0\":578,\"y0\":347,\"yoffs\":4,\"xpad\":0.625,\"w\":11,\"h\":12},{\"c\":187,\"x0\":701,\"y0\":347,\"yoffs\":13,\"xpad\":0.140625,\"w\":11,\"h\":11},{\"c\":188,\"x0\":247,\"y0\":8,\"yoffs\":2,\"xpad\":0.0546875,\"w\":25,\"h\":29},{\"c\":189,\"x0\":136,\"y0\":57,\"yoffs\":2,\"xpad\":1.22656,\"w\":25,\"h\":28},{\"c\":190,\"x0\":289,\"y0\":8,\"yoffs\":2,\"xpad\":0.109375,\"w\":26,\"h\":29},{\"c\":191,\"x0\":88,\"y0\":270,\"yoffs\":6,\"xpad\":0.09375,\"w\":13,\"h\":22},{\"c\":192,\"x0\":178,\"y0\":57,\"yoffs\":-2,\"w\":19,\"h\":28},{\"c\":193,\"x0\":214,\"y0\":57,\"yoffs\":-2,\"w\":19,\"h\":28},{\"c\":194,\"x0\":250,\"y0\":57,\"yoffs\":-2,\"w\":19,\"h\":28},{\"c\":195,\"x0\":648,\"y0\":103,\"w\":19,\"h\":26},{\"c\":196,\"x0\":252,\"y0\":103,\"yoffs\":-1,\"w\":19,\"h\":27},{\"c\":197,\"x0\":286,\"y0\":57,\"yoffs\":-2,\"w\":19,\"h\":28},{\"c\":198,\"x0\":331,\"y0\":309,\"yoffs\":5,\"xpad\":0.28125,\"w\":27,\"h\":21},{\"c\":199,\"x0\":322,\"y0\":57,\"yoffs\":5,\"xpad\":0.945313,\"w\":17,\"h\":28},{\"c\":200,\"x0\":356,\"y0\":57,\"yoffs\":-2,\"xpad\":0.617188,\"w\":16,\"h\":28},{\"c\":201,\"x0\":389,\"y0\":57,\"yoffs\":-2,\"xpad\":0.617188,\"w\":16,\"h\":28},{\"c\":202,\"x0\":422,\"y0\":57,\"yoffs\":-2,\"xpad\":0.617188,\"w\":16,\"h\":28},{\"c\":203,\"x0\":288,\"y0\":103,\"yoffs\":-1,\"xpad\":0.617188,\"w\":16,\"h\":27},{\"c\":204,\"x0\":455,\"y0\":57,\"yoffs\":-2,\"xpad\":1.54688,\"w\":7,\"h\":28},{\"c\":205,\"x0\":479,\"y0\":57,\"yoffs\":-2,\"xpad\":0.546875,\"w\":8,\"h\":28},{\"c\":206,\"x0\":504,\"y0\":57,\"yoffs\":-2,\"w\":11,\"h\":28},{\"c\":207,\"x0\":321,\"y0\":103,\"yoffs\":-1,\"w\":9,\"h\":27},{\"c\":208,\"x0\":375,\"y0\":309,\"yoffs\":5,\"xpad\":1.22656,\"w\":20,\"h\":21},{\"c\":209,\"x0\":684,\"y0\":103,\"xpad\":2.74219,\"w\":19,\"h\":26},{\"c\":210,\"x0\":332,\"y0\":8,\"yoffs\":-2,\"xpad\":1.22656,\"w\":21,\"h\":29},{\"c\":211,\"x0\":370,\"y0\":8,\"yoffs\":-2,\"xpad\":1.22656,\"w\":21,\"h\":29},{\"c\":212,\"x0\":408,\"y0\":8,\"yoffs\":-2,\"xpad\":1.22656,\"w\":21,\"h\":29},{\"c\":213,\"x0\":347,\"y0\":103,\"xpad\":1.22656,\"w\":21,\"h\":27},{\"c\":214,\"x0\":532,\"y0\":57,\"yoffs\":-1,\"xpad\":1.22656,\"w\":21,\"h\":28},{\"c\":215,\"x0\":346,\"y0\":347,\"yoffs\":11,\"xpad\":0.359375,\"w\":15,\"h\":15},{\"c\":216,\"x0\":523,\"y0\":190,\"yoffs\":4,\"xpad\":1.22656,\"w\":21,\"h\":23},{\"c\":217,\"x0\":446,\"y0\":8,\"yoffs\":-2,\"xpad\":2.04688,\"w\":19,\"h\":29},{\"c\":218,\"x0\":482,\"y0\":8,\"yoffs\":-2,\"xpad\":2.04688,\"w\":19,\"h\":29},{\"c\":219,\"x0\":518,\"y0\":8,\"yoffs\":-2,\"xpad\":2.04688,\"w\":19,\"h\":29},{\"c\":220,\"x0\":570,\"y0\":57,\"yoffs\":-1,\"xpad\":2.04688,\"w\":19,\"h\":28},{\"c\":221,\"x0\":606,\"y0\":57,\"yoffs\":-2,\"w\":18,\"h\":28},{\"c\":222,\"x0\":412,\"y0\":309,\"yoffs\":5,\"xpad\":1.00781,\"w\":17,\"h\":21},{\"c\":223,\"x0\":446,\"y0\":309,\"yoffs\":5,\"xpad\":1.30469,\"w\":17,\"h\":21},{\"c\":224,\"x0\":69,\"y0\":148,\"yoffs\":3,\"xpad\":1.29688,\"w\":14,\"h\":24},{\"c\":225,\"x0\":100,\"y0\":148,\"yoffs\":3,\"xpad\":1.29688,\"w\":14,\"h\":24},{\"c\":226,\"x0\":131,\"y0\":148,\"yoffs\":3,\"xpad\":1.29688,\"w\":14,\"h\":24},{\"c\":227,\"x0\":561,\"y0\":190,\"yoffs\":4,\"xpad\":1.29688,\"w\":14,\"h\":23},{\"c\":228,\"x0\":592,\"y0\":190,\"yoffs\":4,\"xpad\":1.29688,\"w\":14,\"h\":23},{\"c\":229,\"x0\":975,\"y0\":103,\"yoffs\":2,\"xpad\":1.29688,\"w\":14,\"h\":25},{\"c\":230,\"x0\":926,\"y0\":309,\"yoffs\":10,\"xpad\":0.960938,\"w\":24,\"h\":17},{\"c\":231,\"x0\":623,\"y0\":190,\"yoffs\":10,\"xpad\":0.273438,\"w\":14,\"h\":23},{\"c\":232,\"x0\":162,\"y0\":148,\"yoffs\":3,\"xpad\":1.04688,\"w\":15,\"h\":24},{\"c\":233,\"x0\":194,\"y0\":148,\"yoffs\":3,\"xpad\":1.04688,\"w\":15,\"h\":24},{\"c\":234,\"x0\":226,\"y0\":148,\"yoffs\":3,\"xpad\":1.04688,\"w\":15,\"h\":24},{\"c\":235,\"x0\":654,\"y0\":190,\"yoffs\":4,\"xpad\":1.04688,\"w\":15,\"h\":23},{\"c\":236,\"x0\":686,\"y0\":190,\"yoffs\":3,\"xpad\":1.34375,\"w\":6,\"h\":23},{\"c\":237,\"x0\":709,\"y0\":190,\"yoffs\":3,\"w\":8,\"h\":23},{\"c\":238,\"x0\":734,\"y0\":190,\"yoffs\":3,\"w\":11,\"h\":23},{\"c\":239,\"x0\":118,\"y0\":270,\"yoffs\":4,\"w\":9,\"h\":22},{\"c\":240,\"x0\":762,\"y0\":190,\"yoffs\":4,\"xpad\":1.53125,\"w\":15,\"h\":23},{\"c\":241,\"x0\":144,\"y0\":270,\"yoffs\":4,\"xpad\":2.03906,\"w\":15,\"h\":22},{\"c\":242,\"x0\":258,\"y0\":148,\"yoffs\":3,\"xpad\":0.828125,\"w\":16,\"h\":24},{\"c\":243,\"x0\":291,\"y0\":148,\"yoffs\":3,\"xpad\":0.828125,\"w\":16,\"h\":24},{\"c\":244,\"x0\":324,\"y0\":148,\"yoffs\":3,\"xpad\":0.828125,\"w\":16,\"h\":24},{\"c\":245,\"x0\":794,\"y0\":190,\"yoffs\":4,\"xpad\":0.828125,\"w\":16,\"h\":23},{\"c\":246,\"x0\":827,\"y0\":190,\"yoffs\":4,\"xpad\":0.828125,\"w\":16,\"h\":23},{\"c\":247,\"x0\":478,\"y0\":347,\"yoffs\":11,\"xpad\":0.453125,\"w\":14,\"h\":14},{\"c\":248,\"x0\":967,\"y0\":309,\"yoffs\":10,\"xpad\":0.828125,\"w\":16,\"h\":17},{\"c\":249,\"x0\":357,\"y0\":148,\"yoffs\":3,\"xpad\":1.64844,\"w\":15,\"h\":24},{\"c\":250,\"x0\":389,\"y0\":148,\"yoffs\":3,\"xpad\":1.64844,\"w\":15,\"h\":24},{\"c\":251,\"x0\":421,\"y0\":148,\"yoffs\":3,\"xpad\":1.64844,\"w\":15,\"h\":24},{\"c\":252,\"x0\":860,\"y0\":190,\"yoffs\":4,\"xpad\":1.64844,\"w\":15,\"h\":23},{\"c\":253,\"x0\":64,\"y0\":8,\"yoffs\":3,\"w\":15,\"h\":30},{\"c\":254,\"x0\":554,\"y0\":8,\"yoffs\":4,\"xpad\":0.890625,\"w\":16,\"h\":29},{\"c\":255,\"x0\":587,\"y0\":8,\"yoffs\":4,\"w\":15,\"h\":29},{\"c\":256,\"x0\":720,\"y0\":103,\"w\":19,\"h\":26},{\"c\":257,\"x0\":892,\"y0\":190,\"yoffs\":4,\"xpad\":1.29688,\"w\":14,\"h\":23},{\"c\":258,\"x0\":385,\"y0\":103,\"yoffs\":-1,\"w\":19,\"h\":27},{\"c\":259,\"x0\":453,\"y0\":148,\"yoffs\":3,\"xpad\":1.29688,\"w\":14,\"h\":24},{\"c\":260,\"x0\":641,\"y0\":57,\"yoffs\":5,\"w\":21,\"h\":28},{\"c\":261,\"x0\":923,\"y0\":190,\"yoffs\":10,\"w\":16,\"h\":23},{\"c\":262,\"x0\":619,\"y0\":8,\"yoffs\":-2,\"xpad\":0.945313,\"w\":17,\"h\":29},{\"c\":263,\"x0\":484,\"y0\":148,\"yoffs\":3,\"xpad\":0.273438,\"w\":14,\"h\":24},{\"c\":268,\"x0\":653,\"y0\":8,\"yoffs\":-2,\"xpad\":0.945313,\"w\":17,\"h\":29},{\"c\":269,\"x0\":515,\"y0\":148,\"yoffs\":3,\"xpad\":0.273438,\"w\":14,\"h\":24},{\"c\":270,\"x0\":679,\"y0\":57,\"yoffs\":-2,\"xpad\":1.01563,\"w\":20,\"h\":28},{\"c\":271,\"x0\":956,\"y0\":190,\"yoffs\":4,\"w\":22,\"h\":23},{\"c\":272,\"x0\":480,\"y0\":309,\"yoffs\":5,\"xpad\":1.22656,\"w\":20,\"h\":21},{\"c\":273,\"x0\":995,\"y0\":190,\"yoffs\":4,\"xpad\":0.0703125,\"w\":17,\"h\":23},{\"c\":274,\"x0\":756,\"y0\":103,\"xpad\":0.617188,\"w\":16,\"h\":26},{\"c\":275,\"x0\":8,\"y0\":230,\"yoffs\":4,\"xpad\":1.04688,\"w\":15,\"h\":23},{\"c\":278,\"x0\":421,\"y0\":103,\"yoffs\":-1,\"xpad\":0.617188,\"w\":16,\"h\":27},{\"c\":279,\"x0\":40,\"y0\":230,\"yoffs\":4,\"xpad\":1.04688,\"w\":15,\"h\":23},{\"c\":280,\"x0\":716,\"y0\":57,\"yoffs\":5,\"xpad\":0.617188,\"w\":16,\"h\":28},{\"c\":281,\"x0\":72,\"y0\":230,\"yoffs\":10,\"xpad\":1.04688,\"w\":15,\"h\":23},{\"c\":282,\"x0\":749,\"y0\":57,\"yoffs\":-2,\"xpad\":0.617188,\"w\":16,\"h\":28},{\"c\":283,\"x0\":546,\"y0\":148,\"yoffs\":3,\"xpad\":1.04688,\"w\":15,\"h\":24},{\"c\":286,\"x0\":782,\"y0\":57,\"yoffs\":-1,\"xpad\":1.75,\"w\":18,\"h\":28},{\"c\":287,\"x0\":96,\"y0\":8,\"yoffs\":3,\"xpad\":2.07031,\"w\":15,\"h\":30},{\"c\":290,\"x0\":817,\"y0\":57,\"yoffs\":5,\"xpad\":1.75,\"w\":18,\"h\":28},{\"c\":291,\"x0\":32,\"y0\":8,\"yoffs\":2,\"xpad\":2.07031,\"w\":15,\"h\":31},{\"c\":298,\"x0\":789,\"y0\":103,\"w\":9,\"h\":26},{\"c\":299,\"x0\":176,\"y0\":270,\"yoffs\":4,\"w\":9,\"h\":22},{\"c\":302,\"x0\":852,\"y0\":57,\"yoffs\":5,\"xpad\":0.546875,\"w\":8,\"h\":28},{\"c\":303,\"x0\":877,\"y0\":57,\"yoffs\":5,\"w\":8,\"h\":28},{\"c\":304,\"x0\":454,\"y0\":103,\"yoffs\":-1,\"xpad\":1.54688,\"w\":7,\"h\":27},{\"c\":305,\"x0\":378,\"y0\":347,\"yoffs\":11,\"xpad\":1.34375,\"w\":6,\"h\":15},{\"c\":310,\"x0\":687,\"y0\":8,\"yoffs\":5,\"w\":19,\"h\":29},{\"c\":311,\"x0\":128,\"y0\":8,\"yoffs\":4,\"xpad\":0.171875,\"w\":15,\"h\":30},{\"c\":313,\"x0\":902,\"y0\":57,\"yoffs\":-2,\"w\":16,\"h\":28},{\"c\":314,\"x0\":815,\"y0\":103,\"w\":8,\"h\":26},{\"c\":315,\"x0\":723,\"y0\":8,\"yoffs\":5,\"w\":16,\"h\":29},{\"c\":316,\"x0\":160,\"y0\":8,\"yoffs\":4,\"xpad\":1.46875,\"w\":6,\"h\":30},{\"c\":317,\"x0\":202,\"y0\":270,\"yoffs\":4,\"w\":16,\"h\":22},{\"c\":318,\"x0\":235,\"y0\":270,\"yoffs\":4,\"w\":12,\"h\":22},{\"c\":321,\"x0\":517,\"y0\":309,\"yoffs\":5,\"xpad\":0.046875,\"w\":16,\"h\":21},{\"c\":322,\"x0\":264,\"y0\":270,\"yoffs\":4,\"w\":11,\"h\":22},{\"c\":323,\"x0\":935,\"y0\":57,\"yoffs\":-2,\"xpad\":2.74219,\"w\":19,\"h\":28},{\"c\":324,\"x0\":104,\"y0\":230,\"yoffs\":3,\"xpad\":2.03906,\"w\":15,\"h\":23},{\"c\":325,\"x0\":756,\"y0\":8,\"yoffs\":5,\"xpad\":2.74219,\"w\":19,\"h\":29},{\"c\":326,\"x0\":578,\"y0\":148,\"yoffs\":10,\"xpad\":2.03906,\"w\":15,\"h\":24},{\"c\":327,\"x0\":971,\"y0\":57,\"yoffs\":-2,\"xpad\":2.74219,\"w\":19,\"h\":28},{\"c\":328,\"x0\":136,\"y0\":230,\"yoffs\":3,\"xpad\":2.03906,\"w\":15,\"h\":23},{\"c\":332,\"x0\":478,\"y0\":103,\"xpad\":1.22656,\"w\":21,\"h\":27},{\"c\":333,\"x0\":168,\"y0\":230,\"yoffs\":4,\"xpad\":0.828125,\"w\":16,\"h\":23},{\"c\":336,\"x0\":792,\"y0\":8,\"yoffs\":-2,\"xpad\":1.22656,\"w\":21,\"h\":29},{\"c\":337,\"x0\":610,\"y0\":148,\"yoffs\":3,\"xpad\":0.828125,\"w\":16,\"h\":24},{\"c\":338,\"x0\":292,\"y0\":270,\"yoffs\":5,\"xpad\":0.390625,\"w\":29,\"h\":22},{\"c\":339,\"x0\":8,\"y0\":347,\"yoffs\":10,\"xpad\":0.65625,\"w\":25,\"h\":17},{\"c\":340,\"x0\":8,\"y0\":103,\"yoffs\":-2,\"w\":19,\"h\":28},{\"c\":341,\"x0\":201,\"y0\":230,\"yoffs\":3,\"xpad\":0.203125,\"w\":10,\"h\":23},{\"c\":342,\"x0\":830,\"y0\":8,\"yoffs\":5,\"w\":19,\"h\":29},{\"c\":343,\"x0\":228,\"y0\":230,\"yoffs\":11,\"xpad\":0.203125,\"w\":10,\"h\":23},{\"c\":344,\"x0\":44,\"y0\":103,\"yoffs\":-2,\"w\":19,\"h\":28},{\"c\":345,\"x0\":255,\"y0\":230,\"yoffs\":3,\"xpad\":0.203125,\"w\":10,\"h\":23},{\"c\":346,\"x0\":866,\"y0\":8,\"yoffs\":-2,\"xpad\":1.32031,\"w\":15,\"h\":29},{\"c\":347,\"x0\":643,\"y0\":148,\"yoffs\":3,\"xpad\":0.28125,\"w\":13,\"h\":24},{\"c\":350,\"x0\":898,\"y0\":8,\"yoffs\":4,\"xpad\":1.32031,\"w\":15,\"h\":29},{\"c\":351,\"x0\":282,\"y0\":230,\"yoffs\":10,\"xpad\":0.28125,\"w\":13,\"h\":23},{\"c\":352,\"x0\":930,\"y0\":8,\"yoffs\":-2,\"xpad\":1.32031,\"w\":15,\"h\":29},{\"c\":353,\"x0\":673,\"y0\":148,\"yoffs\":3,\"xpad\":0.28125,\"w\":13,\"h\":24},{\"c\":354,\"x0\":80,\"y0\":103,\"yoffs\":5,\"w\":17,\"h\":28},{\"c\":355,\"x0\":840,\"y0\":103,\"yoffs\":7,\"xpad\":0.234375,\"w\":10,\"h\":26},{\"c\":356,\"x0\":114,\"y0\":103,\"yoffs\":-2,\"w\":17,\"h\":28},{\"c\":357,\"x0\":312,\"y0\":230,\"yoffs\":4,\"w\":15,\"h\":23},{\"c\":362,\"x0\":516,\"y0\":103,\"xpad\":2.04688,\"w\":19,\"h\":27},{\"c\":363,\"x0\":344,\"y0\":230,\"yoffs\":4,\"xpad\":1.64844,\"w\":15,\"h\":23},{\"c\":366,\"x0\":962,\"y0\":8,\"yoffs\":-2,\"xpad\":2.04688,\"w\":19,\"h\":29},{\"c\":367,\"x0\":8,\"y0\":148,\"yoffs\":2,\"xpad\":1.64844,\"w\":15,\"h\":25},{\"c\":368,\"x0\":8,\"y0\":57,\"yoffs\":-2,\"xpad\":2.04688,\"w\":19,\"h\":29},{\"c\":369,\"x0\":703,\"y0\":148,\"yoffs\":3,\"xpad\":1.64844,\"w\":15,\"h\":24},{\"c\":370,\"x0\":148,\"y0\":103,\"yoffs\":5,\"xpad\":2.04688,\"w\":19,\"h\":28},{\"c\":371,\"x0\":338,\"y0\":270,\"yoffs\":11,\"w\":17,\"h\":22},{\"c\":376,\"x0\":552,\"y0\":103,\"yoffs\":-1,\"w\":18,\"h\":27},{\"c\":377,\"x0\":184,\"y0\":103,\"yoffs\":-2,\"xpad\":0.226563,\"w\":17,\"h\":28},{\"c\":378,\"x0\":376,\"y0\":230,\"yoffs\":3,\"xpad\":0.851563,\"w\":13,\"h\":23},{\"c\":379,\"x0\":587,\"y0\":103,\"yoffs\":-1,\"xpad\":0.226563,\"w\":17,\"h\":27},{\"c\":380,\"x0\":372,\"y0\":270,\"yoffs\":4,\"xpad\":0.851563,\"w\":13,\"h\":22},{\"c\":381,\"x0\":218,\"y0\":103,\"yoffs\":-2,\"xpad\":0.226563,\"w\":17,\"h\":28},{\"c\":382,\"x0\":406,\"y0\":230,\"yoffs\":3,\"xpad\":0.851563,\"w\":13,\"h\":23},{\"c\":402,\"x0\":40,\"y0\":148,\"yoffs\":4,\"w\":12,\"h\":25},{\"c\":536,\"x0\":183,\"y0\":8,\"yoffs\":4,\"xpad\":1.32031,\"w\":15,\"h\":30},{\"c\":537,\"x0\":735,\"y0\":148,\"yoffs\":10,\"xpad\":0.28125,\"w\":13,\"h\":24},{\"c\":538,\"x0\":44,\"y0\":57,\"yoffs\":5,\"w\":17,\"h\":29},{\"c\":539,\"x0\":621,\"y0\":103,\"yoffs\":7,\"xpad\":0.234375,\"w\":10,\"h\":27},{\"c\":8226,\"x0\":103,\"y0\":381,\"yoffs\":13,\"xpad\":0.28125,\"w\":7,\"h\":6},{\"c\":8482,\"x0\":606,\"y0\":347,\"yoffs\":5,\"xpad\":0.882813,\"w\":22,\"h\":12},{\"c\":8592,\"x0\":761,\"y0\":347,\"yoffs\":11,\"xpad\":0.882813,\"w\":26,\"h\":10},{\"c\":8593,\"x0\":765,\"y0\":148,\"yoffs\":4,\"xpad\":7.88281,\"w\":19,\"h\":24},{\"c\":8594,\"x0\":804,\"y0\":347,\"yoffs\":11,\"xpad\":0.882813,\"w\":26,\"h\":10},{\"c\":8595,\"x0\":801,\"y0\":148,\"yoffs\":4,\"xpad\":7.88281,\"w\":19,\"h\":24},{\"c\":8734,\"x0\":509,\"y0\":347,\"yoffs\":11,\"xpad\":0.6875,\"w\":25,\"h\":14},{\"c\":9742,\"x0\":837,\"y0\":148,\"yoffs\":4,\"w\":31,\"h\":24},{\"c\":9743,\"x0\":885,\"y0\":148,\"yoffs\":4,\"w\":31,\"h\":24},{\"c\":65533,\"x0\":550,\"y0\":309,\"yoffs\":5,\"w\":20,\"h\":21}]}","/*eslint global-require:off*/\nconst glov_local_storage = require('./glov/local_storage.js');\nglov_local_storage.storage_prefix = 'glovjs-playground'; // Before requiring anything else that might load from this\n\nconst engine = require('./glov/engine.js');\nconst net = require('./glov/net.js');\nconst ui = require('./glov/ui.js');\nconst { soundLoad, soundPlayMusic } = require('./glov/sound.js');\nconst soundscape = require('./glov/soundscape.js');\n\nwindow.Z = window.Z || {};\nZ.BACKGROUND = 1;\nZ.SPRITES = 10;\nZ.PARTICLES = 20;\nZ.UI_TEST = 200;\n\n// let app = exports;\n// Virtual viewport for our game logic\nexport const game_width = 320;\nexport const game_height = 240;\n\nexport let sprites = {};\n\nexport function main() {\n  if (engine.DEBUG) {\n    // Enable auto-reload, etc\n    net.init({ engine });\n  }\n\n  if (!engine.startup({\n    game_width,\n    game_height,\n    pixely: 'strict',\n    viewport_postprocess: false\n  })) {\n    return;\n  }\n\n  // const font = engine.font;\n\n  // Perfect sizes for pixely modes\n  ui.scaleSizes(13 / 32);\n  ui.setFontHeight(8);\n\n  let ss;\n  let intensity = 0.5;\n  function initGraphics() {\n    soundLoad('soundscape/milestone', { streaming: true });\n    soundLoad('soundscape/scenario', { streaming: true });\n    function genFiles(base, count) {\n      let ret = [];\n      for (let ii = 0; ii < count; ++ii) {\n        ret.push(`${base}${ii + 1}`);\n      }\n      return ret;\n    }\n    ss = soundscape.create({\n      base_path: 'soundscape/',\n      layers: {\n        bg: {\n          odds: [0, 3, 3, 1],\n          period: 30000,\n          period_noise: 10000,\n          min_intensity: 0,\n          add_delay: 2000,\n          files: genFiles('bg', 3),\n          tags: {\n            epic: {\n              priority: 1,\n              files: genFiles('bg-epic', 3)\n            },\n            night: {\n              priority: 0.5,\n              files: []\n            }\n          }\n        },\n        bass: {\n          max: 2,\n          period: 20000,\n          period_noise: 10000,\n          min_intensity: 0.2,\n          files: genFiles('bass', 3)\n        },\n        color: {\n          max: 1,\n          min_intensity: 0.4,\n          files: genFiles('color', 2)\n        },\n        fg: {\n          odds: [1, 2],\n          period: 20000,\n          period_noise: 10000,\n          min_intensity: 0.6,\n          files: genFiles('fg', 4)\n        }\n      }\n    });\n  }\n\n  function test(dt) {\n    let x = ui.button_height;\n    let button_spacing = ui.button_height + 2;\n    let y = game_height - 10 - button_spacing * 5;\n    let z = Z.UI;\n\n    intensity = ui.slider(intensity, {\n      x, y, z,\n      min: 0,\n      max: 1\n    });\n    ss.setIntensity(intensity);\n    ui.print(null, x + ui.button_width + 8, y, z, `${intensity.toFixed(2)}`);\n    y += ui.button_height;\n\n    if (ui.buttonText({ x, y, text: `Tag:epic = ${ss.getTag('epic') ? 'ON' : 'Off'}` })) {\n      ss.setTag('epic', !ss.getTag('epic'));\n    }\n    y += button_spacing;\n    if (ui.buttonText({ x, y, text: `Tag:night = ${ss.getTag('night') ? 'ON' : 'Off'}` })) {\n      ss.setTag('night', !ss.getTag('night'));\n    }\n    y += button_spacing;\n\n    if (ui.buttonText({ x, y, text: 'Play fanfare' })) {\n      soundPlayMusic(['soundscape/milestone', 'soundscape/scenario'][Math.floor(Math.random() * 2)]);\n    }\n    y += button_spacing;\n\n    x = game_width / 2;\n    y = 5;\n    let debug = ss.debug();\n    for (let ii = 0; ii < debug.length; ++ii) {\n      ui.print(null, x, y, z, debug[ii]);\n      y += ui.font_height;\n    }\n\n    ss.tick();\n  }\n\n  function testInit(dt) {\n    engine.setState(test);\n    test(dt);\n  }\n\n  initGraphics();\n  engine.setState(testInit);\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nfunction ok(exp, msg) {\n  if (exp) {\n    return;\n  }\n  throw new Error(`Assertion failed: ${msg ? msg : exp === undefined ? '' : JSON.stringify(exp)}`);\n}\nmodule.exports = ok;\nmodule.exports.ok = ok;\n\nfunction equal(a, b) {\n  if (a === b) {\n    return;\n  }\n  throw new Error(`Assertion failed: \"${a}\"===\"${b}\"`);\n}\nmodule.exports.equal = equal;\n","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nexport let Buffer = {};\nBuffer.isBuffer = function (b) {\n  return false;\n};\n","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\n// Dummy shim module that does not exist in worker bundles, to catch bat requires at bundle-time instead of run-time\n\nmodule.exports = true;\n","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint no-bitwise:off */\n\nconst assert = require('assert');\nconst { isPacket } = require('./packet.js');\n\nexport function ackInitReceiver(receiver) {\n  receiver.last_pak_id = 0;\n  receiver.resp_cbs = {};\n  receiver.responses_waiting = 0;\n}\n\nconst ACKFLAG_IS_RESP = 1 << 3;\nconst ACKFLAG_ERR = 1 << 4;\nconst ACKFLAG_DATA_JSON = 1 << 5;\n// `receiver` is really the sender, here, but will receive any response\nexport function ackWrapPakStart(pak, receiver, msg) {\n  let flags = 0;\n\n  pak.ack_data = {\n    receiver\n  };\n\n  if (typeof msg === 'number') {\n    flags |= ACKFLAG_IS_RESP;\n    pak.writeInt(msg);\n  } else {\n    pak.writeAnsiString(msg);\n  }\n  let resp_pak_id = receiver ? ++receiver.last_pak_id : 0;\n  pak.ack_data.resp_pak_id = resp_pak_id;\n  pak.ack_data.resp_pak_id_offs = pak.getOffset();\n  pak.writeInt(resp_pak_id);\n\n  pak.ack_data.data_offs = pak.getOffset();\n  pak.ack_data.flags = flags;\n}\n\nexport function ackWrapPakPayload(pak, data) {\n  if (isPacket(data)) {\n    pak.appendRemaining(data);\n  } else {\n    pak.ack_data.flags |= ACKFLAG_DATA_JSON;\n    pak.writeJSON(data);\n  }\n}\n\nexport function ackWrapPakFinish(pak, err, resp_func) {\n  let flags = pak.ack_data.flags;\n  let offs = pak.getOffset();\n  if (err) {\n    // Nothing else must have been written\n    assert.equal(pak.ack_data.data_offs, offs);\n    flags |= ACKFLAG_ERR;\n    pak.writeString(String(err));\n    offs = pak.getOffset();\n  }\n  pak.makeReadable();\n  let resp_pak_id = 0;\n  if (resp_func) {\n    resp_pak_id = pak.ack_data.resp_pak_id;\n    assert(resp_pak_id);\n    assert(pak.ack_data.receiver);\n    pak.ack_data.receiver.resp_cbs[resp_pak_id] = resp_func;\n  } else {\n    pak.seek(pak.ack_data.resp_pak_id_offs);\n    pak.zeroInt();\n    pak.seek(offs);\n  }\n  pak.updateFlags(flags);\n  delete pak.ack_data;\n  return resp_pak_id;\n}\n\nfunction ackReadHeader(pak) {\n  let flags = pak.getFlags();\n  let msg = flags & ACKFLAG_IS_RESP ? pak.readInt() : pak.readAnsiString();\n  let pak_id = pak.readInt();\n  let err = flags & ACKFLAG_ERR ? pak.readString() : undefined;\n  let data;\n  if (flags & ACKFLAG_DATA_JSON) {\n    data = pak.readJSON();\n  } else {\n    data = pak;\n  }\n  return {\n    msg,\n    err,\n    data,\n    pak_id\n  };\n}\n\nexport function failAll(receiver, err) {\n  err = err || 'ERR_DISCONNECTED';\n  let cbs = receiver.resp_cbs;\n  receiver.resp_cbs = {};\n  receiver.responses_waiting = 0;\n  for (let pak_id in cbs) {\n    cbs[pak_id](err);\n  }\n}\n\n// `source` is a string for debug/logging only\n// `receiver` needs initReceicver called on it, have .onError() in the prototype and optionally .log()\n// sendFunc(msg, err, data, resp_func)\n// handleFunc(msg, data, resp_func)\n// eslint-disable-next-line consistent-return\nexport function ackHandleMessage(receiver, source, net_data_or_pak, send_func, pak_func, handle_func) {\n  let net_data = isPacket(net_data_or_pak) ? ackReadHeader(net_data_or_pak) : net_data_or_pak;\n  let { err, data, msg, pak_id } = net_data;\n  let now = Date.now();\n  let expecting_response = Boolean(pak_id);\n  let timeout_id;\n  if (expecting_response) {\n    timeout_id = 'pending';\n  }\n  let sent_response = false;\n  let start_time = now;\n\n  function preSendResp() {\n    assert(!sent_response, 'Response function called twice');\n    sent_response = true;\n\n    if (expecting_response) {\n      if (timeout_id) {\n        if (timeout_id !== 'pending') {\n          clearTimeout(timeout_id);\n        }\n      } else {\n        (receiver.log ? receiver : console).log(`Response finally sent for ${msg} after ${((Date.now() - start_time) / 1000).toFixed(1)}s`);\n      }\n      receiver.responses_waiting--;\n    }\n  }\n\n  function respFunc(err, resp_data, resp_func) {\n    preSendResp();\n    // the callback wants to send a response, and possibly get a response from that!\n    if (!expecting_response) {\n      // But, the other end is not expecting a response from this packet, black-hole it\n      if (resp_func) {\n        // We better not be expecting a response to our response!\n        receiver.onError(`Sending a response to a packet (${msg}) that did not expect` + ' one, but we are expecting a response');\n        return;\n      }\n      // however, if there was an error, let's forward that along as an error message\n      if (err) {\n        send_func('error', null, err, null);\n      }\n      return;\n    }\n    send_func(pak_id, err, resp_data, resp_func);\n  }\n  respFunc.expecting_response = expecting_response;\n  respFunc.pak = function (ref_pak) {\n    assert(expecting_response);\n    let pak = pak_func(pak_id, ref_pak);\n    let orig_send = pak.send;\n    pak.send = function (err, resp_func) {\n      preSendResp();\n      orig_send.call(pak, err, resp_func);\n    };\n    return pak;\n  };\n\n  if (typeof msg === 'number') {\n    let cb = receiver.resp_cbs[msg];\n    if (!cb) {\n      return receiver.onError(`Received response to unknown packet with id ${msg} from ${source}`);\n    }\n    delete receiver.resp_cbs[msg];\n    cb(err, data, respFunc); // eslint-disable-line callback-return\n  } else {\n    if (!msg) {\n      return receiver.onError(`Received message with no .msg from ${source}`);\n    }\n    handle_func(msg, data, respFunc);\n  }\n  if (expecting_response) {\n    // Note, this may be -1 if respFunc has already been called\n    receiver.responses_waiting++;\n    if (!sent_response) {\n      // timeout warning for response\n      timeout_id = setTimeout(function () {\n        timeout_id = null;\n        (receiver.log ? receiver : console).log(`Response not sent for ${msg} from ${source} after ${((Date.now() - start_time) / 1000).toFixed(1)}s`);\n      }, 15 * 1000);\n    }\n  }\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint no-bitwise:off */\n/* globals atob */\n\n// Encoding is fastest with non-native calls: http://jsperf.com/base64-encode\n// Decoding is fastest using window.btoa: http://jsperf.com/base64-decode\n\nconst { floor } = Math;\n\nconst chr_table = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.split('');\nconst PAD = '=';\n\n// dv is a DataView with a .u8 property\nfunction encode(dv, offset, length) {\n  let data = dv.u8;\n  let result = '';\n  let i;\n  let effi;\n  // Convert every three bytes to 4 ascii characters.\n  for (i = 0; i < length - 2; i += 3) {\n    effi = offset + i;\n    result += chr_table[data[effi] >> 2];\n    result += chr_table[((data[effi] & 0x03) << 4) + (data[effi + 1] >> 4)];\n    result += chr_table[((data[effi + 1] & 0x0f) << 2) + (data[effi + 2] >> 6)];\n    result += chr_table[data[effi + 2] & 0x3f];\n  }\n\n  // Convert the remaining 1 or 2 bytes, pad out to 4 characters.\n  if (length % 3) {\n    i = length - length % 3;\n    effi = offset + i;\n    result += chr_table[data[effi] >> 2];\n    if (length % 3 === 2) {\n      result += chr_table[((data[effi] & 0x03) << 4) + (data[effi + 1] >> 4)];\n      result += chr_table[(data[effi + 1] & 0x0f) << 2];\n      result += PAD;\n    } else {\n      result += chr_table[(data[effi] & 0x03) << 4];\n      result += PAD + PAD;\n    }\n  }\n\n  return result;\n}\n\nfunction decodeNativeBrowser(data, allocator) {\n  let str = atob(data);\n  let len = str.length;\n  let dv = allocator(len);\n  let u8 = dv.u8;\n  for (let ii = 0; ii < len; ++ii) {\n    u8[ii] = str.charCodeAt(ii);\n  }\n  dv.decode_size = len;\n  return dv;\n}\n\nfunction encodeNativeNode(dv, offset, length) {\n  // Allocates a Buffer() object each time - could have our allocDataView do that if needed for perf\n  return Buffer.from(dv.buffer).toString('base64', offset, offset + length);\n}\n// Faster, but uses an internal function that might break:\n// function encodeNativeNode(dv, offset, length) {\n//   return Buffer.prototype.base64Slice.call(dv.u8, offset, offset + length);\n// }\n\nfunction decodeNativeNode(data, allocator) {\n  let buffer_len = (data.length >> 2) * 3 + floor(data.length % 4 / 1.5);\n  let dv = allocator(buffer_len);\n  let buffer = Buffer.from(dv.buffer);\n  dv.decode_size = buffer.write(data, 'base64');\n  return dv;\n}\n\nconst BROWSER = typeof window !== 'undefined';\n\n// string -> Uint8Array or Buffer\nexports.base64Decode = BROWSER ? decodeNativeBrowser : decodeNativeNode;\n// Uint8Array or Buffer -> string\nexports.base64Encode = BROWSER ? encode : encodeNativeNode;","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst assert = require('assert');\nconst { isInteger } = require('./util.js');\n\nfunction canonical(cmd) {\n  return cmd.toLowerCase().replace(/[_.]/g, '');\n}\n\nexport const TYPE_INT = 0;\nexport const TYPE_FLOAT = 1;\nexport const TYPE_STRING = 2;\nconst TYPE_NAME = ['INTEGER', 'NUMBER', 'STRING'];\n\nexport function defaultHandler(err, resp) {\n  if (err) {\n    console.error(err, resp);\n  } else {\n    console.info(resp);\n  }\n}\n\nfunction checkAccess(access, list) {\n  if (list) {\n    for (let ii = 0; ii < list.length; ++ii) {\n      if (!access || !access[list[ii]]) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nfunction CmdParse(params) {\n  this.cmds = {};\n  this.cmds_for_complete = this.cmds;\n  this.was_not_found = false;\n  this.storage = params && params.storage; // expects .setJSON(), .getJSON()\n  this.default_handler = defaultHandler;\n  this.register({\n    cmd: 'cmd_list',\n    func: this.cmdList.bind(this),\n    access_show: ['hidden']\n  });\n}\nCmdParse.prototype.cmdList = function (str, resp_func) {\n  if (!this.cmd_list) {\n    let list = this.cmd_list = {};\n    for (let cmd in this.cmds) {\n      let cmd_data = this.cmds[cmd];\n      let access = []; // combine for data compaction\n      if (cmd_data.access_show) {\n        access = access.concat(cmd_data.access_show);\n      }\n      if (cmd_data.access_run) {\n        access = access.concat(cmd_data.access_run);\n      }\n      if (access.indexOf('hidden') !== -1) {\n        continue;\n      }\n      let data = {\n        name: cmd_data.name,\n        help: cmd_data.help\n      };\n      if (cmd_data.usage) {\n        data.usage = cmd_data.usage;\n      }\n      if (access.length) {\n        data.access_show = access;\n      }\n      list[cmd] = data;\n    }\n  }\n  resp_func(null, this.cmd_list);\n};\n\nCmdParse.prototype.setDefaultHandler = function (fn) {\n  assert(this.default_handler === defaultHandler); // Should only set this once\n  this.default_handler = fn;\n};\nCmdParse.prototype.handle = function (self, str, resp_func) {\n  resp_func = resp_func || this.default_handler;\n  this.was_not_found = false;\n  let m = str.match(/^([^\\s]+)(?:\\s+(.*))?$/);\n  if (!m) {\n    resp_func('Missing command');\n    return true;\n  }\n  let cmd = canonical(m[1]);\n  let cmd_data = this.cmds[cmd];\n  if (cmd_data && !checkAccess(self && self.access, cmd_data.access_run)) {\n    // this.was_not_found = true;\n    resp_func(`Access denied: \"${m[1]}\"`);\n    return false;\n  }\n  if (!cmd_data) {\n    this.was_not_found = true;\n    resp_func(`Unknown command: \"${m[1]}\"`);\n    return false;\n  }\n  cmd_data.fn.call(self, m[2] || '', resp_func);\n  return true;\n};\n\nCmdParse.prototype.register = function (param) {\n  assert.equal(typeof param, 'object');\n  let { cmd, func, help, usage, access_show, access_run } = param;\n  assert(cmd && func);\n  this.cmds[canonical(cmd)] = {\n    name: cmd,\n    fn: func,\n    help: help || '',\n    usage: usage || undefined,\n    access_show,\n    access_run\n  };\n};\n\nCmdParse.prototype.registerValue = function (cmd, param) {\n  assert(TYPE_NAME[param.type] || !param.set);\n  assert(param.set || param.get);\n  let label = param.label || cmd;\n  let store = param.store && this.storage || false;\n  let store_key = `cmd_parse_${canonical(cmd)}`;\n  if (param.ver) {\n    store_key += `_${param.ver}`;\n  }\n  if (store) {\n    assert(param.set);\n    let init_value = this.storage.getJSON(store_key);\n    if (init_value !== undefined) {\n      param.set(init_value);\n    }\n  }\n  let fn = (str, resp_func) => {\n    function value() {\n      resp_func(null, `${label} = ${param.get()}`);\n    }\n    function usage() {\n      resp_func(`Usage: /${cmd} ${TYPE_NAME[param.type]}`);\n    }\n    if (!str) {\n      if (param.get) {\n        return value();\n      } else {\n        return usage();\n      }\n    }\n    if (!param.set) {\n      return resp_func(`Usage: /${cmd}`);\n    }\n    let n = Number(str);\n    if (param.range) {\n      if (n < param.range[0]) {\n        n = param.range[0];\n      } else if (n > param.range[1]) {\n        n = param.range[1];\n      }\n    }\n    let store_value = n;\n    if (param.type === TYPE_INT) {\n      if (!isInteger(n)) {\n        return usage();\n      }\n      param.set(n);\n    } else if (param.type === TYPE_FLOAT) {\n      if (!isFinite(n)) {\n        return usage();\n      }\n      param.set(n);\n    } else {\n      store_value = str;\n      param.set(str);\n    }\n    if (store) {\n      this.storage.setJSON(store_key, store_value);\n    }\n    if (param.get) {\n      return value();\n    } else {\n      return resp_func(null, `${label} udpated`);\n    }\n  };\n  this.register({\n    cmd,\n    func: fn,\n    help: param.help || (param.get && param.set ? `Set or display \"${label}\" value` : param.set ? `Set \"${label}\" value` : `Display \"${label}\" value`),\n    usage: param.usage || (param.get ? `Display \"${label}\" value\\n  Usage: /${cmd}\\n` : '') + (param.set ? `Set \"${label}\" value\\n  Usage: /${cmd} NewValue` : ''),\n    access_show: param.access_show,\n    access_run: param.access_run\n  });\n};\n\nfunction cmpCmd(a, b) {\n  if (a.cname < b.cname) {\n    return -1;\n  }\n  return 1;\n}\n\n// for auto-complete\nCmdParse.prototype.addServerCommands = function (new_cmds) {\n  let cmds = this.cmds_for_complete;\n  if (this.cmds_for_complete === this.cmds) {\n    cmds = this.cmds_for_complete = {};\n    for (let cname in this.cmds) {\n      cmds[cname] = this.cmds[cname];\n    }\n  }\n  for (let cname in new_cmds) {\n    if (!cmds[cname]) {\n      cmds[cname] = new_cmds[cname];\n    }\n  }\n};\n\nCmdParse.prototype.autoComplete = function (str, access) {\n  let list = [];\n  str = str.split(' ');\n  let first_tok = canonical(str[0]);\n  for (let cname in this.cmds_for_complete) {\n    if (str.length === 1 && cname.slice(0, first_tok.length) === first_tok || str.length > 1 && cname === first_tok) {\n      let cmd_data = this.cmds_for_complete[cname];\n      if (checkAccess(access, cmd_data.access_show) && checkAccess(access, cmd_data.access_run)) {\n        list.push({\n          cname,\n          cmd: cmd_data.name,\n          help: cmd_data.help,\n          usage: cmd_data.usage\n        });\n      }\n    }\n  }\n  list.sort(cmpCmd);\n  return list; // .slice(0, 20); Maybe?\n};\n\nCmdParse.prototype.canonical = canonical;\n\nCmdParse.prototype.TYPE_INT = TYPE_INT;\nCmdParse.prototype.TYPE_FLOAT = TYPE_FLOAT;\nCmdParse.prototype.TYPE_STRING = TYPE_STRING;\n\nexport function create(params) {\n  return new CmdParse(params);\n}","/**\n *\n *  MD5 (Message-Digest Algorithm)\n *  http://www.webtoolkit.info/\n *\n * Modified by railGun to handle node.js Buffer objects\n *\n **/\n\n/* eslint no-bitwise:off, new-cap:off*/\nconst assert = require('assert');\n\nfunction stringUtf8Encode(str) {\n  let c;\n  let n;\n  let utftext = [];\n  str = str.replace(/\\r\\n/g, '\\n');\n  for (n = 0; n < str.length; ++n) {\n    c = str.charCodeAt(n);\n    if (c < 128) {\n      utftext.push(String.fromCharCode(c));\n    } else if (c > 127 && c < 2048) {\n      utftext.push(String.fromCharCode(c >> 6 | 192));\n      utftext.push(String.fromCharCode(c & 63 | 128));\n    } else {\n      utftext.push(String.fromCharCode(c >> 12 | 224));\n      utftext.push(String.fromCharCode(c >> 6 & 63 | 128));\n      utftext.push(String.fromCharCode(c & 63 | 128));\n    }\n  }\n  return utftext.join('');\n}\n\nfunction rotateLeft(lValue, iShiftBits) {\n  return lValue << iShiftBits | lValue >>> 32 - iShiftBits;\n}\n\nfunction addUnsigned(lX, lY) {\n  let lX8 = lX & 0x80000000;\n  let lY8 = lY & 0x80000000;\n  let lX4 = lX & 0x40000000;\n  let lY4 = lY & 0x40000000;\n  let lResult = (lX & 0x3FFFFFFF) + (lY & 0x3FFFFFFF);\n  if (lX4 & lY4) {\n    return lResult ^ 0x80000000 ^ lX8 ^ lY8;\n  }\n  if (lX4 | lY4) {\n    if (lResult & 0x40000000) {\n      return lResult ^ 0xC0000000 ^ lX8 ^ lY8;\n    } else {\n      return lResult ^ 0x40000000 ^ lX8 ^ lY8;\n    }\n  } else {\n    return lResult ^ lX8 ^ lY8;\n  }\n}\n\nfunction F(x, y, z) {\n  return x & y | ~x & z;\n}\nfunction G(x, y, z) {\n  return x & z | y & ~z;\n}\nfunction H(x, y, z) {\n  return x ^ y ^ z;\n}\nfunction I(x, y, z) {\n  return y ^ (x | ~z);\n}\n\nfunction FF(a, b, c, d, x, s, ac) {\n  a = addUnsigned(a, addUnsigned(addUnsigned(F(b, c, d), x), ac));\n  return addUnsigned(rotateLeft(a, s), b);\n}\n\nfunction GG(a, b, c, d, x, s, ac) {\n  a = addUnsigned(a, addUnsigned(addUnsigned(G(b, c, d), x), ac));\n  return addUnsigned(rotateLeft(a, s), b);\n}\n\nfunction HH(a, b, c, d, x, s, ac) {\n  a = addUnsigned(a, addUnsigned(addUnsigned(H(b, c, d), x), ac));\n  return addUnsigned(rotateLeft(a, s), b);\n}\n\nfunction II(a, b, c, d, x, s, ac) {\n  a = addUnsigned(a, addUnsigned(addUnsigned(I(b, c, d), x), ac));\n  return addUnsigned(rotateLeft(a, s), b);\n}\n\nfunction convertToWordArray(string) {\n  let lWordCount;\n  let lMessageLength = string.length;\n  let lNumberOfWords_temp1 = lMessageLength + 8;\n  let lNumberOfWords_temp2 = (lNumberOfWords_temp1 - lNumberOfWords_temp1 % 64) / 64;\n  let lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16;\n  let lWordArray = new Array(lNumberOfWords - 1);\n  let lBytePosition = 0;\n  let lByteCount = 0;\n  while (lByteCount < lMessageLength) {\n    lWordCount = (lByteCount - lByteCount % 4) / 4;\n    lBytePosition = lByteCount % 4 * 8;\n    lWordArray[lWordCount] |= string.charCodeAt(lByteCount) << lBytePosition;\n    lByteCount++;\n  }\n  lWordCount = (lByteCount - lByteCount % 4) / 4;\n  lBytePosition = lByteCount % 4 * 8;\n  lWordArray[lWordCount] |= 0x80 << lBytePosition;\n  lWordArray[lNumberOfWords - 2] = lMessageLength << 3;\n  lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;\n  return lWordArray;\n}\n\n// function convertByteArraytoWordArray(arr) {\n//   let lWordCount;\n//   let lMessageLength = arr.length;\n//   let lNumberOfWords_temp1 = lMessageLength + 8;\n//   let lNumberOfWords_temp2 =\n//     (lNumberOfWords_temp1 - (lNumberOfWords_temp1 % 64)) / 64;\n//   let lNumberOfWords = (lNumberOfWords_temp2 + 1) * 16;\n//   let lWordArray = new Array(lNumberOfWords - 1);\n//   let lBytePosition = 0;\n//   let lByteCount = 0;\n//   while (lByteCount < lMessageLength) {\n//     lWordCount = (lByteCount - (lByteCount % 4)) / 4;\n//     lBytePosition = (lByteCount % 4) * 8;\n//     lWordArray[lWordCount] |= arr[lByteCount] << lBytePosition;\n//     lByteCount++;\n//   }\n//   lWordCount = (lByteCount - (lByteCount % 4)) / 4;\n//   lBytePosition = (lByteCount % 4) * 8;\n//   lWordArray[lWordCount] |= 0x80 << lBytePosition;\n//   lWordArray[lNumberOfWords - 2] = lMessageLength << 3;\n//   lWordArray[lNumberOfWords - 1] = lMessageLength >>> 29;\n//   return lWordArray;\n// }\n\nfunction wordToHex(lValue) {\n  let wordToHexValue = '';\n\n  let wordToHexValue_temp = '';\n\n  let lByte;\n  let lCount;\n  for (lCount = 0; lCount <= 3; lCount++) {\n    lByte = lValue >>> lCount * 8 & 255;\n    wordToHexValue_temp = `0${lByte.toString(16)}`;\n    wordToHexValue += wordToHexValue_temp.substr(wordToHexValue_temp.length - 2, 2);\n  }\n  return wordToHexValue;\n}\n\n// string can either be a string, node.js Buffer, array (of numbers < 256)\n// or a typed array\nmodule.exports = function md5(string) {\n  let AA;\n  let BB;\n  let CC;\n  let DD;\n  let a;\n  let b;\n  let c;\n  let d;\n  let k;\n  let S11 = 7;\n  let S12 = 12;\n  let S13 = 17;\n  let S14 = 22;\n  let S21 = 5;\n  let S22 = 9;\n  let S23 = 14;\n  let S24 = 20;\n  let S31 = 4;\n  let S32 = 11;\n  let S33 = 16;\n  let S34 = 23;\n  let S41 = 6;\n  let S42 = 10;\n  let S43 = 15;\n  let S44 = 21;\n\n  let x;\n  if (typeof string === 'string') {\n    string = stringUtf8Encode(string);\n    x = convertToWordArray(string);\n  } else {\n    assert(false); // disable due to not used\n    // node.js buffer or Array\n    // x = convertByteArraytoWordArray(string);\n  }\n\n  a = 0x67452301;\n  b = 0xEFCDAB89;\n  c = 0x98BADCFE;\n  d = 0x10325476;\n\n  for (k = 0; k < x.length; k += 16) {\n    AA = a;\n    BB = b;\n    CC = c;\n    DD = d;\n    a = FF(a, b, c, d, x[k], S11, 0xD76AA478);\n    d = FF(d, a, b, c, x[k + 1], S12, 0xE8C7B756);\n    c = FF(c, d, a, b, x[k + 2], S13, 0x242070DB);\n    b = FF(b, c, d, a, x[k + 3], S14, 0xC1BDCEEE);\n    a = FF(a, b, c, d, x[k + 4], S11, 0xF57C0FAF);\n    d = FF(d, a, b, c, x[k + 5], S12, 0x4787C62A);\n    c = FF(c, d, a, b, x[k + 6], S13, 0xA8304613);\n    b = FF(b, c, d, a, x[k + 7], S14, 0xFD469501);\n    a = FF(a, b, c, d, x[k + 8], S11, 0x698098D8);\n    d = FF(d, a, b, c, x[k + 9], S12, 0x8B44F7AF);\n    c = FF(c, d, a, b, x[k + 10], S13, 0xFFFF5BB1);\n    b = FF(b, c, d, a, x[k + 11], S14, 0x895CD7BE);\n    a = FF(a, b, c, d, x[k + 12], S11, 0x6B901122);\n    d = FF(d, a, b, c, x[k + 13], S12, 0xFD987193);\n    c = FF(c, d, a, b, x[k + 14], S13, 0xA679438E);\n    b = FF(b, c, d, a, x[k + 15], S14, 0x49B40821);\n    a = GG(a, b, c, d, x[k + 1], S21, 0xF61E2562);\n    d = GG(d, a, b, c, x[k + 6], S22, 0xC040B340);\n    c = GG(c, d, a, b, x[k + 11], S23, 0x265E5A51);\n    b = GG(b, c, d, a, x[k], S24, 0xE9B6C7AA);\n    a = GG(a, b, c, d, x[k + 5], S21, 0xD62F105D);\n    d = GG(d, a, b, c, x[k + 10], S22, 0x2441453);\n    c = GG(c, d, a, b, x[k + 15], S23, 0xD8A1E681);\n    b = GG(b, c, d, a, x[k + 4], S24, 0xE7D3FBC8);\n    a = GG(a, b, c, d, x[k + 9], S21, 0x21E1CDE6);\n    d = GG(d, a, b, c, x[k + 14], S22, 0xC33707D6);\n    c = GG(c, d, a, b, x[k + 3], S23, 0xF4D50D87);\n    b = GG(b, c, d, a, x[k + 8], S24, 0x455A14ED);\n    a = GG(a, b, c, d, x[k + 13], S21, 0xA9E3E905);\n    d = GG(d, a, b, c, x[k + 2], S22, 0xFCEFA3F8);\n    c = GG(c, d, a, b, x[k + 7], S23, 0x676F02D9);\n    b = GG(b, c, d, a, x[k + 12], S24, 0x8D2A4C8A);\n    a = HH(a, b, c, d, x[k + 5], S31, 0xFFFA3942);\n    d = HH(d, a, b, c, x[k + 8], S32, 0x8771F681);\n    c = HH(c, d, a, b, x[k + 11], S33, 0x6D9D6122);\n    b = HH(b, c, d, a, x[k + 14], S34, 0xFDE5380C);\n    a = HH(a, b, c, d, x[k + 1], S31, 0xA4BEEA44);\n    d = HH(d, a, b, c, x[k + 4], S32, 0x4BDECFA9);\n    c = HH(c, d, a, b, x[k + 7], S33, 0xF6BB4B60);\n    b = HH(b, c, d, a, x[k + 10], S34, 0xBEBFBC70);\n    a = HH(a, b, c, d, x[k + 13], S31, 0x289B7EC6);\n    d = HH(d, a, b, c, x[k], S32, 0xEAA127FA);\n    c = HH(c, d, a, b, x[k + 3], S33, 0xD4EF3085);\n    b = HH(b, c, d, a, x[k + 6], S34, 0x4881D05);\n    a = HH(a, b, c, d, x[k + 9], S31, 0xD9D4D039);\n    d = HH(d, a, b, c, x[k + 12], S32, 0xE6DB99E5);\n    c = HH(c, d, a, b, x[k + 15], S33, 0x1FA27CF8);\n    b = HH(b, c, d, a, x[k + 2], S34, 0xC4AC5665);\n    a = II(a, b, c, d, x[k], S41, 0xF4292244);\n    d = II(d, a, b, c, x[k + 7], S42, 0x432AFF97);\n    c = II(c, d, a, b, x[k + 14], S43, 0xAB9423A7);\n    b = II(b, c, d, a, x[k + 5], S44, 0xFC93A039);\n    a = II(a, b, c, d, x[k + 12], S41, 0x655B59C3);\n    d = II(d, a, b, c, x[k + 3], S42, 0x8F0CCC92);\n    c = II(c, d, a, b, x[k + 10], S43, 0xFFEFF47D);\n    b = II(b, c, d, a, x[k + 1], S44, 0x85845DD1);\n    a = II(a, b, c, d, x[k + 8], S41, 0x6FA87E4F);\n    d = II(d, a, b, c, x[k + 15], S42, 0xFE2CE6E0);\n    c = II(c, d, a, b, x[k + 6], S43, 0xA3014314);\n    b = II(b, c, d, a, x[k + 13], S44, 0x4E0811A1);\n    a = II(a, b, c, d, x[k + 4], S41, 0xF7537E82);\n    d = II(d, a, b, c, x[k + 11], S42, 0xBD3AF235);\n    c = II(c, d, a, b, x[k + 2], S43, 0x2AD7D2BB);\n    b = II(b, c, d, a, x[k + 9], S44, 0xEB86D391);\n    a = addUnsigned(a, AA);\n    b = addUnsigned(b, BB);\n    c = addUnsigned(c, CC);\n    d = addUnsigned(d, DD);\n  }\n\n  let temp = wordToHex(a) + wordToHex(b) + wordToHex(c) + wordToHex(d);\n  return temp.toLowerCase();\n};\n\n/* // Uncomment this and run \"node MD5.js file.ext\"\nvar FS = require('fs');\nvar data = FS.readFileSync(process.argv[2]);\nvar md5 = module.exports(data);\nconsole.log('MD5 = ' + md5);\n// */","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n// Some code derived from libGLOV (C++), also MIT Licensed\n\n/* eslint no-bitwise:off */\n\n// Upon read, throw an exception if there is any data read error (e.g. read off of end of packet)\n\n// TODO: Maybe: Have 2 offsets, one for writing (data_len?), one for reading (buf_offs?),\n//   then there should be many fewer ?pak.readable branches\n//   that return different values under different circumstances, and maybe fewer .makeReadable() calls needed.\n\n\n// 3 bits of flags reserved for internal use\nconst PACKET_DEBUG = exports.PACKET_DEBUG = 1 << 0;\nconst PACKET_RESERVED1 = exports.PACKET_RESERVED1 = 1 << 1;\nconst PACKET_RESERVED2 = exports.PACKET_RESERVED2 = 1 << 2;\nconst FLAG_PACKET_INTERNAL = PACKET_DEBUG | PACKET_RESERVED1 | PACKET_RESERVED2;\n\n// Internal, runtime-only (not serialized) flags < 8 bits\nconst PACKET_UNOWNED_BUFFER = 1 << 8;\n\nexports.default_flags = 0;\n\nconst assert = require('assert');\nconst { max } = Math;\nconst { isInteger, log2 } = require('../common/util.js');\n// const { isInteger, log2 } = require('../../build.dev/common/util.js');\nconst { base64Encode, base64Decode } = require('../common/base64.js');\n\nconst FALSYS = [undefined, null, 0, false, '', NaN];\nconst PAK_BUF_DEFAULT_SIZE = 1024;\n\nconst UNDERRUN = 'PKTERR_UNDERRUN';\n\nconst POOL_PACKETS = 5000;\nconst POOL_TIMEOUT = 5000;\nconst POOL_BUF_BY_SIZE = [0, // 2^0 : 1 - shouldn't be allocated ever?\n10, // 2^1 : 2\n10, // 2^2 : 4\n20, // 2^3 : 8\n20, // 2^4 : 16\n20, // 2^5 : 32\n20, // 2^6 : 64\n20, // 2^7 : 128\n20, // 2^8 : 256\n20, // 2^9 : 512\n5000, // 2^10 : 1024 - standard Packet size\n20, // 2^11 : 2048\n20, // 2^12 : 4096\n20, // 2^13 : 8192\n20, // 2^14 : 16384\n20, // 2^15 : 32768\n20, // 2^16 : 65536\n10, // 2^17 : 131072\n10];\n\nlet pak_pool = [];\nlet pak_debug_pool = [];\nlet buf_pool = POOL_BUF_BY_SIZE.map(() => []);\n\nfunction allocDataView(size) {\n  let pool_idx = log2(size);\n  assert(pool_idx);\n  if (pool_idx >= buf_pool.length) {\n    pool_idx = 0;\n  }\n  if (pool_idx) {\n    size = 1 << pool_idx;\n    if (buf_pool[pool_idx].length) {\n      // No reinit here, just a container\n      //console.log(`Buffer FROMPOOL:${size}/${pool_idx}`);\n      return buf_pool[pool_idx].pop();\n    }\n  } else {}\n  // Enable this (and lower pool size) to track down big packets:\n  // console.log(`Allocating UNPOOLABLE buffer of size ${size} from ${new Error().stack}`);\n\n  //console.log(`Buffer ALLOC:${size}`);\n  let u8 = new Uint8Array(size);\n  let dv = new DataView(u8.buffer);\n  dv.u8 = u8;\n  if (pool_idx) {\n    dv.packet_pool_idx = pool_idx;\n  }\n  return dv;\n}\n\nfunction wrapU8AsDataView(u8) {\n  let dv = new DataView(u8.buffer, u8.byteOffset, u8.byteLength);\n  dv.u8 = u8;\n  return dv;\n}\n\nfunction utf8ByteLength(str) {\n  let len = str.length;\n  let ret = len;\n  for (let ii = 0; ii < len; ++ii) {\n    let c = str.charCodeAt(ii);\n    if (c > 0x7F) {\n      ++ret;\n      if (c > 0x07FF) {\n        ++ret;\n        if (c > 0xFFFF) {\n          ++ret;\n          if (c > 0x1FFFFF) {\n            ++ret;\n            if (c > 0x3FFFFFF) {\n              ++ret;\n            }\n          }\n        }\n      }\n    }\n  }\n  return ret;\n}\n\n// Assumes buffer will fit it\nfunction utf8WriteChar(buf, buf_offs, c) {\n  if (c <= 0x7F) {\n    buf.u8[buf_offs++] = c;\n  } else if (c <= 0x07FF) {\n    buf.u8[buf_offs++] = c >> 6 | 0xC0;\n    buf.u8[buf_offs++] = c & 0x3F | 0x80;\n  } else if (c <= 0xFFFF) {\n    buf.u8[buf_offs++] = c >> 12 | 0xE0;\n    buf.u8[buf_offs++] = c >> 6 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c & 0x3F | 0x80;\n  } else if (c <= 0x1FFFFF) {\n    buf.u8[buf_offs++] = c >> 18 | 0xF0;\n    buf.u8[buf_offs++] = c >> 12 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c >> 6 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c & 0x3F | 0x80;\n  } else if (c <= 0x3FFFFFF) {\n    buf.u8[buf_offs++] = c >> 24 | 0xF8;\n    buf.u8[buf_offs++] = c >> 18 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c >> 12 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c >> 6 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c & 0x3F | 0x80;\n  } else if (c <= 0x7FFFFFFF) {\n    buf.u8[buf_offs++] = c >> 30 | 0xFC;\n    buf.u8[buf_offs++] = c >> 24 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c >> 18 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c >> 12 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c >> 6 & 0x3F | 0x80;\n    buf.u8[buf_offs++] = c & 0x3F | 0x80;\n  }\n  return buf_offs;\n}\n\nfunction poolBuf(dv) {\n  // if it's poolable (not part of another Buffer), pool it!\n  assert(dv);\n  assert(dv.u8);\n  let pool_idx = dv.packet_pool_idx;\n  if (pool_idx) {\n    let arr = buf_pool[pool_idx];\n    if (arr.length < POOL_BUF_BY_SIZE[pool_idx]) {\n      //console.log(`Buffer TOPOOL:${dv.byteLength}/${pool_idx}`);\n      arr.push(dv);\n    }\n  } else {\n    // console.log(`Buffer UNPOOLABLE:${dv.byteLength}`);\n  }\n}\n\nexport function packetBufPoolAlloc(size) {\n  return allocDataView(size);\n}\nexport function packetBufPoolFree(dv) {\n  poolBuf(dv);\n}\n\nfunction Packet(flags, init_size, pak_debug) {\n  this.reinit(flags, init_size, pak_debug);\n}\nPacket.prototype.reinit = function (flags, init_size, pak_debug) {\n  this.flags = flags || 0;\n  this.has_flags = false;\n  this.buf = null;\n  this.buf_len = 0;\n  this.buf_offs = 0;\n  this.bufs = null;\n  this.bsizes = null;\n  this.readable = false;\n  this.ref_count = 1;\n  this.pak_debug = pak_debug;\n  if (init_size) {\n    this.fit(init_size, true);\n    this.buf_len = init_size;\n  }\n};\nPacket.prototype.ref = function () {\n  ++this.ref_count;\n};\nPacket.prototype.pool = function () {\n  assert(this.ref_count);\n  if (--this.ref_count) {\n    return;\n  }\n  // Do not clear on pool(), callers (readInt()) may still momentarily reference .buf, etc\n  if (this.flags & PACKET_UNOWNED_BUFFER) {\n    // doing nothing with buffers, still pooling the packet\n  } else {\n    if (this.buf) {\n      poolBuf(this.buf);\n    }\n    if (this.bufs) {\n      for (let ii = 0; ii < this.bufs.length; ++ii) {\n        poolBuf(this.bufs[ii]);\n      }\n    }\n  }\n  if (pak_pool.length < POOL_PACKETS) {\n    pak_pool.push(this);\n  }\n  if (this.pak_debug) {\n    this.pak_debug.poolDebug();\n  }\n};\n\nPacket.prototype.totalSize = function () {\n  let ret = 0;\n  if (this.readable) {\n    return this.buf_len;\n  }\n  if (this.bsizes) {\n    for (let ii = 0; ii < this.bsizes.length; ++ii) {\n      ret += this.bsizes[ii];\n    }\n  }\n  ret += this.buf_offs;\n  return ret;\n};\n\nPacket.prototype.setReadable = function () {\n  assert(this.buf);\n  assert(!this.bufs);\n  assert(!this.readable);\n  this.readable = true;\n};\n\nPacket.prototype.makeReadable = function () {\n  assert(this.buf);\n  assert(!this.readable); // otherwise just reset offset? or do nothing?\n  let total = this.totalSize(); // before this.readable = true\n  this.readable = true;\n  if (!this.bufs) {\n    this.buf_len = total;\n    this.buf_offs = 0;\n    return;\n  }\n  let buf = allocDataView(total);\n  let u8 = buf.u8;\n  let offs = 0;\n  for (let ii = 0; ii < this.bufs.length; ++ii) {\n    let bsize = this.bsizes[ii];\n    let dv = this.bufs[ii];\n    if (offs + bsize > total) {\n      // unused portion would overrun\n      assert.equal(dv.byteOffset, 0);\n      u8.set(new Uint8Array(dv.buffer, 0, bsize), offs);\n    } else {\n      u8.set(dv.u8, offs);\n    }\n    offs += bsize;\n    poolBuf(dv);\n  }\n  assert.equal(this.buf.byteOffset, 0); // Would handle it, but should never happen here, these are our pooled buffers?\n  u8.set(new Uint8Array(this.buf.buffer, this.buf.byteOffset, this.buf_offs), offs);\n  poolBuf(this.buf);\n  assert.equal(offs + this.buf_offs, total);\n  this.bufs = this.bsizes = null;\n  this.buf = buf;\n  this.buf_offs = 0;\n  this.buf_len = total; // buffer is actually buf.buffer.byteLength, but we can't read past `total`\n};\n\nPacket.prototype.flush = function () {\n  let { buf, buf_offs } = this;\n  if (!this.bufs) {\n    this.bufs = [buf];\n    this.bsizes = [buf_offs];\n  } else {\n    this.bufs.push(buf);\n    this.bsizes.push(buf_offs);\n  }\n  this.buf = null;\n  this.buf_len = 0;\n  this.buf_offs = 0;\n};\nPacket.prototype.fit = function (extra_bytes, no_advance) {\n  let { buf, buf_len, buf_offs } = this;\n  let new_offs = buf_offs + extra_bytes;\n  if (new_offs <= buf_len) {\n    if (!no_advance) {\n      this.buf_offs = new_offs;\n    }\n    return buf_offs;\n  }\n  assert(!this.readable); // Shouldn't happen on concatenated buffers\n  if (buf) {\n    this.flush();\n  }\n  this.buf_len = buf_len = max(PAK_BUF_DEFAULT_SIZE, extra_bytes);\n  this.buf = allocDataView(buf_len);\n  this.buf_offs = no_advance ? 0 : extra_bytes;\n  return 0;\n};\nPacket.prototype.advance = function (bytes) {\n  let offs = this.buf_offs;\n  let new_offs = offs + bytes;\n  this.buf_offs = new_offs;\n  if (new_offs > this.buf_len) {\n    throw new Error(UNDERRUN);\n  }\n  if (new_offs === this.buf_len) {\n    this.pool();\n  }\n  return offs;\n};\nPacket.prototype.ended = function () {\n  return this.buf_offs === this.buf_len;\n};\n\n// low-level write/read functions\nPacket.prototype.writeU8 = function (v) {\n  assert(v >= 0 && v < 256);\n  let offs = this.fit(1);\n  this.buf.u8[offs] = v;\n};\nPacket.prototype.readU8 = function () {\n  return this.buf.u8[this.advance(1)];\n};\n// Packed int, first byte:\n// 0-247 byte\n// 248 positive 16-bit\n// 249 negative 16-bit\n// 250 positive 32-bit\n// 251 negative 32-bit\n// 252 positive 64-bit\n// 253 negative 64-bit\n// 254 unused\n// 255 negative byte\nPacket.prototype.writeInt = function (v) {\n  assert(isInteger(v));\n  let offs = this.fit(9, true); // 9 is max size of a packed int\n  let buf = this.buf;\n  let neg = v < 0 ? 1 : 0;\n  if (neg) {\n    v = -v;\n  }\n  if (v < 248) {\n    // || neg && v < 256 would also decode right\n    if (neg) {\n      buf.u8[offs++] = 255;\n    }\n    buf.u8[offs++] = v;\n  } else {\n    if (v < 65536) {\n      buf.u8[offs++] = 248 + neg;\n      buf.setUint16(offs, v, true);\n      offs += 2;\n    } else if (v < 4294967296) {\n      buf.u8[offs++] = 250 + neg;\n      buf.setUint32(offs, v, true);\n      offs += 4;\n    } else {\n      buf.u8[offs++] = 252 + neg;\n      let low_bits = v >>> 0;\n      buf.setUint32(offs, low_bits, true);\n      offs += 4;\n      buf.setUint32(offs, (v - low_bits) / 4294967296, true);\n      offs += 4;\n    }\n  }\n  this.buf_offs = offs;\n};\nPacket.prototype.zeroInt = function () {\n  // Overwrite an existing int with a zero, keeping the same packed size\n  let b1 = this.buf.u8[this.buf_offs];\n  if (b1 < 248) {\n    this.buf.u8[this.buf_offs++] = 0;\n    return;\n  }\n  // Otherwise, leave header bit\n  this.buf_offs++;\n  let zeroes = 1;\n  switch (b1) {\n    case 253:\n    case 252:\n      // 8\n      zeroes += 4;\n    case 251: // eslint-disable-line no-fallthrough\n    case 250:\n      // 4\n      zeroes += 2;\n    case 249: // eslint-disable-line no-fallthrough\n    case 248:\n      // 2\n      zeroes++;\n    case 255:\n      // eslint-disable-line no-fallthrough\n      // 1\n      break;\n    default:\n      throw new Error('PKTERR_PACKED_INT');\n  }\n  while (zeroes) {\n    --zeroes;\n    this.buf.u8[this.buf_offs++] = 0;\n  }\n};\nPacket.prototype.readInt = function () {\n  let b1 = this.buf.u8[this.advance(1)];\n  if (b1 < 248) {\n    return b1;\n  }\n  let sign = 1;\n  switch (b1) {\n    case 249:\n      sign = -1;\n    case 248:\n      // eslint-disable-line no-fallthrough\n      return sign * this.buf.getUint16(this.advance(2), true);\n    case 251:\n      sign = -1;\n    case 250:\n      // eslint-disable-line no-fallthrough\n      return sign * this.buf.getUint32(this.advance(4), true);\n    case 253:\n      sign = -1;\n    case 252:\n      {\n        // eslint-disable-line no-fallthrough\n        let low_bits = this.buf.getUint32(this.advance(4), true);\n        let high_bits = this.buf.getUint32(this.advance(4), true);\n        return sign * (high_bits * 4294967296 + low_bits);\n      }\n    case 255:\n      return -this.buf.u8[this.advance(1)];\n    default:\n      throw new Error('PKTERR_PACKED_INT');\n  }\n};\nPacket.prototype.writeFloat = function (v) {\n  assert.equal(typeof v, 'number');\n  if (!v) {\n    this.buf.u8[this.fit(1)] = 0;\n    return;\n  }\n  let offs = this.fit(5, true);\n  this.buf.setFloat32(offs, v, true);\n  if (this.buf.u8[offs] <= 1) {\n    // escape a 0 or 1 in the first byte\n    this.buf.u8[offs++] = 1;\n    this.buf.setFloat32(offs, v, true);\n  }\n  this.buf_offs = offs + 4;\n};\nPacket.prototype.readFloat = function () {\n  let offs = this.advance(1);\n  let b1 = this.buf.u8[offs];\n  if (!b1) {\n    return 0;\n  }\n  if (b1 === 1) {\n    return this.buf.getFloat32(this.advance(4), true);\n  }\n  this.advance(3);\n  return this.buf.getFloat32(offs, true);\n};\nPacket.prototype.writeU32 = function (v) {\n  assert.equal(typeof v, 'number');\n  this.buf.setUint32(this.fit(4), v, true);\n};\nPacket.prototype.readU32 = function () {\n  return this.buf.getUint32(this.advance(4), true);\n};\nPacket.prototype.writeString = function (v) {\n  assert.equal(typeof v, 'string'); // Could maybe do a toString() here if not\n  let byte_length = utf8ByteLength(v);\n  this.writeInt(byte_length); // Just 1 byte for small strings\n  if (!byte_length) {\n    return;\n  }\n  let offs = this.fit(byte_length);\n  let buf = this.buf;\n  for (let ii = 0; ii < v.length; ++ii) {\n    let c = v.charCodeAt(ii);\n    if (c <= 0x7F) {\n      buf.u8[offs++] = c;\n    } else {\n      offs = utf8WriteChar(buf, offs, c);\n    }\n  }\n};\n// Only called on multi-byte characters; Supplied the first byte for efficiency\nPacket.prototype.utf8ReadChar = function (c) {\n  let buf = this.buf;\n  if (c >= 0xC0 && c < 0xE0) {\n    return (c & 0x1F) << 6 | buf.u8[this.buf_offs++] & 0x3F;\n  } else if (c >= 0xE0 && c < 0xF0) {\n    return (c & 0x0F) << 12 | (buf.u8[this.buf_offs++] & 0x3F) << 6 | buf.u8[this.buf_offs++] & 0x3F;\n  } else if (c >= 0xF0 && c < 0xF8) {\n    return (c & 0x0F) << 18 | (buf.u8[this.buf_offs++] & 0x3F) << 12 | (buf.u8[this.buf_offs++] & 0x3F) << 6 | buf.u8[this.buf_offs++] & 0x3F;\n  } else if (c >= 0xF8 && c < 0xFC) {\n    return (c & 0x0F) << 24 | (buf.u8[this.buf_offs++] & 0x3F) << 18 | (buf.u8[this.buf_offs++] & 0x3F) << 12 | (buf.u8[this.buf_offs++] & 0x3F) << 6 | buf.u8[this.buf_offs++] & 0x3F;\n  } else {\n    //if (c >= 0xFC) {\n    return (c & 0x0F) << 30 | (buf.u8[this.buf_offs++] & 0x3F) << 24 | (buf.u8[this.buf_offs++] & 0x3F) << 18 | (buf.u8[this.buf_offs++] & 0x3F) << 12 | (buf.u8[this.buf_offs++] & 0x3F) << 6 | buf.u8[this.buf_offs++] & 0x3F;\n  }\n};\n\nlet string_assembly = [];\nPacket.prototype.readString = function () {\n  let byte_length = this.readInt();\n  if (!byte_length) {\n    return '';\n  }\n  if (this.buf_offs + byte_length > this.buf_len) {\n    throw new Error(UNDERRUN);\n  }\n\n  let { buf } = this;\n  let end_offset = this.buf_offs + byte_length;\n  let ret;\n  if (byte_length > 8192) {\n    ret = '';\n    while (this.buf_offs < end_offset) {\n      let c = buf.u8[this.buf_offs++];\n      if (c > 0x7F) {\n        c = this.utf8ReadChar(c);\n      }\n      ret += String.fromCharCode(c);\n    }\n  } else {\n    string_assembly.length = byte_length;\n    let ii = 0;\n    while (this.buf_offs < end_offset) {\n      let c = buf.u8[this.buf_offs++];\n      if (c > 0x7F) {\n        c = this.utf8ReadChar(c);\n      }\n      string_assembly[ii++] = c;\n    }\n    if (string_assembly.length !== ii) {\n      // truncate if multi-byte UTF8 produced single characters\n      string_assembly.length = ii;\n    }\n    ret = String.fromCharCode.apply(undefined, string_assembly);\n  }\n  if (this.buf_offs === this.buf_len) {\n    this.pool();\n  }\n  return ret;\n};\n// Much more efficient than writeString if the input is known to be ANSI-ish (all characters <= 255)\nPacket.prototype.writeAnsiString = function (v) {\n  assert.equal(typeof v, 'string'); // Could maybe do a toString() here if not\n  let byte_length = v.length;\n  this.writeInt(byte_length);\n  let offs = this.fit(byte_length);\n  let { buf } = this;\n  for (let ii = 0; ii < byte_length; ++ii) {\n    buf.u8[offs++] = v.charCodeAt(ii);\n  }\n};\nPacket.prototype.readAnsiString = function () {\n  let len = this.readInt();\n  let offs = this.advance(len);\n  let { buf } = this;\n  string_assembly.length = len;\n  for (let ii = 0; ii < len; ++ii) {\n    string_assembly[ii] = buf.u8[offs++];\n  }\n  return String.fromCharCode.apply(undefined, string_assembly);\n};\n\n// high-level write/read functions\nPacket.prototype.writeJSON = function (v) {\n  if (!v) {\n    let idx = FALSYS.indexOf(v);\n    assert(idx !== -1);\n    this.writeU8(idx + 1);\n    return;\n  }\n  this.writeU8(0);\n  this.writeString(JSON.stringify(v));\n};\nPacket.prototype.readJSON = function () {\n  let byte = this.readU8();\n  if (byte) {\n    if (byte - 1 >= FALSYS.length) {\n      throw new Error('PKTERR_JSON_HEADER');\n    }\n    return FALSYS[byte - 1];\n  }\n  let str = this.readString();\n  return JSON.parse(str);\n};\n// Uint8Array or Buffer object?\nPacket.prototype.writeBuffer = function (v) {\n  this.writeInt(v.length);\n  if (v.length) {\n    let offs = this.fit(v.length);\n    this.buf.u8.set(v, offs);\n  }\n};\nconst null_buf = new Uint8Array(0);\nPacket.prototype.readBuffer = function (do_copy) {\n  let len = this.readInt();\n  if (!len) {\n    return null_buf;\n  }\n  let offs = this.advance(len);\n  if (do_copy) {\n    return this.buf.u8.slice(offs, len);\n  } else {\n    let { buf } = this;\n    return new Uint8Array(buf.buffer, buf.byteOffset + offs, len);\n  }\n};\nPacket.prototype.writeBool = function (v) {\n  this.writeU8(v ? 1 : 0);\n};\nPacket.prototype.readBool = function () {\n  return Boolean(this.readU8());\n};\n\nPacket.prototype.append = function (pak) {\n  assert.equal(this.flags & FLAG_PACKET_INTERNAL, pak.flags & FLAG_PACKET_INTERNAL);\n  if (pak.bufs) {\n    for (let ii = 0; ii < pak.bufs.length; ++ii) {\n      let buf = pak.bufs[ii];\n      let bsize = pak.bsizes[ii];\n      let offs = this.fit(bsize);\n      if (bsize !== buf.byteLength) {\n        this.buf.u8.set(new Uint8Array(buf.buffer, buf.byteOffset, bsize), offs);\n      } else {\n        this.buf.u8.set(buf.u8, offs);\n      }\n    }\n  }\n  if (pak.buf) {\n    let buf = pak.buf;\n    let bsize = pak.readable ? pak.buf_len : pak.buf_offs;\n    let offs = this.fit(bsize);\n    if (bsize !== buf.byteLength) {\n      this.buf.u8.set(new Uint8Array(buf.buffer, buf.byteOffset, bsize), offs);\n    } else {\n      this.buf.u8.set(buf.u8, offs);\n    }\n  }\n};\n\nPacket.prototype.appendRemaining = function (pak) {\n  assert.equal(this.flags & FLAG_PACKET_INTERNAL, pak.flags & FLAG_PACKET_INTERNAL);\n  assert(pak.readable);\n  assert(!pak.bufs);\n  assert(pak.buf);\n  assert(pak.buf_offs <= pak.buf_len);\n  let bsize = pak.buf_len - pak.buf_offs;\n  if (bsize) {\n    let offs = this.fit(bsize);\n    this.buf.u8.set(new Uint8Array(pak.buf.buffer, pak.buf.byteOffset + pak.buf_offs, bsize), offs);\n  }\n  // everything consumed, pool it\n  pak.pool();\n};\n\nPacket.prototype.toJSON = function () {\n  let ret = {\n    f: this.flags\n  };\n\n  if (this.bufs) {\n    ret.b = [];\n    for (let ii = 0; ii < this.bufs.length; ++ii) {\n      ret.b.push(base64Encode(this.bufs[ii], 0, this.bsizes[ii]));\n    }\n  }\n  if (this.buf) {\n    if (this.readable) {\n      ret.d = base64Encode(this.buf, 0, this.buf_len);\n    } else {\n      ret.d = base64Encode(this.buf, 0, this.buf_offs);\n    }\n  }\n  return ret;\n};\n\nPacket.prototype.setBuffer = function (buf, buf_len) {\n  assert(!this.buf);\n  assert(!this.bufs);\n  assert(this.flags & PACKET_UNOWNED_BUFFER); // Probably okay if not?\n  assert(buf instanceof Uint8Array);\n  this.buf = wrapU8AsDataView(buf);\n  this.buf_len = buf_len;\n  this.readable = true;\n};\n\nPacket.prototype.getBuffer = function () {\n  assert(this.buf);\n  assert(!this.bufs);\n  return this.buf.u8;\n};\n\nPacket.prototype.getBufferLen = function () {\n  assert(this.buf);\n  assert(!this.bufs);\n  return this.readable ? this.buf_len : this.buf_offs;\n};\n\nPacket.prototype.getOffset = function () {\n  if (this.readable) {\n    return this.buf_offs;\n  }\n  return this.totalSize();\n};\n\nPacket.prototype.seek = function (pos) {\n  assert(this.readable); // .makeReadable should be called so that it is a single buffer\n  assert(pos >= 0 && pos <= this.buf_len);\n  this.buf_offs = pos;\n};\n\nPacket.prototype.writeFlags = function () {\n  assert(!this.has_flags);\n  assert.equal(this.buf_offs, 0);\n  this.writeU8(this.flags);\n  this.has_flags = true;\n};\n\nPacket.prototype.updateFlags = function (flags) {\n  assert(this.has_flags);\n  assert(!(flags & FLAG_PACKET_INTERNAL));\n  this.flags = this.flags & FLAG_PACKET_INTERNAL | flags;\n  let buf = this.bufs ? this.bufs[0] : this.buf;\n  buf.u8[0] = this.flags;\n};\n\nPacket.prototype.readFlags = function () {\n  let read = this.readU8();\n  assert.equal(read, this.flags & 0xFF);\n  this.has_flags = true;\n  return this.flags;\n};\n\nPacket.prototype.getFlags = function () {\n  return this.flags;\n};\n\nPacket.prototype.getInternalFlags = function () {\n  return this.flags & FLAG_PACKET_INTERNAL;\n};\n\nfunction PacketDebug(flags, init_size) {\n  this.reinit(flags, init_size);\n}\nPacketDebug.prototype.reinit = function (flags, init_size) {\n  this.in_pool = false;\n  if (pak_pool.length) {\n    this.pak = pak_pool.pop();\n    this.pak.reinit(flags, init_size, this);\n  } else {\n    this.pak = new Packet(flags, init_size, this);\n  }\n  this.warned = false;\n  this.pool_timer = setTimeout(() => {\n    console.warn(`Packet not pooled after 5s: ${this.contents()}`);\n    this.warned = true;\n  }, POOL_TIMEOUT);\n};\nPacketDebug.prototype.poolDebug = function () {\n  if (this.warned) {\n    console.warn('Packet pooled after timeout');\n  } else {\n    clearTimeout(this.pool_timer);\n  }\n  assert(!this.in_pool);\n  this.in_pool = true; // Set this, as if pooled, even if discarded\n  if (pak_debug_pool.length < POOL_PACKETS) {\n    pak_debug_pool.push(this);\n  }\n};\nconst types = [null, 'U8', 'U32', 'Int', 'Float', 'String', 'AnsiString', 'JSON', 'Bool', 'Buffer'];\n// Functions (types) that read and write a debug byte\ntypes.forEach((type, idx) => {\n  if (!type) {\n    // don't use debug ID 0\n    return;\n  }\n  let write = `write${type}`;\n  let read = `read${type}`;\n  let write_fn = Packet.prototype[write];\n  let read_fn = Packet.prototype[read];\n  PacketDebug.prototype[write] = function (v) {\n    this.pak.writeU8(idx);\n    write_fn.call(this.pak, v);\n  };\n  PacketDebug.prototype[read] = function (param) {\n    let found_idx = this.pak.readU8();\n    if (found_idx !== idx) {\n      assert(false, `PacketDebug error: Expected ${type}(${idx}), found ${types[found_idx]}(${found_idx})`);\n    }\n    return read_fn.call(this.pak, param);\n  };\n});\nPacketDebug.prototype.zeroInt = function () {\n  this.pak.writeU8(3); // types.indexof('Int')\n  this.pak.zeroInt();\n};\n// Functions that simply fall through\n['ended', 'getBuffer', 'getBufferLen', 'getFlags', 'getInternalFlags', 'getOffset', 'makeReadable', 'pool', 'readFlags', // *not* wrapped in debug headers\n'ref', 'seek', 'setBuffer', 'setReadable', 'toJSON', 'totalSize', 'updateFlags', 'writeFlags'].forEach(fname => {\n  let fn = Packet.prototype[fname];\n  PacketDebug.prototype[fname] = function () {\n    return fn.apply(this.pak, arguments); // eslint-disable-line prefer-rest-params\n  };\n});\nPacketDebug.prototype.append = function (pak) {\n  assert(pak instanceof PacketDebug);\n  this.pak.append(pak.pak);\n};\nPacketDebug.prototype.appendRemaining = function (pak) {\n  assert(pak instanceof PacketDebug);\n  this.pak.appendRemaining(pak.pak);\n};\nfunction format(v) {\n  switch (typeof v) {\n    case 'object':\n      return JSON.stringify(v);\n    default:\n      return v;\n  }\n}\nPacketDebug.prototype.contents = function () {\n  let { pak } = this;\n  let cur_offs = pak.getOffset();\n  let read_len = cur_offs;\n  let ret = [`buf:${pak.buf_offs}/${pak.buf_len}`];\n  if (pak.bufs) {\n    // write packet, just combine and reset location when done\n    pak.makeReadable();\n    ret.push('bufs');\n  } else {\n    // read packet, or write packet that is a single buf\n    if (pak.readable) {\n      read_len = pak.buf_len;\n    }\n    assert(pak.buf);\n    pak.buf_offs = 0;\n  }\n  let saved_ref_count = pak.ref_count;\n  pak.ref(); // prevent auto pooling\n  try {\n    if (pak.has_flags) {\n      ret.push(`flags:${pak.readU8()}`);\n    }\n    while (pak.buf_offs < read_len) {\n      let type_idx = pak.readU8();\n      let type = types[type_idx];\n      if (!type) {\n        ret.push(`UnknownType:${type_idx}`);\n        break;\n      }\n      let val = pak[`read${type}`]();\n      ret.push(`${type}:${format(val)}`);\n    }\n  } catch (e) {\n    ret.push(`Error dumping packet contents: ${e}`);\n  }\n  pak.ref_count = saved_ref_count;\n  pak.buf_offs = cur_offs;\n  return ret.join(',');\n};\n\nfunction packetCreate(flags, init_size) {\n  if (flags === undefined) {\n    flags = exports.default_flags;\n  }\n  let pool = flags & PACKET_DEBUG ? pak_debug_pool : pak_pool;\n  if (pool.length) {\n    let pak = pool.pop();\n    pak.reinit(flags, init_size);\n    return pak;\n  }\n  if (flags & PACKET_DEBUG) {\n    return new PacketDebug(flags, init_size);\n  }\n  return new Packet(flags, init_size);\n}\nexports.packetCreate = packetCreate;\n\nfunction packetFromBuffer(buf, buf_len, need_copy) {\n  let flags = buf[0];\n  assert.equal(typeof flags, 'number'); // `buf` should be a Buffer or Uint8Array, not a DataView like other funcs here\n  if (need_copy) {\n    assert(buf_len);\n    assert(buf.buffer instanceof ArrayBuffer);\n    let pak = packetCreate(flags, buf_len);\n    if (buf.byteLength !== buf_len) {\n      buf = Buffer.from(buf.buffer, 0, buf_len);\n    }\n    pak.getBuffer().set(buf);\n    pak.setReadable();\n    return pak;\n  } else {\n    // reference unowned/unpoolable buffer\n    assert(buf instanceof Uint8Array);\n    let pak = packetCreate(flags | PACKET_UNOWNED_BUFFER);\n    pak.setBuffer(buf, buf_len || buf.byteLength);\n    return pak;\n  }\n}\nexports.packetFromBuffer = packetFromBuffer;\n\nfunction packetFromJSON(js_obj) {\n  let pak = packetCreate(js_obj.f);\n\n  let payload = pak.pak || pak;\n\n  function decode(str) {\n    return base64Decode(str, allocDataView);\n  }\n  if (js_obj.b) {\n    payload.bsizes = [];\n    payload.bufs = [];\n    for (let ii = 0; ii < js_obj.b.length; ++ii) {\n      let buf = decode(js_obj.b[ii]);\n      payload.bufs.push(buf);\n      payload.bsizes.push(buf.decode_size);\n      delete buf.decode_size;\n    }\n  }\n  if (js_obj.d) {\n    payload.buf = decode(js_obj.d);\n    payload.buf_len = payload.buf.decode_size;\n    delete payload.buf.decode_size;\n    payload.buf_offs = 0;\n  }\n\n  return pak;\n}\nexports.packetFromJSON = packetFromJSON;\n\nfunction isPacket(thing) {\n  return thing instanceof Packet || thing instanceof PacketDebug;\n}\nexports.isPacket = isPacket;","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n/* eslint prefer-rest-params:off, no-underscore-dangle:off */\n\nconst assert = require('assert');\n\nfunction EventEmitter() {\n  this._listeners = {};\n}\n\nmodule.exports = EventEmitter;\nmodule.exports.EventEmitter = EventEmitter;\n\nfunction addListener(ee, type, fn, once) {\n  assert(typeof fn === 'function');\n  let arr = ee._listeners[type];\n  if (!arr) {\n    arr = ee._listeners[type] = [];\n  }\n  arr.push({\n    once,\n    fn\n  });\n}\n\nEventEmitter.prototype.hasListener = function (type, fn) {\n  let arr = this._listeners[type];\n  if (!arr) {\n    return false;\n  }\n  for (let ii = 0; ii < arr.length; ++ii) {\n    if (arr[ii].fn === fn) {\n      return true;\n    }\n  }\n  return false;\n};\n\nEventEmitter.prototype.on = function (type, fn) {\n  addListener(this, type, fn, 0);\n  return this;\n};\n\nEventEmitter.prototype.once = function (type, fn) {\n  addListener(this, type, fn, 1);\n  return this;\n};\n\nEventEmitter.prototype.removeListener = function (type, fn) {\n  let arr = this._listeners[type];\n  assert(arr);\n  for (let ii = 0; ii < arr.length; ++ii) {\n    if (arr[ii].fn === fn) {\n      arr.splice(ii, 1);\n      return this;\n    }\n  }\n  assert(false); // expected to find the listener!\n  return this;\n};\n\nfunction filterNotOnce(elem) {\n  return !elem.once;\n}\n\nEventEmitter.prototype.emit = function (type, ...args) {\n  let arr = this._listeners[type];\n  if (!arr) {\n    return false;\n  }\n\n  let any = false;\n  let any_once = false;\n  for (let ii = 0; ii < arr.length; ++ii) {\n    let elem = arr[ii];\n    any = true;\n    elem.fn(...args);\n    if (elem.once) {\n      any_once = true;\n    }\n  }\n  if (any_once) {\n    this._listeners[type] = arr.filter(filterNotOnce);\n  }\n\n  return any;\n};\n\n// Aliases\n// EventEmitter.prototype.addListener = EventEmitter.prototype.on;","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst assert = require('assert');\nconst { abs, floor, min, max, random, round, pow, sqrt } = Math;\n\nexport function nop() {\n  // empty\n}\n\nexport function empty(obj) {\n  for (let key in obj) {\n    return false;\n  }\n  return true;\n}\n\nexport function easeInOut(v, a) {\n  let va = pow(v, a);\n  return va / (va + pow(1 - v, a));\n}\n\nexport function easeIn(v, a) {\n  return 2 * easeInOut(0.5 * v, a);\n}\n\nexport function easeOut(v, a) {\n  return 2 * easeInOut(0.5 + 0.5 * v, a) - 1;\n}\n\nexport function clone(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nexport function merge(dest, src) {\n  for (let f in src) {\n    dest[f] = src[f];\n  }\n  return dest;\n}\n\nexport function has(obj, field) {\n  return Object.prototype.hasOwnProperty.call(obj, field);\n}\n\nexport function defaults(dest, src) {\n  for (let f in src) {\n    if (!has(dest, f)) {\n      dest[f] = src[f];\n    }\n  }\n  return dest;\n}\n\nexport function cloneShallow(src) {\n  return merge({}, src);\n}\n\nexport function clamp(v, mn, mx) {\n  return min(max(mn, v), mx);\n}\n\nexport function lerp(a, v0, v1) {\n  return (1 - a) * v0 + a * v1;\n}\n\nexport function mix(v0, v1, a) {\n  // GLSL semantics\n  return (1 - a) * v0 + a * v1;\n}\n\nexport function sign(a) {\n  return a < 0 ? -1 : a > 0 ? 1 : 0;\n}\n\n// log2 rounded up to nearest integer\nexport function log2(val) {\n  for (let ii = 1, jj = 0;; ii <<= 1, ++jj) {\n    // eslint-disable-line no-bitwise\n    if (ii >= val) {\n      return jj;\n    }\n  }\n}\n\nexport function ridx(arr, idx) {\n  arr[idx] = arr[arr.length - 1];\n  arr.pop();\n}\n\nexport function round100(a) {\n  return round(a * 100) / 100;\n}\n\nexport function round1000(a) {\n  return round(a * 1000) / 1000;\n}\n\nexport function fract(a) {\n  return a - floor(a);\n}\n\nexport function nearSame(a, b, tol) {\n  return abs(b - a) <= tol;\n}\n\nexport function titleCase(str) {\n  return str.split(' ').map(word => `${word[0].toUpperCase()}${word.slice(1)}`).join(' ');\n}\n\nconst EPSILON = 0.00001;\n\n// http://local.wasp.uwa.edu.au/~pbourke/geometry/sphereline/\nexport function lineCircleIntersect(p1, p2, pCircle, radius) {\n  let dp = [p2[0] - p1[0], p2[1] - p1[1]];\n  let a = dp[0] * dp[0] + dp[1] * dp[1];\n  let b = 2 * (dp[0] * (p1[0] - pCircle[0]) + dp[1] * (p1[1] - pCircle[1]));\n  let c = pCircle[0] * pCircle[0] + pCircle[1] * pCircle[1];\n  c += p1[0] * p1[0] + p1[1] * p1[1];\n  c -= 2 * (pCircle[0] * p1[0] + pCircle[1] * p1[1]);\n  c -= radius * radius;\n  let bb4ac = b * b - 4 * a * c;\n  if (abs(a) < EPSILON || bb4ac < 0) {\n    return false;\n  }\n\n  let mu1 = (-b + sqrt(bb4ac)) / (2 * a);\n  let mu2 = (-b - sqrt(bb4ac)) / (2 * a);\n  if (mu1 >= 0 && mu1 <= 1 || mu2 >= 0 && mu2 <= 1) {\n    return true;\n  }\n\n  return false;\n}\n\nexport function inherits(ctor, superCtor) {\n  // From Node.js\n  assert(typeof superCtor === 'function');\n  // not needed? ctor.super_ = superCtor; // eslint-disable-line no-underscore-dangle\n  // second parameter also not actually needed, just defines new Foo().constructor === Foo?\n  ctor.prototype = Object.create(superCtor.prototype, {\n    constructor: {\n      value: ctor,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n}\n\nexport function isPowerOfTwo(n) {\n  return (n & n - 1) === 0; // eslint-disable-line no-bitwise\n}\n\nexport function nextHighestPowerOfTwo(x) {\n  --x;\n  for (let i = 1; i < 32; i <<= 1) {\n    // eslint-disable-line no-bitwise\n    x |= x >> i; // eslint-disable-line no-bitwise\n  }\n  return x + 1;\n}\n\nexport function logdata(data) {\n  if (data === undefined) {\n    return '';\n  }\n  let r = JSON.stringify(data);\n  if (r.length < 120) {\n    return r;\n  }\n  return `${r.slice(0, 120 - 3)}...`;\n}\n\nexport function isInteger(v) {\n  return typeof v === 'number' && isFinite(v) && floor(v) === v;\n}\n\nexport function toNumber(v) {\n  return Number(v);\n}\n\nexport function randomNot(not_value, max_value) {\n  let new_value;\n  do {\n    new_value = floor(random() * max_value);\n  } while (new_value === not_value);\n  return new_value;\n}\n\nexport function toArray(array_like) {\n  return Array.prototype.slice.call(array_like);\n}\n\nexport function matchAll(str, re) {\n  let ret = [];\n  let m;\n  do {\n    m = re.exec(str);\n    if (m) {\n      ret.push(m[1]);\n    }\n  } while (m);\n  return ret;\n}\n\nexport function callEach(arr, pre_clear, ...args) {\n  if (arr && arr.length) {\n    for (let ii = 0; ii < arr.length; ++ii) {\n      arr[ii](...args);\n    }\n  }\n}","// Portions Copyright 2019 Jimb Esser (https://github.com/Jimbly/)\n// Released under MIT License: https://opensource.org/licenses/MIT\n\nconst ack = require('./ack.js');\nconst assert = require('assert');\nconst { ackHandleMessage, ackWrapPakStart, ackWrapPakPayload, ackWrapPakFinish } = ack;\nconst packet = require('./packet.js');\nconst { isPacket, packetCreate, packetFromBuffer } = packet;\n\nexport const CONNECTION_TIMEOUT = 60000;\nexport const PING_TIME = CONNECTION_TIMEOUT / 2;\nexports.PROTOCOL_VERSION = '1';\n\n// Rough estimate, if over, will prevent resizing the packet\nconst PAK_HEADER_SIZE = 1 + // flags\n1 + 16 + // message id\n1 + 9; // resp_pak_id\n\nexport function wsPakSendDest(client, pak) {\n  if (!client.connected || client.socket.readyState !== 1) {\n    console.error('Attempting to send on a disconnected link (internal), ignoring');\n    pak.pool();\n    return;\n  }\n  let buf = pak.getBuffer(); // a Uint8Array\n  let buf_len = pak.getBufferLen();\n  if (buf_len !== buf.length) {\n    buf = new Uint8Array(buf.buffer, buf.byteOffset, buf_len);\n  }\n  if (client.ws_server) {\n    client.socket.send(buf, function () {\n      pak.pool();\n    });\n  } else {\n    client.socket.send(buf);\n    pak.pool();\n  }\n  client.last_send_time = Date.now();\n}\n\nfunction wsPakSendFinish(pak, err, resp_func) {\n  let { client, msg } = pak.ws_data;\n  delete pak.ws_data;\n  let ack_resp_pkt_id = ackWrapPakFinish(pak, err, resp_func);\n\n  if (!client.connected || client.socket.readyState !== 1) {\n    // WebSocket.OPEN\n    (client.log ? client : console).log(`Attempting to send msg=${msg} on a disconnected link, ignoring`);\n    if (!client.log && client.onError && msg && typeof msg !== 'number') {\n      // On the client, if we try to send a new packet while disconnected, this is an application error\n      client.onError(`Attempting to send msg=${msg} on a disconnected link`);\n    }\n\n    if (ack_resp_pkt_id) {\n      // Callback will never be dispatched through ack.js, remove the callback here\n      delete client.resp_cbs[ack_resp_pkt_id];\n    }\n    pak.pool();\n    return;\n  }\n\n  assert.equal(Boolean(resp_func), Boolean(ack_resp_pkt_id));\n\n  wsPakSendDest(client, pak);\n}\n\nfunction wsPakSend(err, resp_func) {\n  let pak = this; //eslint-disable-line no-invalid-this\n  if (typeof err === 'function' && !resp_func) {\n    resp_func = err;\n    err = null;\n  }\n  wsPakSendFinish(pak, err, resp_func);\n}\n\nexport function wsPak(msg, ref_pak, client) {\n  assert(typeof msg === 'string' || typeof msg === 'number');\n\n  // Assume new packet needs to be comparable to old packet, in flags and size\n  let pak = packetCreate(ref_pak ? ref_pak.getInternalFlags() : packet.default_flags, ref_pak ? ref_pak.totalSize() + PAK_HEADER_SIZE : 0);\n  pak.writeFlags();\n\n  ackWrapPakStart(pak, client, msg);\n\n  pak.ws_data = {\n    msg,\n    client\n  };\n  pak.send = wsPakSend;\n  return pak;\n}\n\nfunction sendMessageInternal(client, msg, err, data, resp_func) {\n  let is_packet = isPacket(data);\n  let pak = wsPak(msg, is_packet ? data : null, client);\n\n  if (!err) {\n    ackWrapPakPayload(pak, data);\n  }\n\n  pak.send(err, resp_func);\n}\n\nexport function sendMessage(msg, data, resp_func) {\n  sendMessageInternal(this, msg, null, data, resp_func); // eslint-disable-line no-invalid-this\n}\n\nexport function wsHandleMessage(client, buf) {\n  let now = Date.now();\n  let source = client.id ? `client ${client.id}` : 'server';\n  if (!(buf instanceof Uint8Array)) {\n    (client.log ? client : console).log(`Received incorrect WebSocket data type from ${source} (${typeof buf})`);\n    return client.onError('Invalid data received');\n  }\n  let pak = packetFromBuffer(buf, buf.length, false);\n  pak.readFlags();\n  client.last_receive_time = now;\n\n  return ackHandleMessage(client, source, pak, function sendFunc(msg, err, data, resp_func) {\n    if (resp_func && !resp_func.expecting_response) {\n      resp_func = null;\n    }\n    sendMessageInternal(client, msg, err, data, resp_func);\n  }, function pakFunc(msg, ref_pak) {\n    return wsPak(msg, ref_pak, client);\n  }, function handleFunc(msg, data, resp_func) {\n    let handler = client.handlers[msg];\n    if (!handler) {\n      let error_msg = `No handler for message ${JSON.stringify(msg)} from ${source}`;\n      console.error(error_msg, data);\n      if (client.onError) {\n        return client.onError(error_msg);\n      }\n      return resp_func(error_msg);\n    }\n    return handler(client, data, resp_func);\n  });\n}"]}